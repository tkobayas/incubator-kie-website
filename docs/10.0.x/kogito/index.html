<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="The Kogito Community &lt;https://kie.apache.org/community/&gt;">
<title>Kogito Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<!-- Collapsed Table of Content -->
<link rel="stylesheet" href="website/jstree/style.css" />
<link rel="stylesheet" href="website/toc.css" />
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Kogito Documentation</h1>
<div class="details">
<span id="author" class="author">The Kogito Community &lt;https://kie.apache.org/community/&gt;</span><br>
<span id="revnumber">version 10.0.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#chap-kogito-creating-running">1. Creating and running your first Kogito services</a>
<ul class="sectlevel2">
<li><a href="#con-kogito-automation_kogito-creating-running">1.1. Kogito business automation</a>
<ul class="sectlevel3">
<li><a href="#_cloud_first_priority">1.1.1. Cloud-first priority</a></li>
<li><a href="#_domain_specific_flexibility">1.1.2. Domain-specific flexibility</a></li>
<li><a href="#_developer_centered_experience">1.1.3. Developer-centered experience</a></li>
<li><a href="#con-kogito-quarkus-springboot_kogito-creating-running">1.1.4. Kogito on Quarkus and Spring Boot</a></li>
</ul>
</li>
<li><a href="#ref-kogito-app-examples_kogito-creating-running">1.2. Example applications with Kogito services</a>
<ul class="sectlevel3">
<li><a href="#proc-kogito-app-examples-running_kogito-creating-running">1.2.1. Running the Kogito example applications</a></li>
<li><a href="#proc-kogito-app-examples-with-console-running_kogito-creating-running">1.2.2. Interacting with Kogito Management and Task Console using example applications</a></li>
</ul>
</li>
<li><a href="#con-kogito-modelers_kogito-creating-running">1.3. Kogito BPMN and DMN modelers</a>
<ul class="sectlevel3">
<li><a href="#proc-kogito-vscode-extension_kogito-creating-running">1.3.1. Installing the Apache KIE™ Kogito Bundle VSCode extension</a></li>
<li><a href="#proc-kogito-standalone-editors_kogito-creating-running">1.3.2. Configuring the Kogito standalone editors</a></li>
</ul>
</li>
<li><a href="#proc-kogito-creating-project_kogito-creating-running">1.4. Creating a Maven project for a Kogito service</a>
<ul class="sectlevel3">
<li><a href="#proc-customizing-spring-boot-project-creation_kogito-creating-running">1.4.1. Creating a custom Kogito Spring Boot project</a></li>
<li><a href="#proc-kogito-creating-project-custom_kogito-creating-running">1.4.2. Creating a custom Kogito project using code scaffolding</a></li>
</ul>
</li>
<li><a href="#proc-kogito-custom-rest-endpoint-api_kogito-creating-running">1.5. Creating custom REST endpoints using Kogito API</a></li>
<li><a href="#con-kogito-spring-boot-starters_kogito-creating-running">1.6. Spring Boot Starters for your Kogito project</a>
<ul class="sectlevel3">
<li><a href="#ref-kogito-spring-boot-starter_kogito-creating-running">1.6.1. Kogito Spring Boot Starters</a></li>
</ul>
</li>
<li><a href="#ref-kogito-add-ons_kogito-creating-running">1.7. Kogito add-ons</a>
<ul class="sectlevel3">
<li><a href="#_kogito_messaging_add_on">1.7.1. Kogito messaging add-on</a></li>
<li><a href="#_kogito_decision_model_and_notation_dmn_event_driven_add_on">1.7.2. Kogito Decision Model and Notation (DMN) event-driven add-on</a></li>
<li><a href="#_kogito_explainability_add_on">1.7.3. Kogito explainability add-on</a></li>
<li><a href="#_kogito_jobs_management_add_on">1.7.4. Kogito jobs management add-on</a></li>
<li><a href="#_kogito_knative_eventing_add_on">1.7.5. Kogito Knative Eventing add-on</a></li>
<li><a href="#_kogito_mail_add_on">1.7.6. Kogito mail add-on</a></li>
<li><a href="#_kogito_events_add_on">1.7.7. Kogito events add-on</a></li>
<li><a href="#_kogito_monitoring_add_on">1.7.8. Kogito monitoring add-on</a></li>
<li><a href="#_kogito_persistence_add_on">1.7.9. Kogito persistence add-on</a></li>
<li><a href="#con-bpmn-process-management-addon_kogito-creating-running">1.7.10. Kogito process management add-on</a></li>
<li><a href="#con-bpmn-process-svg-addon_kogito-creating-running">1.7.11. Kogito process SVG add-on</a></li>
<li><a href="#con-bpmn-process-event-addon_kogito-creating-running">1.7.12. Kogito process event add-on</a></li>
<li><a href="#_kogito_task_management_add_on">1.7.13. Kogito task management add-on</a></li>
<li><a href="#_kogito_tracing_add_on">1.7.14. Kogito tracing add-on</a></li>
<li><a href="#source-files-add-on">1.7.15. Kogito source files add-on</a></li>
</ul>
</li>
<li><a href="#proc-kogito-designing-app_kogito-creating-running">1.8. Designing the application logic for a Kogito service using DMN and BPMN</a>
<ul class="sectlevel3">
<li><a href="#proc-kogito-designing-app-rule-units_kogito-creating-running">1.8.1. Using DRL rule units as an alternative decision service</a></li>
</ul>
</li>
<li><a href="#proc-kogito-testing-decision-logic_kogito-creating-running">1.9. Testing the decision logic for a Kogito service using test scenarios</a></li>
<li><a href="#proc-kogito-running-app_kogito-creating-running">1.10. Running a Kogito service</a></li>
<li><a href="#proc-kogito-interacting-app_kogito-creating-running">1.11. Interacting with a running Kogito service</a></li>
<li><a href="#ref-kogito-glossary_kogito-creating-running">1.12. Kogito glossary of terms</a></li>
<li><a href="#_additional_resources">1.13. Additional resources</a></li>
</ul>
</li>
<li><a href="#collection-kogito-developing-decision-services">2. Developing decision services with Kogito</a>
<ul class="sectlevel2">
<li><a href="#chap-kogito-using-dmn-models">2.1. Using DMN models in Kogito services</a>
<ul class="sectlevel3">
<li><a href="#ref-decision-authoring-assets_kogito-dmn-models">2.1.1. Decision-authoring assets in Kogito</a></li>
<li><a href="#con-dmn_kogito-dmn-models">2.1.2. Decision Model and Notation (DMN)</a></li>
<li><a href="#con-dmn-support_kogito-dmn-models">2.1.3. DMN support in Kogito</a></li>
<li><a href="#proc-dmn-model-creating_kogito-dmn-models">2.1.4. Creating and editing DMN models in the Kogito DMN modeler</a></li>
<li><a href="#con-kogito-service-execution_kogito-dmn-models">2.1.5. Kogito service execution</a></li>
<li><a href="#con-audit-console_kogito-dmn-models">2.1.6. Kogito Audit Investigation Console</a></li>
<li><a href="#_additional_resources_2">2.1.7. Additional resources</a></li>
</ul>
</li>
<li><a href="#chap-kogito-using-drl-rules">2.2. Using DRL rules in Kogito services</a>
<ul class="sectlevel3">
<li><a href="#ref-decision-authoring-assets_kogito-drl-rules">2.2.1. Decision-authoring assets in Kogito</a></li>
<li><a href="#con-drl_kogito-drl-rules">2.2.2. Drools Rule Language (DRL)</a></li>
<li><a href="#proc-drl-rules-central-create_kogito-drl-rules">2.2.3. Creating DRL rules for your Kogito project</a></li>
<li><a href="#con-kogito-service-execution_kogito-drl-rules">2.2.4. Kogito service execution</a></li>
<li><a href="#_additional_resources_3">2.2.5. Additional resources</a></li>
</ul>
</li>
<li><a href="#chap-kogito-using-spreadsheet-decision-tables">2.3. Using spreadsheet decision tables in Kogito services</a>
<ul class="sectlevel3">
<li><a href="#ref-decision-authoring-assets_kogito-decision-tables">2.3.1. Decision-authoring assets in Kogito</a></li>
<li><a href="#con-decision-tables_kogito-decision-tables">2.3.2. Spreadsheet decision tables</a></li>
<li><a href="#con-decision-tables-use-case_kogito-decision-tables">2.3.3. Decision table use case</a></li>
<li><a href="#proc-decision-tables-creating_kogito-decision-tables">2.3.4. Creating spreadsheet decision tables for your Kogito project</a></li>
<li><a href="#con-kogito-service-execution_kogito-decision-tables">2.3.5. Kogito service execution</a></li>
<li><a href="#_additional_resources_4">2.3.6. Additional resources</a></li>
</ul>
</li>
<li><a href="#chap-kogito-decision-engine">2.4. Decision engine in Kogito</a>
<ul class="sectlevel3">
<li><a href="#con-decision-engine_kogito-decision-engine">2.4.1. Decision engine in Kogito</a></li>
<li><a href="#con-execution-control_kogito-decision-engine">2.4.2. Execution control in the decision engine</a></li>
<li><a href="#con-phreak-algorithm_kogito-decision-engine">2.4.3. Phreak rule algorithm in the decision engine</a></li>
<li><a href="#con-engine-event-listeners_kogito-decision-engine">2.4.4. Decision engine event listeners and debug logging</a></li>
<li><a href="#_additional_resources_5">2.4.5. Additional resources</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#chap-kogito-developing-process-services">3. Developing process services with Kogito</a>
<ul class="sectlevel2">
<li><a href="#con-bpmn_kogito-developing-process-services">3.1. Business Process Model and Notation (BPMN) 2.0</a>
<ul class="sectlevel3">
<li><a href="#ref-bpmn-model-example_kogito-developing-process-services">3.1.1. BPMN model example</a></li>
<li><a href="#ref-bpmn-support_kogito-developing-process-services">3.1.2. BPMN2 support in Kogito</a></li>
<li><a href="#ref-bpmn-start-events_kogito-developing-process-services">3.1.3. Start events supported in Kogito</a></li>
<li><a href="#ref-bpmn-intermediate-events_kogito-developing-process-services">3.1.4. Intermediate events supported in Kogito</a></li>
<li><a href="#ref-bpmn-end-events_kogito-developing-process-services">3.1.5. End events supported in Kogito</a></li>
<li><a href="#ref-bpmn-tasks_kogito-developing-process-services">3.1.6. Tasks supported in Kogito</a></li>
<li><a href="#ref-bpmn-custom-tasks_kogito-developing-process-services">3.1.7. Custom tasks supported in Kogito</a></li>
<li><a href="#ref-bpmn-subprocesses_kogito-developing-process-services">3.1.8. Subprocesses supported in Kogito</a></li>
<li><a href="#ref-bpmn-gateways_kogito-developing-process-services">3.1.9. Gateways supported in Kogito</a></li>
<li><a href="#ref-bpmn-connectors_kogito-developing-process-services">3.1.10. Connectors supported in Kogito</a></li>
</ul>
</li>
<li><a href="#proc-bpmn-model-creating_kogito-developing-process-services">3.2. Creating and editing BPMN models in the Kogito BPMN modeler</a></li>
<li><a href="#con-bpmn-variables_kogito-developing-process-services">3.3. Variables in Kogito processes</a>
<ul class="sectlevel3">
<li><a href="#_variable_tags_in_bpmn_process_files">3.3.1. Variable tags in BPMN process files</a></li>
<li><a href="#proc-bpmn-variables-process_kogito-developing-process-services">3.3.2. Defining process variables in Kogito processes</a></li>
<li><a href="#proc-bpmn-variables-local_kogito-developing-process-services">3.3.3. Defining local variables in Kogito processes</a></li>
</ul>
</li>
<li><a href="#con-persistence_kogito-developing-process-services">3.4. Persistence in Kogito services</a>
<ul class="sectlevel3">
<li><a href="#_persistence_workflow_in_kogito">3.4.1. Persistence workflow in Kogito</a></li>
<li><a href="#_persisted_process_instance_variables_and_data_types">3.4.2. Persisted process instance variables and data types</a></li>
<li><a href="#_supported_data_types_for_persisted_variables">3.4.3. Supported data types for persisted variables</a></li>
<li><a href="#proc-jdbc-persistence-enabling_kogito-developing-process-services">3.4.4. Enabling JDBC persistence for Kogito services</a></li>
<li><a href="#proc-infinispan-persistence-enabling_kogito-developing-process-services">3.4.5. Enabling Infinispan persistence for Kogito services</a></li>
<li><a href="#proc-mongodb-persistence-enabling_kogito-developing-process-services">3.4.6. Enabling MongoDB persistence for Kogito services</a></li>
<li><a href="#proc-kafka-streams-persistence-enabling_kogito-developing-process-services">3.4.7. Enabling Kafka Streams persistence for Kogito services</a></li>
<li><a href="#proc-locking-persistence-enabling_kogito-developing-process-services">3.4.8. Enabling optimistic locking with persistence</a></li>
</ul>
</li>
<li><a href="#proc-messaging-enabling_kogito-developing-process-services">3.5. Enabling Kafka messaging for Kogito services</a></li>
<li><a href="#con-knative-eventing_kogito-developing-process-services">3.6. Knative Eventing in Kogito services</a>
<ul class="sectlevel3">
<li><a href="#proc-knative-eventing-process-services_kogito-developing-process-services">3.6.1. Enabling Knative Eventing for Kogito services</a></li>
</ul>
</li>
<li><a href="#con-task-lifecycle_kogito-developing-process-services">3.7. Task lifecycle in Kogito processes</a>
<ul class="sectlevel3">
<li><a href="#_user_task_authorization">3.7.1. User task authorization</a></li>
<li><a href="#_rest_endpoints_for_tasks_in_kogito">3.7.2. REST endpoints for tasks in Kogito</a></li>
<li><a href="#_api_interaction_with_task_lifecycle_phases">3.7.3. API interaction with task lifecycle phases</a></li>
<li><a href="#proc-task-lifecycle-custom_kogito-developing-process-services">3.7.4. Creating a custom task lifecycle and phase</a></li>
<li><a href="#con-task-notification-addon_kogito-developing-process-services">3.7.5. Kogito task notification add-on</a></li>
</ul>
</li>
<li><a href="#con-process-decisions-integration_kogito-developing-process-services">3.8. Processes and decisions integration in Kogito</a>
<ul class="sectlevel3">
<li><a href="#con-process-decisions-integration-embedded_kogito-developing-process-services">3.8.1. Embedded method to integrate processes and decisions</a></li>
<li><a href="#con-process-decisions-integration-remote_kogito-developing-process-services">3.8.2. Remote method to integrate processes and decisions</a></li>
</ul>
</li>
<li><a href="#con-flex-processes_kogito-developing-process-services">3.9. Flexible processes for case management in Kogito</a>
<ul class="sectlevel3">
<li><a href="#ref-flex-process-example_kogito-developing-process-services">3.9.1. Flexible process example</a></li>
</ul>
</li>
<li><a href="#con-bpmn-process-management-addon_kogito-developing-process-services">3.10. Kogito process management add-on</a>
<ul class="sectlevel3">
<li><a href="#_rest_endpoints_for_the_process_management_add_on">3.10.1. REST endpoints for the process management add-on</a></li>
</ul>
</li>
<li><a href="#con-bpmn-process-svg-addon_kogito-developing-process-services">3.11. Kogito process SVG add-on</a>
<ul class="sectlevel3">
<li><a href="#_rest_endpoints_for_the_process_svg_add_on">3.11.1. REST endpoints for the process SVG add-on</a></li>
</ul>
</li>
<li><a href="#con-bpmn-process-event-addon_kogito-developing-process-services">3.12. Kogito process event add-on</a></li>
<li><a href="#con-management-console_kogito-developing-process-services">3.13. Kogito Management Console</a>
<ul class="sectlevel3">
<li><a href="#proc-management-console-using_kogito-developing-process-services">3.13.1. Using the Kogito Management Console to manage process instances</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="./logos/kogitoLogo.png" alt="kogitoLogo">
</div>
</div>
<h1 id="_welcome" class="discrete">Welcome</h1>
</div>
</div>
<div class="sect1">
<h2 id="chap-kogito-creating-running"><a class="anchor" href="#chap-kogito-creating-running"></a><a class="link" href="#chap-kogito-creating-running">1. Creating and running your first Kogito services</a></h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a developer of business processes and decisions, you can use Kogito business automation to build  cloud-native applications that adapt to your business domain and tooling.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>JDK 17 is installed.</p>
</li>
<li>
<p>Apache Maven 3.9.6 is installed.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="con-kogito-automation_kogito-creating-running"><a class="anchor" href="#con-kogito-automation_kogito-creating-running"></a><a class="link" href="#con-kogito-automation_kogito-creating-running">1.1. Kogito business automation</a></h3>
<div class="paragraph _abstract">
<p>Kogito is a cloud-native business automation technology for building cloud-ready business applications. The name <em>Kogito</em> derives from the Latin "Cogito", as in "Cogito, ergo sum" ("I think, therefore I am"), and is pronounced <code>[ˈkoː.d͡ʒi.to]</code> (<em>KO-jee-to</em>). The letter <em>K</em> refers to Kubernetes, the base for OpenShift as the target cloud platform for Kogito, and to the Knowledge Is Everything (KIE) open source business automation project from which Kogito originates.</p>
</div>
<div class="paragraph">
<p>Kogito is optimized for a hybrid cloud environment and adapts to your domain and tooling needs. The core objective of Kogito is to help you mold a set of business processes and decisions into your own domain-specific cloud-native set of services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-assets-to-cloud_enterprise.png" alt="Image of business assets moving to cloud services">
</div>
<div class="title">Figure 1. Business processes and decisions to cloud services</div>
</div>
<div class="paragraph">
<p>When you use Kogito, you are building a cloud-native application as a set of independent domain-specific services to achieve some business value. The processes and decisions that you use to describe the target behavior are executed as part of the services that you create. The resulting services are highly distributed and scalable with no centralized orchestration service, and the runtime that your service uses is optimized for what your service needs.</p>
</div>
<div class="paragraph">
<p>If you need long-lived processes, you can persist the runtime state externally in a data grid such as Infinispan or the provided Data Index service. Each Kogito service also produces events that can be consumed by other services. For example, if you use Apache Kafka, events can be aggregated and indexed in a data index service, offering advanced query capabilities through GraphQL.</p>
</div>
<div class="paragraph">
<p>Kogito includes components that are based on well-known business automation KIE projects, specifically <a href="https://drools.org">Drools</a>, <a href="https://jbpm.org">jBPM</a>, and <a href="https://optaplanner.org">OptaPlanner</a>, to offer dependable open source solutions for business rules, business processes, and constraint solving.</p>
</div>
<div class="sect3">
<h4 id="_cloud_first_priority"><a class="anchor" href="#_cloud_first_priority"></a><a class="link" href="#_cloud_first_priority">1.1.1. Cloud-first priority</a></h4>
<div class="paragraph">
<p>Kogito is designed to run and scale on a cloud infrastructure. You can use Kogito with the latest cloud-based technologies, such as Quarkus, Knative, and Apache Kafka, to increase start times and instant scaling on container application platforms, such as OpenShift.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-related-technolgies_enterprise.png" alt="Image of cloud-based technologies">
</div>
<div class="title">Figure 2. Technologies used with Kogito</div>
</div>
<div class="paragraph">
<p>For example, Kogito is compatible with the following technologies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpenShift</strong>, based on Kubernetes, is the target platform for building and managing containerized applications.</p>
</li>
<li>
<p><strong>Quarkus</strong> is native Java stack for Kubernetes that you can use to build applications with Kogito services.</p>
</li>
<li>
<p><strong>Spring Boot</strong> is also supported with Kogito so that you can use the Spring Framework with Kogito.</p>
</li>
<li>
<p><strong>GraalVM</strong> with Quarkus enables you to use native compilation with Kogito, resulting in fast start-up times and minimal footprint. For example, a native Kogito service starts in about 0.003ms, about 100 times faster than a non-native start-up. Fast start-up is almost a necessity in a cloud ecosystem, especially if you need small serverless applications.</p>
</li>
<li>
<p><strong>Knative</strong> enables you to build serverless applications with Kogito that you can scale up or down (to zero) as needed.</p>
</li>
<li>
<p><strong>Prometheus</strong> and <strong>Grafana</strong> are compatible with Kogito services for monitoring and analytics with optional extensions.</p>
</li>
<li>
<p><strong>Infinispan</strong> and <strong>MongoDB</strong> are middleware technologies that Kogito supports for persistence.</p>
</li>
<li>
<p><strong>Kafka</strong> and <strong>Keycloak</strong> are middleware technologies that Kogito supports for messaging and security.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_domain_specific_flexibility"><a class="anchor" href="#_domain_specific_flexibility"></a><a class="link" href="#_domain_specific_flexibility">1.1.2. Domain-specific flexibility</a></h4>
<div class="paragraph">
<p>Kogito adapts to your business domain instead of forcing you to modify your domain to work with Kogito. You can expose your Kogito services with domain-specific APIs, based on the processes and decisions that you have defined. Domain-specific APIs for Kogito services do not require third-party or internal APIs.</p>
</div>
<div class="paragraph">
<p>For example, a process for onboarding employees could generate remote REST API endpoints that you can use to onboard new employees or get information on their status, all using domain-specific JSON data.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-domain-api-endpoints-example.png" alt="Image of REST API endpoints in Swagger UI">
</div>
<div class="title">Figure 3. Example custom API endpoints in Swagger</div>
</div>
<div class="paragraph">
<p>You can also expose domain-specific data through events or in a data index so that the data can be consumed and queried by other services.</p>
</div>
</div>
<div class="sect3">
<h4 id="_developer_centered_experience"><a class="anchor" href="#_developer_centered_experience"></a><a class="link" href="#_developer_centered_experience">1.1.3. Developer-centered experience</a></h4>
<div class="paragraph">
<p>Another focus of Kogito is optimal developer experience. You can use much or all of your existing tooling and workflow to develop, build, and deploy Kogito services, whether locally for testing or into the cloud. Quarkus offers development-mode features to help with local testing, such as live reload of your processes and decisions in your running applications for advanced debugging.</p>
</div>
<div class="paragraph">
<p>Kogito tooling is embeddable so that you can continue using the workflow you already use for cloud-native services. For example, the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension enables you to edit your Business Process Model and Notation (BPMN) 2.0 business processes and Decision Model and Notation (DMN) decision models directly in your VSCode IDE, next to your other application code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-run-quarkus-devmode-demo.gif" alt="Demo of Kogito BPMN2 extension in VSCode">
</div>
<div class="title">Figure 4. Building a Kogito process service in VSCode</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-quarkus-springboot_kogito-creating-running"><a class="anchor" href="#con-kogito-quarkus-springboot_kogito-creating-running"></a><a class="link" href="#con-kogito-quarkus-springboot_kogito-creating-running">1.1.4. Kogito on Quarkus and Spring Boot</a></h4>
<div class="paragraph _abstract">
<p>The primary Java frameworks that Kogito supports are Quarkus (recommended) and Spring Boot.</p>
</div>
<div class="paragraph">
<p><a href="https://quarkus.io/">Quarkus</a> is a Kubernetes-native Java framework with a container-first approach to building Java applications, especially for Java virtual machines (JVMs) such as GraalVM and HotSpot. Quarkus optimizes Java specifically for Kubernetes by reducing the size of both the Java application and container image footprint, eliminating some of the Java programming workload from previous generations, and reducing the amount of memory required to run those images.</p>
</div>
<div class="paragraph">
<p>For Kogito services, Quarkus is the preferred framework for optimal Kubernetes compatibility and enhanced developer features, such as live reload in development mode for advanced debugging.</p>
</div>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-boot">Spring Boot</a> is a Java-based framework for building standalone production-ready Spring applications. Spring Boot enables you to develop Spring applications with minimal configurations and without an entire Spring configuration setup.</p>
</div>
<div class="paragraph">
<p>For Kogito services, Spring Boot is supported for developers who need to use Kogito in an existing Spring Framework environment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ref-kogito-app-examples_kogito-creating-running"><a class="anchor" href="#ref-kogito-app-examples_kogito-creating-running"></a><a class="link" href="#ref-kogito-app-examples_kogito-creating-running">1.2. Example applications with Kogito services</a></h3>
<div class="paragraph _abstract">
<p>Kogito includes example applications in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub. These example applications contain various types of Kogito services on Quarkus or Spring Boot to help you develop your own applications. The services use one or more Business Process Model and Notation (BPMN) process models, Decision Model and Notation (DMN) decision models, Drools Rule Language (DRL) rule units, XLS spreadsheet decision tables, or Java classes to define the service logic.</p>
</div>
<div class="paragraph">
<p>For information about each example application and instructions for using them, see the <code>README</code> file in the relevant application folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>Kogito-examples</code></a> repository in GitHub, the example applications in the default <code>stable</code> branch use the latest version of Kogito. When you run examples in a local environment, ensure that the environment matches the requirements that are listed in the <code>README</code> file of the relevant application folder. Also, this might require making the necessary network ports available, as configured for Quarkus, Spring Boot, and docker-compose where applicable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following list describes some of the examples provided with Kogito:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Decision services</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>dmn-quarkus-example</code> and <code>dmn-springboot-example</code>: A decision service (on Quarkus or Spring Boot) that uses DMN to determine driver penalty and suspension based on traffic violations.</p>
</li>
<li>
<p><code>rules-quarkus-helloworld</code>: A Hello World decision service on Quarkus with a single DRL rule unit.</p>
</li>
<li>
<p><code>ruleunit-quarkus-example</code> and <code>ruleunit-springboot-example</code>: A decision service (on Quarkus or Spring Boot) that uses DRL with rule units to validate a loan application and that exposes REST operations to view application status.</p>
</li>
<li>
<p><code>dmn-event-driven-quarkus</code> and <code>dmn-event-driven-springboot</code>: A DMN decision service on Quarkus and Spring Boot that demonstrates the capability of the Kogito Event-Driven decisions add-on.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Decision services that use the Kogito Trusty Service and Explainability Service</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>dmn-tracing-quarkus</code>: A DMN decision service on Quarkus that uses the <code>kie-addons-quarkus-tracing-decision</code> add-on to generate tracing events that the Kogito Trusty Service and Explainability Service can consume and expose.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>process-quarkus-example</code> and <code>process-springboot-example</code>: A process service (on Quarkus or Spring Boot) for ordering items and that exposes REST operations to create new orders or to list and delete active orders.</p>
</li>
<li>
<p><code>onboarding-example</code>: A combination of a process service and two decision services that use DMN and DRL for onboarding new employees.</p>
</li>
<li>
<p><code>flexible-process-quarkus</code> and <code>flexible-process-springboot</code>: A process service (on Quarkus or Spring Boot) that uses flexible processes for case management in Kogito.</p>
</li>
<li>
<p><code>process-springboot-example</code>: A process service on Spring Boot for ordering items using add-ons.</p>
</li>
<li>
<p><code>process-usertasks-with-security-oidc-quarkus-with-console</code>: A quickstart project using add-ons to show typical user task orchestration.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services that use Decision services</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>process-decision-quarkus</code>: A process service integrated with decisions services, using an embedded method, in which business rule tasks are used for communication. The decisions are declared with DMN and DRL.</p>
</li>
<li>
<p><code>process-decision-rest-quarkus</code>: A process service integrated with decisions services, using REST endpoints for remote communication. The decisions are declared with DMN and DRL.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services for OpenShift deployment</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>kogito-travel-agency</code>: A combination of process services and decision services that use DRL and XLS for travel booking, intended for deployment on OpenShift.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Process services that use MongoDB</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code>process-mongodb-persistence-quarkus</code> and <code>process-mongodb-persistence-springboot</code>: A quickstart project on (Quarkus and Spring Boot) using add-ons that process deals for travelers using MongoDB.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="proc-kogito-app-examples-running_kogito-creating-running"><a class="anchor" href="#proc-kogito-app-examples-running_kogito-creating-running"></a><a class="link" href="#proc-kogito-app-examples-running_kogito-creating-running">1.2.1. Running the Kogito example applications</a></h4>
<div class="paragraph _abstract">
<p>To get started quickly with Kogito, you can run any of the example applications in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub and experiment with the Kogito services.</p>
</div>
<div class="paragraph">
<p>For this procedure, use the <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/process-quarkus-example"><code>process-quarkus-example</code></a> or <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/process-springboot-example"><code>process-springboot-example</code></a> application. You can follow similar steps with the other Kogito examples on Quarkus or Spring Boot.</p>
</div>
<div class="paragraph">
<p>In the <code>process-quarkus-example</code> and <code>process-springboot-example</code> applications, the <code>orders.bpmn2</code> process describes the steps that need to be followed when ordering items. The process includes a script task for writing debug information and a call activity for invoking a subprocess, using a custom <code>Order</code> data object.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/bpmn-model-example-orders.png" alt="Image of `orders.bpmn` example process">
</div>
<div class="title">Figure 5. Example <code>orders.bpmn2</code> process</div>
</div>
<div class="paragraph">
<p>The <code>Add items</code> subprocess invokes the following <code>orderItems.bpmn2</code> process, which uses a <code>CalculationService.calculateTotal</code> custom Java service and a user task to verify the order.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/bpmn-model-example-order-items.png" alt="Image of `orderItems.bpmn` example process">
</div>
<div class="title">Figure 6. Example <code>orderItems.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>The <code>persons.bpmn2</code> process invokes a Drools Rule Language (DRL) rule unit in a business rule task to determine customer age, followed by a user task for special handling requirements for children, if applicable.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of `persons` process diagram">
</div>
<div class="title">Figure 7. Example <code>persons.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>Based on these processes and on application configurations, this example service exposes REST operations to create new orders, to list and delete active orders, and to determine the age of a specified person.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the latest <a href="https://github.com/apache/incubator-kie-kogito-examples/releases"><code>kogito-examples</code></a> release to a local directory and extract the file.</p>
</li>
<li>
<p>In a command terminal, navigate to the extracted <code>kogito-examples-<em>RELEASE</em>/process-<em>PLATFORM</em>-example</code> folder, and enter one of the following commands to build and run the example.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Quarkus and Spring Boot support the following run modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Development mode</strong>: For local testing. On Quarkus, development mode also offers live reload of your processes and decisions in your running applications for advanced debugging.</p>
</li>
<li>
<p><strong>JVM mode</strong>: For compatibility with a Java virtual machine (JVM).</p>
</li>
<li>
<p><strong>Native mode</strong>: (Quarkus only, requires GraalVM or Mandrel) For direct binary execution as native code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command that you use depends on your preferred run mode and application environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For development mode:</p>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p>For JVM mode:</p>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/quarkus-app/quarkus-run.jar</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/sample-kogito-1.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
</li>
<li>
<p>For native mode (requires GraalVM or Mandrel):</p>
<div class="listingblock">
<div class="title">On Quarkus only</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative
$ ./target/sample-kogito-1.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>After the Kogito service is running, use a REST client, curl utility, or the Swagger UI configured for the application (such as http://localhost:8080/q/swagger-ui or http://localhost:8080/swagger-ui.html) to send API requests with the following components:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>URL</strong>: <code>http://localhost:8080/</code></p>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> and <code>PUT</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, <code>PUT</code> or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example POST request body to create an order (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "approver": "john",
  "order": {
    "orderNumber": "12345",
    "shipped": false
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to create an order</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json' -d '{"approver" : "john", "order" : {"orderNumber" : "12345", "shipped" : false}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "approver": "john",
  "id": "6b53c227-6d5e-40b7-8c8c-a541a2a47d58",
  "order": {
    "orderNumber": "12345",
    "shipped": false,
    "total": 0.3845152065899532
  }
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-swagger-example-jbpm.png" alt="Image of Swagger UI for example application">
</div>
<div class="title">Figure 8. Swagger UI to interact with all application endpoints (such as http://localhost:8080/q/swagger-ui or http://localhost:8080/swagger-ui.html)</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the predefined Kogito example applications, the Swagger UI for interacting with service endpoints is available only on Quarkus examples that you run in
development mode or in native mode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This example procedure uses the following curl commands for convenience:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an order:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json' -d '{"approver" : "john", "order" : {"orderNumber" : "12345", "shipped" : false}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"approver":"john","id":"6b53c227-6d5e-40b7-8c8c-a541a2a47d58","order":{"orderNumber":"12345","shipped":false,"total":0.3845152065899532}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new order has an <code>"id"</code> field with a generated UUID that you can use to retrieve details about this specific order, if needed.</p>
</div>
</li>
<li>
<p>View active orders:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>[{"approver":"john","id":"6b53c227-6d5e-40b7-8c8c-a541a2a47d58","order":{"orderNumber":"12345","shipped":false,"total":0.3845152065899532}}]</code></pre>
</div>
</div>
</li>
<li>
<p>View order details using the returned UUID:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orders/6b53c227-6d5e-40b7-8c8c-a541a2a47d58 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"approver":"john","id":"6b53c227-6d5e-40b7-8c8c-a541a2a47d58","order":{"orderNumber":"12345","shipped":false,"total":0.3845152065899532}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You use the <code>"id"</code> value for the order that was returned when you created the order or when you retrieved active orders.</p>
</div>
</li>
<li>
<p>Cancel the order using the returned UUID:</p>
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE http://localhost:8080/orders/6b53c227-6d5e-40b7-8c8c-a541a2a47d58 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-app-examples-with-console-running_kogito-creating-running"><a class="anchor" href="#proc-kogito-app-examples-with-console-running_kogito-creating-running"></a><a class="link" href="#proc-kogito-app-examples-with-console-running_kogito-creating-running">1.2.2. Interacting with Kogito Management and Task Console using example applications</a></h4>
<div class="paragraph">
<p>You can interact with the Kogito Management and Task Console to run the processes using the example applications in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub. The example applications containing the <code>with-consoles</code> suffix, allow you to experiment with the Kogito services and Kogito Management and Task Console.</p>
</div>
<div class="paragraph">
<p>The Management and Task Console need to interact with the Kogito Data Index service using minimal persistence configuration, which you can perform using docker-compose configuration. The example applications provide docker-compose configuration to configure and start the required services, including Kafka, Infinispan, Kogito Data Index, Kogito Management Console, and Kogito Task Console.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/docker-compose.png" alt="Image of default services started by docker-compose 'with-console' examples">
</div>
<div class="title">Figure 9. Default services started by docker-compose 'with-console' example applications</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In each example application, the docker-compose starts the needed services to run the project. The docker-compose also configures additional services such as Keycloak (process-usertasks-with-security-oidc-PLATFORM-with-console) or Kogito Jobs (process-usertasks-timer-quarkus-with-console).
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Download the latest <a href="https://github.com/apache/incubator-kie-kogito-examples/releases"><code>kogito-examples</code></a> release to a local directory and extract the file.</p>
</li>
<li>
<p>In a command terminal, navigate to the extracted <code>kogito-examples-<em>RELEASE</em>/process-usertask-PLATFORM__-with-console</code> folder</p>
</li>
<li>
<p>Compile the project to generate the persistence file descriptor, which docker-compose uses.</p>
</li>
<li>
<p>From the docker-compose folder, execute <code>./startServices.sh</code> to start the containers with the services needed in each case.</p>
</li>
<li>
<p>Enter one of the following commands to build and run the example:</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Quarkus and Spring Boot support the following run modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Development mode</strong>: For local testing. On Quarkus, development mode also offers live reload of your processes and decisions in your running applications for advanced debugging.</p>
</li>
<li>
<p><strong>JVM mode</strong>: For compatibility with a Java virtual machine (JVM).</p>
</li>
<li>
<p><strong>Native mode</strong>: (Quarkus only, requires GraalVM or Mandrel) For direct binary execution as native code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The command that you use depends on your preferred run mode and application environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For development mode:</p>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p>For JVM mode:</p>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/quarkus-app/quarkus-run.jar</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/sample-kogito-1.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
</li>
<li>
<p>For native mode (requires GraalVM or Mandrel):</p>
<div class="listingblock">
<div class="title">On Quarkus only</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative
$ ./target/sample-kogito-1.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>When the Kogito service is running, use a REST client, curl utility, or the Swagger UI (if configured for the application) to start a new request.</p>
</li>
<li>
<p>Use the Kogito Management console to see the created process instance available by default at <code><a href="http://localhost:8280" class="bare">http://localhost:8280</a></code>.</p>
</li>
<li>
<p>Use the Kogito Task console available by default at <code><a href="http://localhost:8380" class="bare">http://localhost:8380</a></code> to execute the user tasks.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In case some ports need to be changed, you can find the configuration of the containers in the <code>docker-compose/docker-compose.yml</code> file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-kogito-modelers_kogito-creating-running"><a class="anchor" href="#con-kogito-modelers_kogito-creating-running"></a><a class="link" href="#con-kogito-modelers_kogito-creating-running">1.3. Kogito BPMN and DMN modelers</a></h3>
<div class="paragraph _abstract">
<p>Kogito provides the following extensions or applications that you can use to design Business Process Model and Notation (BPMN) process models and Decision Model and Notation (DMN) decision models for your Kogito services using graphical modelers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Apache KIE™ Kogito Bundle VSCode extension</strong>: (Recommended) Enables you to view and design BPMN models, DMN models, and test scenario files in Visual Studio Code (VSCode). The VSCode extension in the Kogito requires VSCode .</p>
<div class="paragraph">
<p>To install the <strong>Apache KIE™ Kogito Bundle VSCode extension</strong> extension select the <strong>Extensions</strong> menu option in VSCode and search for and install the <strong>Apache KIE™ Kogito Bundle</strong> extension.</p>
</div>
</li>
<li>
<p><strong>Apache KIE™ BPMN, DMN &amp; Test Scenario Editors for GitHub Chrome extension</strong>: Enables you to view and design BPMN and DMN models in GitHub repositories in Google Chrome.</p>
<div class="paragraph">
<p>To install the Apache KIE™ BPMN, DMN &amp; Test Scenario Editors for GitHub Chrome extension search its name on <a href="https://chromewebstore.google.com/" class="bare">https://chromewebstore.google.com/</a>. Alternatively, build the package <a href="https://github.com/apache/incubator-kie-tools/blob/main/packages/chrome-extension-pack-kogito-kie-editors" class="bare">https://github.com/apache/incubator-kie-tools/blob/main/packages/chrome-extension-pack-kogito-kie-editors</a> locally, and then in the upper-right corner in Chrome, go to <strong>Customize and control</strong> &#8594; <strong>Settings</strong> &#8594; <strong>Extensions</strong> &#8594; <strong>Load unpacked</strong> and open the extracted <code>dist</code> folder.</p>
</div>
</li>
<li>
<p><strong>Apache KIE™ Sandbox</strong>: Enables you to view and design BPMN and DMN models online at <code><a href="https://sandbox.kie.org/" class="bare">https://sandbox.kie.org/</a></code>.</p>
</li>
<li>
<p><strong>BPMN and DMN Standalone Editors</strong>: Enable you to view and design BPMN and DMN models embedded in your web applications. To download the necessary files, you can use the NPM artifacts from the <a href="https://www.npmjs.com/package/@kie-tools/kie-editors-standalone">Apache KIE™ repository</a>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="proc-kogito-vscode-extension_kogito-creating-running"><a class="anchor" href="#proc-kogito-vscode-extension_kogito-creating-running"></a><a class="link" href="#proc-kogito-vscode-extension_kogito-creating-running">1.3.1. Installing the Apache KIE™ Kogito Bundle VSCode extension</a></h4>
<div class="paragraph _abstract">
<p>VSCode is the preferred integrated development environment (IDE) for developing Kogito services. Kogito provides a <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension that enables you to design Decision Model and Notation (DMN) decision models, Business Process Model and Notation (BPMN) 2.0 business processes, and test scenarios directly in VSCode. Kogito also provides individual <strong>DMN Editor</strong> and <strong>BPMN Editor</strong> VSCode extensions for DMN or BPMN support only, if needed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a>  is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, select the <strong>Extensions</strong> menu option and search for <strong>Apache KIE™ Kogito Bundle</strong> for DMN, BPMN, and test scenario file support.</p>
<div class="paragraph">
<p>For DMN or BPMN file support only, you can also search for the individual <strong>DMN Editor</strong> or <strong>BPMN Editor</strong> extensions.</p>
</div>
</li>
<li>
<p>When the Kogito extension appears in the extension list in VSCode, select it and click <strong>Install</strong>.</p>
</li>
<li>
<p>For optimal VSCode editor behavior, after the extension installation is complete, reload or close and re-launch your instance of VSCode.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you install the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension bundle, any <code>.dmn</code> or <code>.bpmn2</code> files that you open in VSCode are automatically displayed as graphical models. Additionally, any <code>.scesim</code> files that you open are automatically displayed as tabular test scenario models for testing the functionality of your business decisions.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN, BPMN, or test scenario modelers open only the XML source of a DMN, BPMN, or test scenario file and displays an error message, review the reported errors and the model file to ensure that all elements are correctly defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-standalone-editors_kogito-creating-running"><a class="anchor" href="#proc-kogito-standalone-editors_kogito-creating-running"></a><a class="link" href="#proc-kogito-standalone-editors_kogito-creating-running">1.3.2. Configuring the Kogito standalone editors</a></h4>
<div class="paragraph _abstract">
<p>The Kogito standalone editors are distributed in a self-contained library that provides an all-in-one JavaScript file for each editor. The JavaScript file uses a comprehensive API to set and control the editor.</p>
</div>
<div class="paragraph">
<p>You can install the standalone editors in three ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use hosted JavaScript files directly</p>
</li>
<li>
<p>Download each JavaScript file manually</p>
</li>
<li>
<p>Use the NPM package</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Install the Kogito standalone editors using one of the following methods:</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>Use hosted JavaScript files directly</strong>: For this method, add the following <code>&lt;script&gt;</code> tags to your HTML page:</p>
</div>
<div class="listingblock">
<div class="title">Script tags for your HTML page</div>
<div class="content">
<pre class="highlight"><code>&lt;script src="https://kiegroup.github.io/kogito-online/standalone/dmn/index.js"&gt;&lt;/script&gt;
&lt;script src="https://kiegroup.github.io/kogito-online/standalone/bpmn/index.js"&gt;&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Download each JavaScript file manually</strong>: For this method, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download the JavaScript files:</p>
<div class="ulist">
<ul>
<li>
<p>For the DMN editor, go to <a href="https://kiegroup.github.io/kogito-online/standalone/dmn/index.js" class="bare">https://kiegroup.github.io/kogito-online/standalone/dmn/index.js</a>.</p>
</li>
<li>
<p>For the BPMN editor, go to <a href="https://kiegroup.github.io/kogito-online/standalone/bpmn/index.js" class="bare">https://kiegroup.github.io/kogito-online/standalone/bpmn/index.js</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add the downloaded Javascript files to your hosted application.</p>
</li>
<li>
<p>Add the following <code>&lt;script&gt;</code> tag to your HTML page:</p>
<div class="listingblock">
<div class="title">Script tag for your HTML page</div>
<div class="content">
<pre class="highlight"><code>&lt;script src="https://&lt;YOUR_PAGE&gt;/dmn/index.js"&gt;&lt;/script&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Use the NPM package</strong>: For this method, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Go to the <a href="https://www.npmjs.com/package/@kie-tools/kie-editors-standalone">Apache KIE™ repository</a> in NPM and download the NPM package.</p>
</li>
<li>
<p>Add the NPM package to your <code>package.json</code> file:</p>
<div class="listingblock">
<div class="title">Adding the NPM package</div>
<div class="content">
<pre class="highlight"><code>npm install @kie-tools/kie-editors-standalone</code></pre>
</div>
</div>
</li>
<li>
<p>Import each editor library to your TypeScript file:</p>
<div class="listingblock">
<div class="title">Importing each editor</div>
<div class="content">
<pre class="highlight"><code>import * as DmnEditor from "@kie-tools/kie-editors-standalone/dist/dmn"
import * as BpmnEditor from "@kie-tools/kie-editors-standalone/dist/bpmn"</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>After you install the standalone editors, open the required editor by using the provided editor API, as shown in the following example for opening a DMN editor. The API is the same for each editor.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Opening the DMN standalone editor</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">const editor = DmnEditor.open({
  container: document.getElementById("dmn-editor-container"),
  initialContent: Promise.resolve(""),
  readOnly: false,
  origin: "",
  resources: new Map([
    [
      "MyIncludedModel.dmn",
      {
        contentType: "text",
        content: Promise.resolve("")
      }
    ]
  ])
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the following parameters with the editor API:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Example parameters</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>container</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTML element in which the editor is appended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>initialContent</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Promise to a DMN model content. This parameter can be empty, as shown in the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Promise.resolve("")</code></p>
</li>
<li>
<p><code>Promise.resolve("&lt;DIAGRAM_CONTENT_DIRECTLY_HERE&gt;")</code></p>
</li>
<li>
<p><code>fetch("MyDmnModel.dmn").then(content &#8658; content.text())</code></p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>readOnly</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Enables you to allow changes in the editor. Set to <code>false</code> (default) to allow content editing and <code>true</code> for read-only mode in editor.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>origin</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Origin of the repository. The default value is <code>window.location.origin</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resources</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Map of resources for the editor. For example, this parameter is used to provide included models for the DMN editor or work item definitions for the BPMN editor. Each entry in the map contains a resource name and an object that consists of <code>content-type</code> (<code>text</code> or <code>binary</code>) and <code>content</code> (similar to the <code>initialContent</code> parameter).</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The returned object contains the methods that are required to manipulate the editor.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Returned object methods</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getContent(): Promise&lt;string&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a promise containing the editor content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setContent(path: string, content: string): void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the content of the editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getPreview(): Promise&lt;string&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a promise containing an SVG string of the current diagram.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>subscribeToContentChanges(callback: (isDirty: boolean) &#8658; void): (isDirty: boolean) &#8658; void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets a callback to be called when the content changes in the editor and returns the same callback to be used for unsubscription.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsubscribeToContentChanges(callback: (isDirty: boolean) &#8658; void): void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsubscribes the passed callback when the content changes in the editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markAsSaved(): void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resets the editor state that indicates that the content in the editor is saved. Also, it activates the subscribed callbacks related to content change.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>undo(): void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undoes the last change in the editor. Also, it activates the subscribed callbacks related to content change.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>redo(): void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redoes the last undone change in the editor. Also, it activates the subscribed callbacks related to content change.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>close(): void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Closes the editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getElementPosition(selector: string): Promise&lt;Rect&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides an alternative to extend the standard query selector when an element lives inside a canvas or a video component. The <code>selector</code> parameter must follow the <code>&lt;PROVIDER&gt;:::&lt;SELECT&gt;</code> format, such as <code>Canvas:::MySquare</code> or <code>Video:::PresenterHand</code>. This method returns a <code>Rect</code> representing the element position.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>envelopeApi: MessageBusClientApi&lt;KogitoEditorEnvelopeApi&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is an advanced editor API. For more information about advanced editor API, see <a href="https://github.com/kiegroup/kie-tools/blob/master/packages/envelope-bus/src/api/index.ts#L43-L56">MessageBusClientApi</a> and <a href="https://github.com/kiegroup/kie-tools/blob/master/packages/editor/src/api/KogitoEditorEnvelopeApi.ts#L34-L41">KogitoEditorEnvelopeApi</a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-creating-project_kogito-creating-running"><a class="anchor" href="#proc-kogito-creating-project_kogito-creating-running"></a><a class="link" href="#proc-kogito-creating-project_kogito-creating-running">1.4. Creating a Maven project for a Kogito service</a></h3>
<div class="paragraph _abstract">
<p>Before you can begin developing Kogito services, you need to create a Maven project where you can build your Kogito assets and any other related resources for your application.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to a local folder where you want to store the new Kogito project.</p>
</li>
<li>
<p>Enter the following command to generate a project within a defined folder:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn io.quarkus:quarkus-maven-plugin:create \
    -DprojectGroupId=org.acme -DprojectArtifactId=sample-kogito \
    -DprojectVersion=1.0.0-SNAPSHOT -Dextensions=kogito-quarkus</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can generate a project using the <a href="https://code.quarkus.io/?e=org.kie.kogito%3Akogito-quarkus">Quarkus website</a>.</p>
</div>
<div id="proc-kogito-creating-project-spring-boot_kogito-creating-running" class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-spring-boot-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion=10.0.0.0 \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>These commands generate a <code>sample-kogito</code> Maven project and import the Kogito extension for all required dependencies and configurations to prepare your application for business automation.</p>
</div>
</div>
</div>
</li>
<li>
<p>Open or import the project in your VSCode IDE to view the contents.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="proc-customizing-spring-boot-project-creation_kogito-creating-running"><a class="anchor" href="#proc-customizing-spring-boot-project-creation_kogito-creating-running"></a><a class="link" href="#proc-customizing-spring-boot-project-creation_kogito-creating-running">1.4.1. Creating a custom Kogito Spring Boot project</a></h4>
<div class="paragraph">
<p>With Spring Boot, you can create custom Maven projects using Kogito Spring Boot archetype. This archetype enables adding Kogito Spring Boot starters or add-ons in the project creation. The Kogito Spring Boot starters include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>decisions</code></p>
</li>
<li>
<p><code>processes</code></p>
</li>
<li>
<p><code>rules</code></p>
</li>
<li>
<p><code>predictions</code></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to a local folder where you want to store the new Kogito project.</p>
</li>
<li>
<p>Enter any of the following command to generate a project using <code>starters</code> or <code>addons</code> property:</p>
<div class="ulist">
<ul>
<li>
<p>To generate a project based on Kogito process services using the <code>starters</code> property, enter the following command:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-springboot-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion=10.0.0.0 \
    -Dversion=1.0-SNAPSHOT
    -Dstarters=processes</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new project includes the dependencies required to run Kogito process services. You can combine multiple Kogito Spring Boot starters using a comma-separated list. For example <code>starters=processes,rules</code>.</p>
</div>
</div>
</div>
</li>
<li>
<p>To generate a project containing Prometheus monitoring and Infinispan persistence using the Kogito <code>add-ons</code> property, enter the following command:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-springboot-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion=10.0.0.0 \
    -Dversion=1.0-SNAPSHOT
    -Dstarters=processes
    -Daddons=monitoring-prometheus,persistence-infinispan</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you pass an add-on to the property, the add-on name does not require the <code>kogito-addons-springboot</code> prefix. Also, you can combine the <code>add-ons</code> and <code>starters</code> properties to customize the project.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Open or import the project in your IDE to view the contents.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about Kogito Spring Boot starters and Kogito add-ons, see <a href="#con-kogito-spring-boot-starters_kogito-creating-running">Spring Boot Starters for your Kogito project</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-kogito-creating-project-custom_kogito-creating-running"><a class="anchor" href="#proc-kogito-creating-project-custom_kogito-creating-running"></a><a class="link" href="#proc-kogito-creating-project-custom_kogito-creating-running">1.4.2. Creating a custom Kogito project using code scaffolding</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This feature is experimental and might be substantially modified or removed in a future release. This feature also requires a special project setup. The generated code uses APIs that are not final in Kogito and will not function the same way in future releases.
</td>
</tr>
</table>
</div>
<div class="paragraph _abstract">
<p>The Quarkus extension and Maven plug-in within a standard Kogito project generate all the required code and boilerplate for your Kogito services so that you do not have to write the project setup code yourself. By default, a Kogito project generates a REST service from business assets automatically. The generated service usually exposes default REST endpoints using the information that is inferred from the business assets that you include in your project.</p>
</div>
<div class="paragraph">
<p>If you want to customize the code for your Kogito project, such as adding more REST endpoints, you can use <em>code scaffolding</em> to generate the project code to a specified user directory and then modify the code as needed.</p>
</div>
<div class="paragraph">
<p>With code scaffolding, you generate your Kogito project with the Kogito Maven archetype as usual, but you disable the project ability to automatically regenerate the project code and explicitly instruct Kogito to generate the code in a custom target directory. The code is generated one time in the specified target directory and is not regenerated at build time unless you explicitly request it. You can customize the project code in the specified target directory as needed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
On Quarkus, disabling code regeneration also disables hot reload of business assets in development mode. This limitation will be improved in a future release.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to a local folder where you want to store the custom Kogito project and enter the following command to generate your Kogito project with the Kogito Maven archetype as usual:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn io.quarkus:quarkus-maven-plugin:create \
    -DprojectGroupId=org.acme -DprojectArtifactId=sample-kogito \
    -DprojectVersion=1.0.0-SNAPSHOT -Dextensions=kogito-quarkus</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can generate a project using the <a href="https://code.quarkus.io/?e=org.kie.kogito%3Akogito-quarkus">Quarkus website</a>.</p>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn archetype:generate \
    -DarchetypeGroupId=org.kie.kogito \
    -DarchetypeArtifactId=kogito-spring-boot-archetype \
    -DgroupId=org.acme -DartifactId=sample-kogito \
    -DarchetypeVersion=10.0.0.0 \
    -Dversion=1.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a <code>sample-kogito</code> Maven project and imports the Kogito extension for all required dependencies and configurations to prepare your application for business automation.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the project <code>pom.xml</code> file, modify the project dependencies and plug-ins to disable code regeneration:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>On Quarkus</strong>: Delete the <code>kogito-quarkus</code> dependency and add the <code>kie-maven-plugin</code> plug-in, as shown in the following examples:</p>
<div class="listingblock">
<div class="title">Deleting the <code>kogito-quarkus</code> dependency</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
    &lt;artifactId&gt;jbpm-quarkus&lt;/artifactId&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Adding the <code>kie-maven-plugin</code> plug-in</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
  ...
  &lt;plugins&gt;
    ...
    &lt;plugin&gt;
      &lt;groupId&gt;org.kie&lt;/groupId&gt;
      &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
        &lt;onDemand&gt;true&lt;/onDemand&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
    ...
  &lt;/plugins&gt;
  ...
&lt;/build&gt;</code></pre>
</div>
</div>
</li>
<li>
<p><strong>On Spring Boot</strong>: Modify the existing <code>kie-maven-plugin</code> plug-in as shown in the following example:</p>
<div class="listingblock">
<div class="title">Modifying the <code>kie-maven-plugin</code> plug-in</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;build&gt;
  ...
  &lt;plugins&gt;
    ...
    &lt;plugin&gt;
      &lt;groupId&gt;org.kie&lt;/groupId&gt;
      &lt;artifactId&gt;kie-maven-plugin&lt;/artifactId&gt;
      &lt;configuration&gt;
        &lt;onDemand&gt;true&lt;/onDemand&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
    ...
  &lt;/plugins&gt;
  ...
&lt;/build&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In a command terminal, navigate to the root of your Kogito project and enter the following command to generate your modified project using code scaffolding:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Generating the Kogito project using code scaffolding</div>
<div class="content">
<pre class="highlight"><code> $ mvn compile kogito:scaffold</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command compiles the assets in your project and generates the code in the <code>src/main/java</code> directory. In the automatic Kogito project build, the default directory is <code>target/generated-sources/kogito</code>.</p>
</div>
<div class="paragraph">
<p>If you want to override the default location for code generation, use the following command to define a custom target directory:</p>
</div>
<div class="listingblock">
<div class="title">Generating the Kogito project using code scaffolding with a custom directory</div>
<div class="content">
<pre class="highlight"><code> $ mvn compile kogito:scaffold -Dkogito.codegen.sources.directory=src/main/generated-java</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>kogito.codegen.sources.directory</code> parameter defines the custom target directory where you want the code to be generated, such as <code>src/main/generated-java</code> in this example.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If you invoke the generation command again with the same target directory, the files are overwritten. This limitation will be fixed in a future release.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After you run the scaffolding command, either the default <code>src/main/java</code> directory or the custom target directory that you defined now contains the following resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your existing project files</p>
</li>
<li>
<p>Generated data classes corresponding to process variables or Decision Model and Notation (DMN) definitions</p>
</li>
<li>
<p>Generated REST endpoints</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example project contains a <code>persons</code> Business Process Model and Notation (BPMN) process model, so the generated REST endpoints are modified as shown in the following Java object:</p>
</div>
<div class="listingblock">
<div class="title">Modified REST endpoints for a <code>person</code> BPMN process model</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.travels;

// Imports

@Path("/persons")
@ApplicationScoped
public class PersonsResource {

    @Inject
    @Named("persons")
    Process&lt;PersonsModel&gt; process;

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    public PersonsModelOutput createResource_persons(
            @Context HttpHeaders httpHeaders,
            @QueryParam("businessKey") String businessKey,
            @Valid @NotNull PersonsModelInput resource) {
        ...
    }

    // Other endpoints
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>PersonsModel</code>, <code>PersonsModelInput</code>, and <code>PersonsModelOutput</code> elements are the generated data models. These models are inferred automatically from the process variables in the process. Input and output models are inferred by how you tagged your process variables.</p>
</div>
<div class="paragraph">
<p>Similar endpoints are generated for any available rule units. This example project contains a <code>PersonValidationService</code> class for a rule unit model, so the generated REST endpoints are modified as shown in the following Java object:</p>
</div>
<div class="listingblock">
<div class="title">Modified REST endpoints for a <code>PersonValidationService</code> rule unit class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.travels;

// Imports

@Path("/persons-validation-service")
@ApplicationScoped
public class PersonsValidationServiceResource {

    @Inject
    RuleUnit&lt;PersonValidationService&gt; unit;

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    public QueryResult fireRules(PersonValidationService resource) {
        ...
    }

    // Other endpoints
}</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-bpmn-variables_kogito-developing-process-services">Variables in Kogito processes</a></p>
</li>
<li>
<p><a href="#proc-kogito-designing-app-rule-units_kogito-creating-running">Using DRL rule units as an alternative decision service</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-custom-rest-endpoint-api_kogito-creating-running"><a class="anchor" href="#proc-kogito-custom-rest-endpoint-api_kogito-creating-running"></a><a class="link" href="#proc-kogito-custom-rest-endpoint-api_kogito-creating-running">1.5. Creating custom REST endpoints using Kogito API</a></h3>
<div class="paragraph">
<p>Kogito enables you to create custom REST endpoints using Kogito API.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>JDK 17 is installed.</p>
</li>
<li>
<p>Apache Maven is installed.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Kogito API is only available for Quarkus and is currently experimental. This feature is available to the adopters to collect feedback and modify in a future release.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a Kogito project using the Maven plugin or Quarkus CLI.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example project using the Quarkus Maven plugin</div>
<div class="content">
<pre class="highlight"><code>mvn io.quarkus:quarkus-maven-plugin:create \
   -DprojectGroupId=com.company \
   -DprojectArtifactId=sample-kogito \
   -Dextensions="kogito"</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add a business asset to the <code>resource</code> folder such as a DMN file. To create the example DMN model, copy the following <code>PersonDecisions.dmn</code> file content:</p>
<div class="openblock">
<div class="content">
<div id="person-decisions-source-xml" class="listingblock">
<div class="title">Example <code>PersonDecisions.dmn</code> file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dmn:definitions xmlns:dmn="https://www.omg.org/spec/DMN/20230324/MODEL/" xmlns="https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:kie="https://kie.org/dmn/extensions/1.0" xmlns:dmndi="https://www.omg.org/spec/DMN/20230324/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" xmlns:feel="http://www.omg.org/spec/DMN/20180521/FEEL/" id="_84B432F5-87E7-43B1-9101-1BAFE3D18FC5" name="PersonDecisions" typeLanguage="https://www.omg.org/spec/DMN/20230324/FEEL/" namespace="https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36"&gt;
  &lt;dmn:parsererror style="display: block; white-space: pre; border: 2px solid #c77; padding: 0 1em 0 1em; margin: 1em; background-color: #fdd; color: black"&gt;
    &lt;dmn:h3 /&gt;
    &lt;dmn:h3 /&gt;
    &lt;dmn:div style="font-family:monospace;font-size:12px" /&gt;
  &lt;/dmn:parsererror&gt;
  &lt;dmn:extensionElements /&gt;
  &lt;dmn:itemDefinition id="_DEF2C3A7-F3A9-4ABA-8D0A-C823E4EB43AB" name="tPerson" isCollection="false"&gt;
    &lt;dmn:itemComponent id="_DB46DB27-0752-433F-ABE3-FC9E3BDECC97" name="Age" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_8C6D865F-E9C8-43B0-AB4D-3F2075A4ECA6" name="Name" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_9033704B-4E1C-42D3-AC5E-0D94107303A1" name="Adult" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;boolean&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:inputData id="_F9685B74-0C69-4982-B3B6-B04A14D79EDB" name="Person"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_0E345A3C-BB1F-4FB2-B00F-C5691FD1D36C" name="Person" typeRef="tPerson" /&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:decision id="_0D2BD7A9-ACA1-49BE-97AD-19699E0C9852" name="isAdult"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_54CD509F-452F-40E5-941C-AFB2667D4D45" name="isAdult" typeRef="boolean" /&gt;
    &lt;dmn:informationRequirement id="_2F819B03-36B7-4DEB-AED6-2B46AE3ADB75"&gt;
      &lt;dmn:requiredInput href="#_F9685B74-0C69-4982-B3B6-B04A14D79EDB" /&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:decisionTable id="_58370567-05DE-4EC0-AC2D-A23803C1EAAE" hitPolicy="UNIQUE" preferredOrientation="Rule-as-Row"&gt;
      &lt;dmn:input id="_ADEF36CD-286A-454A-ABD8-9CF96014021B"&gt;
        &lt;dmn:inputExpression id="_4930C2E5-7401-46DD-8329-EAC523BFA492" typeRef="number"&gt;
          &lt;dmn:text&gt;Person.Age&lt;/dmn:text&gt;
        &lt;/dmn:inputExpression&gt;
      &lt;/dmn:input&gt;
      &lt;dmn:output id="_9867E9A3-CBF6-4D66-9804-D2206F6B4F86" typeRef="boolean" /&gt;
      &lt;dmn:rule id="_59D6BFF0-35B4-4B7E-8D7B-E31CB0DB8242"&gt;
        &lt;dmn:inputEntry id="_7DC55D63-234F-497B-A12A-93DA358C0136"&gt;
          &lt;dmn:text&gt;&amp;gt; 18&lt;/dmn:text&gt;
        &lt;/dmn:inputEntry&gt;
        &lt;dmn:outputEntry id="_B3BB5B97-05B9-464A-AB39-58A33A9C7C00"&gt;
          &lt;dmn:text&gt;true&lt;/dmn:text&gt;
        &lt;/dmn:outputEntry&gt;
      &lt;/dmn:rule&gt;
      &lt;dmn:rule id="_8FCD63FE-8AD8-4F56-AD12-923E87AFD1B1"&gt;
        &lt;dmn:inputEntry id="_B4EF7F13-E486-46CB-B14E-1D21647258D9"&gt;
          &lt;dmn:text&gt;&amp;lt;= 18&lt;/dmn:text&gt;
        &lt;/dmn:inputEntry&gt;
        &lt;dmn:outputEntry id="_F3A9EC8E-A96B-42A0-BF87-9FB1F2FDB15A"&gt;
          &lt;dmn:text&gt;false&lt;/dmn:text&gt;
        &lt;/dmn:outputEntry&gt;
      &lt;/dmn:rule&gt;
    &lt;/dmn:decisionTable&gt;
  &lt;/dmn:decision&gt;
  &lt;dmndi:DMNDI&gt;
    &lt;dmndi:DMNDiagram id="_E09E7797-14AA-4811-AA1E-61FFC737F4C6" name="Default DRD" useAlternativeInputDataShape="false"&gt;
      &lt;di:extension&gt;
        &lt;kie:ComponentsWidthsExtension&gt;
          &lt;kie:ComponentWidths dmnElementRef="_58370567-05DE-4EC0-AC2D-A23803C1EAAE"&gt;
            &lt;kie:width&gt;50&lt;/kie:width&gt;
            &lt;kie:width&gt;100&lt;/kie:width&gt;
            &lt;kie:width&gt;100&lt;/kie:width&gt;
            &lt;kie:width&gt;100&lt;/kie:width&gt;
          &lt;/kie:ComponentWidths&gt;
        &lt;/kie:ComponentsWidthsExtension&gt;
      &lt;/di:extension&gt;
      &lt;dmndi:DMNShape id="dmnshape-_F9685B74-0C69-4982-B3B6-B04A14D79EDB" dmnElementRef="_F9685B74-0C69-4982-B3B6-B04A14D79EDB" isCollapsed="false"&gt;
        &lt;dmndi:DMNStyle id="_8B2F25AD-1B38-462A-9890-912D97103B9E"&gt;
          &lt;dmndi:FillColor red="255" green="255" blue="255" /&gt;
          &lt;dmndi:StrokeColor red="0" green="0" blue="0" /&gt;
          &lt;dmndi:FontColor red="0" green="0" blue="0" /&gt;
        &lt;/dmndi:DMNStyle&gt;
        &lt;dc:Bounds x="320" y="200" width="100" height="50" /&gt;
        &lt;dmndi:DMNLabel id="_97FE1357-957E-48C5-8222-BDD52128BE3A" /&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNShape id="dmnshape-_0D2BD7A9-ACA1-49BE-97AD-19699E0C9852" dmnElementRef="_0D2BD7A9-ACA1-49BE-97AD-19699E0C9852" isCollapsed="false"&gt;
        &lt;dmndi:DMNStyle id="_8D4C2082-2C14-47DC-A872-E710845C9BBE"&gt;
          &lt;dmndi:FillColor red="255" green="255" blue="255" /&gt;
          &lt;dmndi:StrokeColor red="0" green="0" blue="0" /&gt;
          &lt;dmndi:FontColor red="0" green="0" blue="0" /&gt;
        &lt;/dmndi:DMNStyle&gt;
        &lt;dc:Bounds x="580" y="200" width="100" height="50" /&gt;
        &lt;dmndi:DMNLabel id="_B814BC45-74BA-4DB1-A3D6-EDCDB489856E" /&gt;
      &lt;/dmndi:DMNShape&gt;
      &lt;dmndi:DMNEdge id="dmnedge-_2F819B03-36B7-4DEB-AED6-2B46AE3ADB75" dmnElementRef="_2F819B03-36B7-4DEB-AED6-2B46AE3ADB75"&gt;
        &lt;di:waypoint x="420" y="225" /&gt;
        &lt;di:waypoint x="580" y="225" /&gt;
      &lt;/dmndi:DMNEdge&gt;
    &lt;/dmndi:DMNDiagram&gt;
  &lt;/dmndi:DMNDI&gt;
&lt;/dmn:definitions&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>PersonDecisions.dmn</code> file defines a DMN model with <code><a href="https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36" class="bare">https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36</a></code> namespace and <code>PersonDecisions</code> name.</p>
</div>
</div>
</div>
</li>
<li>
<p>Create a source file for the custom REST endpoint:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example REST endpoint</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme;

import java.util.Map;

import javax.inject.Inject;
import javax.ws.rs.Consumes;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

import org.kie.kogito.incubation.application.AppRoot;
import org.kie.kogito.incubation.common.DataContext;
import org.kie.kogito.incubation.common.MapDataContext;
import org.kie.kogito.incubation.decisions.DecisionIds;
import org.kie.kogito.incubation.decisions.services.DecisionService;

@Path("/hello")
public class GreetingResource {

    // Inject the application root
    @Inject AppRoot appRoot;
    // Inject a decision service
    @Inject DecisionService svc;

    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    @Produces(MediaType.APPLICATION_JSON)
    public DataContext hello(Map&lt;String, Object&gt; payload) {
        var id = appRoot
                .get(DecisionIds.class)
                .get("https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36",
                        "PersonDecisions");
        var ctx = MapDataContext.from(payload);
        return svc.evaluate(id, ctx);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous example of REST endpoints contains the following aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>AppRoot</code> object is injected that is used to create identifiers for resources to be evaluated.</p>
</li>
<li>
<p>The <code>@Inject DecisionService svc</code> injects the <code>DecisionService</code>, which is used to evaluate a DMN model. The following list describes different types of services:</p>
<div class="ulist">
<ul>
<li>
<p><code>StraightThroughProcessService</code> for BPMN processes that terminate immediately and do not suspend into intermediate states</p>
</li>
<li>
<p><code>DecisionService</code> for DMN decision models</p>
</li>
<li>
<p><code>PredictionService</code> for PMML predictive models</p>
</li>
<li>
<p><code>RuleUnitService</code> for Rule Unit evaluation</p>
<div class="paragraph">
<p>Each service can be injected (<code>@inject</code>) and provides an <code>evaluate(Id, DataContext)</code> method. For more information about how to invoke the services, you can see <code>dmn-incubation-api-quarkus</code>, <code>pmml-incubation-api-quarkus</code>, <code>process-incubation-api-quarkus</code>, and <code>rules-incubation-api-quarkus</code> example applications.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The REST endpoint expects an arbitrary <code>Map&lt;String, Object&gt;</code> of values.</p>
</li>
<li>
<p>In the body of the REST handler, the <code>Map</code> is converted into a <code>DataContext</code>. Each service expects a <code>DataContext</code> to evaluate together with the identifier.</p>
</li>
<li>
<p>The <code>evaluate(id, ctx)</code> method returns a <code>DataContext</code>. The <code>DataContext</code> be returned directly by the REST handler: the system knows how to handle the response.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>DataContext</code> is a class that implements the <code>DataContext</code> interface. <code>DataContext</code> provides  <code>&lt;T extends DataContext&gt; T as(Class&lt;T&gt;)</code> method to convert a type of data context to another. The root type of data context provides the <code>as()</code> method only, because the root type does not contain additional behavior.</p>
</div>
<div class="paragraph">
<p>In the previous example, <code>DataContext</code> is converted into a <code>MapDataContext</code> and <code>Person</code> object. The following is an example of using a <code>DataContext</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example of using a <code>DataContext</code></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataContext ctx = ...;
MapDataContext mctx = ctx.as(MapDataContext.class);
Person person = mctx.as(Person.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous example, <code>MapDataContext</code> is a type of built-in data context (<code>Map&lt;String, Object&gt;</code>) and provides <code>get()</code> and <code>set()</code> methods to access the data. The <code>get()</code> method pulls the entered data by performing an internal conversion if applicable.</p>
</div>
<div class="listingblock">
<div class="title">Example of using <code>MapDataContext</code></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataContext ctx = ...;
MapDataContext mctx = ctx.as(MapDataContext.class);
ctx.set("Paul", new Person("Paul", 79));
Object o = ctx.get("Paul");
Person p = ctx.get("Paul", Paul.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, you can customize the example REST endpoint further by expecting a <code>DataContext</code> in the method signature:</p>
</div>
<div class="listingblock">
<div class="title">Example REST endpoint</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    @Produces(MediaType.APPLICATION_JSON)
    public DataContext hello(MapDataContext ctx) { // use ctx here
        var id = appRoot
                .get(DecisionIds.class)
                .get("https://kiegroup.org/dmn/rest-example",
                        "PersonDecisions");
        return svc.evaluate(id, ctx);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, you can transform the Map data context into a Java class. This mapping is performed automatically using field naming conventions as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example Java class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.kie.kogito.incubation.common.*;
public class Person implements DataContext, DefaultCastable {
    String name;
    int age;
    // constructors...
    // getters and setters...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DataContext</code> interface marks the Java class as a bindable context, enabling you to convert another <code>DataContext</code> using the <code>as(Class&lt;DataContext&gt;)</code> method:</p>
</div>
<div class="listingblock">
<div class="title">Example conversion of a <code>MapDataContext</code> into a <code>Person</code></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public DataContext hello(MapDataContext ctx) {
        ...
        Person person = ctx.as(Person.class);
        return svc.evaluate(id, person);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, you can use the converted <code>DataContext</code> directly as an argument. In the following example, the <code>Person</code> is used as an argument:</p>
</div>
<div class="listingblock">
<div class="title">Example REST endpoint using <code>Person</code> as an argument</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public DataContext hello(Person person) {
        ...
        return svc.evaluate(id, ctx);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The custom data contexts can also be used in the return type as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example REST endpoint using <code>Person</code> as an argument and a custom return type</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    class MyCustomDataContext implements DataContext, DefaultCastable {...}
    public MyCustomDataContext hello(Person person) {
        ...
        DataContext result = svc.evaluate(id, ctx);
        MyCustomDataContext typedResult = result.as(MyCustomDataContext.class)
        return result;
    }</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Optionally, you can disable automated generation of the REST endpoint by setting <code>kogito.generate.rest.decisions</code> property to <code>false</code> in the <code>application.properties</code> file:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title"><code>application.properties</code> file</div>
<div class="content">
<pre class="highlight"><code>kogito.generate.rest.decisions=false</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Test the created custom REST endpoint:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example of invoking a REST endpoint</div>
<div class="content">
<pre class="highlight"><code># starts the application in devmode
$ mvn quarkus:dev
# invoke the REST service
$ curl -X POST \
    -H 'Accept: application/json' \
    -H 'Content-Type: application/json' \
    -d '{"name": "Paul" , "age" : 79}' \
    http://localhost:8080/hello</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "name":"Paul",
  "adult":true,
  "age":79
}</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="con-kogito-spring-boot-starters_kogito-creating-running"><a class="anchor" href="#con-kogito-spring-boot-starters_kogito-creating-running"></a><a class="link" href="#con-kogito-spring-boot-starters_kogito-creating-running">1.6. Spring Boot Starters for your Kogito project</a></h3>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#using-boot-starter">Spring Boot starters</a> are a set of dependency descriptors that you can include in your Kogito application. Using Spring Boot starters, you can eliminate the need to go through sample code, and copy and pasting dependency descriptors.</p>
</div>
<div class="paragraph">
<p>When you create a project, the <code>pom.xml</code> file contains all the necessary starters. You can also include a new starter if required. For more information on creating projects using Kogito Spring Boot archetype, see <a href="#proc-customizing-spring-boot-project-creation_kogito-creating-running">Creating a custom Kogito Spring Boot project</a>.</p>
</div>
<div class="sect3">
<h4 id="ref-kogito-spring-boot-starter_kogito-creating-running"><a class="anchor" href="#ref-kogito-spring-boot-starter_kogito-creating-running"></a><a class="link" href="#ref-kogito-spring-boot-starter_kogito-creating-running">1.6.1. Kogito Spring Boot Starters</a></h4>
<div class="paragraph">
<p>The Kogito Spring Boot starter is an all-in-one descriptor for the Kogito projects that require business automation engines provided by Kogito. The Kogito Spring Boot starter includes decisions, rules, processes, predictions, and the Serverless Workflow implementation.</p>
</div>
<div class="paragraph">
<p>When your project consists of all the assets and you want a quick way to get started with Kogito, you can use the <code>kogito-spring-boot-starter</code>. For more granular approach, you can use the specific starters or a combination of starters.</p>
</div>
<div class="paragraph">
<p>You can add a Kogito Spring Boot starter to your project as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
    &lt;artifactId&gt;jbpm-spring-boot-starter&lt;/artifactId&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following list describes the different Spring Boot starters:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Kogito decisions Spring Boot starter</dt>
<dd>
<p>Starter for decisions such as DMN support for your Kogito Spring Boot project. You can add a Kogito decisions Spring Boot starter as follows:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-rules-spring-boot-starter&lt;/artifactId&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Kogito predictions Spring Boot starter</dt>
<dd>
<p>Starter for predictions such as PMML support for your Kogito Spring Boot project. You can add a Kogito predictions Spring Boot starter as follows:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-predictions-spring-boot-starter&lt;/artifactId&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Kogito processes Spring Boot starter</dt>
<dd>
<p>Starter for processes such as BPMN support for your Kogito Spring Boot project. You can add a Kogito processes Spring Boot starter as follows:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
    &lt;artifactId&gt;jbpm-with-drools-spring-boot-starter&lt;/artifactId&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Kogito rules Spring Boot starter</dt>
<dd>
<p>Starter for rules such as DRL support for your Kogito Spring Boot project. You can add a Kogito rules Spring Boot starter as follows:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-rules-spring-boot-starter&lt;/artifactId&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ref-kogito-add-ons_kogito-creating-running"><a class="anchor" href="#ref-kogito-add-ons_kogito-creating-running"></a><a class="link" href="#ref-kogito-add-ons_kogito-creating-running">1.7. Kogito add-ons</a></h3>
<div class="paragraph _abstract">
<p>You can extend Kogito core capabilities by using add-ons modules. The add-on modules extend persistence, monitoring, messaging, and other features of Kogito services.</p>
</div>
<div class="paragraph">
<p>The following tables list all the supported add-ons:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Kogito add-ons for Quarkus</caption>
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 55.5555%;">
<col style="width: 22.2223%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Artifact Id</th>
<th class="tableblock halign-left valign-top">Since</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Messaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-messaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events Decisions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-events-decisions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events Process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-events-process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explainability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-explainability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.15.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jobs Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-jobs-management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knative Eventing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-knative-eventing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jbpm-addons-quarkus-mail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elastic Monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-monitoring-elastic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prometheus Monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-monitoring-prometheus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Persistence ISPN Health</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-persistence-infinispan-health</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Persistence Kafka</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-persistence-kafka</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-process-management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process SVG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-process-svg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jbpm-addons-quarkus-task-management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task Notification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kogito-addons-quarkus-task-notification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tracing Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-tracing-decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.11.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events MongoDB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-events-mongodb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source Files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-quarkus-source-files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.20.0</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Kogito add-ons for Spring Boot</caption>
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 55.5555%;">
<col style="width: 22.2223%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Artifact Id</th>
<th class="tableblock halign-left valign-top">Since</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Messaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-messaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events Decisions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-events-decisions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events Kafka</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-events-process-kafka</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explainability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-explainability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.15.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jobs Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-jobs-management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jbpm-addons-springboot-mail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elastic Monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-monitoring-elastic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prometheus Monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-monitoring-prometheus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kogito-addons-springboot-process-management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process SVG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-process-svg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jbpm-addons-springboot-task-management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task Notification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kogito-addons-springboot-task-notification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tracing Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-tracing-decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.11.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Events MongoDB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kie-addons-springboot-events-mongodb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11.0</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_kogito_messaging_add_on"><a class="anchor" href="#_kogito_messaging_add_on"></a><a class="link" href="#_kogito_messaging_add_on">1.7.1. Kogito messaging add-on</a></h4>
<div class="paragraph">
<p>Kogito provides a messaging add-on, enabling a process to register an event listener. The messaging add-on uses events in the Kogito projects. For more information, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#con-kogito-runtime-events_kogito-configuring">Kogito runtime events</a></p>
</li>
<li>
<p><a href="#con-kogito-travel-agency_kogito-deploying-on-openshift">Travel agency tutorial for Kogito services on OpenShift</a></p>
</li>
<li>
<p><a href="#con-data-index-service_kogito-configuring">Kogito Data Index Service</a></p>
</li>
<li>
<p><a href="#con-trusty-service_kogito-configuring">Kogito Trusty Service and Explainability Service</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure messaging capabilities for your Kogito services, you must add the messaging add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable messaging operations in Quarkus projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-messaging&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable messaging operations in Spring Boot projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-messaging&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For Quarkus, the Kogito process event add-on implementation is based on <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/2/connectors/connectors.html">Smallrye Messaging</a> library, which provides a set of connectors for event brokers, such as JMS, AMQP, and Kafka. Therefore, the Kogito process event add-on is not specifically combined with any event broker, but also requires additional configuration to use a suitable Smallrye connector.</p>
</div>
<div class="paragraph">
<p>For example, to use Kafka as an event broker in Quarkus, you must add the following dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable event broker in Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
   &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
   &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Smallrye uses an abstraction named <code>channel</code>. The implementation of channels depends on the underlying event broker. For example, when using Kafka, every channel is mapped to a topic.</p>
</div>
<div class="paragraph">
<p>Channels are configured by using properties. The pattern for these properties is <code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.&lt;property_name&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Kogito allows different channel mapping strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define one default incoming channel to receive all the incoming messages and one default outgoing channel to store all the published messages.</p>
</li>
<li>
<p>Define a channel for each message name so that every message type has a dedicated channel.</p>
</li>
<li>
<p>Define a channel for certain message names and let the not mapped message names to use the default incoming or outgoing channel.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Kogito first searches for channel name equals to message name in the properties. If found, it uses that channel for that message name. If not, it searches for default channel definition. If also not existing, then an error will be reported.</p>
</div>
<div class="paragraph">
<p>The name for the default incoming channel is <code>kogito_incoming_stream</code> and for the default outgoing channel is <code>kogito_outgoing_stream</code>.</p>
</div>
<div class="paragraph">
<p>You can change the default incoming and outgoing topic name as follows:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.addon.messaging.incoming.defaultName=&lt;default channel name&gt;
kogito.addon.messaging.outgoing.defaultName=&lt;default channel name&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.addon.cloudevents.kafka.kogito_incoming_stream=&lt;default channel name&gt;
kogito.addon.cloudevents.kafka.kogito_outgoing_stream=&lt;default channel name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally, for Kafka connector, you can define the Kafka topic to be used for that channel using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.topic = &lt;topic name&gt;</code></p>
</div>
<div class="paragraph">
<p>If the topic property is not found, then the topic name is considered to be the same as Kafka name. Note that you can map different channels to the same topic, if you wish to do so.</p>
</div>
<div class="sect4">
<h5 id="_providing_a_key_for_a_kafka_record"><a class="anchor" href="#_providing_a_key_for_a_kafka_record"></a><a class="link" href="#_providing_a_key_for_a_kafka_record">1.7.1.1. Providing a key for a Kafka record</a></h5>
<div class="paragraph">
<p>To specify the key to your Kafka record, you can use a custom <a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/quarkus/addons/messaging/common/src/main/java/org/kie/kogito/addon/quarkus/messaging/common/message/MessageDecorator.java">MessageDecorator</a> implementation.</p>
</div>
<div class="paragraph">
<p>For an example, see <a href="https://github.com/apache/incubator-kie-kogito-examples/blob/main/kogito-quarkus-examples/process-kafka-avro-multi-quarkus/src/main/java/org/acme/travel/StringKeyDecorator.java">StringKeyDecorator.java</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_customizing_message_format"><a class="anchor" href="#_customizing_message_format"></a><a class="link" href="#_customizing_message_format">1.7.1.2. Customizing message format</a></h5>
<div class="paragraph">
<p>By default, Kogito uses Cloud event JSON format for messaging. However, you can change the default format by providing your own <a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-events-api/src/main/java/org/kie/kogito/event/EventMarshaller.java">event marshaler</a> implementation.
For an example, see <a href="https://github.com/apache/incubator-kie-kogito-examples/blob/main/kogito-quarkus-examples/process-kafka-avro-multi-quarkus/src/main/java/org/acme/travel/AvroEventMarshaller.java">AvroEventMarshaller.java example</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_decision_model_and_notation_dmn_event_driven_add_on"><a class="anchor" href="#_kogito_decision_model_and_notation_dmn_event_driven_add_on"></a><a class="link" href="#_kogito_decision_model_and_notation_dmn_event_driven_add_on">1.7.2. Kogito Decision Model and Notation (DMN) event-driven add-on</a></h4>
<div class="paragraph">
<div class="title">Quarkus</div>
<p>To use the DMN event-driven add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-events-decisions&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-events-decisions&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_explainability_add_on"><a class="anchor" href="#_kogito_explainability_add_on"></a><a class="link" href="#_kogito_explainability_add_on">1.7.3. Kogito explainability add-on</a></h4>
<div class="paragraph">
<p>The Explainability add-on in Kogito provides integration with Explainability and Trusty Services.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="#con-trusty-service_kogito-configuring">[con-trusty-service_kogito-configuring]</a>.</p>
</div>
<div class="paragraph">
<p>To use the explainability add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-explainability&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-explainability&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_jobs_management_add_on"><a class="anchor" href="#_kogito_jobs_management_add_on"></a><a class="link" href="#_kogito_jobs_management_add_on">1.7.4. Kogito jobs management add-on</a></h4>
<div class="paragraph">
<p>The Jobs Management add-on provides integration and configuration for a project using the supporting services related to Jobs. For more information, see the <a href="#con-jobs-service_kogito-configuring">documentation</a>.</p>
</div>
<div class="paragraph">
<p>To use the Jobs Management add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-jobs-management&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-jobs-management&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_knative_eventing_add_on"><a class="anchor" href="#_kogito_knative_eventing_add_on"></a><a class="link" href="#_kogito_knative_eventing_add_on">1.7.5. Kogito Knative Eventing add-on</a></h4>
<div class="paragraph">
<p>The Knative Eventing add-on is used in the Kogito project for messaging. The <a href="https://github.com/apache/incubator-kie-kogito-runtimes/tree/main/addons/common/knative/eventing">Kogito Knative Eventing</a> add-on enables your project to connect to a <a href="https://knative.dev/docs/developer/eventing/sinks/">sink</a> or make it a <a href="https://github.com/knative-sandbox/eventing-kogito#kogito-source">KogitoSource</a>.</p>
</div>
<div class="paragraph">
<p>The add-on processes the <a href="https://knative.dev/development/developer/eventing/sources/sinkbinding/"><code>K_SINK</code></a> and <a href="https://knative.dev/development/developer/eventing/sources/sinkbinding/reference/#cloudevent-overrides"><code>K_CE_OVERRIDES</code></a> environment variables injected by Knative Eventing controllers (<code>SinkBinding</code> or <code>KogitoSource</code>).</p>
</div>
<div class="paragraph">
<p>The service requires the <a href="https://github.com/apache/incubator-kie-kogito-runtimes/tree/main/addons/common/messaging">Kogito Messaging</a> and <a href="https://quarkus.io/guides/reactive-messaging-http.html">Quarkus HTTP connector</a> libraries to wire the Kogito service with a given sink. The Kogito Messaging and Quarkus HTTP connector perform as dependencies for the Knative Eventing add-on.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot does not support Knative Eventing currently.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information, see <a href="#con-knative-eventing_kogito-developing-process-services">Knative Eventing in Kogito services</a>.</p>
</div>
<div class="paragraph">
<p>To use the Knative Eventing add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-knative-eventing&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_auto_generated_knative_resources"><a class="anchor" href="#_auto_generated_knative_resources"></a><a class="link" href="#_auto_generated_knative_resources">1.7.5.1. Auto-generated Knative resources</a></h5>
<div class="paragraph">
<p>The Knative Eventing add-on can generate Knative Eventing resources by inspecting your BPMN or Serverless Workflow files for event definitions. For more information about creating BPMN files using message trigger events, see <a href="https://kie.apache.org/kogito-docs/#con-knative-eventing_kogito-developing-process-services"><em>Knative Eventing in Kogito services</em></a>. You can also see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-orchestrating-serverless"><em>Orchestrating microservices with Serverless Workflow in Kogito</em></a> to know more about the Serverless Workflow events.</p>
</div>
<div class="paragraph">
<p>To enable the auto-generation of Knative resources, add the following dependency to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-kubernetes&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the previous dependency, the add-on generates Knative Eventing resources to handle the events that are produced or consumed by your BPMN or Serverless Workflow resources on Knative Eventing platform.</p>
</div>
<div class="paragraph">
<p>For each consumed event, the add-on generates a <a href="https://knative.dev/docs/eventing/broker/triggers/">Knative Eventing Trigger</a> as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example Knative <code>Trigger</code> custom resource for a Kogito service with <code>Broker</code> binding</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: travellers-trigger-process-knative-quickstart-quarkus
spec:
  broker: default
  filter:
    attributes:
      type: travellers
  subscriber:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: process-knative-quickstart-quarkus</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Trigger</code> resource requires a subscriber to receive the events that are routed by the <code>Broker</code>. In this case, the current Kogito service work as a subscriber, and the Knative Eventing add-on uses the Kogito service deployment, which is configured by Quarkus Kubernetes.</p>
</div>
<div class="paragraph">
<p>If a <code>Broker</code> is not specified, the Knative Eventing add-on generates a default <code>InMemoryChannel</code> as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>Broker</code> custom resource for Knative Eventing with default <code>InMemoryChannel</code></div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Broker
metadata:
  name: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>Broker</code> is configured in the target namespace, you can specify the <code>Broker</code> using the following property:
<code>org.kie.kogito.addons.knative.eventing.broker=myKafkaBroker</code>.</p>
</div>
<div class="paragraph">
<p>If the Kogito service contains any produced event definitions, the Knative Eventing add-on generates a <a href="https://knative.dev/development/eventing/custom-event-source/sinkbinding/">Knative Eventing <code>SinkBinding</code></a>, or a <a href="https://github.com/knative-sandbox/eventing-kogito#kogito-source">Knative Eventing <code>KogitoSource</code></a>. By default, the <code>SinkBinding</code> is generated, but you can change this behavior by setting <code>org.kie.kogito.addons.knative.eventing.generate-kogito-source</code> property to <code>true</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example <code>SinkBinding</code> custom resource for Knative Eventing</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: sources.knative.dev/v1
kind: SinkBinding
metadata:
  name: sb-process-knative-quickstart-quarkus
spec:
  sink:
    ref:
      apiVersion: eventing.knative.dev/v1
      kind: Broker
      name: default
  subject:
    apiVersion: serving.knative.dev/v1
    kind: Service
    name: process-knative-quickstart-quarkus</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example <code>KogitoSource</code> custom resource for Knative Eventing</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: kogito.knative.dev/v1alpha1
kind: KogitoSource
metadata:
  name: process-knative-quickstart-quarkus
spec:
  sink:
    ref:
      apiVersion: eventing.knative.dev/v1
      kind: Broker
      name: default
      namespace: ""
  subject:
    apiVersion: serving.knative.dev/v1
    kind: Service
    name: process-knative-quickstart-quarkus</code></pre>
</div>
</div>
<div class="paragraph">
<p>The target deployment defined in the Quarkus Kubernetes plugin work as the subject for <code>SinkBinding</code> and <code>KogitoSource</code>. You can configure the <code>sink</code> using the application properties. By default, the generated <code>Broker</code> is defined as the <code>sink</code>.</p>
</div>
<div class="paragraph">
<p>The following table lists all the available properties for the Knative Eventing add-on:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Kogito Knative Eventing Add-on  properties</caption>
<colgroup>
<col style="width: 55.5555%;">
<col style="width: 22.2222%;">
<col style="width: 22.2223%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.sink.namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property for set sink namespace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.sink.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to set sink name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>my-sink</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.sink.api-version</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to set Kubernetes API version of the sink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eventing.knative.dev/v1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.sink.kind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to set Kubernetes resource kind of the sink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Broker</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.broker</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to set name of the pre-defined Broker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myKafkaBroker</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.generate-kogito-source</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to enable the generation of <code>KogitoSource</code> instead of <code>SinkBinding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.kie.kogito.addons.knative.eventing.auto-generate-broker</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to enable the generation of default in-memory Broker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For more information about the Knative Eventing add-on, see the following example applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/main/kogito-quarkus-examples/process-knative-quickstart-quarkus">Process Knative Eventing</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_mail_add_on"><a class="anchor" href="#_kogito_mail_add_on"></a><a class="link" href="#_kogito_mail_add_on">1.7.6. Kogito mail add-on</a></h4>
<div class="paragraph">
<p>The mail add-on is used to send emails in a process project. To use the mail add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
  &lt;artifactId&gt;jbpm-addons-quarkus-mail&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
  &lt;artifactId&gt;jbpm-addons-springboot-mail&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_events_add_on"><a class="anchor" href="#_kogito_events_add_on"></a><a class="link" href="#_kogito_events_add_on">1.7.7. Kogito events add-on</a></h4>
<div class="paragraph">
<p>The events add-on provides a default implementation in supported target platforms for EventEmitter and EventReceiver interfaces. You can use EventEmitter and EventReceiver interfaces to enable messaging by process, serverless workflow events, and event decision handling. For more information, see <a href="#con-knative-eventing_kogito-developing-process-services">Knative Eventing in Kogito services</a>, <a href="#proc-messaging-enabling_kogito-configuring">[proc-messaging-enabling_kogito-configuring]</a>.</p>
</div>
<div class="sect4">
<h5 id="_implementing_message_payload_decorator"><a class="anchor" href="#_implementing_message_payload_decorator"></a><a class="link" href="#_implementing_message_payload_decorator">1.7.7.1. Implementing message payload decorator</a></h5>
<div class="paragraph">
<p>Any dependant add-on can implement the <a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/addons/common/messaging/common/src/main/java/org/kie/kogito/addon/cloudevents/message/MessagePayloadDecorator.java">MessagePayloadDecorator</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed the Events add-on in Kogito.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a file named <code>META-INF/services/org.kie.kogito.add-on.cloudevents.message.MessagePayloadDecorator</code> in your class path.</p>
</li>
<li>
<p>Open the file.</p>
</li>
<li>
<p>Enter the full name of your implementation class in the file.</p>
</li>
<li>
<p>Save the file.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>MessagePayloadDecoratorProvider</code> loads the file upon application startup and adds the file to the decoration chain. When Kogito calls the <a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/addons/common/messaging/common/src/main/java/org/kie/kogito/addon/cloudevents/message/MessagePayloadDecoratorProvider.java">MessagePayloadDecoratorProvider#decorate</a>, your implementation is part of the decoration algorithm.</p>
</div>
<div class="paragraph">
<p>To use the events add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Events smallrye add-on for Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-events-process&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Events decisions add-on for Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-events-decisions&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Events Kafka add-on for Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-events-process-kafka&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Events decisions add-on for Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-events-decisions&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_monitoring_add_on"><a class="anchor" href="#_kogito_monitoring_add_on"></a><a class="link" href="#_kogito_monitoring_add_on">1.7.8. Kogito monitoring add-on</a></h4>
<div class="paragraph">
<p>The monitoring add-on provides monitoring capabilities in the Kogito project. For more information, see <a href="#_metrics_monitoring_in_kogito_services">Metrics monitoring in Kogito</a>.</p>
</div>
<div class="paragraph">
<p>To use the monitoring add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for elastic search</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-monitoring-elastic&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for Prometheus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-monitoring-prometheus&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for elastic search</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-monitoring-elastic&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for Prometheus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-monitoring-prometheus&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_persistence_add_on"><a class="anchor" href="#_kogito_persistence_add_on"></a><a class="link" href="#_kogito_persistence_add_on">1.7.9. Kogito persistence add-on</a></h4>
<div class="paragraph">
<p>The persistence add-on provides persistence capability in your Kogito project. For more information, <a href="#con-persistence_kogito-developing-process-services">Persistence in Kogito services</a>.</p>
</div>
<div class="paragraph">
<p>To use the Persistence add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for persistence filesystem</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-filesystem&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for persistence filesystem</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-filesystem&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for persistence Infinispan</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-infinispan&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for persistence Infinispan</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-infinispan&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for persistence JDBC</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for persistence JDBC</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for persistence MongoDB</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-mongodb&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for persistence MongoDB</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-mongodb&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for persistence PostgreSQL</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-postgresql&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot dependency for persistence PostgreSQL</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kogito-addons-springboot-persistence-postgresql&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus dependency for persistence Kafka</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-kafka&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-bpmn-process-management-addon_kogito-creating-running"><a class="anchor" href="#con-bpmn-process-management-addon_kogito-creating-running"></a><a class="link" href="#con-bpmn-process-management-addon_kogito-creating-running">1.7.10. Kogito process management add-on</a></h4>
<div class="paragraph _abstract">
<p>Kogito provides a <code>kie-addons-quarkus-process-management</code> add-on that enables basic REST operations that you can use to manage process instances. These REST operations are supplemental to any other specific REST operations that you have configured in your application.</p>
</div>
<div class="paragraph">
<p>To configure process management REST capabilities for your Kogito services, you can add the process management add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process management REST operations</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-process-management&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kogito process management add-on provides REST support for the following basic operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process instances</strong>: Abort an active process instance</p>
</li>
<li>
<p><strong>Node instances</strong>:  Cancel or re-trigger a node instance, or trigger a new node instance</p>
</li>
<li>
<p><strong>Error handling</strong>: Retrieve error details for a process instance, or skip or re-trigger a failed node instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to exposed REST operations, the process management add-on also provides the following REST exception mappers to generate more meaningful error messages for typical exception types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ProcessInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeNotFound</code></p>
</li>
<li>
<p><code>ProcessInstanceExecutionError</code></p>
</li>
<li>
<p><code>NotAuthorized</code></p>
</li>
<li>
<p><code>InvalidTransition</code> (for work items)</p>
</li>
<li>
<p><code>InvalidLifeCyclePhase</code> (for work items)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These exception mappers produce a valid HTTP error code with JSON payload with the context that caused the exception.</p>
</div>
<div class="paragraph">
<p>For example, the following is a <code>ProcessInstanceNotFoundException</code> error generated at runtime:</p>
</div>
<div class="listingblock">
<div class="title">Example error with JSON payload at runtime</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP code : 404

{
  "processInstanceId" : "c6862071-0f2e-4f21-9bc8-586245a76c3aa",
  "message" : "Process instance with id c6862071-0f2e-4f21-9bc8-586245a76c3aa not found"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-bpmn-process-svg-addon_kogito-creating-running"><a class="anchor" href="#con-bpmn-process-svg-addon_kogito-creating-running"></a><a class="link" href="#con-bpmn-process-svg-addon_kogito-creating-running">1.7.11. Kogito process SVG add-on</a></h4>
<div class="paragraph _abstract">
<p>Kogito provides an add-on named <code>process-svg-addon</code>, enabling the basic REST operations that you can use to visualize the process diagram and execution path of the related process instances. The REST operations are supplemental to any other specific REST operation that is configured in your application.</p>
</div>
<div class="paragraph">
<p>The add-on requires the access of process SVG files. The process SVG files can be placed in a file system, which is accessible to the service or available in <code>META-INF/processSVG/</code> folder in the class path. For example, when the SVG files are generated, rename the files to <code>{processId}.svg</code>. The <code>{processId}.svg</code> file is used by the add-on and placed in a file system folder (accessible by the service) or in <code>META-INF/processSVG</code> folder in the class path. The configuration property <code>kogito.svg.folder.path</code> of the add-on points to the file system folder, otherwise the files are searched in the class path.</p>
</div>
<div class="paragraph">
<p>The VSCode extension enables you to export the process to SVG format:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-svg-addon-manually-export.png" alt="Manually export to SVG at VSCode">
</div>
<div class="title">Figure 10. Export process diagram at VSCode</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you export a process to SVG format, the generated SVG is named to {processFileName}-svg.svg.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The process code generation searches this export and, if this file exists, copies and renames it to `META-INF/processSVG/{processId}.svg allowing the process SVG addon to consume it directly.</p>
</div>
<div class="paragraph">
<p>To configure process SVG REST capabilities for your Kogito services, you can add the process SVG add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process SVG REST operations in Quarkus projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-process-svg&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process SVG REST operations in Spring Boot projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-process-svg&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The process SVG add-on provides the following set of configuration properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Process SVG add-on configuration properties in Kogito</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.svg.folder.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the folder in which the add-on searches the initial process diagrams. If this property is not enabled, then the add-on searches <code>META-INF/processSVG/</code> folder in the class path.</p>
<p class="tableblock">Default value: <code>empty</code></p>
<p class="tableblock">Example: <code>kogito.svg.folder.path=/home/user/diagrams</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.svg.color.completed</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the color to fill the completed nodes when showing the execution path.</p>
<p class="tableblock">Default value: <code>#C0C0C0</code></p>
<p class="tableblock">Example: <code>kogito.svg.color.completed=#C2C0C1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.svg.color.completed.border</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the color of the border of the completed node when showing the execution path.</p>
<p class="tableblock">Default value: <code>#030303</code></p>
<p class="tableblock">Example: <code>kogito.svg.color.completed.border=#C2C0C1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.svg.color.active.border</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the color of the border of the active node when showing the execution path.</p>
<p class="tableblock">Default value: <code>#FF0000</code></p>
<p class="tableblock">Example: <code>kogito.svg.color.active.border=#C2C0C1</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Kogito process SVG add-on provides REST support for the following basic operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process Diagram</strong>: Return the process SVG diagram</p>
</li>
<li>
<p><strong>Process instance diagram</strong>: Return the process SVG diagram displaying the executed path of a specific process instance</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="con-bpmn-process-event-addon_kogito-creating-running"><a class="anchor" href="#con-bpmn-process-event-addon_kogito-creating-running"></a><a class="link" href="#con-bpmn-process-event-addon_kogito-creating-running">1.7.12. Kogito process event add-on</a></h4>
<div class="paragraph">
<p>Kogito provides a process event add-on, which you can use to send processes, tasks, and variable events to an external event listener. In this case, the processes, tasks, and variable events are generated as a result of the execution of an operation, which modifies a process state; such events are known as runtime events.</p>
</div>
<div class="paragraph">
<p>In Kogito, every modifying operation is executed within an abstraction called a unit of work. Examples of such operations include creating a process instance, transitioning a task, and modifying a variable. A runtime event is published when a unit of work is completed.</p>
</div>
<div class="paragraph">
<p>You can use the Kogito process event add-on to build a historical representation of all process instance executions. Also, you can use this add-on with process REST API to build a custom graphical user interface to handle the user tasks.</p>
</div>
<div class="paragraph">
<p>By default, the event format follows <a href="https://cloudevents.io/">CloudEvent</a> specification. The CloudEvent specification allows sending information using the data field, which contains a JSON of one of the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-services/src/main/java/org/kie/kogito/services/event/impl/ProcessInstanceEventBody.java">ProcessInstanceEvent</a>: This event is published when a process instance is created, modified, or completed.</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-services/src/main/java/org/kie/kogito/services/event/impl/UserTaskInstanceEventBody.java">UserTaskInstanceEvent</a>: This event is published when a change occurs on a user task.</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-services/src/main/java/org/kie/kogito/services/event/impl/VariableInstanceEventBody.java">VariableInstanceEvent</a>: This event is published when a variable is created, modified, or removed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure process event capabilities for your Kogito services, you can add the process event add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process event operations in Quarkus projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-events-process&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process event operations in Spring Boot projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  	&lt;groupId&gt;org.kie&lt;/groupId&gt;
  	&lt;artifactId&gt;kie-addons-springboot-events-process-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Kogito process event add-on for Spring Boot is specific to Kafka. Therefore, you do not need to add additional dependencies to your <code>pom.xml</code> file to use an event broker.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For Quarkus, the Kogito process event add-on implementation is based on <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/2/connectors/connectors.html">Smallrye Messaging</a> library, which provides a set of connectors for event brokers, such as JMS, AMQP, and Kafka. Therefore, the Kogito process event add-on is not specifically combined with any event broker in Quarkus, but requires additional configuration to use a suitable Smallrye connector.</p>
</div>
<div class="paragraph">
<p>For example, to use Kafka as an event broker in Quarkus, you can add the following dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable Kafka event broker in Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;dependency&gt;
  	&lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  	&lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Smallrye defines an abstraction named channel to enable multi-broker support. For every channel that you define in your Kogito application, you can specify the connector to use for that channel using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.connector = &lt;connector name&gt;</code></p>
</div>
<div class="paragraph">
<p>Optionally, for Kafka connector, you can define the Kafka topic to be used for that channel using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.topic = &lt;topic name&gt;</code></p>
</div>
<div class="paragraph">
<p>You can also set up a channel property using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.&lt;property name&gt;= &lt;property value&gt;</code></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If the defined property is not found, then the topic name is considered to be the same as Kafka name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Kogito process event add-on defines a channel for each event type, such as <code>kogito-processinstances-events</code>, <code>kogito-usertaskinstances-events</code>, and <code>kogito-variables-events</code>. Therefore, when the process event add-on is enabled, you must add the event types to your <code>application.properties</code> file using the following properties:</p>
</div>
<div class="listingblock">
<div class="title">Properties to define event types in <code>application.properties</code> file</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito-processinstances-events.connector=smallrye-kafka
mp.messaging.outgoing.kogito-processinstances-events.topic=kogito-processinstances-events
mp.messaging.outgoing.kogito-processinstances-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer

mp.messaging.outgoing.kogito-usertaskinstances-events.connector=smallrye-kafka
mp.messaging.outgoing.kogito-usertaskinstances-events.topic=kogito-usertaskinstances-events
mp.messaging.outgoing.kogito-usertaskinstances-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer

mp.messaging.outgoing.kogito-variables-events.connector=smallrye-kafka
mp.messaging.outgoing.kogito-variables-events.topic=kogito-variables-events
mp.messaging.outgoing.kogito-variables-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, you can disable the publishing on any channel by setting the related property to false as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example properties to disable publishing</div>
<div class="content">
<pre class="highlight"><code>kogito.events.usertasks.enabled=false
kogito.events.variables.enabled=false</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_task_management_add_on"><a class="anchor" href="#_kogito_task_management_add_on"></a><a class="link" href="#_kogito_task_management_add_on">1.7.13. Kogito task management add-on</a></h4>
<div class="paragraph">
<p>The Task Management add-on provides integration with the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/task-console">Task Console</a>. For more information, see <a href="#con-task-console_kogito-developing-process-services">Kogito Task Console</a>.</p>
</div>
<div class="paragraph">
<p>To use the Task Management add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
  &lt;artifactId&gt;jbpm-addons-quarkus-task-management&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
  &lt;artifactId&gt;jbpm-addons-springboot-task-management&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kogito_tracing_add_on"><a class="anchor" href="#_kogito_tracing_add_on"></a><a class="link" href="#_kogito_tracing_add_on">1.7.14. Kogito tracing add-on</a></h4>
<div class="paragraph">
<p>The Tracing add-on provides Decision model and notation (DMN) services tracing capability. For more information, see the <a href="https://docs.jboss.org/kogito/release/latest/html_single/#con-trusty-service_kogito-configuring" class="bare">https://docs.jboss.org/kogito/release/latest/html_single/#con-trusty-service_kogito-configuring</a> [documentation].</p>
</div>
<div class="paragraph">
<p>To use the Tracing add-on, add the following code to the <code>pom.xml</code> file of your project:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-tracing-decision&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spring boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-tracing-decision&lt;/artifactId&gt;
  &lt;version&gt;10.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="source-files-add-on"><a class="anchor" href="#source-files-add-on"></a><a class="link" href="#source-files-add-on">1.7.15. Kogito source files add-on</a></h4>
<div class="paragraph">
<p>The Kogito Source Files Add-on adds the capability of listing and downloading source files to Kogito projects.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>⚠️</strong>
This add-on isn&#8217;t supposed to be used by end-users, if not needed for internal integrations, since it can be a potential security breach for some users' use cases.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>To add the endpoints to download your services' source files, you can add the source files add-on as a dependency in your <code>pom.xml</code> file.</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable source files endpoints</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-source-files&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Access to all the endpoints is granted to the role <code>source-files-client</code>.
To define basic authentication, you can add the following code to your <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="title">Example of credentials for the user <code>scott</code> and password <code>jb0ss</code></div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">quarkus.security.users.embedded.enabled=true
quarkus.security.users.embedded.plain-text=true
quarkus.security.users.embedded.users.scott=jb0ss
quarkus.security.users.embedded.roles.scott=source-files-client</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also disable plain-text passwords by setting the <code>quarkus.security.users.embedded.plain-text</code> property to
<code>false</code> or just removing it from the configuration. In this case, the passwords are encrypted using MD5.</p>
</div>
<div class="listingblock">
<div class="title">Example of credentials for the user <code>scott</code> and password <code>jb0ss</code> encrypted using MD5</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">quarkus.security.users.embedded.enabled=true
quarkus.security.users.embedded.users.scott=4960d03c13b5aff4ca6886758a8be019
quarkus.security.users.embedded.roles.scott=source-files-client</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define a more robust authentication mechanism, you can refer to the <a href="https://quarkus.io/guides/security">Quarkus documentation</a>.</p>
</div>
<div class="paragraph">
<p>The Source Files Add-on provides REST support for the following operation:</p>
</div>
<div class="sect4">
<h5 id="_list_all_the_source_files_for_the_specified_process"><a class="anchor" href="#_list_all_the_source_files_for_the_specified_process"></a><a class="link" href="#_list_all_the_source_files_for_the_specified_process">1.7.15.1. List all the source files for the specified process</a></h5>
<div class="ulist">
<ul>
<li>
<p>GET: <code>/management/processes/{processId}/sources</code></p>
<div class="ulist">
<ul>
<li>
<p>parameters:</p>
<div class="ulist">
<ul>
<li>
<p>processId: process identifier</p>
</li>
</ul>
</div>
</li>
<li>
<p>output:</p>
<div class="ulist">
<ul>
<li>
<p>JSON with related source files URIs</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example: to list the source files for the process with id <code>petstore_http</code>, you can use the following command:</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ curl -X 'GET' \
  'http://localhost:8080/management/processes/petstore_http/sources' \
  -H 'accept: application/json' \
  -H 'Authorization: Basic c2NvdHQ6amIwc3M='</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[
  {
    "uri": "https://raw.githubusercontent.com/OAI/OpenAPI-Specification/main/examples/v2.0/json/petstore-simple.json"
  },
  {
    "uri": "/sources/org/kie/kogito/examples/petstore_http.sw.json"
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_download_the_specified_source_file"><a class="anchor" href="#_download_the_specified_source_file"></a><a class="link" href="#_download_the_specified_source_file">1.7.15.2. Download the specified source file</a></h5>
<div class="ulist">
<ul>
<li>
<p>GET: <code>/management/processes/{processId}/source</code></p>
<div class="ulist">
<ul>
<li>
<p>parameters:</p>
<div class="ulist">
<ul>
<li>
<p>processId: process identifier</p>
</li>
</ul>
</div>
</li>
<li>
<p>output:</p>
<div class="ulist">
<ul>
<li>
<p>Source file content used by the editor</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example: to list the source file for the process with id <code>petstore_http</code>, you can use the following command:</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ curl -X 'GET' \
  'http://localhost:8080/management/processes/petstore_http/source' \
  -H 'accept: application/json' \
  -H 'Authorization: Basic c2NvdHQ6amIwc3M='</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Output</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "petstore_http",
  "version": "1.0",
  "name": "Send CloudEvent after creating Pluto",
  "start": "AddPluto",
  "functions": [
    {
      "name": "addPet",
      "operation": "https://raw.githubusercontent.com/OAI/OpenAPI-Specification/main/examples/v2.0/json/petstore-simple.json#addPet"
    }
  ],
  "states": [
    {
      "name": "AddPluto",
      "type": "operation",
      "actions": [
        {
          "functionRef": {
            "refName": "addPet",
            "parameters": {
              "body": {
                "name": "Pluto"
              }
            }
          }
        }
      ],
      "end": true
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: to download the source file located at <code>org/kie/kogito/examples/petstore_http.sw.json</code>, you can use the following command:</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ curl -X 'GET' \
  'http://localhost:8080/sources?uri=org/kie/kogito/examples/petstore_http.sw.json' \
  -H 'accept: */*' \
  -H 'Authorization: Basic c2NvdHQ6amIwc3M='</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-designing-app_kogito-creating-running"><a class="anchor" href="#proc-kogito-designing-app_kogito-creating-running"></a><a class="link" href="#proc-kogito-designing-app_kogito-creating-running">1.8. Designing the application logic for a Kogito service using DMN and BPMN</a></h3>
<div class="paragraph _abstract">
<p>After you create your Kogito project, you can create or import Business Process Model and Notation (BPMN) 2.0 business processes, Decision Model and Notation (DMN) decision models, Drools Rule Language (DRL) business rules, XLS or XLSX decision tables, and other assets in the <code>src/main/resources</code> folder of your project. You can also include Java classes in the <code>src/main/java</code> folder of your project that act as Java services or provide implementations that you call from your business processes or decisions.</p>
</div>
<div class="paragraph">
<p>The example for this procedure is a basic Kogito service that provides a REST endpoint <code>/persons</code>. This endpoint is automatically generated based on an example <code>PersonProcess.bpmn2</code> business process that employs an example <code>PersonDecisions.dmn</code> DMN model to make decisions based on the data being processed.</p>
</div>
<div class="paragraph">
<p>The business process contains the business logic of the Kogito service. The process provides the complete set of steps to achieve the business goal. The process is also the entry point to the service that can be consumed by other services.</p>
</div>
<div class="paragraph">
<p>The business decision contains the decision logic of the Kogito service. In this example, the decision logic is invoked as part of the business process. You can define business rules and decisions in several ways, such as with DMN models, DRL rules, or XLS or XLSX decision tables. The example for this procedure uses a DMN model.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Maven project that you generated for your Kogito service, navigate to the <code>src/main/java/org/acme</code> folder and add the following <code>Person.java</code> file:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example person Java object</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme;

import java.io.Serializable;

public class Person {

	private String name;
	private int age;
	private boolean adult;

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public int getAge() {
		return age;
	}

	public void setAge(int age) {
		this.age = age;
	}

	public boolean isAdult() {
		return adult;
	}

	public void setAdult(boolean adult) {
		this.adult = adult;
	}

	@Override
	public String toString() {
		return "Person [name=" + name + ", age=" + age + ", adult=" + adult + "]";
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example Java object sets and retrieves a person&#8217;s name, age, and adult status.</p>
</div>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>src/main/resources</code> folder and add the following <code>PersonDecisions.dmn</code> DMN decision model:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-dmn-example-person.png" alt="Image of PersonDecisions decision diagram">
</div>
<div class="title">Figure 11. Example <code>PersonDecisions</code> DMN decision requirements diagram (DRD)</div>
</div>
<div class="paragraph">
<p>This example DMN model consists of a basic DMN input node and a decision node defined by a DMN decision table with a custom structured data type.</p>
</div>
<div class="paragraph">
<p>In VSCode (recommended), you can add the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension to design the decision requirements diagram (DRD), boxed expression, and data types with the Kogito DMN modeler.</p>
</div>
<div class="paragraph">
<p>To create this example DMN model quickly, you can copy <a href="#person-decisions-source-xml">Example <code>PersonDecisions.dmn</code> file</a>.</p>
</div>
<div class="paragraph">
<p>To create this example DMN model in VSCode using the Kogito DMN modeler, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the empty <code>PersonDecisions.dmn</code> file and in the upper-right corner of the DMN modeler, click the <strong>Properties</strong> icon and confirm that the DMN model <strong>Name</strong> is set to <code>PersonDecisions</code>.</p>
</li>
<li>
<p>In the left palette, select <strong>DMN Input Data</strong>, drag the node to the canvas, and double-click the node to name it <code>Person</code>.</p>
</li>
<li>
<p>In the left palette, select <strong>DMN Decision</strong>, drag the node to the canvas, double-click the node to name it <code>isAdult</code>, and link to it from the input node.</p>
</li>
<li>
<p>Select the decision node to display the node options and click the <strong>Edit</strong> icon to open the DMN boxed expression editor to define the decision logic for the node.</p>
</li>
<li>
<p>Click the undefined expression field and select <strong>Decision Table</strong>.</p>
</li>
<li>
<p>Click the upper-left corner of the decision table to set the hit policy to <strong>Unique</strong>.</p>
</li>
<li>
<p>Set the input and output columns so that the input source <code>Person.Age</code> with type <code>number</code> determines the age limit and the output target <code>isAdult</code> with type <code>boolean</code> determines adult status:</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-dmn-example-person-logic.png" alt="Image of PersonDecisions decision table">
</div>
<div class="title">Figure 12. Example DMN decision table for <code>isAdult</code> decision</div>
</div>
</li>
<li>
<p>In the upper tab options, select the <strong>Data Types</strong> tab and add the following <code>tPerson</code> structured data type and nested data types:</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-dmn-example-person-data-types.png" alt="Image of PersonDecisions data types">
</div>
<div class="title">Figure 13. Example DMN data types</div>
</div>
</li>
<li>
<p>After you define the data types, select the <strong>Editor</strong> tab to return to the DMN modeler canvas.</p>
</li>
<li>
<p>Select the <strong>Person</strong> input node, click the <strong>Properties</strong> icon, and under <strong>Information item</strong>, set the <strong>Data type</strong> to <code>tPerson</code>.</p>
</li>
<li>
<p>Select the <strong>isAdult</strong> decision node, click the <strong>Properties</strong> icon, and under <strong>Information item</strong>, confirm that the <strong>Data type</strong> is still set to <code>boolean</code>. You previously set this data type when you created the decision table.</p>
</li>
<li>
<p>Save the DMN decision file.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>In the <code>src/main/resources</code> folder, add the following <code>PersonProcess.bpmn2</code> BPMN process model:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of person process diagram">
</div>
<div class="title">Figure 14. Example <code>PersonProcess</code> BPMN process</div>
</div>
<div class="paragraph">
<p>This example process consists of the following basic BPMN components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start event</p>
</li>
<li>
<p>Business rule task</p>
</li>
<li>
<p>Exclusive gateway</p>
</li>
<li>
<p>User task</p>
</li>
<li>
<p>End events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In VSCode (recommended), you can add the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension to model the business process with the Kogito BPMN modeler.</p>
</div>
<div class="paragraph">
<p>To create this example process quickly, you can copy the following <code>PersonProcess.bpmn2</code> file content:</p>
</div>
<div class="listingblock">
<div class="title">Example BPMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:bpsim="http://www.bpsim.org/schemas/1.0" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:drools="http://www.jboss.org/drools" id="_J4ElsVJgEDiScotxwBQ14Q" exporter="jBPM Process Modeler" exporterVersion="2.0" targetNamespace="http://www.omg.org/bpmn20"&gt;
  &lt;bpmn2:itemDefinition id="_personItem" structureRef="org.acme.Person"/&gt;
  &lt;bpmn2:itemDefinition id="_isAdultItem" structureRef="Boolean"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_SkippableInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_PriorityInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_CommentInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_DescriptionInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_CreatedByInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_TaskNameInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_GroupIdInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_ContentInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotStartedReassignInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotCompletedReassignInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotStartedNotifyInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_NotCompletedNotifyInputXItem" structureRef="Object"/&gt;
  &lt;bpmn2:itemDefinition id="_UserTask_1_personInputXItem" structureRef="org.acme.Person"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_namespaceInputXItem" structureRef="java.lang.String"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_modelInputXItem" structureRef="java.lang.String"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_decisionInputXItem" structureRef="java.lang.String"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_PersonInputXItem" structureRef="org.acme.Person"/&gt;
  &lt;bpmn2:itemDefinition id="_BusinessRuleTask_1_isAdultOutputXItem" structureRef="Boolean"/&gt;
  &lt;bpmn2:process id="persons" drools:packageName="org.acme" drools:version="1.0" drools:adHoc="false" name="Person Process" isExecutable="true" processType="Public"&gt;
    &lt;bpmn2:property id="person" itemSubjectRef="_personItem" name="person"/&gt;
    &lt;bpmn2:property id="isAdult" itemSubjectRef="_isAdultItem" name="isAdult"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_1" sourceRef="StartEvent_1" targetRef="BusinessRuleTask_1"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_2" sourceRef="BusinessRuleTask_1" targetRef="ExclusiveGateway_1"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_3" sourceRef="ExclusiveGateway_1" targetRef="UserTask_1"&gt;
      &lt;bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression" language="http://www.java.com/java"&gt;return isAdult == false;&lt;/bpmn2:conditionExpression&gt;
    &lt;/bpmn2:sequenceFlow&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_4" sourceRef="UserTask_1" targetRef="EndEvent_1"/&gt;
    &lt;bpmn2:sequenceFlow id="SequenceFlow_5" sourceRef="ExclusiveGateway_1" targetRef="EndEvent_2"&gt;
      &lt;bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression" language="http://www.java.com/java"&gt;return isAdult == true;&lt;/bpmn2:conditionExpression&gt;
    &lt;/bpmn2:sequenceFlow&gt;
    &lt;bpmn2:startEvent id="StartEvent_1" name="StartProcess"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;StartProcess&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_1&lt;/bpmn2:outgoing&gt;
    &lt;/bpmn2:startEvent&gt;
    &lt;bpmn2:businessRuleTask id="BusinessRuleTask_1" name="Evaluate person" implementation="http://www.jboss.org/drools/dmn"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;Evaluate person&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_1&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_2&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:ioSpecification&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_namespaceInputX" drools:dtype="java.lang.String" itemSubjectRef="_BusinessRuleTask_1_namespaceInputXItem" name="namespace"/&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_decisionInputX" drools:dtype="java.lang.String" itemSubjectRef="_BusinessRuleTask_1_decisionInputXItem" name="decision"/&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_modelInputX" drools:dtype="java.lang.String" itemSubjectRef="_BusinessRuleTask_1_modelInputXItem" name="model"/&gt;
        &lt;bpmn2:dataInput id="BusinessRuleTask_1_PersonInputX" drools:dtype="org.acme.Person" itemSubjectRef="_BusinessRuleTask_1_PersonInputXItem" name="Person"/&gt;
        &lt;bpmn2:dataOutput id="BusinessRuleTask_1_isAdultOutputX" drools:dtype="Boolean" itemSubjectRef="_BusinessRuleTask_1_isAdultOutputXItem" name="isAdult"/&gt;
        &lt;bpmn2:inputSet&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_namespaceInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_decisionInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_modelInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;BusinessRuleTask_1_PersonInputX&lt;/bpmn2:dataInputRefs&gt;
        &lt;/bpmn2:inputSet&gt;
        &lt;bpmn2:outputSet&gt;
          &lt;bpmn2:dataOutputRefs&gt;BusinessRuleTask_1_isAdultOutputX&lt;/bpmn2:dataOutputRefs&gt;
        &lt;/bpmn2:outputSet&gt;
      &lt;/bpmn2:ioSpecification&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_namespaceInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;BusinessRuleTask_1_namespaceInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_decisionInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;isAdult&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;BusinessRuleTask_1_decisionInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_modelInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;PersonDecisions&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;BusinessRuleTask_1_modelInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:sourceRef&gt;person&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;BusinessRuleTask_1_PersonInputX&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataOutputAssociation&gt;
        &lt;bpmn2:sourceRef&gt;BusinessRuleTask_1_isAdultOutputX&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;isAdult&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataOutputAssociation&gt;
    &lt;/bpmn2:businessRuleTask&gt;
    &lt;bpmn2:exclusiveGateway id="ExclusiveGateway_1" name="Exclusive Gateway 1" gatewayDirection="Diverging"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;Exclusive Gateway 1&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_2&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_5&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_3&lt;/bpmn2:outgoing&gt;
    &lt;/bpmn2:exclusiveGateway&gt;
    &lt;bpmn2:userTask id="UserTask_1" name="Special handling for children"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;Special handling for children&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_3&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;SequenceFlow_4&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:ioSpecification&gt;
        &lt;bpmn2:dataInput id="UserTask_1_TaskNameInputX" drools:dtype="Object" itemSubjectRef="_UserTask_1_TaskNameInputXItem" name="TaskName"/&gt;
        &lt;bpmn2:dataInput id="UserTask_1_personInputX" drools:dtype="org.acme.Person" itemSubjectRef="_UserTask_1_personInputXItem" name="person"/&gt;
        &lt;bpmn2:dataInput id="UserTask_1_SkippableInputX" drools:dtype="Object" itemSubjectRef="_UserTask_1_SkippableInputXItem" name="Skippable"/&gt;
        &lt;bpmn2:dataInput id="UserTask_1_PriorityInputX" drools:dtype="Object" itemSubjectRef="_UserTask_1_PriorityInputXItem" name="Priority"/&gt;
        &lt;bpmn2:inputSet&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_TaskNameInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_personInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_SkippableInputX&lt;/bpmn2:dataInputRefs&gt;
          &lt;bpmn2:dataInputRefs&gt;UserTask_1_PriorityInputX&lt;/bpmn2:dataInputRefs&gt;
        &lt;/bpmn2:inputSet&gt;
      &lt;/bpmn2:ioSpecification&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_TaskNameInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;ChildrenHandling&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;UserTask_1_TaskNameInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:sourceRef&gt;person&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_personInputX&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_SkippableInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;true&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;UserTask_1_SkippableInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataInputAssociation&gt;
        &lt;bpmn2:targetRef&gt;UserTask_1_PriorityInputX&lt;/bpmn2:targetRef&gt;
        &lt;bpmn2:assignment&gt;
          &lt;bpmn2:from xsi:type="bpmn2:tFormalExpression"&gt;1&lt;/bpmn2:from&gt;
          &lt;bpmn2:to xsi:type="bpmn2:tFormalExpression"&gt;UserTask_1_PriorityInputX&lt;/bpmn2:to&gt;
        &lt;/bpmn2:assignment&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
    &lt;/bpmn2:userTask&gt;
    &lt;bpmn2:endEvent id="EndEvent_1" name="End Event 1"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;End Event 1&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_4&lt;/bpmn2:incoming&gt;
    &lt;/bpmn2:endEvent&gt;
    &lt;bpmn2:endEvent id="EndEvent_2" name="End Event 2"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;End Event 2&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;SequenceFlow_5&lt;/bpmn2:incoming&gt;
    &lt;/bpmn2:endEvent&gt;
  &lt;/bpmn2:process&gt;
  &lt;bpmndi:BPMNDiagram&gt;
    &lt;bpmndi:BPMNPlane bpmnElement="persons"&gt;
      &lt;bpmndi:BPMNShape id="shape_EndEvent_2" bpmnElement="EndEvent_2"&gt;
        &lt;dc:Bounds height="56" width="56" x="622" y="201"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_EndEvent_1" bpmnElement="EndEvent_1"&gt;
        &lt;dc:Bounds height="56" width="56" x="622" y="105"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_UserTask_1" bpmnElement="UserTask_1"&gt;
        &lt;dc:Bounds height="78" width="134" x="449" y="94"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_ExclusiveGateway_1" bpmnElement="ExclusiveGateway_1"&gt;
        &lt;dc:Bounds height="56" width="56" x="365" y="105"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_BusinessRuleTask_1" bpmnElement="BusinessRuleTask_1"&gt;
        &lt;dc:Bounds height="71" width="141" x="180" y="97"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape_StartEvent_1" bpmnElement="StartEvent_1"&gt;
        &lt;dc:Bounds height="56" width="56" x="80" y="105"/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_ExclusiveGateway_1_to_shape_EndEvent_2" bpmnElement="SequenceFlow_5"&gt;
        &lt;di:waypoint x="390" y="155"/&gt;
        &lt;di:waypoint x="393" y="231"/&gt;
        &lt;di:waypoint x="622" y="219"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_UserTask_1_to_shape_EndEvent_1" bpmnElement="SequenceFlow_4"&gt;
        &lt;di:waypoint x="583" y="133"/&gt;
        &lt;di:waypoint x="622" y="123"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_ExclusiveGateway_1_to_shape_UserTask_1" bpmnElement="SequenceFlow_3"&gt;
        &lt;di:waypoint x="415" y="130"/&gt;
        &lt;di:waypoint x="449" y="133"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_BusinessRuleTask_1_to_shape_ExclusiveGateway_1" bpmnElement="SequenceFlow_2"&gt;
        &lt;di:waypoint x="321" y="132.5"/&gt;
        &lt;di:waypoint x="365" y="130"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape_StartEvent_1_to_shape_BusinessRuleTask_1" bpmnElement="SequenceFlow_1"&gt;
        &lt;di:waypoint x="116" y="123"/&gt;
        &lt;di:waypoint x="180" y="132.5"/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
    &lt;/bpmndi:BPMNPlane&gt;
  &lt;/bpmndi:BPMNDiagram&gt;
  &lt;bpmn2:relationship type="BPSimData"&gt;
    &lt;bpmn2:extensionElements&gt;
      &lt;bpsim:BPSimData&gt;
        &lt;bpsim:Scenario id="default" name="Simulationscenario"&gt;
          &lt;bpsim:ScenarioParameters/&gt;
          &lt;bpsim:ElementParameters elementRef="UserTask_1"&gt;
            &lt;bpsim:TimeParameters&gt;
              &lt;bpsim:ProcessingTime&gt;
                &lt;bpsim:NormalDistribution mean="0" standardDeviation="0"/&gt;
              &lt;/bpsim:ProcessingTime&gt;
            &lt;/bpsim:TimeParameters&gt;
            &lt;bpsim:ResourceParameters&gt;
              &lt;bpsim:Availability&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Availability&gt;
              &lt;bpsim:Quantity&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Quantity&gt;
            &lt;/bpsim:ResourceParameters&gt;
            &lt;bpsim:CostParameters&gt;
              &lt;bpsim:UnitCost&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:UnitCost&gt;
            &lt;/bpsim:CostParameters&gt;
          &lt;/bpsim:ElementParameters&gt;
          &lt;bpsim:ElementParameters elementRef="BusinessRuleTask_1"&gt;
            &lt;bpsim:TimeParameters&gt;
              &lt;bpsim:ProcessingTime&gt;
                &lt;bpsim:NormalDistribution mean="0" standardDeviation="0"/&gt;
              &lt;/bpsim:ProcessingTime&gt;
            &lt;/bpsim:TimeParameters&gt;
            &lt;bpsim:ResourceParameters&gt;
              &lt;bpsim:Availability&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Availability&gt;
              &lt;bpsim:Quantity&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:Quantity&gt;
            &lt;/bpsim:ResourceParameters&gt;
            &lt;bpsim:CostParameters&gt;
              &lt;bpsim:UnitCost&gt;
                &lt;bpsim:FloatingParameter value="0"/&gt;
              &lt;/bpsim:UnitCost&gt;
            &lt;/bpsim:CostParameters&gt;
          &lt;/bpsim:ElementParameters&gt;
          &lt;bpsim:ElementParameters elementRef="StartEvent_1"&gt;
            &lt;bpsim:TimeParameters&gt;
              &lt;bpsim:ProcessingTime&gt;
                &lt;bpsim:NormalDistribution mean="0" standardDeviation="0"/&gt;
              &lt;/bpsim:ProcessingTime&gt;
            &lt;/bpsim:TimeParameters&gt;
          &lt;/bpsim:ElementParameters&gt;
        &lt;/bpsim:Scenario&gt;
      &lt;/bpsim:BPSimData&gt;
    &lt;/bpmn2:extensionElements&gt;
    &lt;bpmn2:source&gt;_J4ElsVJgEDiScotxwBQ14Q&lt;/bpmn2:source&gt;
    &lt;bpmn2:target&gt;_J4ElsVJgEDiScotxwBQ14Q&lt;/bpmn2:target&gt;
  &lt;/bpmn2:relationship&gt;
&lt;/bpmn2:definitions&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create this example BPMN process in VSCode using the Kogito BPMN modeler, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the empty <code>PersonProcess.bpmn2</code> file and in the upper-right corner of the BPMN modeler, click the <strong>Properties</strong> icon and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Process</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: <code>Person Process</code></p>
</li>
<li>
<p><strong>ID</strong>: <code>persons</code></p>
</li>
<li>
<p><strong>Package</strong>: <code>org.acme</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Process Data</strong>: Add the following process variables:</p>
<div class="ulist">
<ul>
<li>
<p><code>person</code> with the type <code>org.acme.Person</code> (Use the <strong>Custom</strong> data type option to define the custom type.)</p>
</li>
<li>
<p><code>isAdult</code> with the type <code>Boolean</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>Business Rule</strong>, drag the task to the canvas, and link to it from the start event.</p>
</li>
<li>
<p>Select the business rule task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Set the rule task <strong>Name</strong> to <code>Evaluate person</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule Language</strong>: <code>DMN</code></p>
</li>
<li>
<p><strong>Namespace</strong>: The <code>namespace</code> property value from the <code>PersonDecisions.dmn</code> file that you created previously, such as <code><a href="https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36" class="bare">https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36</a></code></p>
</li>
<li>
<p><strong>Decision Name</strong>: <code>isAdult</code></p>
</li>
<li>
<p><strong>DMN Model Name</strong>: <code>PersonDecisions</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Data Assignments</strong>: Add the following assignments:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Data Input</strong>: Add a data input with the name <code>Person</code>, with the type <code>org.acme.Person</code>, and with the source <code>person</code>.</p>
</li>
<li>
<p><strong>Data Output</strong>: Add a data output with the name <code>isAdult</code>, with the type <code>Boolean</code>, and with the source <code>isAdult</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>Gateways</strong> &#8594; <strong>Exclusive</strong>, drag the gateway to the canvas, and link to it from the rule task.</p>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>User</strong>, drag the user task to the canvas, and link to it from the exclusive gateway.</p>
</li>
<li>
<p>Select the user task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Set the user task <strong>Name</strong> to <code>Special handling for children</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the <strong>Task Name</strong> to <code>ChildrenHandling</code>, and add a data input with the name <code>person</code>, the type <code>org.acme.Person</code>, and the source <code>person</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>End Events</strong> &#8594; <strong>End</strong>, drag two end events to the canvas, and link to one end event from the user task and to the other end event from the exclusive gateway.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the end event and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition <code>return isAdult == true;</code>.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the user task and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition to <code>return isAdult == false;</code></p>
</li>
<li>
<p>Save the BPMN process file.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="proc-kogito-designing-app-rule-units_kogito-creating-running"><a class="anchor" href="#proc-kogito-designing-app-rule-units_kogito-creating-running"></a><a class="link" href="#proc-kogito-designing-app-rule-units_kogito-creating-running">1.8.1. Using DRL rule units as an alternative decision service</a></h4>
<div class="paragraph _abstract">
<p>As an alternative to using Decision Model and Notation (DMN) to define this example decision service, you can also use a Drools Rule Language (DRL) file implemented as a rule unit.</p>
</div>
<div class="paragraph">
<p>A DRL rule unit is a module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained. For more information about rule units, see <a href="https://kie.apache.org/kogito-docs/#con-drl-rule-units_kogito-drl-rules"><em>Developing decision services with Kogito</em></a>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <code>src/main/resources</code> folder of your example Kogito project, instead of using a DMN file, add the following <code>PersonRules.drl</code> file:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: /person[ age &gt; 18 ]
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example rule determines that any person who is older than 18 is classified as an adult. The rule file also declares that the rule belongs to the rule unit <code>PersonRules</code>. This is the rule unit that you define as part of the business rule task in the example BPMN process. When you build the project, the rule unit is generated and associated with the DRL file.</p>
</div>
<div class="paragraph">
<p>The rule also defines the condition using OOPath notation. OOPath is an object-oriented syntax extension to XPath for navigating through related elements while handling collections and filtering constraints.</p>
</div>
<div class="paragraph">
<p>You can also rewrite the same rule condition in a more explicit form using the traditional rule pattern syntax, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file using traditional notation</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: Person(age &gt; 18) from person
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>In the <code>src/main/resources</code> folder, use the Kogito BPMN modeler in VSCode to open the <code>PersonProcess.bpmn2</code> process diagram that you created.</p>
</li>
<li>
<p>Select the <code>Evaluate person</code> business rule task and modify the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Implementation/Execution</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule Language</strong>: <code>DRL</code> (instead of <code>DMN</code>)</p>
</li>
<li>
<p><strong>Rule Flow Group</strong>: <code>unit:org.acme.PersonRules</code></p>
<div class="paragraph">
<p>This rule unit syntax in the <strong>Rule Flow Group</strong> field specifies that you are using the <code>org.acme.PersonRules</code> rule unit instead of a traditional rule flow group. This is the rule unit that you referenced in the example DRL file. When you build the project, the business process implicitly declares the rule unit as part of the business rule task to execute the DRL file.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Data Assignments</strong>: Open the assignment settings and change the data input <strong>Name</strong> to <code>person</code> (instead of <code>Person</code>). This accommodates the input variable syntax required by the DRL file.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the end event and for the <strong>Implementation/Execution</strong> property, verify that the <strong>Condition Expression</strong> is set to <code>Java</code> and change the condition to <code>return person.isAdult();</code>.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the user task and for the <strong>Implementation/Execution</strong> property, verify that the <strong>Condition Expression</strong> is set to <code>Java</code> and change the condition <code>return ! person.isAdult();</code>.</p>
</li>
<li>
<p>Save the process file to update the model.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-testing-decision-logic_kogito-creating-running"><a class="anchor" href="#proc-kogito-testing-decision-logic_kogito-creating-running"></a><a class="link" href="#proc-kogito-testing-decision-logic_kogito-creating-running">1.9. Testing the decision logic for a Kogito service using test scenarios</a></h3>
<div class="paragraph _abstract">
<p>As you develop business decisions in your Kogito services, you can use test scenarios to validate the functionality of your decisions before you begin running and using your Kogito services. With a test scenario, you use data from your project to set given conditions and expected results based on one or more defined business decisions. When you run the scenario, the expected results and actual results of the decision instance are compared. If the expected results match the actual results, the test is successful. If the expected results do not match the actual results, then the test fails.</p>
</div>
<div class="paragraph">
<p>You define test scenarios in <code>.scesim</code> (scenario simulation) files that you can model in Visual Studio Code (VSCode) using the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension. You can use one or multiple <code>.scesim</code> files in your Kogito project, and each <code>.scesim</code> file can contain one or multiple test scenarios based on the defined decision data.</p>
</div>
<div class="paragraph">
<p>The example for this procedure uses a basic <code>PersonDecisionsTest.scesim</code> test scenario file that validates the decision logic in the example <code>PersonDecisions.dmn</code> Decision Model and Notation (DMN) model that you created previously.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Test scenarios in Kogito currently support DMN decision services only. Test scenarios will support Drools Rule Language (DRL) decision services in a future release.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created the <code>PersonDecisions.dmn</code> DMN model that determines whether a specified person is an adult or is underage. For more information about this DMN model, see <a href="#proc-kogito-designing-app_kogito-creating-running">Designing the application logic for a Kogito service using DMN and BPMN</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Maven project that contains your Kogito decision services, add the following dependency to the <code>pom.xml</code> file to enable test scenario execution for your project:</p>
<div class="listingblock">
<div class="title">Dependency to enable test scenario execution</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.drools&lt;/groupId&gt;
  &lt;artifactId&gt;drools-scenario-simulation&lt;/artifactId&gt;
  &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>src/main</code> folder of the project and create a <code>test</code> folder with the following subfolders. If you have an existing <code>test</code> folder structure, you can adapt the steps that follow according to your project layout.</p>
<div class="listingblock">
<div class="title">Test folder structure for test scenarios</div>
<div class="content">
<pre class="highlight"><code>src/main/test/
          └── java/testscenario
          └── resources</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>test/java/testscenario</code> folder and add the following <code>KogitoScenarioJunitActivatorTest.java</code> class:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Activator class for test scenarios</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package testscenario;

@org.junit.runner.RunWith(org.kogito.scenariosimulation.runner.KogitoJunitActivator.class)
public class KogitoScenarioJunitActivatorTest {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This activator class is a custom <a href="https://junit.org/junit5/">JUnit 5</a> runner that enables the execution of test scenario files in your Kogito project. When you run test scenarios, this class loads all <code>.scesim</code> files available in the project and executes them. For each row (scenario) in a test scenario file, the activator class generates a JUnit test result.</p>
</div>
</div>
</div>
</li>
<li>
<p>Navigate to the <code>test/resources</code> folder and add the following <code>PersonDecisionsTest.scesim</code> test scenario file:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-test-scenario-example-person.png" alt="Image of PersonDecisionsTest test scenario">
</div>
<div class="title">Figure 15. Example test scenarios for <code>PersonDecisions</code> DMN decision logic</div>
</div>
<div class="paragraph">
<p>The <strong>GIVEN</strong> columns specify input conditions based on the corresponding decision service. The <strong>EXPECT</strong> column specifies the expected results of the decision service based on the defined <strong>GIVEN</strong> conditions. Each row in the table is a defined scenario with example values for the <strong>GIVEN</strong> and <strong>EXPECT</strong> definitions to test the decision logic of the corresponding decision service.</p>
</div>
<div class="paragraph">
<p>This example test scenario file tests the decision logic for the following <code>PersonDecisions.dmn</code> model that you created previously. This DMN model determines whether a specified person is an adult or is underage.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-dmn-example-person.png" alt="Image of PersonDecisions decision diagram">
</div>
<div class="title">Figure 16. Example <code>PersonDecisions</code> DMN decision requirements diagram (DRD)</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-dmn-example-person-logic.png" alt="Image of PersonDecisions decision table">
</div>
<div class="title">Figure 17. Example DMN boxed expression for <code>isAdult</code> decision</div>
</div>
<div class="paragraph">
<p>In VSCode (recommended), you can add the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension to design the test scenarios with the test scenario modeler.</p>
</div>
<div class="paragraph">
<p>To create these example test scenarios quickly, you can copy the following <code>PersonDecisionsTest.scesim</code> file content:</p>
</div>
<div class="listingblock">
<div class="title">Example test scenario file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;ScenarioSimulationModel version="1.8"&gt;
  &lt;simulation&gt;
    &lt;scesimModelDescriptor&gt;
      &lt;factMappings&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;Index&lt;/name&gt;
            &lt;type&gt;OTHER&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;#&lt;/name&gt;
            &lt;className&gt;java.lang.Integer&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.Integer&lt;/className&gt;
          &lt;factAlias&gt;#&lt;/factAlias&gt;
          &lt;columnWidth&gt;70&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;Description&lt;/name&gt;
            &lt;type&gt;OTHER&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Scenario description&lt;/name&gt;
            &lt;className&gt;java.lang.String&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.String&lt;/className&gt;
          &lt;factAlias&gt;Scenario description&lt;/factAlias&gt;
          &lt;columnWidth&gt;300&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Person&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Age&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|1&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Person&lt;/name&gt;
            &lt;className&gt;Person&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;number&lt;/className&gt;
          &lt;factAlias&gt;Person&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Age&lt;/expressionAlias&gt;
          &lt;genericTypes/&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Person&lt;/step&gt;
            &lt;/ExpressionElement&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;Name&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|2&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Person&lt;/name&gt;
            &lt;className&gt;Person&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;string&lt;/className&gt;
          &lt;factAlias&gt;Person&lt;/factAlias&gt;
          &lt;expressionAlias&gt;Name&lt;/expressionAlias&gt;
          &lt;genericTypes/&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements&gt;
            &lt;ExpressionElement&gt;
              &lt;step&gt;isAdult&lt;/step&gt;
            &lt;/ExpressionElement&gt;
          &lt;/expressionElements&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|4&lt;/name&gt;
            &lt;type&gt;EXPECT&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;isAdult&lt;/name&gt;
            &lt;className&gt;isAdult&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;boolean&lt;/className&gt;
          &lt;factAlias&gt;isAdult&lt;/factAlias&gt;
          &lt;expressionAlias&gt;value&lt;/expressionAlias&gt;
          &lt;genericTypes/&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
      &lt;/factMappings&gt;
    &lt;/scesimModelDescriptor&gt;
    &lt;scesimData&gt;
      &lt;Scenario&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Scenario description&lt;/name&gt;
              &lt;className&gt;java.lang.String&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Description&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;Is an adult&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;20&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|2&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;"John Quark"&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;isAdult&lt;/name&gt;
              &lt;className&gt;isAdult&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|4&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;true&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;#&lt;/name&gt;
              &lt;className&gt;java.lang.Integer&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Index&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;1&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/Scenario&gt;
      &lt;Scenario&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Scenario description&lt;/name&gt;
              &lt;className&gt;java.lang.String&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Description&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;Is underage&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;15&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Person&lt;/name&gt;
              &lt;className&gt;Person&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|2&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;"Jenny Quark"&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;isAdult&lt;/name&gt;
              &lt;className&gt;isAdult&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|4&lt;/name&gt;
              &lt;type&gt;EXPECT&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;false&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;#&lt;/name&gt;
              &lt;className&gt;java.lang.Integer&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;Index&lt;/name&gt;
              &lt;type&gt;OTHER&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
            &lt;rawValue class="string"&gt;2&lt;/rawValue&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/Scenario&gt;
    &lt;/scesimData&gt;
  &lt;/simulation&gt;
  &lt;background&gt;
    &lt;scesimModelDescriptor&gt;
      &lt;factMappings&gt;
        &lt;FactMapping&gt;
          &lt;expressionElements/&gt;
          &lt;expressionIdentifier&gt;
            &lt;name&gt;1|1&lt;/name&gt;
            &lt;type&gt;GIVEN&lt;/type&gt;
          &lt;/expressionIdentifier&gt;
          &lt;factIdentifier&gt;
            &lt;name&gt;Empty&lt;/name&gt;
            &lt;className&gt;java.lang.Void&lt;/className&gt;
          &lt;/factIdentifier&gt;
          &lt;className&gt;java.lang.Void&lt;/className&gt;
          &lt;factAlias&gt;INSTANCE 1&lt;/factAlias&gt;
          &lt;expressionAlias&gt;PROPERTY 1&lt;/expressionAlias&gt;
          &lt;columnWidth&gt;114&lt;/columnWidth&gt;
          &lt;factMappingValueType&gt;NOT_EXPRESSION&lt;/factMappingValueType&gt;
        &lt;/FactMapping&gt;
      &lt;/factMappings&gt;
    &lt;/scesimModelDescriptor&gt;
    &lt;scesimData&gt;
      &lt;BackgroundData&gt;
        &lt;factMappingValues&gt;
          &lt;FactMappingValue&gt;
            &lt;factIdentifier&gt;
              &lt;name&gt;Empty&lt;/name&gt;
              &lt;className&gt;java.lang.Void&lt;/className&gt;
            &lt;/factIdentifier&gt;
            &lt;expressionIdentifier&gt;
              &lt;name&gt;1|1&lt;/name&gt;
              &lt;type&gt;GIVEN&lt;/type&gt;
            &lt;/expressionIdentifier&gt;
          &lt;/FactMappingValue&gt;
        &lt;/factMappingValues&gt;
      &lt;/BackgroundData&gt;
    &lt;/scesimData&gt;
  &lt;/background&gt;
  &lt;settings&gt;
    &lt;dmnFilePath&gt;src/main/resources/PersonDecisions.dmn&lt;/dmnFilePath&gt;
    &lt;type&gt;DMN&lt;/type&gt;
    &lt;dmnNamespace&gt;https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36&lt;/dmnNamespace&gt;
    &lt;dmnName&gt;PersonDecisions&lt;/dmnName&gt;
    &lt;skipFromBuild&gt;false&lt;/skipFromBuild&gt;
    &lt;stateless&gt;false&lt;/stateless&gt;
  &lt;/settings&gt;
  &lt;imports&gt;
    &lt;imports/&gt;
  &lt;/imports&gt;
&lt;/ScenarioSimulationModel&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create this example test scenario file in VSCode using the Kogito test scenario modeler, follow these steps:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the empty <code>PersonDecisionsTest.scesim</code> file and in the <strong>Create Test Scenario</strong> window that appears, set the <strong>Source type</strong> to <strong>DMN</strong>, select the <code>PersonDecisions.dmn</code> DMN model from the drop-down options, and click <strong>Create</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-test-scenario-example-person-create.png" alt="Image of Create Test Scenario window">
</div>
<div class="title">Figure 18. Create test scenario definition</div>
</div>
<div class="paragraph">
<p>The test scenario modeler automatically generates a scenario template based on the available DMN data types and fields that you defined in the DMN model.</p>
</div>
<div class="paragraph">
<p>You can right-click the relevant header cells to insert or delete columns as needed to modify the table structure. You can also select the relevant header cells to modify or insert data objects from the <strong>Test Tools</strong> panel in the right toolbar.</p>
</div>
</li>
<li>
<p>For this example, modify the generated test scenario header cells and specified data objects as needed to create the following test scenario template. Use the <strong>Test Tools</strong> panel in the right toolbar to select and insert the data objects as needed. Many of the header cell values might already be defined for you.</p>
<div class="ulist">
<ul>
<li>
<p><strong>GIVEN</strong>: Verify that the first header cell (instance) is set to the <strong>Person</strong> data object and that the subheader cells (properties) are set to the <strong>Age</strong> and <strong>Name</strong> data objects. Delete any other columns under <strong>GIVEN</strong> that were automatically generated, if applicable.</p>
</li>
<li>
<p><strong>EXPECT</strong>: Verify that the first header cell (instance) is set to the <strong>isAdult</strong> data object and that the subheader cell (property) is set to the <strong>value</strong> data object. Delete any other columns under <strong>EXPECT</strong> that were automatically generated, if applicable.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-test-scenario-example-person-headers-create.png" alt="Image of test scenario template">
</div>
<div class="title">Figure 19. Define test scenario header cells</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In row 1, create a test scenario with the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Scenario description</strong>: <code>Is an adult</code></p>
</li>
<li>
<p><strong>GIVEN</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Person</strong> &#8594; <strong>Age</strong>: <code>20</code></p>
</li>
<li>
<p><strong>Person</strong> &#8594; <strong>Name</strong>: <code>John Quark</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>EXPECT</strong>: Set the following value:</p>
<div class="ulist">
<ul>
<li>
<p><strong>isAdult</strong> &#8594; <strong>value</strong>: <code>true</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example scenario tests whether the person John Quark with 20 years of age is correctly identified by the <code>isAdult</code> DMN decision as an adult (<code>true</code>), based on the decision logic that adults are more than 18 years old.</p>
</div>
</li>
<li>
<p>Right-click any cell in row 1, select <strong>Insert row below</strong>, and in row 2, create another test scenario with the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Scenario description</strong>: <code>Is underage</code></p>
</li>
<li>
<p><strong>GIVEN</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Person</strong> &#8594; <strong>Age</strong>: <code>15</code></p>
</li>
<li>
<p><strong>Person</strong> &#8594; <strong>Name</strong>: <code>Jenny Quark</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>EXPECT</strong>: Set the following value:</p>
<div class="ulist">
<ul>
<li>
<p><strong>isAdult</strong> &#8594; <strong>value</strong>: <code>false</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example scenario tests whether the person Jenny Quark with 15 years of age is correctly identified by the <code>isAdult</code> DMN decision as not an adult (<code>false</code>), based on the decision logic that adults are more than 18 years old.</p>
</div>
</li>
<li>
<p>Save the test scenario file.</p>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>After you define and save the test scenarios, in a command terminal, navigate to the project that contains your Kogito decision service and test scenarios and enter the following command to run the test scenarios:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Run the test scenarios</div>
<div class="content">
<pre class="highlight"><code>mvn clean test</code></pre>
</div>
</div>
<div class="paragraph">
<p>A summary of the test scenario execution appears in the command terminal, and detailed reports are generated in the <code>target/surefire-reports</code> folder of your Kogito project.</p>
</div>
<div class="paragraph">
<p>In the following example output, the test scenarios were executed successfully and encountered no errors:</p>
</div>
<div class="listingblock">
<div class="title">Terminal output for successful test scenarios</div>
<div class="content">
<pre class="highlight"><code>[INFO] --- maven-surefire-plugin:2.22.1:test (default-test) @ sample-kogito ---
[INFO]
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running testscenario.KogitoScenarioJunitActivatorTest
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.535 s - in testscenario.KogitoScenarioJunitActivatorTest
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 2, Failures: 0, Errors: 0, Skipped: 0
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  52.884 s
[INFO] Finished at: 2020-05-05T15:19:53-04:00
[INFO] ------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expected results defined in the test scenarios matched the actual results of the <code>isAdult</code> DMN decision instance in the <code>PersonDecisions.dmn</code> file. This match of expected and actual results for the decision instance means that the decision logic functions as intended.</p>
</div>
<div class="paragraph">
<p>In the following example output, the test scenarios were executed and the <code>Is underage</code> scenario encountered an error:</p>
</div>
<div class="listingblock">
<div class="title">Terminal output for a test scenario that encountered a decision error</div>
<div class="content">
<pre class="highlight"><code>[INFO] --- maven-surefire-plugin:2.22.1:test (default-test) @ sample-kogito ---
[INFO]
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running testscenario.KogitoScenarioJunitActivatorTest
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
./target/classes/PersonDecisions.dmn
./src/main/resources/PersonDecisions.dmn
[ERROR] Tests run: 2, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.534 s &lt;&lt;&lt; FAILURE! - in testscenario.KogitoScenarioJunitActivatorTest
[ERROR] #2: Is underage  Time elapsed: 0.06 s  &lt;&lt;&lt; ERROR!
org.drools.scenariosimulation.backend.runner.IndexedScenarioException: #2: Scenario 'Is underage' failed(/home/jsmith/sample-kogito/target/test-classes/PersonDecisionsTest.scesim)
Caused by: org.drools.scenariosimulation.backend.runner.ScenarioException: Scenario 'Is underage' failed

[INFO]
[INFO] Results:
[INFO]
[ERROR] Errors:
[ERROR]   KogitoScenarioJunitActivatorTest » IndexedScenario #2: Scenario 'Is underage' ...
[INFO]
[ERROR] Tests run: 2, Failures: 0, Errors: 1, Skipped: 0
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  6.521 s
[INFO] Finished at: 2020-05-05T15:26:10-04:00
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.22.1:test (default-test) on project sample-kogito: There are test failures.
[ERROR]
[ERROR] Please refer to /home/jsmith/sample-kogito/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expected results defined in the <code>Is underage</code> test scenario did not match the actual results of the <code>isAdult</code> DMN decision instance in the <code>PersonDecisions.dmn</code> file. This mismatch of expected and actual results for the decision instance means that either the test scenario identified a flaw in the decision logic or the test scenario is incorrectly defined. In this case, the <code>Is underage</code> test scenario was intentionally modified incorrectly with an age of <code>20</code> instead of an age of <code>18</code> or less. Reverting the age to <code>15</code> as shown in the previous example resolves the error.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-running-app_kogito-creating-running"><a class="anchor" href="#proc-kogito-running-app_kogito-creating-running"></a><a class="link" href="#proc-kogito-running-app_kogito-creating-running">1.10. Running a Kogito service</a></h3>
<div class="paragraph _abstract">
<p>After you design the business decisions and processes for your Kogito service, you can run your Quarkus or Spring Boot application in one of the following modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Development mode</strong>: For local testing. On Quarkus, development mode also offers live reload of your processes and decisions in your running applications for advanced debugging.</p>
</li>
<li>
<p><strong>JVM mode</strong>: For compatibility with a Java virtual machine (JVM).</p>
</li>
<li>
<p><strong>Native mode</strong>: (Quarkus only, requires GraalVM or Mandrel) For direct binary execution as native code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In a command terminal, navigate to the project that contains your Kogito service and enter one of the following commands, depending on your preferred run mode and application environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For development mode:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean compile spring-boot:run</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>For JVM mode:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/quarkus-app/quarkus-run.jar</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package
$ java -jar target/sample-kogito-1.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>For native mode (requires GraalVM):</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus only</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative
$ ./target/sample-kogito-1.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Alternatively, you can use a container builder image. You do not need to install GraalVM because a container containing GraalVM is pulled automatically. Note that the executable targets a Linux kernel by default. For example:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus only (GraalVM native build using container)</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative -Dquarkus.native.container-build</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To use Mandrel instead of GraalVM, run the following command:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus only (Mandrel native build using container)</div>
<div class="content">
<pre class="highlight"><code>$ mvn clean package -Dnative -Dquarkus.native.container-build -Dquarkus.native.builder-image=quay.io/quarkus/ubi-quarkus-mandrel:23.0.6-java17</code></pre>
</div>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For further information about building a native image, see <a href="https://quarkus.io/guides/building-native-image#container-runtime">Quarkus - Building a Native Executable</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="proc-kogito-interacting-app_kogito-creating-running"><a class="anchor" href="#proc-kogito-interacting-app_kogito-creating-running"></a><a class="link" href="#proc-kogito-interacting-app_kogito-creating-running">1.11. Interacting with a running Kogito service</a></h3>
<div class="paragraph _abstract">
<p>After your Kogito service is running, you can send REST API requests to interact with your application and execute your services according to how you set up the application.</p>
</div>
<div class="paragraph">
<p>This example tests the <code>/persons</code> REST API endpoint that is automatically generated based on the <code>PersonProcess.bpmn2</code> business process, according to the decisions in the <code>PersonDecisions.dmn</code> file (or the rules in the <code>PersonRules.drl</code> file if you used a DRL rule unit).</p>
</div>
<div class="paragraph">
<p>For this example, use a REST client, curl utility, or the Swagger UI configured for the application (such as http://localhost:8080/q/swagger-ui or http://localhost:8080/swagger-ui.html) to send API requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>URL</strong>: <code>http://localhost:8080/persons</code></p>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-swagger-example.png" alt="Image of Swagger UI for example application">
</div>
<div class="title">Figure 20. Swagger UI to interact with all application endpoints (such as http://localhost:8080/q/swagger-ui or http://localhost:8080/swagger-ui.html)</div>
</div>
<div class="paragraph">
<p>This example procedure uses curl commands for convenience.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In a command terminal window that is separate from your running application, navigate to the project that contains your Kogito service and use any of the following curl commands with JSON requests to interact with your running service:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
On Spring Boot, you might need to modify how your application exposes API endpoints in order for these example requests to function. For more information, see the <code>README</code> file included in the example Spring Boot project that you created for this tutorial.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Add an adult person:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"3af806dd-8819-4734-a934-728f4c819682","person":{"name":"John Quark","age":20,"adult":false},"isAdult":true}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add an underage person:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"Jenny Quark", "age": 15}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"8eef502b-012b-4628-acb7-73418a089c08","person":{"name":"Jenny Quark","age":15,"adult":false},"isAdult":false}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>View active process instances:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>[{"id":"8eef502b-012b-4628-acb7-73418a089c08","person":{"name":"Jenny Quark","age":15,"adult":false},"isAdult":false}]</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>View process instance details using the returned process UUID:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/persons/8eef502b-012b-4628-acb7-73418a089c08/tasks -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code>{"cdec4241-d676-47de-8c55-4ee4f9598bac":"ChildrenHandling"}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>View task instance details using the returned process and task UUIDs:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/persons/8eef502b-012b-4628-acb7-73418a089c08/ChildrenHandling/cdec4241-d676-47de-8c55-4ee4f9598bac -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"person":{"name":"Jenny Quark","age":15,"adult":false},"name":"ChildrenHandling","id":"cdec4241-d676-47de-8c55-4ee4f9598bac"}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Complete the evaluation using the returned UUIDs:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons/8eef502b-012b-4628-acb7-73418a089c08/ChildrenHandling/cdec4241-d676-47de-8c55-4ee4f9598bac -H 'content-type: application/json' -H 'accept: application/json' -d '{}'</code></pre>
</div>
</div>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="ref-kogito-glossary_kogito-creating-running"><a class="anchor" href="#ref-kogito-glossary_kogito-creating-running"></a><a class="link" href="#ref-kogito-glossary_kogito-creating-running">1.12. Kogito glossary of terms</a></h3>
<div class="paragraph _abstract">
<p>This glossary defines terms, concepts, or components that are referenced frequently in Kogito documentation or that have a unique meaning or function in Kogito.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">BPMN model</dt>
<dd>
<p>A definition of a business process workflow based on the <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation (BPMN) specification</a>. BPMN is a standard established by the Object Management Group (OMG) for describing and modeling business processes. BPMN defines an XML schema that enables BPMN models to be shared between BPMN-compliant platforms and across organizations so that business analysts and business process developers can collaborate in designing and implementing BPMN process services. The BPMN standard is similar to and can be used together with the Decision Model and Notation (DMN) standard for designing and modeling business decisions.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#chap-kogito-developing-process-services"><em>Developing process services with Kogito</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">business domain API</dt>
<dd>
<p>An API that your business develops and implements within business applications that contain Kogito services.</p>
</dd>
<dt class="hdlist1">business models</dt>
<dd>
<p>The collection of BPMN process models, DMN decision models, DRL rules, XLS decision tables, and any other assets that define the business logic for a Kogito service.</p>
</dd>
<dt class="hdlist1">CloudEvents format</dt>
<dd>
<p>A specification for describing event data in a common way. Kogito runtime events for messages, processes, tasks, and other application activities are published in <a href="https://cloudevents.io/">CloudEvents</a> format so that they can be consumed efficiently by other entities, such as the Kogito Data Index Service.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-kogito-runtime-events_kogito-configuring"><em>Kogito runtime events</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Kogito Data Index Service</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">decision table</dt>
<dd>
<p>A set of business rules defined in a tabular format. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-decision-tables_kogito-decision-tables"><em>Designing a decision service using spreadsheet decision tables</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">development mode</dt>
<dd>
<p>A project build option that provides a fast feedback loop from code changes to a running system using hot reload. Development mode also enables debugging tools such as Swagger in Kogito runtime services.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-kogito-running-app_kogito-creating-running"><em>Running a Kogito service</em></a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/maven-tooling"><em>Quarkus - Building applications with Maven</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DRL rule</dt>
<dd>
<p>A definition of a business rule in Drools Rule Language (DRL) format. DRL is a notation established by the <a href="https://www.drools.org/">Drools</a> open source business automation project for defining and describing business rules.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-drl_kogito-drl-rules"><em>Designing a decision service using DRL rules</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DRL rule unit</dt>
<dd>
<p>A module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-drl-rule-units_kogito-drl-rules"><em>Rule units in DRL</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">DMN model</dt>
<dd>
<p>A definition of a business decision flow based on the <a href="https://www.omg.org/spec/DMN">Decision Model and Notation (DMN) specification</a>. DMN is a standard established by the Object Management Group (OMG) for describing and modeling operational decisions. DMN defines an XML schema that enables DMN models to be shared between DMN-compliant platforms and across organizations so that business analysts and business rules developers can collaborate in designing and implementing DMN decision services. The DMN standard is similar to and can be used together with the Business Process Model and Notation (BPMN) standard for designing and modeling business processes.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-dmn_kogito-dmn-models"><em>Designing a decision service using DMN models</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">event listener</dt>
<dd>
<p>A procedure or function in a program that reacts to a specified event, such as a completed node in a process or an executed decision.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-event-listeners-registering_kogito-configuring"><em>Registering event listeners</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">intelligent application</dt>
<dd>
<p>An optimized, integrated solution that uses Kogito services to implement business-domain knowledge.</p>
</dd>
<dt class="hdlist1">Kogito Audit Investigation Console</dt>
<dd>
<p>A user interface for monitoring and investigating Decision Model and Notation (DMN) model executions in Kogito.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-audit-console_kogito-dmn-models"><em>Kogito Audit Investigation Console</em></a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Kogito Data Index Service</dt>
<dd>
<p>A dedicated service in Kogito that stores all Kogito events related to processes, tasks, and domain data. The Data Index Service uses Apache Kafka messaging to consume CloudEvents messages from Kogito services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan or MongoDB persistence store. The Data Index Service is at the core of all Kogito search, insight, and management capabilities.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Kogito Data Index Service</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito domain-specific service</dt>
<dd>
<p>A business automation service for your business domain that you create using Kogito. You define the logic of this service using BPMN process models, DMN decision models, or other business models, and any other supported runtime configurations. In Kogito documentation, the general term for <em>Kogito services</em> that you create refers to this type of service.</p>
</dd>
<dt class="hdlist1">Kogito Explainability Service</dt>
<dd>
<p>A dedicated service in Kogito that provides an explanation for the decisions made in Kogito services, in conjunction with the <em>Kogito Trusty Service</em>.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-trusty-service_kogito-configuring"><em>Kogito Trusty Service and Explainability Service</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito Jobs Service</dt>
<dd>
<p>A dedicated service in Kogito for scheduling BPMN process events that are configured to be executed at a specified time. These time-based events in a process model are known as <em>jobs</em>. The Jobs Service does not execute a job, but triggers a callback that might be an HTTP request on a given endpoint specified for the job request or any other configured callback. The Jobs Service receives requests for job scheduling and then sends a request at the time specified on the job request.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-jobs-service_kogito-configuring"><em>Kogito Jobs Service</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito Management Console</dt>
<dd>
<p>A user interface for viewing the state of all available Kogito services and managing process instances.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-management-console_kogito-developing-process-services"><em>Kogito Management Console</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito runtime event</dt>
<dd>
<p>A record of a significant change of state in the application domain at a point in time. Kogito emits runtime events as a result of successfully executed requests, or <em>units of work</em>, in a process instance or task instance in a process. Kogito can use these events to notify third parties about changes to the BPMN process instance and its data.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-kogito-runtime-events_kogito-configuring"><em>Kogito runtime events</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito runtime persistence</dt>
<dd>
<p>An optional capability for preserving Kogito process data in your services across application restarts. Kogito persistence is based on <a href="https://infinispan.org/">Infinispan</a> and enables you to configure key-value storage definitions to persist data, such as active process nodes and process instance variables. Alternatively, <a href="https://www.mongodb.com/">MongoDB</a> can be used.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-persistence_kogito-configuring"><em>Persistence in Kogito</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito supporting services</dt>
<dd>
<p>The collection of middleware infrastructure services and other dedicated services that help you build additional functionality in the Kogito domain-specific services that you develop. Key middleware infrastructure services in Kogito include Infinispan, MongoDB, or Kafka Streams persistence, and Apache Kafka reactive messaging. Dedicated services provided by Kogito include the Kogito Data Index Service, Jobs Service, Trusty Service, and Explainability Service.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Kogito Data Index Service</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-jobs-service_kogito-configuring"><em>Kogito Jobs Service</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-trusty-service_kogito-configuring"><em>Kogito Trusty Service and Explainability Service</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-infinispan-persistence-enabling_kogito-configuring"><em>Enabling Infinispan persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-mongodb-persistence-enabling_kogito-configuring"><em>Enabling MongoDB persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-kafka-streams-persistence-enabling_kogito-configuring"><em>Enabling Kafka Streams persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-messaging-enabling_kogito-configuring"><em>Enabling messaging for Kogito services</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito Task Console</dt>
<dd>
<p>A user interface for viewing and interacting with user tasks in Kogito process services.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-task-console_kogito-developing-process-services"><em>Kogito Task Console</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Kogito Trusty Service</dt>
<dd>
<p>A dedicated service in Kogito for storing all Kogito tracing events related to decisions made in Kogito services. The <em>Kogito Explainability Service</em> is typically used in conjunction with this service.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-trusty-service_kogito-configuring"><em>Kogito Trusty Service and Explainability Service</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">message event</dt>
<dd>
<p>A specified point in a business process where a defined message is used as the input (received) or output (sent) as a result of the process execution. For example, a message event might be an email sent to a specified user after a task is complete.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-kogito-runtime-events_kogito-configuring"><em>Kogito runtime events</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-messaging-enabling_kogito-configuring"><em>Enabling messaging for Kogito services</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">MicroProfile Reactive Messaging</dt>
<dd>
<p>A specification for sending and receiving messages within and between microservices using message brokers. Kogito supports <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> for messaging in Kogito services, such as message events used as either input or output of business process execution.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-messaging-enabling_kogito-configuring"><em>Enabling messaging for Kogito services</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">middleware infrastructure services</dt>
<dd>
<p>The collection of supplemental services in Kogito that provide capabilities such as persistence, messaging, and security. Key middleware infrastructure services in Kogito include Infinispan persistence and Apache Kafka reactive messaging.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-infinispan-persistence-enabling_kogito-configuring"><em>Enabling Infinispan persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-messaging-enabling_kogito-configuring"><em>Enabling messaging for Kogito services</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">process definition</dt>
<dd>
<p>A model that defines the components, workflow, and functionality for a business process, such as a BPMN model.</p>
</dd>
<dt class="hdlist1">process instance</dt>
<dd>
<p>An occurrence of a pending, running, or completed business process, based on the process definition.</p>
</dd>
<dt class="hdlist1">PROTO file (<code>.proto</code>)</dt>
<dd>
<p>A data library used for marshalling Java objects in protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) format. Kogito runtime persistence and communication with Infinispan or MongoDB are handled through a protobuf schema and generated marshallers.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-persistence_kogito-configuring"><em>Persistence in Kogito</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">task lifecycle</dt>
<dd>
<p>A mechanism that moves a user task or custom task (work item) across various phases, such as <strong>Active</strong> &#8594; <strong>Claim</strong> &#8594; <strong>Complete</strong>. Kogito provides standard lifecycle phases for user tasks and also supports custom lifecycles or lifecycle phases.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-task-lifecycle_kogito-developing-process-services"><em>Task lifecycle in Kogito processes</em></a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">unit of work</dt>
<dd>
<p>A component in Kogito that serves as the basis for Kogito runtime execution. Units of work capture all steps in a process and are used internally to move a process instance from one state to the next state. After all possible steps in a process are successfully executed, the final state is sent to the Kogito runtime as a runtime event. Kogito can then use these events to notify third parties about changes to the BPMN process instance and its data.</p>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-kogito-runtime-events_kogito-configuring"><em>Kogito runtime events</em></a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2 _additional-resources">
<h3 id="_additional_resources"><a class="anchor" href="#_additional_resources"></a><a class="link" href="#_additional_resources">1.13. Additional resources</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Developing decision services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="collection-kogito-developing-decision-services"><a class="anchor" href="#collection-kogito-developing-decision-services"></a><a class="link" href="#collection-kogito-developing-decision-services">2. Developing decision services with Kogito</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a developer of business decisions, you can use Kogito business automation to develop decision services using Decision Model and Notation (DMN) models, Drools Rule Language (DRL) rules, XLS or XLSX spreadsheet decision tables, or a combination of all three methods.</p>
</div>
<div class="sect2">
<h3 id="chap-kogito-using-dmn-models"><a class="anchor" href="#chap-kogito-using-dmn-models"></a><a class="link" href="#chap-kogito-using-dmn-models">2.1. Using DMN models in Kogito services</a></h3>
<div class="paragraph _abstract">
<p>As a developer of business decisions, you can use Decision Model and Notation (DMN) to model a decision service graphically. The decision requirements of a DMN decision model are determined by a decision requirements graph (DRG) that is depicted in one or more decision requirements diagrams (DRDs). A DRD can represent part or all of the overall DRG for the DMN model. DRDs trace business decisions from start to finish, with each decision node using logic defined in DMN boxed expressions such as decision tables.</p>
</div>
<div class="paragraph">
<p>Kogito provides runtime support for DMN 1.1, 1.2, 1.3, 1.4 and 1.5 models at conformance level 3 and design support for DMN 1.2 (Classic DMN Editor) and 1.5 models (New DMN Editor) at conformance level 3.</p>
</div>
<div class="paragraph">
<p>For more information about DMN, see the Object Management Group (OMG) <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect3">
<h4 id="ref-decision-authoring-assets_kogito-dmn-models"><a class="anchor" href="#ref-decision-authoring-assets_kogito-dmn-models"></a><a class="link" href="#ref-decision-authoring-assets_kogito-dmn-models">2.1.1. Decision-authoring assets in Kogito</a></h4>
<div class="paragraph _abstract">
<p>Kogito supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.</p>
</div>
<div class="paragraph">
<p>The following table highlights the main decision-authoring assets supported in Kogito projects to help you decide or confirm the best method for defining decisions in your decision service.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Decision-authoring assets supported in Kogito</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Asset</th>
<th class="tableblock halign-left valign-top">Highlights</th>
<th class="tableblock halign-left valign-top">Authoring tools</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision Model and Notation (DMN) models</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are decision models based on a notation standard defined by the Object Management Group (OMG)</p>
</li>
<li>
<p>Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows</p>
</li>
<li>
<p>Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms</p>
</li>
<li>
<p>Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions</p>
</li>
<li>
<p>Can be integrated efficiently with Business Process Model and Notation (BPMN) process models</p>
</li>
<li>
<p>Are optimal for creating comprehensive, illustrative, and stable decision flows</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kogito DMN modeler in VSCode or other DMN-compliant editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-dmn_kogito-dmn-models">Decision Model and Notation (DMN)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DRL rules</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are individual rules that you define directly in <code>.drl</code> text files</p>
</li>
<li>
<p>Provide the most flexibility for defining rules and other technicalities of rule behavior</p>
</li>
<li>
<p>Are optimal for creating rules that require advanced DRL options, such as rule units</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any integrated development environment (IDE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-drl_kogito-drl-rules">Drools Rule Language (DRL)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet decision tables</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are tabular sets of rules that you define in <code>.xls</code> or <code>.xlsx</code> spreadsheet files</p>
</li>
<li>
<p>Support template keys and values for creating rule templates</p>
</li>
<li>
<p>Are optimal for business environments that already rely on decision tables for rules</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly when used in Kogito</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-decision-tables_kogito-decision-tables">Spreadsheet decision tables</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="con-dmn_kogito-dmn-models"><a class="anchor" href="#con-dmn_kogito-dmn-models"></a><a class="link" href="#con-dmn_kogito-dmn-models">2.1.2. Decision Model and Notation (DMN)</a></h4>
<div class="paragraph _abstract">
<p>Decision Model and Notation (DMN) is a standard established by the <a href="https://www.omg.org/">Object Management Group (OMG)</a> for describing and modeling operational decisions. DMN defines an XML schema that enables DMN models to be shared between DMN-compliant platforms and across organizations so that business analysts and business rules developers can collaborate in designing and implementing DMN decision services. The DMN standard is similar to and can be used together with the Business Process Model and Notation (BPMN) standard for designing and modeling business processes.</p>
</div>
<div class="paragraph">
<p>For more information about the background and applications of DMN, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect4">
<h5 id="con-dmn-conformance-levels_kogito-dmn-models"><a class="anchor" href="#con-dmn-conformance-levels_kogito-dmn-models"></a><a class="link" href="#con-dmn-conformance-levels_kogito-dmn-models">2.1.2.1. DMN conformance levels</a></h5>
<div class="paragraph _abstract">
<p>The DMN specification defines three incremental levels of conformance in a software implementation. A product that claims compliance at one level must also be compliant with any preceding levels. For example, a conformance level 3 implementation must also include the supported components in conformance levels 1 and 2. For the formal definitions of each conformance level, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="paragraph">
<p>The following list summarizes the three DMN conformance levels:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Conformance level 1</dt>
<dd>
<p>A DMN conformance level 1 implementation supports decision requirement diagrams (DRDs), decision logic, and decision tables, but decision models are not executable. Any language can be used to define the expressions, including natural, unstructured languages.</p>
</dd>
<dt class="hdlist1">Conformance level 2</dt>
<dd>
<p>A DMN conformance level 2 implementation includes the requirements in conformance level 1, and supports Simplified Friendly Enough Expression Language (S-FEEL) expressions and fully executable decision models.</p>
</dd>
<dt class="hdlist1">Conformance level 3</dt>
<dd>
<p>A DMN conformance level 3 implementation includes the requirements in conformance levels 1 and 2, and supports Friendly Enough Expression Language (FEEL) expressions, the full set of boxed expressions, and fully executable decision models.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Kogito provides runtime support for DMN 1.1, 1.2, 1.3, 1.4 and 1.5 models at conformance level 3 and design support for DMN 1.2 (Classic DMN Editor) and 1.5 models (New DMN Editor) at conformance level 3.</p>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-drd-components-ref-kogito-dmn-models"><a class="anchor" href="#ref-dmn-drd-components-ref-kogito-dmn-models"></a><a class="link" href="#ref-dmn-drd-components-ref-kogito-dmn-models">2.1.2.2. DMN decision requirements diagram (DRD) components</a></h5>
<div class="paragraph _abstract">
<p>A decision requirements diagram (DRD) is a visual representation of your DMN model. A DRD can represent part or all of the overall decision requirements graph (DRG) for the DMN model. DRDs trace business decisions using decision nodes, business knowledge models, sources of business knowledge, input data, and decision services.</p>
</div>
<div class="paragraph">
<p>The following table summarizes the components in a DRD:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. DRD components</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">Component</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Notation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock">Elements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node where one or more input elements determine an output based on defined decision logic.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-node.png" alt="dmn decision node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable function with one or more decision elements. Decisions that have the same logic but depend on different sub-input data or sub-decisions use business knowledge models to determine which procedure to follow.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-node.png" alt="dmn bkm node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">External authorities, documents, committees, or policies that regulate a decision or business knowledge model. Knowledge sources are references to real-world factors rather than executable business rules.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-knowledge-source-node.png" alt="dmn knowledge source node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information used in a decision node or a business knowledge model. Input data usually includes business-level concepts or objects relevant to the business, such as loan applicant data used in a lending strategy.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-input-data-node.png" alt="dmn input data node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision service</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Top-level decision containing a set of reusable decisions published as a service for invocation. A decision service can be invoked from an external application or a BPMN business process.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-service-node.png" alt="dmn decision service node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Requirement connectors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from an input data node or decision node to another decision node that requires the information.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-info-connector.png" alt="dmn info connector">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from a business knowledge model to a decision node or to another business knowledge model that invokes the decision logic.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-knowledge-connector.png" alt="dmn knowledge connector">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authority requirement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from an input data node or a decision node to a dependent knowledge source or from a knowledge source to a decision node, business knowledge model, or another knowledge source.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-authority-connector.png" alt="dmn authority connector">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Artifacts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Text annotation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explanatory note associated with an input data node, decision node, business knowledge model, or knowledge source.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-annotation-node.png" alt="dmn annotation node">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Association</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection from an input data node, decision node, business knowledge model, or knowledge source to a text annotation.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-association-connector.png" alt="dmn association connector">
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following table summarizes the permitted connectors between DRD elements:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. DRD connector rules</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Starts from</th>
<th class="tableblock halign-left valign-top">Connects to</th>
<th class="tableblock halign-left valign-top">Connection type</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-to-decision.png" alt="dmn decision to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Knowledge requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-to-decision.png" alt="dmn bkm to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-to-bkm.png" alt="dmn bkm to bkm">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><div class="content"><div class="paragraph">
<p>Decision service</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Knowledge requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-service-to-decision.png" alt="dmn decision service to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-service-to-bkm.png" alt="dmn decision service to bkm">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Input data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Information requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-input-to-decision.png" alt="dmn input to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authority requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-input-to-knowledge-source.png" alt="dmn input to knowledge source">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Authority requirement</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-knowledge-source-to-decision.png" alt="dmn knowledge source to decision">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-knowledge-source-to-bkm.png" alt="dmn knowledge source to bkm">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-knowledge-source-to-knowledge-source.png" alt="dmn knowledge source to knowledge source">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision</p></td>
<td class="tableblock halign-left valign-top" rowspan="4"><p class="tableblock">Text annotation</p></td>
<td class="tableblock halign-left valign-top" rowspan="4"><p class="tableblock">Association</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-to-annotation.png" alt="dmn decision to annotation">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business knowledge model</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-to-annotation.png" alt="dmn bkm to annotation">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Knowledge source</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-knowledge-source-to-annotation.png" alt="dmn knowledge source to annotation">
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input data</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-input-to-annotation.png" alt="dmn input to annotation">
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following example DRD illustrates some of these DMN components in practice:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-example-drd.png" alt="dmn example drd">
</div>
<div class="title">Figure 21. Example DRD: Loan prequalification</div>
</div>
<div class="paragraph">
<p>The following example DRD illustrates DMN components that are part of a reusable decision service:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-example-drd3.png" alt="dmn example drd3" width="90%">
</div>
<div class="title">Figure 22. Example DRD: Phone call handling as a decision service</div>
</div>
<div class="paragraph">
<p>In a DMN decision service node, the decision nodes in the bottom segment incorporate input data from outside of the decision service to arrive at a final decision in the top segment of the decision service node. The resulting top-level decisions from the decision service are then implemented in any subsequent decisions or business knowledge requirements of the DMN model. You can reuse DMN decision services in other DMN models to apply the same decision logic with different input data and different outgoing connections.</p>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-feel_kogito-dmn-models"><a class="anchor" href="#con-dmn-feel_kogito-dmn-models"></a><a class="link" href="#con-dmn-feel_kogito-dmn-models">2.1.2.3. Rule expressions in FEEL</a></h5>
<div class="paragraph _abstract">
<p>Friendly Enough Expression Language (FEEL) is an expression language defined by the Object Management Group (OMG) DMN specification. FEEL expressions define the logic of a decision in a DMN model. FEEL is designed to facilitate both decision modeling and execution by assigning semantics to the decision model constructs. FEEL expressions in decision requirements diagrams (DRDs) occupy table cells in boxed expressions for decision nodes and business knowledge models.</p>
</div>
<div class="paragraph">
<p>For more information about FEEL in DMN, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect5">
<h6 id="ref-dmn-feel-data-types_kogito-dmn-models"><a class="anchor" href="#ref-dmn-feel-data-types_kogito-dmn-models"></a><a class="link" href="#ref-dmn-feel-data-types_kogito-dmn-models">Data types in FEEL</a></h6>
<div class="paragraph _abstract">
<p>Friendly Enough Expression Language (FEEL) supports the following data types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Numbers</p>
</li>
<li>
<p>Strings</p>
</li>
<li>
<p>Boolean values</p>
</li>
<li>
<p>Dates</p>
</li>
<li>
<p>Time</p>
</li>
<li>
<p>Date and time</p>
</li>
<li>
<p>Days and time duration</p>
</li>
<li>
<p>Years and months duration</p>
</li>
<li>
<p>Functions</p>
</li>
<li>
<p>Contexts</p>
</li>
<li>
<p>Ranges (or intervals)</p>
</li>
<li>
<p>Lists</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The DMN specification currently does not provide an explicit way of declaring a variable as a <code>function</code>, <code>context</code>, <code>range</code>, or <code>list</code>, but Kogito extends the DMN built-in types to support variables of these types.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following list describes each data type:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Numbers</dt>
<dd>
<p>Numbers in FEEL are based on the <a href="http://ieeexplore.ieee.org/document/4610935/">IEEE 754-2008</a> Decimal 128 format, with 34 digits of precision. Internally, numbers are represented in Java as <a href="https://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html"><code>BigDecimals</code></a> with <code>MathContext DECIMAL128</code>. FEEL supports only one number data type, so the same type is used to represent both integers and floating
point numbers.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>FEEL numbers use a dot (<code>.</code>) as a decimal separator. FEEL does not support <code>-INF</code>, <code>+INF</code>, or <code>NaN</code>. FEEL uses
<code>null</code> to represent invalid numbers.</p>
</div>
<div class="paragraph">
<p>Kogito extends the DMN specification and supports additional number notations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Scientific:</strong> You can use scientific notation with the suffix <code>e&lt;exp&gt;</code> or <code>E&lt;exp&gt;</code>. For example, <code>1.2e3</code> is the same as writing the expression <code>1.2*10**3</code>, but is a literal instead of an expression.</p>
</li>
<li>
<p><strong>Hexadecimal:</strong> You can use hexadecimal numbers with the prefix <code>0x</code>. For example, <code>0xff</code> is the same as the decimal number <code>255</code>. Both uppercase and lowercase letters are supported. For example, <code>0XFF</code> is the same as <code>0xff</code>.</p>
</li>
<li>
<p><strong>Type suffixes:</strong> You can use the type suffixes <code>f</code>, <code>F</code>, <code>d</code>, <code>D</code>, <code>l</code>, and <code>L</code>. These suffixes are ignored.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Strings</dt>
<dd>
<p>Strings in FEEL are any sequence of characters delimited by double quotation marks.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre>"John Doe"</pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Boolean values</dt>
<dd>
<p>FEEL uses three-valued boolean logic, so a boolean logic expression may have values <code>true</code>, <code>false</code>, or <code>null</code>.</p>
</dd>
<dt class="hdlist1">Dates</dt>
<dd>
<p>Date literals are not supported in FEEL, but you can use the built-in <code>date()</code> function to construct date values. Date strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#date">XML Schema Part 2: Datatypes</a> document. The format is <code>"YYYY-MM-DD"</code> where <code>YYYY</code> is the year with four digits, <code>MM</code> is the number of the month with two digits, and <code>DD</code> is the number of the day.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>date( "2017-06-23" )</pre>
</div>
</div>
<div class="paragraph">
<p>Date objects have time equal to <code>"00:00:00"</code>, which is midnight. The dates are considered to be local, without a timezone.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Time</dt>
<dd>
<p>Time literals are not supported in FEEL, but you can use the built-in <code>time()</code> function to construct time values. Time strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#time">XML Schema Part 2: Datatypes</a> document. The format is <code>"hh:mm:ss[.uuu][(-)hh:mm]"` where `hh` is the hour of the day (from `00` to `23`), `mm` is the minutes in the hour, and `ss` is the number of seconds in the minute. Optionally, the string may define the number of milliseconds (`uuu`) within the second and contain a positive (`</code>) or negative (<code>-</code>) offset from UTC time to define its timezone. Instead of using an offset, you can use the letter <code>z</code> to represent the UTC time, which is the same as an offset of <code>-00:00</code>. If no offset is defined, the time is considered to be local.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>time( "04:25:12" )
time( "14:10:00+02:00" )
time( "22:35:40.345-05:00" )
time( "15:00:30z" )</pre>
</div>
</div>
<div class="paragraph">
<p>Time values that define an offset or a timezone cannot be compared to local times that do not define an offset or a timezone.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Date and time</dt>
<dd>
<p>Date and time literals are not supported in FEEL, but you can use the built-in <code>date and time()</code> function to construct date and time values. Date and time strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#dateTime">XML Schema Part 2: Datatypes</a> document. The format is <code>"&lt;date&gt;T&lt;time&gt;"</code>, where <code>&lt;date&gt;</code> and <code>&lt;time&gt;</code> follow the prescribed XML schema formatting, conjoined by <code>T</code>.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>date and time( "2017-10-22T23:59:00" )
date and time( "2017-06-13T14:10:00+02:00" )
date and time( "2017-02-05T22:35:40.345-05:00" )
date and time( "2017-06-13T15:00:30z" )</pre>
</div>
</div>
<div class="paragraph">
<p>Date and time values that define an offset or a timezone cannot be compared to local date and time values
that do not define an offset or a timezone.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code>dateTime</code> as a synonym of <code>date and time</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Days and time duration</dt>
<dd>
<p>Days and time duration literals are not supported in FEEL, but you can use the built-in <code>duration()</code> function to construct days and time duration values. Days and time duration strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#duration">XML Schema Part 2: Datatypes</a> document, but are restricted to only days, hours, minutes and seconds. Months and years are not supported.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>duration( "P1DT23H12M30S" )
duration( "P23D" )
duration( "PT12H" )
duration( "PT35M" )</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code>dayTimeDuration</code> as a synonym of <code>days and time duration</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Years and months duration</dt>
<dd>
<p>Years and months duration literals are not supported in FEEL, but you can use the built-in <code>duration()</code> function to construct days and time duration values. Years and months duration strings in FEEL follow the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#duration">XML Schema Part 2: Datatypes</a> document, but are restricted to only years and months. Days, hours, minutes, or seconds are not supported.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>duration( "P3Y5M" )
duration( "P2Y" )
duration( "P10M" )
duration( "P25M" )</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If your implementation of the DMN specification does not support spaces in the XML schema, use the keyword <code>yearMonthDuration</code> as a synonym of <code>years and months duration</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Functions</dt>
<dd>
<p>FEEL has <code>function</code> literals (or anonymous functions) that you can use to create functions. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>function</code>, but Kogito extends the DMN built-in types to support variables of functions.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>function(a, b) a + b</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the FEEL expression creates a function that adds the parameters <code>a</code> and <code>b</code> and returns the result.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Contexts</dt>
<dd>
<p>FEEL has <code>context</code> literals that you can use to create contexts. A <code>context</code> in FEEL is a list of key and value pairs, similar to maps in languages like Java. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>context</code>, but Kogito extends the DMN built-in types to support variables of contexts.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{ x : 5, y : 3 }</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the expression creates a context with two entries, <code>x</code> and <code>y</code>, representing a coordinate in a chart.</p>
</div>
<div class="paragraph">
<p>In DMN 1.2, another way to create contexts is to create an item definition that contains the list of keys as attributes, and then declare the variable as having that item definition type.</p>
</div>
<div class="paragraph">
<p>The Kogito DMN API supports DMN <code>ItemDefinition</code> structural types in a <code>DMNContext</code> represented in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User-defined Java type: Must be a valid JavaBeans object defining properties and getters for each of the components in the DMN <code>ItemDefinition</code>. If necessary, you can also use the <code>@FEELProperty</code> annotation for those getters representing a component name which would result in an invalid Java identifier.</p>
</li>
<li>
<p><code>java.util.Map</code> interface: The map needs to define the appropriate entries, with the keys corresponding to the component name in the DMN <code>ItemDefinition</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Ranges (or intervals)</dt>
<dd>
<p>FEEL has <code>range</code> literals that you can use to create ranges or intervals. A <code>range</code> in FEEL is a value that defines a lower and an upper bound, where either can be open or closed. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>range</code>, but Kogito extends the DMN built-in types to support variables of ranges.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The syntax of a range is defined in the following formats:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>range          := interval_start endpoint '..' endpoint interval_end
interval_start := open_start | closed_start
open_start     := '(' | ']'
closed_start   := '['
interval_end   := open_end | closed_end
open_end       := ')' | '['
closed_end     := ']'
endpoint       := expression</pre>
</div>
</div>
<div class="paragraph">
<p>The expression for the endpoint must return a comparable value, and the lower bound endpoint must be lower than the upper bound endpoint.</p>
</div>
<div class="paragraph">
<p>For example, the following literal expression defines an interval between <code>1</code> and <code>10</code>, including the boundaries (a closed interval on both endpoints):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ 1 .. 10 ]</pre>
</div>
</div>
<div class="paragraph">
<p>The following literal expression defines an interval between 1 hour and 12 hours, including the lower boundary (a closed interval), but excluding the upper boundary (an open interval):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ duration("PT1H") .. duration("PT12H") )</pre>
</div>
</div>
<div class="paragraph">
<p>You can use ranges in decision tables to test for ranges of values, or use ranges in simple literal expressions. For example, the following literal expression returns <code>true</code> if the value of a variable <code>x</code> is between <code>0</code> and <code>100</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x in [ 1 .. 100 ]</pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Lists</dt>
<dd>
<p>FEEL has <code>list</code> literals that you can use to create lists of items. A <code>list</code> in FEEL is represented by a comma-separated list of values enclosed in square brackets. The DMN specification currently does not provide an explicit way of declaring a variable as a <code>list</code>, but Kogito extends the DMN built-in types to support variables of lists.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[ 2, 3, 4, 5 ]</pre>
</div>
</div>
<div class="paragraph">
<p>All lists in FEEL contain elements of the same type and are immutable. Elements in a list can be accessed by index, where the first element is <code>1</code>. Negative indexes can access elements starting from the end of the list so that <code>-1</code> is the last element.</p>
</div>
<div class="paragraph">
<p>For example, the following expression returns the second element of a list <code>x</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x[2]</pre>
</div>
</div>
<div class="paragraph">
<p>The following expression returns the second-to-last element of a list <code>x</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>x[-2]</pre>
</div>
</div>
<div class="paragraph">
<p>Elements in a list can also be counted by the function <code>count</code>, which uses the list of elements as the parameter.</p>
</div>
<div class="paragraph">
<p>For example, the following expression returns <code>4</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>count([ 2, 3, 4, 5 ])</pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="ref-dmn-feel-builtin-functions_kogito-dmn-models"><a class="anchor" href="#ref-dmn-feel-builtin-functions_kogito-dmn-models"></a><a class="link" href="#ref-dmn-feel-builtin-functions_kogito-dmn-models">Built-in functions in FEEL</a></h6>
<div class="paragraph _abstract">
<p>To promote interoperability with other platforms and systems, Friendly Enough Expression Language (FEEL) includes a library of built-in functions. The built-in FEEL functions are implemented in the Drools Decision Model and Notation (DMN) engine so that you can use the functions in your DMN decision services.</p>
</div>
<div class="paragraph">
<p>The following sections describe each built-in FEEL function, listed in the format <code><em>NAME</em>( <em>PARAMETERS</em> )</code>. For more information about FEEL functions in DMN, see the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect6">
<h7 id="_conversion_functions"><a class="anchor" href="#_conversion_functions"></a><a class="link" href="#_conversion_functions">Conversion functions</a></h7>
<div class="paragraph">
<p>The following functions support conversion between values of different types. Some of these functions use specific string formats, such as the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>date string</code>: Follows the format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#date">XML Schema Part 2: Datatypes</a> document, such as <code>2020-06-01</code></p>
</li>
<li>
<p><code>time string</code>: Follows one of the following formats:</p>
<div class="ulist">
<ul>
<li>
<p>Format defined in the <a href="https://www.w3.org/TR/xmlschema-2/#time">XML Schema Part 2: Datatypes</a> document, such as <code>23:59:00z</code></p>
</li>
<li>
<p>Format for a local time defined by ISO 8601 followed by <code>@</code> and an IANA Timezone, such as <code>00:01:00@Etc/UTC</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>date time string</code>: Follows the format of a <code>date string</code> followed by <code>T</code> and a <code>time string</code>, such as <code>2012-12-25T11:00:00Z</code></p>
</li>
<li>
<p><code>duration string</code>: Follows the format of <code>days and time duration</code> and <code>years and months duration</code> defined in the <a href="https://www.w3.org/TR/xpath-datamodel/#types">XQuery 1.0 and XPath 2.0 Data Model</a>, such as <code>P1Y2M</code></p>
</li>
</ul>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date( from ) - <em>using date</em></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>date</code> value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date( "2012-12-25" ) - date( "2012-12-24" ) = duration( "P1D" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date( from ) - <em>using date and time</em></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>date</code> value and sets time components to null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date(date and time( "2012-12-25T11:00:00Z" )) = date( "2012-12-25" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date( year, month, day )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>date</code> from the specified year, month, and day values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>year</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>month</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>day</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date( 2012, 12, 25 ) = date( "2012-12-25" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date and time( date, time )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>date and time</code> from the specified date and ignores any time components and the specified time.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date and time ( "2012-12-24T23:59:00" ) = date and time(date( "2012-12-24" ), time( "23:59:00" ))</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date and time( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>date and time</code> from the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date time string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date and time( "2012-12-24T23:59:00" ) + duration( "PT1M" ) = date and time( "2012-12-25T00:00:00" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>time</code> from the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">time( "23:59:00z" ) + duration( "PT2M" ) = time( "00:01:00@Etc/UTC" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>time</code> from the specified parameter and ignores any date components.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>time</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">time(date and time( "2012-12-25T11:00:00Z" )) = time( "11:00:00Z" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">time( hour, minute, second, offset? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a <code>time</code> from the specified hour, minute, and second component values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hour</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>minute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>second</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offset</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>days and time duration</code> or null</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">time( "23:59:00z" ) = time(23, 59, 0, duration( "PT0H" ))</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">number( from, grouping separator, decimal separator )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>number</code> using the specified separators.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code> representing a valid number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grouping separator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space ( ), comma (<code>,</code>), period (<code>.</code>), or null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>decimal separator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Same types as <code>grouping separator</code>, but the values cannot match</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">number( "1 000,0", " ", "," ) = number( "1,000.0", ",", "." )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">string( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Provides a string representation of the specified parameter.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-null value</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">string( 1.1 ) = "1.1"
string( null ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">duration( from )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Converts <code>from</code> to a <code>days and time duration</code> value or <code>years and months duration</code> value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">date and time( "2012-12-24T23:59:00" ) - date and time( "2012-12-22T03:45:00" ) = duration( "P2DT20H14M" )
duration( "P2Y2M" ) = duration( "P26M" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">years and months duration( from, to )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the <code>years and months duration</code> between the two specified parameters.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>from</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>to</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">years and months duration( date( "2011-12-22" ), date( "2013-08-24" ) ) = duration( "P1Y8M" )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_boolean_functions"><a class="anchor" href="#_boolean_functions"></a><a class="link" href="#_boolean_functions">Boolean functions</a></h7>
<div class="paragraph">
<p>The following functions support Boolean operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">not( negand )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Performs the logical negation of the <code>negand</code> operand.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>negand</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">not( true ) = false
not( null ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_string_functions"><a class="anchor" href="#_string_functions"></a><a class="link" href="#_string_functions">String functions</a></h7>
<div class="paragraph">
<p>The following functions support string operations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In FEEL, Unicode characters are counted based on their code points.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">substring( string, start position, length? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the substring from the start position for the specified length. The first character is at position value <code>1</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>start position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>length</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">substring( "testing",3 ) = "sting"
substring( "testing",3,3 ) = "sti"
substring( "testing", -2, 1 ) = "n"
substring( "\U01F40Eab", 2 ) = "ab"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In FEEL, the string literal <code>"\U01F40Eab"</code> is the <code>🐎ab</code> string (horse symbol followed by <code>a</code> and <code>b</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">string length( string )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the length of the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">string length( "tes" ) = 3
string length( "\U01F40Eab" ) = 3</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">upper case( string )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces an uppercase version of the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">upper case( "aBc4" ) = "ABC4"</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">lower case( string )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Produces a lowercase version of the specified string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">lower case( "aBc4" ) = "abc4"</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">substring before( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the substring before the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">substring before( "testing", "ing" ) = "test"
substring before( "testing", "xyz" ) = ""</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">substring after( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the substring after the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">substring after( "testing", "test" ) = "ing"
substring after( "", "a" ) = ""</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">replace( input, pattern, replacement, flags? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the regular expression replacement.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>input</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>replacement</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This function uses regular expression parameters as defined in <a href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">replace( "banana", "a", "o" ) = "bonono"
replace( "abcd", "(ab)|(a)", "[1=$1][2=$2]" ) = "[1=ab][2=]cd"</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">contains( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the string contains the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">contains( "testing", "to" ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">starts with( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the string starts with the match</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">starts with( "testing", "te" ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">ends with( string, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the string ends with the match.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">ends with( "testing", "g" ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">matches( input, pattern, flags? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the input matches the regular expression.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>input</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flags</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This function uses regular expression parameters as defined in <a href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">matches( "teeesting", "^te*sting" ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">split( string, delimiter )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of the original string and splits it at the delimiter regular expression pattern.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delimiter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code> for a regular expression pattern</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This function uses regular expression parameters as defined in <a href="https://www.w3.org/TR/xquery-operators/#regex-syntax">XQuery 1.0 and XPath 2.0 Functions and Operators</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">split( "John Doe", "\\s" ) = ["John", "Doe"]
split( "a;b;c;;", ";" ) = ["a","b","c","",""]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">string join( list, delimiter )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a string which is composed by joining all the string elements from the list parameter, separated by the delimiter.
The <code>delimiter</code> can be an empty string.
Null elements in the list parameter are ignored.
If <code>list</code> is empty, the result is the empty string.
If <code>delimiter</code> is null, the string elements are joined without a separator.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delimiter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">string join(["a","b","c"], "_and_") = "a_and_b_and_c"
string join(["a","b","c"], "") = "abc"
string join(["a","b","c"], null) = "abc"
string join(["a"], "X") = "a"
string join(["a",null,"c"], "X") = "aXc"
string join([], "X") = ""</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">string join( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a string which is composed by joining all the string elements from the list parameter.
Null elements in the <code>list</code> parameter are ignored.
If <code>list</code> is empty, the result is the empty string.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">string join(["a","b","c"]) = "abc"
string join(["a",null,"c"]) = "ac"
string join([]) = ""</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_list_functions"><a class="anchor" href="#_list_functions"></a><a class="link" href="#_list_functions">List functions</a></h7>
<div class="paragraph">
<p>The following functions support list operations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In FEEL, the index of the first element in a list is <code>1</code>. The index of the last element in a list can be identified as <code>-1</code>.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">list contains( list, element )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the list contains the element.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>element</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type, including null</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">list contains( [1,2,3], 2 ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">count( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Counts the elements in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">count( [1,2,3] ) = 3
count( [] ) = 0
count( [1,[2,3]] ) = 2</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">min( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the minimum comparable element in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>min( e1, e2, ..., eN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">min( [1,2,3] ) = 1
min( 1 ) = 1
min( [1] ) = 1</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">max( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the maximum comparable element in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>max( e1, e2, ..., eN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">max( 1,2,3 ) = 3
max( [] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">sum( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the sum of the numbers in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>sum( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sum( [1,2,3] ) = 6
sum( 1,2,3 ) = 6
sum( 1 ) = 1
sum( [] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">mean( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Calculates the average (arithmetic mean) of the elements in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>mean( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">mean( [1,2,3] ) = 2
mean( 1,2,3 ) = 2
mean( 1 ) = 1
mean( [] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">all( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if all elements in the list are true.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>boolean</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>all( b1, b2, ..., bN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">all( [false,null,true] ) = false
all( true ) = true
all( [true] ) = true
all( [] ) = true
all( 0 ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">any( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if any element in the list is true.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>boolean</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>any( b1, b2, ..., bN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">any( [false,null,true] ) = true
any( false ) = false
any( [] ) = false
any( 0 ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">sublist( list, start position, length? )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the sublist from the start position, limited to the length elements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>start position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>length</code> (Optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sublist( [4,5,6], 1, 2 ) = [4,5]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">append( list, item )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list that is appended to the item or items.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>item</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">append( [1], 2, 3 ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">concatenate( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list that is the result of the concatenated lists.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">concatenate( [1,2],[3] ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">insert before( list, position, newItem )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list with the <code>newItem</code> inserted at the specified position.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>newItem</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">insert before( [1,3],1,2 ) = [2,1,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">remove( list, position )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Creates a list with the removed element excluded from the specified position.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 49. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">remove( [1,2,3], 2 ) = [1,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">reverse( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a reversed list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 50. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">reverse( [1,2,3] ) = [3,2,1]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">index of( list, match )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns indexes matching the element.</p>
</div>
<div class="ulist">
<div class="title">Parameters</div>
<ul>
<li>
<p><code>list</code> of type <code>list</code></p>
</li>
<li>
<p><code>match</code> of any type</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 51. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">index of( [1,2,3,2],2 ) = [2,4]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">union( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of all the elements from multiple lists and excludes duplicates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 52. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">union( [1,2],[2,3] ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">distinct values( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of elements from a single list and excludes duplicates.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 53. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">distinct values( [1,2,3,2,1] ) = [1,2,3]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">flatten( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a flattened list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 54. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">flatten( [[1,2],[[3]], 4] ) = [1,2,3,4]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">product( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the product of the numbers in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 55. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>product( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">product( [2, 3, 4] ) = 24
product( [] ) = null
product( 2, 3, 4 ) = 24</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">median( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the median of the numbers in the list. If the number of elements is odd, the result is the middle element. If the number of elements is even, the result is the average of the two middle elements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 56. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>median( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">median( 8, 2, 5, 3, 4 ) = 4
median( [6, 1, 2, 3] ) = 2.5
median( [ ] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">stddev( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the standard deviation of the numbers in the list.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 57. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>stddev( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">stddev( 2, 4, 7, 5 ) = 2.081665999466132735282297706979931
stddev( [47] ) = null
stddev( 47 ) = null
stddev( [ ] ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">mode( list )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the mode of the numbers in the list. If multiple elements are returned, the numbers are sorted in ascending order.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 58. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>number</code> elements</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>mode( n1, n2, ..., nN )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">mode( 6, 3, 9, 6, 6 ) = [6]
mode( [6, 1, 9, 6, 1] ) = [1, 6]
mode( [ ] ) = [ ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_numeric_functions"><a class="anchor" href="#_numeric_functions"></a><a class="link" href="#_numeric_functions">Numeric functions</a></h7>
<div class="paragraph">
<p>The following functions support number operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">decimal( n, scale )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a number with the specified scale.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 59. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code> in the range <code>[−6111..6176]</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This function is implemented to be consistent with the <code>FEEL:number</code> definition for rounding decimal numbers to the nearest even decimal number.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">decimal( 1/3, 2 ) = .33
decimal( 1.5, 0 ) = 2
decimal( 2.5, 0 ) = 2
decimal( 1.035, 2 ) = 1.04
decimal( 1.045, 2 ) = 1.04
decimal( 1.055, 2 ) = 1.06
decimal( 1.065, 2 ) = 1.06</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">floor( n )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>n</code> with given scale and rounding mode <em>flooring</em>.
If at least one of <code>n</code> or <code>scale</code> is null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 60. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>floor( n, scale )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">floor( 1.5 ) = 1
floor( -1.56, 1 ) = -1.6
floor( -1.5 ) = -2</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">ceiling( n )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>n</code> with given scale and rounding mode <em>ceiling</em>.
If at least one of <code>n</code> or <code>scale</code> is null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 61. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Alternative signature</div>
<div class="content">
<pre>ceiling( n, scale )</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">ceiling( 1.5 ) = 2
ceiling( -1.56, 1 ) = -1.5
ceiling( -1.5 ) = -1</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">round up( n, scale )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>n</code> with given scale and rounding mode <em>round up</em>.
If at least one of <code>n</code> or <code>scale</code> is null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 62. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">round up( 5.5, 0 ) = 6
round up( -5.5, 0 ) = -6
round up( 1.121, 2 ) = 1.13
round up( -1.126, 2 ) = -1.13</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">round down( n, scale )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>n</code> with given scale and rounding mode <em>round down</em>.
If at least one of <code>n</code> or <code>scale</code> is null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 63. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">round down( 5.5, 0 ) = 5
round down( -5.5, 0 ) = -5
round down( 1.121, 2 ) = 1.12
round down( -1.126, 2 ) = -1.12</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">round half up( n, scale )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>n</code> with given scale and rounding mode <em>round half up</em>.
If at least one of <code>n</code> or <code>scale</code> is null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 64. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">round half up( 5.5, 0 ) = 6
round half up( -5.5, 0 ) = -6
round half up( 1.121, 2 ) = 1.12
round half up( -1.126, 2 ) = -1.13</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">round half down( n, scale )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>n</code> with given scale and rounding mode <em>round half down</em>.
If at least one of <code>n</code> or <code>scale</code> is null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 65. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">round half down( 5.5, 0 ) = 5
round half down( -5.5, 0 ) = -5
round half down( 1.121, 2 ) = 1.12
round half down( -1.126, 2 ) = -1.13</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">abs( n )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the absolute value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 66. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code>, <code>days and time duration</code>, or <code>years and months duration</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">abs( 10 ) = 10
abs( -10 ) = 10
abs( @"PT5H" ) = @"PT5H"
abs( @"-PT5H" ) = @"PT5H"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">modulo( dividend, divisor )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the remainder of the division of the dividend by the divisor. If either the dividend or divisor is negative, the result is of the same sign as the divisor.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This function is also expressed as <code>modulo(dividend, divisor) = dividend - divisor*floor(dividen d/divisor)</code>.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 67. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dividend</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>divisor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">modulo( 12, 5 ) = 2
modulo( -12,5 )= 3
modulo( 12,-5 )= -3
modulo( -12,-5 )= -2
modulo( 10.1, 4.5 )= 1.1
modulo( -10.1, 4.5 )= 3.4
modulo( 10.1, -4.5 )= -3.4
modulo( -10.1, -4.5 )= -1.1</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">sqrt( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the square root of the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 68. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sqrt( 16 ) = 4</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">log( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the logarithm of the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 69. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">decimal( log( 10 ), 2 ) = 2.30</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">exp( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns Euler’s number <code>e</code> raised to the power of the specified number.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 70. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">decimal( exp( 5 ), 2 ) = 148.41</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">odd( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the specified number is odd.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 71. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">odd( 5 ) = true
odd( 2 ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">even( number )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if the specified number is even.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 72. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>number</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">even( 5 ) = false
even ( 2 ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_date_and_time_functions"><a class="anchor" href="#_date_and_time_functions"></a><a class="link" href="#_date_and_time_functions">Date and time functions</a></h7>
<div class="paragraph">
<p>The following functions support date and time operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">is( value1, value2 )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> if both values are the same element in the FEEL semantic domain.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 73. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">is( date( "2012-12-25" ), time( "23:00:50" ) ) = false
is( date( "2012-12-25" ), date( "2012-12-25" ) ) = true
is( time( "23:00:50z" ), time( "23:00:50" ) ) = false
is( time( "23:00:50z" ), time( "23:00:50+00:00" ) ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_range_functions"><a class="anchor" href="#_range_functions"></a><a class="link" href="#_range_functions">Range functions</a></h7>
<div class="paragraph">
<p>The following functions support temporal ordering operations to establish relationships between single scalar values and ranges of such values. These functions are similar to the components in the Health Level Seven (HL7) International <a href="https://cql.hl7.org/08-a-cqlsyntax.html">Clinical Quality Language (CQL) 1.4 syntax</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">before( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is before an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>before( point1 point2 )</code></p>
</li>
<li>
<p><code>before( point range )</code></p>
</li>
<li>
<p><code>before( range point )</code></p>
</li>
<li>
<p><code>before( range1,range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>point1 &lt; point2</code></p>
</li>
<li>
<p><code>point &lt; range.start or ( point = range.start and not(range.start included) )</code></p>
</li>
<li>
<p><code>range.end &lt; point or ( range.end = point and not(range.end included) )</code></p>
</li>
<li>
<p><code>range1.end &lt; range2.start or (( not(range1.end included) or not(range2.start included) ) and range1.end = range2.start )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">before( 1, 10 ) = true
before( 10, 1 ) = false
before( 1, [1..10] ) = false
before( 1, (1..10] ) = true
before( 1, [5..10] ) = true
before( [1..10], 10 ) = false
before( [1..10), 10 ) = true
before( [1..10], 15 ) = true
before( [1..10], [15..20] ) = true
before( [1..10], [10..20] ) = false
before( [1..10), [10..20] ) = true
before( [1..10], (10..20] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">after( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is after an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>after( point1 point2 )</code></p>
</li>
<li>
<p><code>after( point range )</code></p>
</li>
<li>
<p><code>after( range, point )</code></p>
</li>
<li>
<p><code>after( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>point1 &gt; point2</code></p>
</li>
<li>
<p><code>point &gt; range.end or ( point = range.end and not(range.end included) )</code></p>
</li>
<li>
<p><code>range.start &gt; point or ( range.start = point and not(range.start included) )</code></p>
</li>
<li>
<p><code>range1.start &gt; range2.end or (( not(range1.start included) or not(range2.end included) ) and range1.start = range2.end )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">after( 10, 5 ) = true
after( 5, 10 ) = false
after( 12, [1..10] ) = true
after( 10, [1..10) ) = true
after( 10, [1..10] ) = false
after( [11..20], 12 ) = false
after( [11..20], 10 ) = true
after( (11..20], 11 ) = true
after( [11..20], 11 ) = false
after( [11..20], [1..10] ) = true
after( [1..10], [11..20] ) = false
after( [11..20], [1..11) ) = true
after( (11..20], [1..11] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">meets( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> meets an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>meets( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range1.end included and range2.start included and range1.end = range2.start</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">meets( [1..5], [5..10] ) = true
meets( [1..5), [5..10] ) = false
meets( [1..5], (5..10] ) = false
meets( [1..5], [6..10] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">met by( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is met by an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>met by( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range1.start included and range2.end included and range1.start = range2.end</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">met by( [5..10], [1..5] ) = true
met by( [5..10], [1..5) ) = false
met by( (5..10], [1..5] ) = false
met by( [6..10], [1..5] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">overlaps( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> overlaps an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>overlaps( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>( range1.end &gt; range2.start or (range1.end = range2.start and range1.end included and range2.end included) ) and ( range1.start &lt; range2.end or (range1.start = range2.end and range1.start included and range2.end included) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">overlaps( [1..5], [3..8] ) = true
overlaps( [3..8], [1..5] ) = true
overlaps( [1..8], [3..5] ) = true
overlaps( [3..5], [1..8] ) = true
overlaps( [1..5], [6..8] ) = false
overlaps( [6..8], [1..5] ) = false
overlaps( [1..5], [5..8] ) = true
overlaps( [1..5], (5..8] ) = false
overlaps( [1..5), [5..8] ) = false
overlaps( [1..5), (5..8] ) = false
overlaps( [5..8], [1..5] ) = true
overlaps( (5..8], [1..5] ) = false
overlaps( [5..8], [1..5) ) = false
overlaps( (5..8], [1..5) ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">overlaps before( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> overlaps before an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>overlaps before( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>( range1.start &lt; range2.start or (range1.start = range2.start and range1.start included and not(range2.start included)) ) and ( range1.end &gt; range2.start or (range1.end = range2.start and range1.end included and range2.start included) ) and ( range1.end &lt; range2.end or (range1.end = range2.end and (not(range1.end included) or range2.end included )) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">overlaps before( [1..5], [3..8] ) = true
overlaps before( [1..5], [6..8] ) = false
overlaps before( [1..5], [5..8] ) = true
overlaps before( [1..5], (5..8] ) = false
overlaps before( [1..5), [5..8] ) = false
overlaps before( [1..5), (1..5] ) = true
overlaps before( [1..5], (1..5] ) = true
overlaps before( [1..5), [1..5] ) = false
overlaps before( [1..5], [1..5] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">overlaps after( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> overlaps after an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>overlaps after( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>( range2.start &lt; range1.start or (range2.start = range1.start and range2.start included and not( range1.start included)) ) and ( range2.end &gt; range1.start or (range2.end = range1.start  and range2.end included and range1.start included) ) and ( range2.end &lt; range1.end or (range2.end = range1.end and (not(range2.end included) or range1.end included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">overlaps after( [3..8], [1..5] )= true
overlaps after( [6..8], [1..5] )= false
overlaps after( [5..8], [1..5] )= true
overlaps after( (5..8], [1..5] )= false
overlaps after( [5..8], [1..5) )= false
overlaps after( (1..5], [1..5) )= true
overlaps after( (1..5], [1..5] )= true
overlaps after( [1..5], [1..5) )= false
overlaps after( [1..5], [1..5] )= false
overlaps after( (1..5), [1..5] )= false
overlaps after( (1..5], [1..6] )= false
overlaps after( (1..5], (1..5] )= false
overlaps after( (1..5], [2..5] )= false</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">finishes( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> finishes an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>finishes( point, range )</code></p>
</li>
<li>
<p><code>finishes( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.end included and range.end = point</code></p>
</li>
<li>
<p><code>range1.end included = range2.end included and range1.end = range2.end and ( range1.start &gt; range2.start or (range1.start = range2.start and (not(range1.start included) or range2.start included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">finishes( 10, [1..10] ) = true
finishes( 10, [1..10) ) = false
finishes( [5..10], [1..10] ) = true
finishes( [5..10), [1..10] ) = false
finishes( [5..10), [1..10) ) = true
finishes( [1..10], [1..10] ) = true
finishes( (1..10], [1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">finished by( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is finished by an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>finished by( range, point )</code></p>
</li>
<li>
<p><code>finished by( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.end included and range.end = point</code></p>
</li>
<li>
<p><code>range1.end included = range2.end included and range1.end = range2.end and ( range1.start &lt; range2.start or (range1.start = range2.start and (range1.start included or not(range2.start included))) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">finished by( [1..10], 10 ) = true
finished by( [1..10), 10 ) = false
finished by( [1..10], [5..10] ) = true
finished by( [1..10], [5..10) ) = false
finished by( [1..10), [5..10) ) = true
finished by( [1..10], [1..10] ) = true
finished by( [1..10], (1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">includes( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> includes an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>includes( range, point )</code></p>
</li>
<li>
<p><code>includes( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>(range.start &lt; point and range.end &gt; point) or (range.start = point and range.start included) or (range.end = point and range.end included)</code></p>
</li>
<li>
<p><code>( range1.start &lt; range2.start or (range1.start = range2.start and (range1.start included or not(range2.start included))) ) and ( range1.end &gt; range2.end or (range1.end = range2.end and (range1.end included or not(range2.end included))) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">includes( [1..10], 5 ) = true
includes( [1..10], 12 ) = false
includes( [1..10], 1 ) = true
includes( [1..10], 10 ) = true
includes( (1..10], 1 ) = false
includes( [1..10), 10 ) = false
includes( [1..10], [4..6] ) = true
includes( [1..10], [1..5] ) = true
includes( (1..10], (1..5] ) = true
includes( [1..10], (1..10) ) = true
includes( [1..10), [5..10) ) = true
includes( [1..10], [1..10) ) = true
includes( [1..10], (1..10] ) = true
includes( [1..10], [1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">during( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is during an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>during( point, range )</code></p>
</li>
<li>
<p><code>during( range1 range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>(range.start &lt; point and range.end &gt; point) or (range.start = point and range.start included) or (range.end = point and range.end included)</code></p>
</li>
<li>
<p><code>( range2.start &lt; range1.start or (range2.start = range1.start and (range2.start included or not(range1.start included))) ) and ( range2.end &gt; range1.end or (range2.end = range1.end and (range2.end included or not(range1.end included))) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">during( 5, [1..10] ) = true
during( 12, [1..10] ) = false
during( 1, [1..10] ) = true
during( 10, [1..10] ) = true
during( 1, (1..10] ) = false
during( 10, [1..10) ) = false
during( [4..6], [1..10] ) = true
during( [1..5], [1..10] ) = true
during( (1..5], (1..10] ) = true
during( (1..10), [1..10] ) = true
during( [5..10), [1..10) ) = true
during( [1..10), [1..10] ) = true
during( (1..10], [1..10] ) = true
during( [1..10], [1..10] ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">starts( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> starts an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>starts( point, range )</code></p>
</li>
<li>
<p><code>starts( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.start = point and range.start included</code></p>
</li>
<li>
<p><code>range1.start = range2.start and range1.start included = range2.start included and ( range1.end &lt; range2.end or (range1.end = range2.end and (not(range1.end included) or range2.end included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">starts( 1, [1..10] ) = true
starts( 1, (1..10] ) = false
starts( 2, [1..10] ) = false
starts( [1..5], [1..10] ) = true
starts( (1..5], (1..10] ) = true
starts( (1..5], [1..10] ) = false
starts( [1..5], (1..10] ) = false
starts( [1..10], [1..10] ) = true
starts( [1..10), [1..10] ) = true
starts( (1..10), (1..10) ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">started by( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> is started by an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>started by( range, point )</code></p>
</li>
<li>
<p><code>started by( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>range.start = point and range.start included</code></p>
</li>
<li>
<p><code>range1.start = range2.start and range1.start included = range2.start included and ( range2.end &lt; range1.end or (range2.end = range1.end and (not(range2.end included) or range1.end included)) )</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">started by( [1..10], 1 ) = true
started by( (1..10], 1 ) = false
started by( [1..10], 2 ) = false
started by( [1..10], [1..5] ) = true
started by( (1..10], (1..5] ) = true
started by( [1..10], (1..5] ) = false
started by( (1..10], [1..5] ) = false
started by( [1..10], [1..10] ) = true
started by( [1..10], [1..10) ) = true
started by( (1..10), (1..10) ) = true</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">coincides( )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns <code>true</code> when an element <code>A</code> coincides with an element <code>B</code> and when the relevant requirements for evaluating to <code>true</code> are also met.</p>
</div>
<div class="olist loweralpha">
<div class="title">Signatures</div>
<ol class="loweralpha">
<li>
<p><code>coincides( point1, point2 )</code></p>
</li>
<li>
<p><code>coincides( range1, range2 )</code></p>
</li>
</ol>
</div>
<div class="olist loweralpha">
<div class="title">Requirements for evaluating to <code>true</code></div>
<ol class="loweralpha">
<li>
<p><code>point1 = point2</code></p>
</li>
<li>
<p><code>range1.start = range2.start and range1.start included = range2.start included and range1.end = range2.end and range1.end included = range2.end included</code></p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">coincides( 5, 5 ) = true
coincides( 3, 4 ) = false
coincides( [1..5], [1..5] ) = true
coincides( (1..5), [1..5] ) = false
coincides( [1..5], [2..6] ) = false</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_temporal_functions"><a class="anchor" href="#_temporal_functions"></a><a class="link" href="#_temporal_functions">Temporal functions</a></h7>
<div class="paragraph">
<p>The following functions support general temporal operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">day of year( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian number of the day of the year.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 74. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">day of year( date(2019, 9, 17) ) = 260</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">day of week( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian day of the week: <code>"Monday"</code>, <code>"Tuesday"</code>, <code>"Wednesday"</code>, <code>"Thursday"</code>, <code>"Friday"</code>, <code>"Saturday"</code>, or <code>"Sunday"</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 75. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">day of week( date(2019, 9, 17) ) = "Tuesday"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">month of year( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian month of the year: <code>"January"</code>, <code>"February"</code>, <code>"March"</code>, <code>"April"</code>, <code>"May"</code>, <code>"June"</code>, <code>"July"</code>, <code>"August"</code>, <code>"September"</code>, <code>"October"</code>, <code>"November"</code>, or <code>"December"</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 76. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">month of year( date(2019, 9, 17) ) = "September"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">month of year( date )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the Gregorian week of the year as defined by ISO 8601.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 77. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date</code> or <code>date and time</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">week of year( date(2019, 9, 17) ) = 38
week of year( date(2003, 12, 29) ) = 1
week of year( date(2004, 1, 4) ) = 1
week of year( date(2005, 1, 1) ) = 53
week of year( date(2005, 1, 3) ) = 1
week of year( date(2005, 1, 9) ) = 1</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_sort_functions"><a class="anchor" href="#_sort_functions"></a><a class="link" href="#_sort_functions">Sort functions</a></h7>
<div class="paragraph">
<p>The following functions support sorting operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">sort( list, precedes )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of the same elements but ordered according to the sorting function.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 78. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>precedes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>function</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">sort( list: [3,1,4,5,2], precedes: function(x,y) x &lt; y ) = [1,2,3,4,5]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_context_functions"><a class="anchor" href="#_context_functions"></a><a class="link" href="#_context_functions">Context functions</a></h7>
<div class="paragraph">
<p>The following functions support context operations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">get value( m, key )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the value from the context for the specified entry key.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 79. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">get value( {key1 : "value1"}, "key1" ) = "value1"
get value( {key1 : "value1"}, "unexistent-key" ) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">get entries( m )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a list of key-value pairs for the specified context.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 80. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">get entries( {key1 : "value1", key2 : "value2"} ) = [ { key : "key1", value : "value1" }, {key : "key2", value : "value2"} ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">context( entries )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a new context that includes all specified entries.
If a context item contains additional entries beyond the required "key" and "value" entries, the additional entries are ignored.
If a context item is missing the required "key" and "value" entries, the final result is null.
See also: get entries() built-in function.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 81. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>entries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>context</code> , each item SHALL have two entries having keys named "key" and "value" respectively</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">context([{key:"a", value:1}, {key:"b", value:2}]) = {a:1, b:2}
context([{key:"a", value:1}, {key:"b", value:2, something: "else"}]) = {a:1, b:2}
context([{key:"a", value:1}, {key:"b"}]) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">context put( context, key, value )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a new context that includes the new entry, or overrides the existing value if an entry for the same key already exists in the supplied context parameter.
A new entry is added as the last entry of the new context.
If overriding an existing entry, the order of the keys maintains the same order as in the original context.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 82. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Any</code> type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">context put({x:1}, "y", 2) = {x:1, y:2}
context put({x:1, y:0}, "y", 2) = {x:1, y:2}
context put({x:1, y:0, z:0}, "y", 2) = {x:1, y:2, z:0}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">context put( context, keys, value )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the composite of nested invocations to <code>context put()</code> for each item in <code>keys</code> hierarchy in context.</p>
</div>
<div class="paragraph">
<p>If <code>keys</code> is a list of 1 element, this is equivalent to <code>context put(context, key', value)</code>, where <code>key'</code> is the only element in the list keys.</p>
</div>
<div class="paragraph">
<p>If <code>keys</code> is a list of 2 or more elements, this is equivalent of calling <code>context put(context, key', value')</code>, with:<br>
<code>key'</code> is the head element in the list keys,<br>
<code>value'</code> is the result of invocation of <code>context put(context', keys', value)</code>, where:<br>
<code>context'</code> is the result of <code>context.key'</code>,<br>
<code>keys'</code> is the remainder of the list keys without the head element <code>key'</code>.</p>
</div>
<div class="paragraph">
<p>If <code>keys</code> is an empty list or null, the result is null.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 83. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keys</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Any</code> type</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">context put({x:1}, ["y"], 2) = context put({x:1}, "y", 2)
context put({x:1}, ["y"], 2) = {x:1, y:2}
context put({x:1, y: {a: 0} }, ["y", "a"], 2) = context put({x:1, y: {a: 0} }, "y", context put({a: 0}, ["a"], 2))
context put({x:1, y: {a: 0} }, ["y", "a"], 2) = {x:1, y: {a: 2} }
context put({x:1, y: {a: 0} }, [], 2) = null</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">context merge( contexts )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns a new context that includes all entries from the given contexts; if some of the keys are equal, the entries are overridden.
The entries are overridden in the same order as specified by the supplied parameter, with new entries added as the last entry in the new context.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 84. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>contexts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>list</code> of <code>context</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code class="language-FEEL" data-lang="FEEL">context merge([{x:1}, {y:2}]) = {x:1, y:2}
context merge([{x:1, y:0}, {y:2}]) = {x:1, y:2}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_miscellaneous_functions"><a class="anchor" href="#_miscellaneous_functions"></a><a class="link" href="#_miscellaneous_functions">Miscellaneous functions</a></h7>
<div class="paragraph">
<p>These functions provide support utilities for several miscellaneous use-cases.
For example, when a decision depends on the current date, like deciding the support SLA over the weekends, additional charges for weekend delivery, etc.</p>
</div>
<div class="paragraph">
<p>It is important to note that the functions in this section are intended to be side-effect-free, but they are not deterministic and not idempotent from the perspective of an external observer.</p>
</div>
<div class="paragraph">
<p>As a user, you are encouraged to isolate the decision logic that uses these functions in specific DRG elements, such as Decisions.
The encapsulation enables them to be overridden with synthetic values during scenario testing, that remain constant across executions of the DMN model&#8217;s test cases.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">now()</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the current <code>date and time</code>.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code>now()</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">today()</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the current <code>date</code>.</p>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code>today()</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect6">
<h7 id="_kie_extended_functions"><a class="anchor" href="#_kie_extended_functions"></a><a class="link" href="#_kie_extended_functions">KIE Extended functions</a></h7>
<div class="paragraph">
<p>These functions are provided as an extension to the DMN Standard to enable support for various use-cases on top of the Drools DMN Engine.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">invoke( namespace, modelName, decisionName, parameters )</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Returns the result of the decision evaluation in the specified DMN model available to the <code>DMNRuntime</code> environment in the current DMN model is executed.</p>
</div>
<div class="paragraph">
<p>This function is <em>deprecated</em> in favor of encouraging the usage of DMN Standard capabilities wherever possible; since DMNv1.2 it shall be possible to use the DMN standard&#8217;s <em>Import</em> functionality to import Business Knowledge Model (BKM) nodes and Decision Service nodes, to be invoked from another model.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 85. Parameters</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>modelName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>decisionName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parameter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>context</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre class="highlight"><code>invoke(
    "http://namespace_of_model",
    "my model name",
    "my decision name",
    { a:1, b:2 }
)</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-feel-variable-function-names_kogito-dmn-models"><a class="anchor" href="#ref-dmn-feel-variable-function-names_kogito-dmn-models"></a><a class="link" href="#ref-dmn-feel-variable-function-names_kogito-dmn-models">2.1.2.4. Variable and function names in FEEL</a></h5>
<div class="paragraph _abstract">
<p>Unlike many traditional expression languages, Friendly Enough Expression Language (FEEL) supports spaces and a few special characters as part of variable and function names. A FEEL name must start with a <code>letter</code>, <code>?</code>, or <code>_</code> element. The unicode letter characters are also allowed. Variable names cannot start with a language keyword, such as <code>and</code>, <code>true</code>, or <code>every</code>. The remaining characters in a variable name can be any of the starting characters, as well as <code>digits</code>, white spaces, and special characters such as <code>+</code>, <code>-</code>, <code>/</code>, <code>*</code>, <code>'</code>, and <code>.</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following names are all valid FEEL names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Age</p>
</li>
<li>
<p>Birth Date</p>
</li>
<li>
<p>Flight 234 pre-check procedure</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Several limitations apply to variable and function names in FEEL:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ambiguity</dt>
<dd>
<p>The use of spaces, keywords, and other special characters as part of names can make FEEL ambiguous. The ambiguities are resolved in the context of the expression, matching names from left to right. The parser resolves the variable name as the longest name matched in scope. You can use <code>( )</code> to disambiguate names if necessary.</p>
</dd>
<dt class="hdlist1">Spaces in names</dt>
<dd>
<p>The DMN specification limits the use of spaces in FEEL names. According to the DMN specification, names can contain multiple spaces but not two consecutive spaces.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In order to make the language easier to use and avoid common errors due to spaces, Kogito removes the limitation on the use of consecutive spaces. Kogito supports variable names with any number of consecutive spaces, but normalizes them into a single space. For example, the variable references <code>First Name</code> with one space and <code>First  Name</code> with two spaces are both acceptable in Kogito.</p>
</div>
<div class="paragraph">
<p>Kogito also normalizes the use of other white spaces, like the non-breakable white space that is common in web pages, tabs, and line breaks. From a Kogito FEEL engine perspective, all of these characters are normalized into a single white space before processing.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">The keyword <code>in</code></dt>
<dd>
<p>The keyword <code>in</code> is the only keyword in the language that cannot be used as part of a variable name. Although the specifications allow the use of keywords in the middle of variable names, the use of <code>in</code> in variable names conflicts with the grammar definition of <code>for</code>, <code>every</code> and <code>some</code> expression constructs.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-boxed-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-boxed-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-boxed-expressions_kogito-dmn-models">2.1.2.5. DMN decision logic in boxed expressions</a></h5>
<div class="paragraph _abstract">
<p>Boxed expressions in DMN are tables that you use to define the underlying logic of decision nodes and business knowledge models in a decision requirements diagram (DRD). Some boxed expressions can contain other boxed expressions, but the top-level boxed expression corresponds to the decision logic of a single DRD artifact. While DRDs represent the flow of a DMN decision model, boxed expressions define the actual decision logic of individual nodes. DRDs and boxed expressions together form a complete and functional DMN decision model.</p>
</div>
<div class="paragraph">
<p>The following are the types of DMN boxed expressions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Decision tables</p>
</li>
<li>
<p>Literal expressions</p>
</li>
<li>
<p>Contexts</p>
</li>
<li>
<p>Relations</p>
</li>
<li>
<p>Functions</p>
</li>
<li>
<p>Invocations</p>
</li>
<li>
<p>Lists</p>
</li>
<li>
<p>Conditionals or Lists conditionals</p>
</li>
<li>
<p>Iterators</p>
</li>
<li>
<p>Filters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All Friendly Enough Expression Language (FEEL) expressions that you use in your boxed expressions must conform to the FEEL syntax requirements in the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="sect5">
<h6 id="con-dmn-decision-tables_kogito-dmn-models"><a class="anchor" href="#con-dmn-decision-tables_kogito-dmn-models"></a><a class="link" href="#con-dmn-decision-tables_kogito-dmn-models">DMN decision tables</a></h6>
<div class="paragraph _abstract">
<p>A decision table in DMN is a visual representation of one or more business rules in a tabular format. You use decision tables to define rules for a decision node that applies those rules at a given point in the decision model. Each rule consists of a single row in the table, and includes columns that define the conditions (input) and outcome (output) for that particular row. The definition of each row is precise enough to derive the outcome using the values of the conditions. Input and output values can be FEEL expressions or defined data type values.</p>
</div>
<div class="paragraph">
<p>For example, the following decision table determines credit score ratings based on a defined range of a loan applicant&#8217;s credit score:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example.png" alt="dmn decision table example">
</div>
<div class="title">Figure 23. Decision table for credit score rating</div>
</div>
<div class="paragraph">
<p>The following decision table determines the next step in a lending strategy for applicants depending on applicant loan eligibility and the bureau call type:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example2.png" alt="dmn decision table example2">
</div>
<div class="title">Figure 24. Decision table for lending strategy</div>
</div>
<div class="paragraph">
<p>The following decision table determines applicant qualification for a loan as the concluding decision node in a loan prequalification decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3">
</div>
<div class="title">Figure 25. Decision table for loan prequalification</div>
</div>
<div class="paragraph">
<p>Decision tables are a popular way of modeling rules and decision logic, and are used in many methodologies (such as DMN) and implementation frameworks (such as Drools).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Kogito supports both DMN decision tables and Drools-native decision tables, but they are different types of assets with different syntax requirements and are not interchangeable. For more information about Drools-native decision tables in Kogito, see <a href="#con-decision-tables_kogito-decision-tables">Spreadsheet decision tables</a>.
</td>
</tr>
</table>
</div>
<div class="sect6">
<h7 id="con-dmn-decision-tables-hit-policies_kogito-dmn-models"><a class="anchor" href="#con-dmn-decision-tables-hit-policies_kogito-dmn-models"></a><a class="link" href="#con-dmn-decision-tables-hit-policies_kogito-dmn-models">Hit policies in DMN decision tables</a></h7>
<div class="paragraph _abstract">
<p>Hit policies determine how to reach an outcome when multiple rules in a decision table match the provided input values. For example, if one rule in a decision table applies a sales discount to military personnel and another rule applies a discount to students, then when a customer is both a student and in the military, the decision table hit policy must indicate whether to apply one discount or the other (<strong>Unique</strong>, <strong>First</strong>) or both discounts (<strong>Collect Sum</strong>). You specify the single character of the hit policy (<strong>U</strong>, <strong>F</strong>, <strong>C+</strong>) in the upper-left corner of the decision table.</p>
</div>
<div class="paragraph">
<p>The following decision table hit policies are supported in DMN:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Unique (U):</strong> Permits only one rule to match. Any overlap raises an error.</p>
</li>
<li>
<p><strong>Any (A):</strong> Permits multiple rules to match, but they must all have the same output. If multiple matching rules do not have the same output, an error is raised.</p>
</li>
<li>
<p><strong>Priority (P):</strong> Permits multiple rules to match, with different outputs. The output that comes first in the output values list is selected.</p>
</li>
<li>
<p><strong>First (F):</strong> Uses the first match in rule order.</p>
</li>
<li>
<p><strong>Collect (C+, C&gt;, C&lt;, C#):</strong> Aggregates output from multiple rules based on an aggregation function.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Collect ( C ):</strong> Aggregates values in an arbitrary list.</p>
</li>
<li>
<p><strong>Collect Sum (C+):</strong> Outputs the sum of all collected values. Values must be numeric.</p>
</li>
<li>
<p><strong>Collect Min (C&lt;):</strong> Outputs the minimum value among the matches. The resulting values must be comparable, such as numbers, dates, or text (lexicographic order).</p>
</li>
<li>
<p><strong>Collect Max (C&gt;):</strong> Outputs the maximum value among the matches. The resulting values must be comparable, such as numbers, dates or text (lexicographic order).</p>
</li>
<li>
<p><strong>Collect Count (C#):</strong> Outputs the number of matching rules.</p>
</li>
<li>
<p><strong>Rule Order &#174;:</strong> Collects output from multiple rules into a list ordered according to rules order. It is very similar to 'Collect' without any aggregation function, but with explicit consistent ordering in the final list as defined in the table.</p>
</li>
<li>
<p><strong>Output Order (O):</strong> Collects output from multiple rules into a list ordered using the same sorting mechanism as the 'Priority' hit policy.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-literal-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-literal-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-literal-expressions_kogito-dmn-models">Boxed literal expressions</a></h6>
<div class="paragraph _abstract">
<p>A boxed literal expression in DMN is a literal FEEL expression as text in a table cell, typically with a labeled column and an assigned data type. You use boxed literal expressions to define simple or complex node logic or decision data directly in FEEL for a particular node in a decision. Literal FEEL expressions must conform to FEEL syntax requirements in the OMG <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed literal expression defines the minimum acceptable PITI calculation (principal, interest, taxes, and insurance) in a lending decision, where <code>acceptable rate</code> is a variable defined in the DMN model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-literal-expression-example2.png" alt="dmn literal expression example2">
</div>
<div class="title">Figure 26. Boxed literal expression for minimum PITI value</div>
</div>
<div class="paragraph">
<p>The following boxed literal expression sorts a list of possible dating candidates (soul mates) in an online dating application based on their score on criteria such as age, location, and interests:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-literal-expression-example3b.png" alt="dmn literal expression example3b">
</div>
<div class="title">Figure 27. Boxed literal expression for matching online dating candidates</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-context-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-context-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-context-expressions_kogito-dmn-models">Boxed context expressions</a></h6>
<div class="paragraph _abstract">
<p>A boxed context expression in DMN is a set of variable names and values with a result value. Each name-value pair is a context entry. You use context expressions to represent data definitions in decision logic and set a value for a desired decision element within the DMN decision model. A value in a boxed context expression can be a data type value or FEEL expression, or can contain a nested sub-expression of any type, such as a decision table, a literal expression, or another context expression.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed context expression defines the factors for sorting delayed passengers in a flight-rebooking decision model, based on defined data types (<code>tPassengerTable</code>, <code>tFlightNumberList</code>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-context-expression-example.png" alt="dmn context expression example">
</div>
<div class="title">Figure 28. Boxed context expression for flight passenger waiting list</div>
</div>
<div class="paragraph">
<p>The following boxed context expression defines the factors that determine whether a loan applicant can meet minimum mortgage payments based on principal, interest, taxes, and insurance (PITI), represented as a front-end ratio calculation with a sub-context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-context-expression-example2.png" alt="dmn context expression example2">
</div>
<div class="title">Figure 29. Boxed context expression for front-end client PITI ratio</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-relation-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-relation-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-relation-expressions_kogito-dmn-models">Boxed relation expressions</a></h6>
<div class="paragraph _abstract">
<p>A boxed relation expression in DMN is a traditional data table with information about given entities, listed as rows. You use boxed relation tables to define decision data for relevant entities in a decision at a particular node. Boxed relation expressions are similar to context expressions in that they set variable names and values, but relation expressions contain no result value and list all variable values based on a single defined variable in each column.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed relation expression provides information about employees in an employee rostering decision:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-relation-expression-example.png" alt="dmn relation expression example">
</div>
<div class="title">Figure 30. Boxed relation expression with employee information</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-function-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-function-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-function-expressions_kogito-dmn-models">Boxed function expressions</a></h6>
<div class="paragraph _abstract">
<p>A boxed function expression in DMN is a parameterized boxed expression containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type. By default, all business knowledge models are defined as boxed function expressions. You use boxed function expressions to call functions on your decision logic and to define all business knowledge models.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed function expression determines if the airline flight has a capacity in a flight-rebooking decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-function-expression-example.png" alt="dmn function expression example">
</div>
<div class="title">Figure 31. Boxed function expression for flight capacity</div>
</div>
<div class="paragraph">
<p>The following boxed function expression contains a basic Java function as a context expression for determining absolute value in a decision model calculation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-function-expression-example2.png" alt="dmn function expression example2">
</div>
<div class="title">Figure 32. Boxed function expression for absolute value</div>
</div>
<div class="paragraph">
<p>The following boxed function expression determines a monthly mortgage installment as a business knowledge model in a lending decision, with the function value defined as a nested context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-function-expression-example3.png" alt="dmn function expression example3">
</div>
<div class="title">Figure 33. Boxed function expression for installment calculation in business knowledge model</div>
</div>
<div class="paragraph">
<p>The following boxed function expression uses a PMML model included in the DMN file to define the minimum acceptable PITI calculation (principal, interest, taxes, and insurance) in a lending decision:</p>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-invocation-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-invocation-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-invocation-expressions_kogito-dmn-models">Boxed invocation expressions</a></h6>
<div class="paragraph _abstract">
<p>A boxed invocation expression in DMN is a boxed expression that invokes a business knowledge model. A boxed invocation expression contains the name of the business knowledge model to be invoked and a list of parameter bindings. Each binding is represented by two boxed expressions on a row: The box on the left contains the name of a parameter and the box on the right contains the binding expression whose value is assigned to the parameter to evaluate the invoked business knowledge model. You use boxed invocations to invoke at a particular decision node a business knowledge model defined in the decision model.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed invocation expression invokes a <code>Reassign Next Passenger</code> business knowledge model as the concluding decision node in a flight-rebooking decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-invocation-example.png" alt="dmn invocation example">
</div>
<div class="title">Figure 34. Boxed invocation expression to reassign flight passengers</div>
</div>
<div class="paragraph">
<p>The following boxed invocation expression invokes an <code>InstallmentCalculation</code> business knowledge model to calculate a monthly installment amount for a loan before proceeding to affordability decisions:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-invocation-example2.png" alt="dmn invocation example2">
</div>
<div class="title">Figure 35. Boxed invocation expression for required monthly installment</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-list-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-list-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-list-expressions_kogito-dmn-models">Boxed list expressions</a></h6>
<div class="paragraph _abstract">
<p>A boxed list expression in DMN represents a FEEL list of items. You use boxed lists to define lists of relevant items for a particular node in a decision. You can also use literal FEEL expressions for list items in cells to create more complex lists.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed list expression identifies approved credit score agencies in a loan application decision service:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-list-expression-example.png" alt="dmn list expression example">
</div>
<div class="title">Figure 36. Boxed list expression for approved credit score agencies</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-conditional-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-conditional-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-conditional-expressions_kogito-dmn-models">Boxed conditional expressions</a></h6>
<div class="paragraph">
<p>Is an alternative way for constructing <code>if then else</code> expressions.
The attached example below uses just <code>true</code> and <code>false</code> literal expressions.
However, both <code>then</code> and <code>else</code> can be replaced with more complex nested expressions.
For example, a decision table expression.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-conditional-expression.png" alt="dmn conditional expression">
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-conditional-every-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-conditional-every-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-conditional-every-expressions_kogito-dmn-models">Boxed conditional every expressions</a></h6>
<div class="paragraph">
<p>To be evaluated as <code>true</code> every single item <code>every</code> of the collection <code>in</code> needs to satisfy condition <code>satisfies</code>.
Otherwise it is evaluated as <code>false</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-conditional-every-expression.png" alt="dmn conditional every expression">
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-conditional-some-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-conditional-some-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-conditional-some-expressions_kogito-dmn-models">Boxed conditional some expressions</a></h6>
<div class="paragraph">
<p>This is the same expression as <code>every</code>, however to be evaluated as <code>true</code>, it is enough one item of the collection satisfies the codnition.</p>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-iterator-for-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-iterator-for-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-iterator-for-expressions_kogito-dmn-models">Boxed iterator for expressions</a></h6>
<div class="paragraph">
<p>This expression is used for transform every item <code>for</code> of the collection <code>int</code> to a new value <code>return</code>.
In the example below we map list of objects representing attachments, into list of numbers representig file sizes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-iterator-for-expression.png" alt="dmn iterator for expression">
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-dmn-filter-expressions_kogito-dmn-models"><a class="anchor" href="#con-dmn-filter-expressions_kogito-dmn-models"></a><a class="link" href="#con-dmn-filter-expressions_kogito-dmn-models">Boxed filter expressions</a></h6>
<div class="paragraph">
<p>This expression filters items of the collection defined in the first row using the condition defined in the second row.
Please notice there is reserved keyword <code>item</code> to access particular items of the collection.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-filter-expression.png" alt="dmn filter expression">
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-model-example_kogito-dmn-models"><a class="anchor" href="#ref-dmn-model-example_kogito-dmn-models"></a><a class="link" href="#ref-dmn-model-example_kogito-dmn-models">2.1.2.6. DMN model example</a></h5>
<div class="paragraph _abstract">
<p>The following is a real-world DMN model example that demonstrates how you can use decision modeling to reach a decision based on input data, circumstances, and company guidelines. In this scenario, a flight from San Diego to New York is canceled, requiring the affected airline to find alternate arrangements for its inconvenienced passengers.</p>
</div>
<div class="paragraph">
<p>First, the airline collects the information necessary to determine how best to get the travelers to their destinations:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Input data</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>List of flights</p>
</li>
<li>
<p>List of passengers</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Decisions</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Prioritize the passengers who will get seats on a new flight</p>
</li>
<li>
<p>Determine which flights those passengers will be offered</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Business knowledge models</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The company process for determining passenger priority</p>
</li>
<li>
<p>Any flights that have space available</p>
</li>
<li>
<p>Company rules for determining how best to reassign inconvenienced passengers</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The airline then uses the DMN standard to model its decision process in the following decision requirements diagram (DRD) for determining the best rebooking solution:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-passenger-rebooking-drd.png" alt="dmn passenger rebooking drd">
</div>
<div class="title">Figure 37. DRD for flight rebooking</div>
</div>
<div class="paragraph">
<p>Similar to flowcharts, DRDs use shapes to represent the different elements in a process. Ovals contain the two necessary input data, rectangles contain the decision points in the model, and rectangles with clipped corners (business knowledge models) contain reusable logic that can be repeatedly invoked.</p>
</div>
<div class="paragraph">
<p>The DRD draws logic for each element from boxed expressions that provide variable definitions using FEEL expressions or data type values.</p>
</div>
<div class="paragraph">
<p>Some boxed expressions are basic, such as the following decision for establishing a prioritized waiting list:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-context-expression-example.png" alt="dmn context expression example">
</div>
<div class="title">Figure 38. Boxed context expression example for prioritized wait list</div>
</div>
<div class="paragraph">
<p>Some boxed expressions are more complex with greater detail and calculation, such as the following business knowledge model for reassigning the next delayed passenger:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-reassign-passenger.png" alt="dmn reassign passenger">
</div>
<div class="title">Figure 39. Boxed function expression for passenger reassignment</div>
</div>
<div class="paragraph">
<p>The following is the DMN source file for this decision model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dmn:definitions xmlns:dmn="https://www.omg.org/spec/DMN/20230324/MODEL/" xmlns="https://www.drools.org/kie-dmn/Flight-rebooking" xmlns:feel="http://www.omg.org/spec/DMN/20180521/FEEL/" xmlns:kie="https://kie.org/dmn/extensions/1.0" xmlns:dmndi="https://www.omg.org/spec/DMN/20230324/DMNDI/" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" id="_0019_flight_rebooking" name="0019-flight-rebooking" typeLanguage="https://www.omg.org/spec/DMN/20230324/FEEL/" namespace="https://www.drools.org/kie-dmn/Flight-rebooking"&gt;
  &lt;dmn:extensionElements /&gt;
  &lt;dmn:itemDefinition id="_tFlight" name="tFlight" isCollection="false"&gt;
    &lt;dmn:itemComponent id="_tFlight_Flight" name="Flight Number" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_From" name="From" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_To" name="To" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Dep" name="Departure" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;dateTime&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Arr" name="Arrival" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;dateTime&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Capacity" name="Capacity" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tFlight_Status" name="Status" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tFlightTable" name="tFlightTable" isCollection="true"&gt;
    &lt;dmn:typeRef&gt;tFlight&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tPassenger" name="tPassenger" isCollection="false"&gt;
    &lt;dmn:itemComponent id="_tPassenger_Name" name="Name" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Status" name="Status" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Miles" name="Miles" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;number&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
    &lt;dmn:itemComponent id="_tPassenger_Flight" name="Flight Number" isCollection="false"&gt;
      &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
    &lt;/dmn:itemComponent&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tPassengerTable" name="tPassengerTable" isCollection="true"&gt;
    &lt;dmn:typeRef&gt;tPassenger&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_tFlightNumberList" name="tFlightNumberList" isCollection="true"&gt;
    &lt;dmn:typeRef&gt;string&lt;/dmn:typeRef&gt;
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:inputData id="i_Flight_List" name="Flight List"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_92ADF79C-B4A8-4591-80EB-9124BF397C89" name="Flight List" typeRef="tFlightTable" /&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:inputData id="i_Passenger_List" name="Passenger List"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_96FABA70-F83C-468F-8BA3-451A483A99E5" name="Passenger List" typeRef="tPassengerTable" /&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:decision id="d_PrioritizedWaitingList" name="Prioritized Waiting List"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_74957FC7-1D76-48FC-B28F-58FC5F53DC63" name="Prioritized Waiting List" typeRef="tPassengerTable" /&gt;
    &lt;dmn:informationRequirement id="_17AADFCF-8D56-4670-80F1-38A1A0DCD5A6"&gt;
      &lt;dmn:requiredInput href="#i_Passenger_List" /&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement id="_F9A052C7-8382-4631-AFB3-E5D223796069"&gt;
      &lt;dmn:requiredInput href="#i_Flight_List" /&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:knowledgeRequirement id="_F96A303F-40D4-418A-942A-22E5CAD5E32A"&gt;
      &lt;dmn:requiredKnowledge href="#b_PassengerPriority" /&gt;
    &lt;/dmn:knowledgeRequirement&gt;
    &lt;dmn:context id="_52143AF6-0B54-4BA5-999D-90C6C9FB915F"&gt;
      &lt;dmn:contextEntry id="_A6644891-01CB-4251-8ECA-4A3955FB8A7E"&gt;
        &lt;dmn:variable id="_A6943F25-AB09-4C57-8E5B-20ADF3BEA2A9" name="Cancelled Flights" typeRef="tFlightNumberList" /&gt;
        &lt;dmn:literalExpression id="_EC1CBF4D-DE17-4061-81DA-8829B3317AE4"&gt;
          &lt;dmn:text&gt;Flight List[ Status = &amp;quot;cancelled&amp;quot; ].Flight Number&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
      &lt;dmn:contextEntry id="_AE7B6A7E-52C4-4543-AFD3-34CCCC514961"&gt;
        &lt;dmn:variable id="_A579E75D-7A4C-47FF-A4A8-D75F04BCB0F0" name="Waiting List" typeRef="tPassengerTable" /&gt;
        &lt;dmn:literalExpression id="_69421A6E-4B85-4728-B11D-2A961FD6C3F8"&gt;
          &lt;dmn:text&gt;Passenger List[ list contains( Cancelled Flights, Flight Number ) ]&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
      &lt;dmn:contextEntry id="_7C26C0AE-98B4-43E3-89B0-16BE01C4A7F0"&gt;
        &lt;dmn:literalExpression id="_E6FE9128-E9F4-4352-B516-AFEC20744218"&gt;
          &lt;dmn:text&gt;sort( Waiting List, Passenger Priority )&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:contextEntry&gt;
    &lt;/dmn:context&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:decision id="d_RebookedPassengers" name="Rebooked Passengers"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_472D6DCE-E646-4976-A54B-3C7F96F64701" name="Rebooked Passengers" typeRef="tPassengerTable" /&gt;
    &lt;dmn:informationRequirement id="_9D249E20-3D5C-465C-BB79-8496389A2A61"&gt;
      &lt;dmn:requiredDecision href="#d_PrioritizedWaitingList" /&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement id="_3DED24A5-DF2B-45E3-9F65-E2C2A3B23CFB"&gt;
      &lt;dmn:requiredInput href="#i_Flight_List" /&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:knowledgeRequirement id="_3F5C3E35-C002-4A59-85A0-FF1044D98AE2"&gt;
      &lt;dmn:requiredKnowledge href="#b_ReassignNextPassenger" /&gt;
    &lt;/dmn:knowledgeRequirement&gt;
    &lt;dmn:invocation id="_06FFA2CF-F3FB-4EF7-80FB-8102AE35DA43" label="Rebooked Passengers" typeRef="tPassengerTable"&gt;
      &lt;dmn:literalExpression id="_C240EFED-9E51-4818-B13B-456C8D825BA0"&gt;
        &lt;dmn:text&gt;Reassign Next Passenger&lt;/dmn:text&gt;
      &lt;/dmn:literalExpression&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter id="_E580944F-81F7-4882-9BF1-929743403184" name="Waiting List" typeRef="tPassengerTable" /&gt;
        &lt;dmn:literalExpression id="_43D8C887-CECB-4220-A175-605E59B07BFE" label="Waiting List" typeRef="tPassengerTable"&gt;
          &lt;dmn:text&gt;Prioritized Waiting List&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter id="_2D3D7440-28AC-4DC7-B6EF-C8A9F3C1E191" name="Reassigned Passengers List" typeRef="tPassengerTable" /&gt;
        &lt;dmn:literalExpression id="_3A736784-ADD6-4752-820B-B91A48A863AC" label="Reassigned Passengers List" typeRef="tPassengerTable"&gt;
          &lt;dmn:text&gt;[]&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
      &lt;dmn:binding&gt;
        &lt;dmn:parameter id="_31DDBD92-037D-4358-AA20-17EACF402924" name="Flights" typeRef="tFlightTable" /&gt;
        &lt;dmn:literalExpression id="_45BE62E7-58BA-42E0-9D9B-FC3B1C1D4E5E" label="Flights" typeRef="tFlightTable"&gt;
          &lt;dmn:text&gt;Flight List&lt;/dmn:text&gt;
        &lt;/dmn:literalExpression&gt;
      &lt;/dmn:binding&gt;
    &lt;/dmn:invocation&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:businessKnowledgeModel id="b_PassengerPriority" name="Passenger Priority"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_36FDB559-D50D-4CFD-9D2E-25266104806F" name="Passenger Priority" typeRef="boolean" /&gt;
    &lt;dmn:encapsulatedLogic id="_A12D9A11-40CB-4169-83F0-533EE52AF683" kind="FEEL" label="Passenger Priority"&gt;
      &lt;dmn:formalParameter id="_70EEFA25-30B6-4451-AD55-ACE6B97B9414" name="Passenger1" typeRef="tPassenger" /&gt;
      &lt;dmn:formalParameter id="_77208957-C112-400F-85C6-100B983CD49E" name="Passenger2" typeRef="tPassenger" /&gt;
      &lt;dmn:decisionTable id="_8C153723-4E9C-4B79-A7BB-D8E6BD627F54" hitPolicy="UNIQUE" preferredOrientation="Rule-as-Row"&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P1_Status"&gt;
          &lt;dmn:inputExpression id="_0010A7B6-F021-4136-BBD7-464614721E05" typeRef="string"&gt;
            &lt;dmn:text&gt;Passenger1.Status&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
          &lt;dmn:inputValues id="_FB57465B-D909-4E5F-9B68-98ACCB9ECC22"&gt;
            &lt;dmn:text&gt;&amp;quot;gold&amp;quot;, &amp;quot;silver&amp;quot;, &amp;quot;bronze&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputValues&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P2_Status"&gt;
          &lt;dmn:inputExpression id="_E9245558-4DDC-47D9-8198-718BC2B56369" typeRef="string"&gt;
            &lt;dmn:text&gt;Passenger2.Status&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
          &lt;dmn:inputValues id="_0B1A73C7-07EE-4C25-94CE-8E5975B10B04"&gt;
            &lt;dmn:text&gt;&amp;quot;gold&amp;quot;, &amp;quot;silver&amp;quot;, &amp;quot;bronze&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputValues&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:input id="b_Passenger_Priority_dt_i_P1_Miles"&gt;
          &lt;dmn:inputExpression id="_D61DF10C-13D2-46E7-938B-CFF273890F2C" typeRef="string"&gt;
            &lt;dmn:text&gt;Passenger1.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputExpression&gt;
        &lt;/dmn:input&gt;
        &lt;dmn:output id="b_Status_Priority_dt_o"&gt;
          &lt;dmn:outputValues id="_AFBEAC3A-D643-47BB-88D0-134201ACFF23"&gt;
            &lt;dmn:text&gt;true, false&lt;/dmn:text&gt;
          &lt;/dmn:outputValues&gt;
          &lt;dmn:defaultOutputEntry id="_65509263-B427-41E3-8079-AD7DEC0E0D56"&gt;
            &lt;dmn:text&gt;false&lt;/dmn:text&gt;
          &lt;/dmn:defaultOutputEntry&gt;
        &lt;/dmn:output&gt;
        &lt;dmn:annotation name="" /&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r1"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i1"&gt;
            &lt;dmn:text&gt;&amp;quot;gold&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i2"&gt;
            &lt;dmn:text&gt;&amp;quot;gold&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r1_i3"&gt;
            &lt;dmn:text&gt;&amp;gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r1_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
          &lt;dmn:annotationEntry&gt;
            &lt;dmn:text&gt;&lt;/dmn:text&gt;
          &lt;/dmn:annotationEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r2"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i1"&gt;
            &lt;dmn:text&gt;&amp;quot;gold&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i2"&gt;
            &lt;dmn:text&gt;&amp;quot;silver&amp;quot;,&amp;quot;bronze&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r2_i3"&gt;
            &lt;dmn:text&gt;-&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r2_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
          &lt;dmn:annotationEntry&gt;
            &lt;dmn:text&gt;&lt;/dmn:text&gt;
          &lt;/dmn:annotationEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r3"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i1"&gt;
            &lt;dmn:text&gt;&amp;quot;silver&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i2"&gt;
            &lt;dmn:text&gt;&amp;quot;silver&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r3_i3"&gt;
            &lt;dmn:text&gt;&amp;gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r3_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
          &lt;dmn:annotationEntry&gt;
            &lt;dmn:text&gt;&lt;/dmn:text&gt;
          &lt;/dmn:annotationEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r4"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i1"&gt;
            &lt;dmn:text&gt;&amp;quot;silver&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i2"&gt;
            &lt;dmn:text&gt;&amp;quot;bronze&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r4_i3"&gt;
            &lt;dmn:text&gt;-&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r4_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
          &lt;dmn:annotationEntry&gt;
            &lt;dmn:text&gt;&lt;/dmn:text&gt;
          &lt;/dmn:annotationEntry&gt;
        &lt;/dmn:rule&gt;
        &lt;dmn:rule id="b_Passenger_Priority_dt_r5"&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i1"&gt;
            &lt;dmn:text&gt;&amp;quot;bronze&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i2"&gt;
            &lt;dmn:text&gt;&amp;quot;bronze&amp;quot;&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:inputEntry id="b_Passenger_Priority_dt_r5_i3"&gt;
            &lt;dmn:text&gt;&amp;gt;= Passenger2.Miles&lt;/dmn:text&gt;
          &lt;/dmn:inputEntry&gt;
          &lt;dmn:outputEntry id="b_Passenger_Priority_dt_r5_o1"&gt;
            &lt;dmn:text&gt;true&lt;/dmn:text&gt;
          &lt;/dmn:outputEntry&gt;
          &lt;dmn:annotationEntry&gt;
            &lt;dmn:text&gt;&lt;/dmn:text&gt;
          &lt;/dmn:annotationEntry&gt;
        &lt;/dmn:rule&gt;
      &lt;/dmn:decisionTable&gt;
    &lt;/dmn:encapsulatedLogic&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
  &lt;dmn:businessKnowledgeModel id="b_ReassignNextPassenger" name="Reassign Next Passenger"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_41A73A5D-92D4-446F-A4E5-34219738B5B4" name="Reassign Next Passenger" typeRef="tPassengerTable" /&gt;
    &lt;dmn:encapsulatedLogic label="Reassign Next Passenger" typeRef="tPassengerTable" id="_BA138AA8-7F53-4DF6-B065-51B5B69C1E1E" kind="FEEL"&gt;
      &lt;dmn:formalParameter id="_079D9B01-66C5-4EE4-BC20-94C202A8305E" name="Waiting List" typeRef="tPassengerTable" /&gt;
      &lt;dmn:formalParameter id="_AED0030C-0CEB-47BB-A9DA-49C5425380EC" name="Reassigned Passengers List" typeRef="tPassengerTable" /&gt;
      &lt;dmn:formalParameter id="_07788CAF-36F6-4482-8978-75035E6574DC" name="Flights" typeRef="tFlightTable" /&gt;
      &lt;dmn:context id="_16299B5F-1F35-408A-AF34-E42B6BFA3185"&gt;
        &lt;dmn:contextEntry id="_94F5F8C3-B195-4CD2-9DDD-2DEEEE6970DC"&gt;
          &lt;dmn:variable id="_46340F69-2156-4545-86A9-49B2D0E99EEE" name="Next Passenger" typeRef="tPassenger" /&gt;
          &lt;dmn:literalExpression id="_011682F2-D817-4002-A291-3CD9EAB4F6C8"&gt;
            &lt;dmn:text&gt;Waiting List[1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry id="_7E261BA1-D8A9-426F-9D03-462358524C55"&gt;
          &lt;dmn:variable id="_26B9ABE1-53B4-4E77-9554-7554C8C03BB9" name="Original Flight" typeRef="tFlight" /&gt;
          &lt;dmn:literalExpression id="_D788D461-6466-44E6-947C-79CB0565F8B3"&gt;
            &lt;dmn:text&gt;Flights[ Flight Number = Next Passenger.Flight Number ][1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry id="_B0CAE4E8-0CD0-4282-8F93-1116AAE31453"&gt;
          &lt;dmn:variable id="_CE22E635-50E0-464F-8BBD-73C6C4260E46" name="Best Alternate Flight" typeRef="tFlight" /&gt;
          &lt;dmn:literalExpression id="_E718531A-DADE-4A94-8820-01255E99BE4A"&gt;
            &lt;dmn:text&gt;Flights[ From = Original Flight.From and To = Original Flight.To and Departure &amp;gt; Original Flight.Departure and Status = &amp;quot;scheduled&amp;quot; and Has Capacity( item, Reassigned Passengers List ) ][1]&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry id="_0BF8AA52-5E85-4EA2-8856-59CB343F7FE2"&gt;
          &lt;dmn:variable id="_F447DFC2-5F03-4934-A039-D6E0136894FA" name="Reassigned Passenger" typeRef="tPassenger" /&gt;
          &lt;dmn:context id="_A1190B20-8D81-47F8-A2DB-90962B6B0D6A"&gt;
            &lt;dmn:contextEntry id="_07F1D257-7E12-416F-889A-E9E9F404FBFA"&gt;
              &lt;dmn:variable id="_C506F923-8DB2-4320-8E0A-ED98D92E0C8A" name="Name" typeRef="string" /&gt;
              &lt;dmn:literalExpression id="_310215F5-27BC-41F2-A7E8-0B0E2118ADB8"&gt;
                &lt;dmn:text&gt;Next Passenger.Name&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry id="_492523E6-B422-441C-BABD-C49762DA95F4"&gt;
              &lt;dmn:variable id="_82D7A27B-4855-42BE-9ED3-1B19D4C82963" name="Status" typeRef="string" /&gt;
              &lt;dmn:literalExpression id="_2CE91293-14BC-4927-B554-9F5D14D7E06C"&gt;
                &lt;dmn:text&gt;Next Passenger.Status&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry id="_948F3E97-140A-4D81-935C-428431471641"&gt;
              &lt;dmn:variable id="_1A4A9CA8-87F0-4FE1-97E9-1DF836736B3E" name="Miles" typeRef="number" /&gt;
              &lt;dmn:literalExpression id="_673BC185-8101-4D53-B0FD-CBB3C84D2D63"&gt;
                &lt;dmn:text&gt;Next Passenger.Miles&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
            &lt;dmn:contextEntry id="_0D03AEC3-6622-4579-9FF9-B001E31802FE"&gt;
              &lt;dmn:variable id="_FF4B08AE-2B00-4BB1-AEE7-E0D648F54895" name="Flight Number" typeRef="string" /&gt;
              &lt;dmn:literalExpression id="_B857CFA3-8026-4F52-9D16-6023D5401CF2"&gt;
                &lt;dmn:text&gt;Best Alternate Flight.Flight Number&lt;/dmn:text&gt;
              &lt;/dmn:literalExpression&gt;
            &lt;/dmn:contextEntry&gt;
          &lt;/dmn:context&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry id="_A9A4BDE9-5CB4-4476-A9E1-05D15558DF7A"&gt;
          &lt;dmn:variable id="_CB8AF390-5F44-42A6-8785-0E21E42A0D46" name="Remaining Waiting List" typeRef="tPassengerTable" /&gt;
          &lt;dmn:literalExpression id="_F098987F-B83D-4248-AA87-E0EDA51C6489"&gt;
            &lt;dmn:text&gt;remove( Waiting List, 1 )&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry id="_43439528-BE5D-4699-AE31-4CC9A0D5896A"&gt;
          &lt;dmn:variable id="_77C9EAC3-290F-4257-9CB1-21320A29B110" name="Updated Reassigned Passengers List" typeRef="tPassengerTable" /&gt;
          &lt;dmn:literalExpression id="_040FFB3A-5547-423A-941B-66A7DD494D15"&gt;
            &lt;dmn:text&gt;append( Reassigned Passengers List, Reassigned Passenger )&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
        &lt;dmn:contextEntry id="_7D17464F-CF70-4B1C-BB6D-1F6EF118228F"&gt;
          &lt;dmn:literalExpression id="_32FC2785-E382-488F-9809-53D16B3BDDC7"&gt;
            &lt;dmn:text&gt;if count( Remaining Waiting List ) &amp;gt; 0 then Reassign Next Passenger( Remaining Waiting List, Updated Reassigned Passengers List, Flights ) else Updated Reassigned Passengers List&lt;/dmn:text&gt;
          &lt;/dmn:literalExpression&gt;
        &lt;/dmn:contextEntry&gt;
      &lt;/dmn:context&gt;
    &lt;/dmn:encapsulatedLogic&gt;
    &lt;dmn:knowledgeRequirement id="_F40BEF92-01D5-477E-84C4-958DAFD05F3C"&gt;
      &lt;dmn:requiredKnowledge href="#b_HasCapacity" /&gt;
    &lt;/dmn:knowledgeRequirement&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
  &lt;dmn:businessKnowledgeModel id="b_HasCapacity" name="Has Capacity"&gt;
    &lt;dmn:extensionElements /&gt;
    &lt;dmn:variable id="_CB3E3B55-4A09-4B0C-AB69-2B23329BA605" name="Has Capacity" typeRef="boolean" /&gt;
    &lt;dmn:encapsulatedLogic id="_02BB134E-37A5-4377-9E05-8020A95431C1" kind="FEEL" label="Has Capacity"&gt;
      &lt;dmn:formalParameter id="_39834437-3345-41F2-85CE-E180C7C3CCBF" name="flight" typeRef="tFlight" /&gt;
      &lt;dmn:formalParameter id="_C3979622-AC93-42F1-9C25-3582A1A2A177" name="rebooked list" typeRef="tPassengerTable" /&gt;
      &lt;dmn:literalExpression id="_E34A45D9-BF5C-47A4-8F75-1D00C2F8ADEA"&gt;
        &lt;dmn:text&gt;flight.Capacity &amp;gt; count( rebooked list[ Flight Number = flight.Flight Number ] )&lt;/dmn:text&gt;
      &lt;/dmn:literalExpression&gt;
    &lt;/dmn:encapsulatedLogic&gt;
  &lt;/dmn:businessKnowledgeModel&gt;
&lt;/dmn:definitions&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-dmn-support_kogito-dmn-models"><a class="anchor" href="#con-dmn-support_kogito-dmn-models"></a><a class="link" href="#con-dmn-support_kogito-dmn-models">2.1.3. DMN support in Kogito</a></h4>
<div class="paragraph _abstract">
<p>Kogito provides runtime support for DMN 1.1, 1.2, 1.3, 1.4 and 1.5 models at conformance level 3 and design support for DMN 1.2 (Classic DMN Editor) and 1.5 models (New DMN Editor) at conformance level 3.</p>
</div>
<div class="paragraph">
<p>The following table summarizes the design and runtime support for each DMN version in Kogito:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 86. DMN support in Kogito</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
<col style="width: 15%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">DMN version</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">DMN engine support</p></th>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Classic DMN Editor</p></th>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">New DMN Editor</p></th>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Execution</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Open</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Save</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Open</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Save</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DMN 1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DMN 1.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DMN 1.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DMN 1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DMN 1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition to all DMN conformance level 3 requirements, Kogito also includes enhancements and fixes to FEEL and DMN model components to optimize the experience of implementing DMN decision services with Kogito. From a platform perspective, DMN models are like any other business asset in Kogito, such as DRL files or spreadsheet decision tables, that you can include in your Kogito project and execute to start your DMN decision services.</p>
</div>
<div class="sect4">
<h5 id="con-dmn-validation_kogito-dmn-models"><a class="anchor" href="#con-dmn-validation_kogito-dmn-models"></a><a class="link" href="#con-dmn-validation_kogito-dmn-models">2.1.3.1. Configurable DMN validation in Kogito</a></h5>
<div class="paragraph _abstract">
<p>By default, the Kogito CodeGen component uses the <code>kogito.decisions.validation=ENABLED</code> configuration to perform pre-compilation validation of DMN model assets and to perform DMN decision table static analysis.</p>
</div>
<div class="paragraph">
<p>When this configuration is enabled, Kogito performs the following DMN validations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DMN model files are verified against the DMN specification XSD schema to ensure that the files are valid XML and compliant with the specification.</p>
</li>
<li>
<p>The pre-compilation analysis is performed for the DMN model to ensure that the basic semantic is aligned with the DMN specification.</p>
</li>
<li>
<p>DMN decision tables are statically analyzed for gaps or overlaps and to ensure that the semantic of the decision table follows best practices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any DMN validation error causes the Kogito CodeGen build to fail and errors are reported accordingly, as shown in the following example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-dmn-validation-con-error.png" alt="Image of DMN validation errors">
</div>
<div class="title">Figure 40. DMN validation errors</div>
</div>
<div class="paragraph">
<p>You can modify the default DMN validation and DMN decision table analysis behavior to ignore errors during the project build, or you can disable this default behavior completely, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="title">Default configuration for DMN validation and decision table analysis</div>
<div class="content">
<pre class="highlight"><code>kogito.decisions.validation=ENABLED</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Configuration to validate DMN models and DMN decision tables but ignore errors</div>
<div class="content">
<pre class="highlight"><code>kogito.decisions.validation=IGNORE</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Configuration to disable all DMN validation</div>
<div class="content">
<pre class="highlight"><code>kogito.decisions.validation=DISABLED</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you enter an unrecognized <code>kogito.decisions.validation</code> configuration flag, all pre-compilation validation features are disabled and the Kogito CodeGen emits related log messages.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-feel-enhancements_kogito-dmn-models"><a class="anchor" href="#ref-dmn-feel-enhancements_kogito-dmn-models"></a><a class="link" href="#ref-dmn-feel-enhancements_kogito-dmn-models">2.1.3.2. FEEL enhancements in Kogito</a></h5>
<div class="paragraph _abstract">
<p>Kogito includes the following enhancements and other changes to FEEL in the current DMN implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Space Sensitivity</em>: This DMN implementation of the FEEL language is space insensitive. The goal is to avoid non-deterministic behavior based on the context and differences in behavior based on invisible characters, such as white spaces. This means that for this implementation, a variable named <code>first name</code> with one space is exactly the same as <code>first  name</code> with two spaces in it.</p>
</li>
<li>
<p><em>List functions <code>or()</code> and <code>and()</code> </em>: The specification defines two list functions named <code>or()</code> and <code>and()</code>. However,
according to the FEEL grammar, these are not valid function names, as <code>and</code> and <code>or</code> are reserved keywords.
 This implementation renames these functions to <code>any()</code> and <code>all()</code> respectively, in anticipation for DMN 1.2.</p>
</li>
<li>
<p><em>Keyword <code>in</code> cannot be used in variable names</em>: The specification defines that any keyword can be reused as part
of a variable name, but the ambiguities caused with the <code>for &#8230;&#8203; in &#8230;&#8203; return</code> loop prevent the reuse of the <code>in</code>
keyword. All other keywords are supported as part of variable names.</p>
</li>
<li>
<p><em>Keywords are not supported in attributes of anonymous types</em>: FEEL is not a strongly typed language and the parser must resolve ambiguity in name parts of an attribute of an anonymous type. The parser supports reusable keywords as part of a variable name defined in the scope, but the parser does not support keywords in attributes of an anonymous type. For example, <code>for item in Order.items return Federal Tax for Item( item )</code> is a valid and supported FEEL expression, where a function named <code>Federal Tax for Item(&#8230;&#8203;)</code> can be defined and invoked correctly in the scope. However, the expression <code>for i in [ {x and y : true, n : 1}, {x and y : false, n: 2} ] return i.x and y</code> is not supported because anonymous types are defined in the iteration context of the <code>for</code> expression and the parser cannot resolve the ambiguity.</p>
</li>
<li>
<p><em>Support for date and time literals on ranges</em>: According to the grammar rules #8, #18, #19, #34 and #62, <code>date
and time</code> literals are supported in ranges (pages 110-111). Chapter 10.3.2.7 on page 114, on the other hand, contradicts
the grammar and says they are not supported. This implementation chose to follow the grammar and support <code>date and
time</code> literals on ranges, as well as extend the specification to support any arbitrary expression (see extensions below).</p>
</li>
<li>
<p><em>Invalid time syntax</em>: Chapter 10.3.2.3.4 on page 112 and bullet point about <code>time</code> on page 131 both state that
the <code>time</code> string lexical representation follows the XML Schema Datatypes specification as well as ISO 8601. According
to the XML Schema specification (<a href="https://www.w3.org/TR/xmlschema-2/#time" class="bare">https://www.w3.org/TR/xmlschema-2/#time</a>), the lexical representation of a time follows
the pattern <code>hh:mm:ss.sss</code> without any leading character. The DMN specification uses a leading "T" in several examples,
that we understand is a typo and not in accordance with the standard.</p>
</li>
<li>
<p><em>Support for scientific and hexadecimal notations</em>: This implementation supports scientific and hexadecimal
notation for numbers. For example, <code>1.2e5</code> (scientific notation), <code>0xD5</code> (hexadecimal notation).</p>
</li>
<li>
<p><em>Support for expressions as end points in ranges</em>: This implementation supports expressions as endpoints
for ranges. For example, <code>[date("2016-11-24")..date("2016-11-27")]</code></p>
</li>
<li>
<p><em>Support for additional types</em>: The specification only defines the following as basic types of the language:</p>
<div class="ulist">
<ul>
<li>
<p>number</p>
</li>
<li>
<p>string</p>
</li>
<li>
<p>boolean</p>
</li>
<li>
<p>days and time duration</p>
</li>
<li>
<p>years and month duration</p>
</li>
<li>
<p>time</p>
</li>
<li>
<p>date and time</p>
<div class="paragraph">
<p>For completeness and orthogonality, this implementation also supports the following types:</p>
</div>
</li>
<li>
<p>context</p>
</li>
<li>
<p>list</p>
</li>
<li>
<p>range</p>
</li>
<li>
<p>function</p>
</li>
<li>
<p>unary test</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Support for unary tests</em>: For completeness and orthogonality, unary tests are supported
as first class citizens in the language. They are functions with an implicit single
parameter and can be invoked in the same way as functions. For example,</p>
<div class="listingblock">
<div class="title">UnaryTestAsFunction.feel</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  {
      is minor : &lt; 18,
      Bob is minor : is minor( bob.age )
  }</code></pre>
</div>
</div>
</li>
<li>
<p><em>Support for additional built-in functions</em>: The following additional functions are supported:</p>
<div class="ulist">
<ul>
<li>
<p><code>now()</code> : Returns the current local date and time.</p>
</li>
<li>
<p><code>today()</code> : Returns the current local date.</p>
</li>
<li>
<p><code>decision table()</code> : Returns a decision table function, although the specification mentions a decision table.
The function on page 114 is not implementable as defined.</p>
</li>
<li>
<p><code>string( mask, p&#8230;&#8203; )</code> : Returns a string formatted as per the mask. See Java String.format() for
details on the mask syntax. For example, <code>string( "%4.2f", 7.1298 )</code> returns the string <code>"7.12"</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>Support for additional date and time arithmetics</em>: Subtracting two dates returns a day and time duration with the number of days between the two
dates, ignoring daylight savings. For example,</p>
<div class="listingblock">
<div class="title">DateArithmetic.feel</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">date( "2017-05-12" ) - date( "2017-04-25" ) = duration( "P17D" )</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-model-enhancements_kogito-dmn-models"><a class="anchor" href="#ref-dmn-model-enhancements_kogito-dmn-models"></a><a class="link" href="#ref-dmn-model-enhancements_kogito-dmn-models">2.1.3.3. DMN model enhancements in Kogito</a></h5>
<div class="paragraph _abstract">
<p>Kogito includes the following enhancements to DMN model support in the current DMN implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Support for types with spaces on names</em>: The DMN XML schema defines type refs such as QNames. The QNames do not allow spaces. Therefore, it is not possible to use types like FEEL <code>date and time</code>,   <code>days and time duration</code> or <code>years and months duration</code>. This implementation does parse such typerefs as strings and allows type names with spaces. However, in order to comply with the XML schema, it also adds the following aliases to such types that can be used instead:</p>
<div class="ulist">
<ul>
<li>
<p><code>date and time</code> = <code>dateTime</code></p>
</li>
<li>
<p><code>days and time duration</code> = <code>duration</code> or <code>dayTimeDuration</code></p>
</li>
<li>
<p><code>years and months duration</code> = <code>duration</code> or <code>yearMonthDuration</code></p>
<div class="paragraph">
<p>Note that, for the "duration" types, the user can simply use <code>duration</code> and the decision engine will infer the proper duration, either <code>days and time duration</code> or <code>years and months duration</code>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><em>Lists support heterogeneous element types</em>: Currently this implementation supports lists with heterogeneous element types. This is an experimental extension and does limit the functionality of some functions and filters. This decision will be re-evaluated in the future.</p>
</li>
<li>
<p><em>TypeRef link between Decision Tables and Item Definitions</em>: On decision tables/input clause, if no values list is defined, the decision engine automatically checks the type reference and applies the allowed values check if it is defined.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-dmn-model-creating_kogito-dmn-models"><a class="anchor" href="#proc-dmn-model-creating_kogito-dmn-models"></a><a class="link" href="#proc-dmn-model-creating_kogito-dmn-models">2.1.4. Creating and editing DMN models in the Kogito DMN modeler</a></h4>
<div class="paragraph _abstract">
<p>You can use the Kogito DMN modeler in VSCode to design DMN decision requirements diagrams (DRDs) and define decision logic for a complete and functional DMN decision model. Kogito provides design support for DMN 1.2 models at conformance level 3, and includes enhancements and fixes to FEEL and DMN model components to optimize the experience of implementing DMN decision services with Kogito.
Kogito provides runtime support for DMN 1.1, 1.2, 1.3, 1.4 and 1.5 models at conformance level 3 and design support for DMN 1.2 (Classic DMN Editor) and 1.5 models (New DMN Editor) at conformance level 3.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a>  is installed.</p>
</li>
<li>
<p>The <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension is installed and enabled in your VSCode IDE. For information about enabling the VSCode extension, see <a href="https://kie.apache.org/kogito-docs/#proc-kogito-vscode-extension_kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</li>
<li>
<p>You have created a Kogito project and have included any Java objects required for your Kogito service. For information about creating a project, see <a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, create or import a DMN file in the relevant folder of your Kogito project, typically in <code>src/main/resources</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you finish creating your decision model, you can click <strong>Download</strong> in the <strong>Apache KIE™ Sandbox</strong> page to import your DMN file into your Kogito project.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Open the new or imported DMN file to view the decision requirements diagram (DRD) in the Kogito DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the Kogito DMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>Begin adding components to your new or imported DRD by clicking and dragging one of the DMN nodes from the left toolbar:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drag-decision-node.png" alt="dmn drag decision node">
</div>
<div class="title">Figure 41. Adding DRD components</div>
</div>
<div class="paragraph">
<p>The following DRD components are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Decision</strong>: Use this node for a DMN decision, where one or more input elements determine an output based on defined decision logic.</p>
</li>
<li>
<p><strong>Business knowledge model</strong>: Use this node for reusable functions with one or more decision elements. Decisions that have the same logic but depend on different sub-input data or sub-decisions use business knowledge models to determine which procedure to follow.</p>
</li>
<li>
<p><strong>Knowledge source</strong>: Use this node for external authorities, documents, committees, or policies that regulate a decision or business knowledge model. Knowledge sources are references to real-world factors rather than executable business rules.</p>
</li>
<li>
<p><strong>Input data</strong>: Use this node for information used in a decision node or a business knowledge model. Input data usually includes business-level concepts or objects relevant to the business, such as loan applicant data used in a lending strategy.</p>
</li>
<li>
<p><strong>Text annotation</strong>: Use this node for explanatory notes associated with an input data node, decision node, business knowledge model, or knowledge source.</p>
</li>
<li>
<p><strong>Decision service</strong>: Use this node to enclose a set of reusable decisions implemented as a decision service for invocation. A decision service can be used in other DMN models and can be invoked from an external application or a BPMN business process.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler canvas, double-click the new DRD node to enter an informative node name.</p>
</li>
<li>
<p>If the node is a decision or business knowledge model, select the node to display the node options and click the <strong>Edit</strong> icon to open the DMN boxed expression editor to define the decision logic for the node:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-edit.png" alt="dmn decision edit">
</div>
<div class="title">Figure 42. Opening a new decision node boxed expression</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-edit.png" alt="dmn bkm edit">
</div>
<div class="title">Figure 43. Opening a new business knowledge model boxed expression</div>
</div>
<div class="paragraph">
<p>By default, all business knowledge models are defined as boxed function expressions containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type.</p>
</div>
<div class="paragraph">
<p>For decision nodes, you click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options">
</div>
<div class="title">Figure 44. Selecting the logic type for a decision node</div>
</div>
<div class="paragraph">
<p>For business knowledge models, you click the upper-left function cell to select the function type, or right-click the function value cell, select <strong>Clear</strong>, and select a boxed expression of another type.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-define.png" alt="dmn bkm define">
</div>
<div class="title">Figure 45. Selecting the function or other logic type for a business knowledge model</div>
</div>
</div>
</div>
</li>
<li>
<p>In the selected boxed expression editor for either a decision node (any expression type) or business knowledge model (function expression), click the applicable table cells to define the table name, variable data types, variable names and values, function parameters and bindings, or FEEL expressions to include in the decision logic.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can right-click cells for additional actions where applicable, such as inserting or removing table rows and columns or clearing table contents.</p>
</div>
<div class="paragraph">
<p>The following is an example decision table for a decision node that determines credit score ratings based on a defined range of a loan applicant&#8217;s credit score:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a">
</div>
<div class="title">Figure 46. Decision node decision table for credit score rating</div>
</div>
<div class="paragraph">
<p>The following is an example boxed function expression for a business knowledge model that calculates mortgage payments based on principal, interest, taxes, and insurance (PITI) as a literal expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-function-expression-example4.png" alt="dmn function expression example4">
</div>
<div class="title">Figure 47. Business knowledge model function for PITI calculation</div>
</div>
</div>
</div>
</li>
<li>
<p>After you define the decision logic for the selected node, click <strong>Back to <em>MODEL_NAME</em></strong> to return to the DRD view.</p>
</li>
<li>
<p>For the selected DRD node, use the available connection options to create and connect to the next node in the DRD, or click and drag a new node onto the DRD canvas from the left toolbar.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The node type determines which connection options are supported. For example, an <strong>Input data</strong> node can connect to a decision node, knowledge source, or text annotation using the applicable connection type, whereas a <strong>Knowledge source</strong> node can connect to any DRD element. A <strong>Decision</strong> node can connect only to another decision or a text annotation.</p>
</div>
<div class="paragraph">
<p>The following connection types are available, depending on the node type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Information requirement</strong>: Use this connection from an input data node or decision node to another decision node that requires the information.</p>
</li>
<li>
<p><strong>Knowledge requirement</strong>: Use this connection from a business knowledge model to a decision node or to another business knowledge model that invokes the decision logic.</p>
</li>
<li>
<p><strong>Authority requirement</strong>: Use this connection from an input data node or a decision node to a dependent knowledge source or from a knowledge source to a decision node, business knowledge model, or another knowledge source.</p>
</li>
<li>
<p><strong>Association</strong>: Use this connection from an input data node, decision node, business knowledge model, or knowledge source to a text annotation.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-input-connection-example.png" alt="dmn input connection example">
</div>
<div class="title">Figure 48. Connecting credit score input to the credit score rating decision</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-input-connection-example2.png" alt="dmn input connection example2">
</div>
</div>
</div>
</div>
</li>
<li>
<p>Continue adding and defining the remaining DRD components of your decision model and save the completed DRD.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following is an example DRD for a loan prequalification decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-example-drd.png" alt="dmn example drd">
</div>
<div class="title">Figure 49. Completed DRD for loan prequalification</div>
</div>
<div class="paragraph">
<p>The following is an example DRD for a phone call handling decision model using a reusable decision service:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-example-drd3.png" alt="dmn example drd3" width="90%">
</div>
<div class="title">Figure 50. Completed DRD for phone call handling with a decision service</div>
</div>
<div class="paragraph">
<p>In a DMN decision service node, the decision nodes in the bottom segment incorporate input data from outside of the decision service to arrive at a final decision in the top segment of the decision service node. The resulting top-level decisions from the decision service are then implemented in any subsequent decisions or business knowledge requirements of the DMN model. You can reuse DMN decision services in other DMN models to apply the same decision logic with different input data and different outgoing connections.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="proc-dmn-logic-defining_kogito-dmn-models"><a class="anchor" href="#proc-dmn-logic-defining_kogito-dmn-models"></a><a class="link" href="#proc-dmn-logic-defining_kogito-dmn-models">2.1.4.1. Defining DMN decision logic in boxed expressions in the Kogito DMN modeler</a></h5>
<div class="paragraph _abstract">
<p>Boxed expressions in DMN are tables that you use to define the underlying logic of decision nodes and business knowledge models in a decision requirements diagram (DRD). Some boxed expressions can contain other boxed expressions, but the top-level boxed expression corresponds to the decision logic of a single DRD artifact. While DRDs represent the flow of a DMN decision model, boxed expressions define the actual decision logic of individual nodes. DRDs and boxed expressions together form a complete and functional DMN decision model.</p>
</div>
<div class="paragraph">
<p>You can use the Kogito DMN modeler in VSCode to define decision logic for your DRD components using built-in boxed expressions.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A DMN file is created or imported in your Kogito project in VSCode.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the Kogito DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the Kogito DMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler canvas, select a decision node or business knowledge model node that you want to define and click the <strong>Edit</strong> icon to open the DMN boxed expression editor:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-edit.png" alt="dmn decision edit">
</div>
<div class="title">Figure 51. Opening a new decision node boxed expression</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-edit.png" alt="dmn bkm edit">
</div>
<div class="title">Figure 52. Opening a new business knowledge model boxed expression</div>
</div>
<div class="paragraph">
<p>By default, all business knowledge models are defined as boxed function expressions containing a literal FEEL expression, a nested context expression of an external JAVA or PMML function, or a nested boxed expression of any type.</p>
</div>
<div class="paragraph">
<p>For decision nodes, you click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options">
</div>
<div class="title">Figure 53. Selecting the logic type for a decision node</div>
</div>
<div class="paragraph">
<p>For business knowledge model nodes, you click the upper-left function cell to select the function type, or right-click the function value cell, select <strong>Clear</strong>, and select a boxed expression of another type.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-define.png" alt="dmn bkm define">
</div>
<div class="title">Figure 54. Selecting the function or other logic type for a business knowledge model</div>
</div>
</div>
</div>
</li>
<li>
<p>For this example, use a decision node and select <strong>Decision Table</strong> as the boxed expression type.</p>
<div class="paragraph">
<p>A decision table in DMN is a visual representation of one or more rules in a tabular format. Each rule consists of a single row in the table, and includes columns that define the conditions (input) and outcome (output) for that particular row.</p>
</div>
</li>
<li>
<p>Click the input column header to define the name and data type for the input condition. For example, name the input column <strong>Credit Score.FICO</strong> with a <code>number</code> data type. This column specifies numeric credit score values or ranges of loan applicants.</p>
</li>
<li>
<p>Click the output column header to define the name and data type for the output values. For example, name the output column <strong>Credit Score Rating</strong> and next to the <strong>Data Type</strong> option, click <strong>Manage</strong> to go to the <strong>Data Types</strong> page where you can create a custom data type with score ratings as constraints.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types.png" alt="dmn manage data types">
</div>
<div class="title">Figure 55. Managing data types for a column header value</div>
</div>
</li>
<li>
<p>On the <strong>Data Types</strong> page, click <strong>New Data Type</strong> to add a new data type.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For this example, click <strong>New Data Type</strong> and create a <strong>Credit_Score_Rating</strong> data type as a <code>string</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-custom-data-type-add.png" alt="dmn custom data type add">
</div>
<div class="title">Figure 56. Adding a new data type</div>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>Add Constraints</strong>, select <strong>Enumeration</strong> from the drop-down options, and add the following constraints:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>"Excellent"</code></p>
</li>
<li>
<p><code>"Good"</code></p>
</li>
<li>
<p><code>"Fair"</code></p>
</li>
<li>
<p><code>"Poor"</code></p>
</li>
<li>
<p><code>"Bad"</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-custom-data-type-constraints.png" alt="dmn custom data type constraints">
</div>
<div class="title">Figure 57. Adding constraints to the new data type</div>
</div>
<div class="paragraph">
<p>To change the order of data type constraints, you can click the left end of the constraint row and drag the row as needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-custom-data-type-constraints-drag.png" alt="dmn custom data type constraints drag">
</div>
<div class="title">Figure 58. Dragging constraints to change constraint order</div>
</div>
<div class="paragraph">
<p>For information about constraint types and syntax requirements for the specified data type, see the <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the constraints and click the check mark to the right of the data type to save the data type.</p>
</li>
<li>
<p>Return to the <strong>Credit Score Rating</strong> decision table, click the <strong>Credit Score Rating</strong> column header, and set the data type to this new custom data type.</p>
</li>
<li>
<p>Use the <strong>Credit Score.FICO</strong> input column to define credit score values or ranges of values, and use the <strong>Credit Score Rating</strong> column to specify one of the corresponding ratings you defined in the <strong>Credit_Score_Rating</strong> data type.</p>
<div class="paragraph">
<p>Right-click any value cell to insert or delete rows (rules) or columns (clauses).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a">
</div>
<div class="title">Figure 59. Decision node decision table for credit score rating</div>
</div>
</li>
<li>
<p>After you define all rules, click the upper-left corner of the decision table to define the rule <strong>Hit Policy</strong> and <strong>Builtin Aggregator</strong> (for <strong>COLLECT</strong> hit policy only).</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The hit policy determines how to reach an outcome when multiple rules in a decision table match the provided input values. The built-in aggregator determines how to aggregate rule values when you use the <strong>COLLECT</strong> hit policy.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-hit-policies.png" alt="dmn hit policies">
</div>
<div class="title">Figure 60. Defining the decision table hit policy</div>
</div>
<div class="paragraph">
<p>The following example is a more complex decision table that determines applicant qualification for a loan as the concluding decision node in the same loan prequalification decision model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3">
</div>
<div class="title">Figure 61. Decision table for loan prequalification</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For boxed expression types other than decision tables, you follow these guidelines similarly to navigate the boxed expression tables and define variables and parameters for decision logic, but according to the requirements of the boxed expression type. Some boxed expressions, such as boxed literal expressions, can be single-column tables, while other boxed expressions, such as function, context, and invocation expressions, can be multi-column tables with nested boxed expressions of other types.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed context expression defines the parameters that determine whether a loan applicant can meet minimum mortgage payments based on principal, interest, taxes, and insurance (PITI), represented as a front-end ratio calculation with a sub-context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-context-expression-example2.png" alt="dmn context expression example2">
</div>
<div class="title">Figure 62. Boxed context expression for front-end client PITI ratio</div>
</div>
<div class="paragraph">
<p>The following boxed function expression determines a monthly mortgage installment as a business knowledge model in a lending decision, with the function value defined as a nested context expression:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-function-expression-example3.png" alt="dmn function expression example3">
</div>
<div class="title">Figure 63. Boxed function expression for installment calculation in business knowledge model</div>
</div>
<div class="paragraph">
<p>For more information and examples of each boxed expression type, see <a href="#con-dmn-boxed-expressions_kogito-dmn-models">DMN decision logic in boxed expressions</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="proc-dmn-data-types-defining_kogito-dmn-models"><a class="anchor" href="#proc-dmn-data-types-defining_kogito-dmn-models"></a><a class="link" href="#proc-dmn-data-types-defining_kogito-dmn-models">2.1.4.2. Creating custom data types for DMN boxed expressions in the Kogito DMN modeler</a></h5>
<div class="paragraph _abstract">
<p>In DMN boxed expressions in the Kogito DMN modeler, data types determine the structure of the data that you use within an associated table, column, or field in the boxed expression. You can use default DMN data types (such as String, Number, Boolean) or you can create custom data types to specify additional fields and constraints that you want to implement for the boxed expression values.</p>
</div>
<div class="paragraph">
<p>Custom data types that you create for a boxed expression can be simple or structured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Simple</strong> data types have only a name and a type assignment. Example: <code>Age (number)</code>.</p>
</li>
<li>
<p><strong>Structured</strong> data types contain multiple fields associated with a parent data type. Example: A single type <code>Person</code> containing the fields <code>Name (string)</code>, <code>Age (number)</code>, <code>Email (string)</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A DMN file is created or imported in your Kogito project in VSCode.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the Kogito DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the Kogito DMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler canvas, select a decision node or business knowledge model for which you want to define the data types and click the <strong>Edit</strong> icon to open the DMN boxed expression editor.</p>
</li>
<li>
<p>If the boxed expression is for a decision node that is not yet defined, click the undefined table to select the type of boxed expression you want to use, such as a boxed literal expression, boxed context expression, decision table, or other DMN boxed expression.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-boxed-expression-options.png" alt="dmn decision boxed expression options">
</div>
<div class="title">Figure 64. Selecting the logic type for a decision node</div>
</div>
</li>
<li>
<p>Click the cell for the table header, column header, or parameter field (depending on the boxed expression type) for which you want to define the data type and click <strong>Manage</strong> to go to the <strong>Data Types</strong> page where you can create a custom data type.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types.png" alt="dmn manage data types">
</div>
<div class="title">Figure 65. Managing data types for a column header value</div>
</div>
<div class="paragraph">
<p>You can also set and manage custom data types for a specified decision node or business knowledge model node by selecting the <strong>Properties</strong> icon in the upper-right corner of the DMN modeler:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types1a.png" alt="dmn manage data types1a">
</div>
<div class="title">Figure 66. Managing data types in decision requirements diagram (DRD) properties</div>
</div>
<div class="paragraph">
<p>The data type that you define for a specified cell in a boxed expression determines the structure of the data that you use within that associated table, column, or field in the boxed expression.</p>
</div>
<div class="paragraph">
<p>In this example, an output column <strong>Credit Score Rating</strong> for a DMN decision table defines a set of custom credit score ratings based on an applicant&#8217;s credit score.</p>
</div>
</div>
</div>
</li>
<li>
<p>On the <strong>Data Types</strong> page, click <strong>New Data Type</strong> to add a new data type.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For this example, click <strong>New Data Type</strong> and create a <strong>Credit_Score_Rating</strong> data type as a <code>string</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-custom-data-type-add.png" alt="dmn custom data type add">
</div>
<div class="title">Figure 67. Adding a new data type</div>
</div>
<div class="paragraph">
<p>If the data type requires a list of items, enable the <strong>List</strong> setting.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>Add Constraints</strong>, select <strong>Enumeration</strong> from the drop-down options, and add the following constraints:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>"Excellent"</code></p>
</li>
<li>
<p><code>"Good"</code></p>
</li>
<li>
<p><code>"Fair"</code></p>
</li>
<li>
<p><code>"Poor"</code></p>
</li>
<li>
<p><code>"Bad"</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-custom-data-type-constraints.png" alt="dmn custom data type constraints">
</div>
<div class="title">Figure 68. Adding constraints to the new data type</div>
</div>
<div class="paragraph">
<p>To change the order of data type constraints, you can click the left end of the constraint row and drag the row as needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-custom-data-type-constraints-drag.png" alt="dmn custom data type constraints drag">
</div>
<div class="title">Figure 69. Dragging constraints to change constraint order</div>
</div>
<div class="paragraph">
<p>For information about constraint types and syntax requirements for the specified data type, see the <a href="https://www.omg.org/spec/DMN">Decision Model and Notation specification</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the constraints and click the check mark to the right of the data type to save the data type.</p>
</li>
<li>
<p>Return to the <strong>Credit Score Rating</strong> decision table, click the <strong>Credit Score Rating</strong> column header, set the data type to this new custom data type, and define the rule values for that column with the rating constraints that you specified.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example1a.png" alt="dmn decision table example1a">
</div>
<div class="title">Figure 70. Decision table for credit score rating</div>
</div>
<div class="paragraph">
<p>In the DMN decision model for this scenario, the <strong>Credit Score Rating</strong> decision flows into the following <strong>Loan Prequalification</strong> decision that also requires custom data types:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-blank.png" alt="dmn manage data types blank">
</div>
<div class="title">Figure 71. Decision table for loan prequalification</div>
</div>
</div>
</div>
</li>
<li>
<p>Continuing with this example, return to the <strong>Data Types</strong> window, click <strong>New Data Type</strong>, and create a <strong>Loan_Qualification</strong> data type as a <code>Structure</code> with no constraints.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When you save the new structured data type, the first sub-field appears so that you can begin defining nested data fields in this parent data type. You can use these sub-fields in association with the parent structured data type in boxed expressions, such as nested column headers in decision tables or nested table parameters in context or function expressions.</p>
</div>
<div class="paragraph">
<p>For additional sub-fields, select the addition icon next to the <strong>Loan_Qualification</strong> data type:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-structured.png" alt="dmn manage data types structured">
</div>
<div class="title">Figure 72. Adding a new structured data type with nested fields</div>
</div>
</div>
</div>
</li>
<li>
<p>For this example, under the structured <strong>Loan_Qualification</strong> data type, add a <strong>Qualification</strong> field with <code>"Qualified"</code> and <code>"Not Qualified"</code> enumeration constraints, and a <strong>Reason</strong> field with no constraints. Add also a simple <strong>Back_End_Ratio</strong> and a <strong>Front_End_Ratio</strong> data type, both with <code>"Sufficient"</code> and <code>"Insufficient"</code> enumeration constraints.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Click the check mark to the right of each data type that you create to save your changes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-structured2.png" alt="dmn manage data types structured2">
</div>
<div class="title">Figure 73. Adding nested data types with constraints</div>
</div>
<div class="paragraph">
<p>To change the order or nesting of data types, you can click the left end of the data type row and drag the row as needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-structured2-drag.png" alt="dmn manage data types structured2 drag">
</div>
<div class="title">Figure 74. Dragging data types to change data type order or nesting</div>
</div>
</div>
</div>
</li>
<li>
<p>Return to the decision table and, for each column, click the column header cell, set the data type to the new corresponding custom data type, and define the rule values as needed for the column with the constraints that you specified, if applicable.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-table-example3.png" alt="dmn decision table example3">
</div>
<div class="title">Figure 75. Decision table for loan prequalification</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For boxed expression types other than decision tables, you follow these guidelines similarly to navigate the boxed expression tables and define custom data types as needed.</p>
</div>
<div class="paragraph">
<p>For example, the following boxed function expression uses custom <code>tCandidate</code> and <code>tProfile</code> structured data types to associate data for online dating compatibility:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-structured3.png" alt="dmn manage data types structured3">
</div>
<div class="title">Figure 76. Boxed function expression for online dating compatibility</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-structured3a.png" alt="dmn manage data types structured3a">
</div>
<div class="title">Figure 77. Custom data type definitions for online dating compatibility</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-manage-data-types-structured3b.png" alt="dmn manage data types structured3b">
</div>
<div class="title">Figure 78. Parameter definitions with custom data types for online dating compatibility</div>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-included-models_kogito-dmn-models"><a class="anchor" href="#con-dmn-included-models_kogito-dmn-models"></a><a class="link" href="#con-dmn-included-models_kogito-dmn-models">2.1.4.3. Included models in DMN files in the Kogito VSCode DMN modeler</a></h5>
<div class="paragraph _abstract">
<p>In the Kogito DMN modeler in VSCode, you can use the <strong>Included Models</strong> tab to include other DMN models and Predictive Model Markup Language (PMML) models from your project in a specified DMN file. When you include a DMN model within another DMN file, you can use all of the nodes and logic from both models in the same decision requirements diagram (DRD). When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node.</p>
</div>
<div class="paragraph">
<p>You cannot include DMN or PMML models from different directories within your Kogito project or from other Kogito projects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Included models are not supported in the <strong>Apache KIE™ BPMN, DMN &amp; Test Scenario Editors for GitHub Chrome extension</strong> and <strong>BPMN and DMN Standalone Editors</strong>.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="proc-dmn-included-models-dmn_kogito-dmn-models"><a class="anchor" href="#proc-dmn-included-models-dmn_kogito-dmn-models"></a><a class="link" href="#proc-dmn-included-models-dmn_kogito-dmn-models">Including other DMN models within a DMN file in the Kogito VSCode DMN modeler</a></h6>
<div class="paragraph _abstract">
<p>In the Kogito DMN modeler in VSCode, you can include other DMN models from the same directory of your Kogito project in a specified DMN file. When you include a DMN model within another DMN file, you can use all of the nodes and logic from both models in the same decision requirements diagram (DRD), but you cannot edit the nodes from the included model. To edit nodes from included models, you must update the source file for the included model directly. If you update the source file for an included DMN model, open the DMN file where the DMN model is included (or close and re-open) to verify the changes.</p>
</div>
<div class="paragraph">
<p>You cannot include DMN models from different directories within your Kogito project or from other Kogito projects.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The DMN models are created or imported (as <code>.dmn</code> files) in the same directory of your Kogito project as the DMN file in which you want to include the models, such as in <code>src/main/resources</code>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the Kogito DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the Kogito DMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler, click the <strong>Included Models</strong> tab.</p>
</li>
<li>
<p>Click <strong>Include Model</strong>, select a DMN model from your directory in the <strong>Models</strong> list, enter a unique name for the included model, and click <strong>Include</strong>:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model.png" alt="dmn include model">
</div>
<div class="title">Figure 79. Including a DMN model</div>
</div>
<div class="paragraph">
<p>The DMN model is added to this DMN file, and all DRD nodes from the included model are listed under <strong>Decision Components</strong> in the <strong>Decision Navigator</strong> view:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model-list.png" alt="dmn include model list">
</div>
<div class="title">Figure 80. DMN file with decision components from the included DMN model</div>
</div>
<div class="paragraph">
<p>All data types from the included model are also listed in read-only mode in the <strong>Data Types</strong> tab for the DMN file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model-data-types.png" alt="dmn include model data types">
</div>
<div class="title">Figure 81. DMN file with data types from the included DMN model</div>
</div>
</div>
</div>
</li>
<li>
<p>In the <strong>Editor</strong> tab of the DMN modeler, click and drag the included DRD components onto the canvas to begin implementing them in your DRD:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model-drd.png" alt="dmn include model drd">
</div>
<div class="title">Figure 82. Adding DRD components from the included DMN model</div>
</div>
<div class="paragraph">
<p>To edit DRD nodes or data types from included models, you must update the source file for the included model directly. If you update the source file for an included DMN model, open the DMN file where the DMN model is included (or close and re-open) to verify the changes.</p>
</div>
<div class="paragraph">
<p>To edit the included model name or to remove the included model from the DMN file, use the <strong>Included Models</strong> tab in the DMN modeler.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you remove an included model, any nodes from that included model that are currently used in the DRD are also removed.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="proc-dmn-included-models-pmml_kogito-dmn-models"><a class="anchor" href="#proc-dmn-included-models-pmml_kogito-dmn-models"></a><a class="link" href="#proc-dmn-included-models-pmml_kogito-dmn-models">Including PMML models within a DMN file in the Kogito VSCode DMN modeler</a></h6>
<div class="paragraph _abstract">
<p>In the Kogito DMN modeler in VSCode, you can include Predictive Model Markup Language (PMML) models from your project in a specified DMN file. When you include a PMML model within a DMN file, you can invoke that PMML model as a boxed function expression for a DMN decision node or business knowledge model node. If you update the source file for an included PMML model, you must remove and re-include the PMML model in the DMN file to apply the source changes.</p>
</div>
<div class="paragraph">
<p>You cannot include PMML models from different directories within your Kogito project or from other Kogito projects.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The PMML models are created or imported (as <code>.pmml</code> files) in the same directory of your Kogito project as the DMN file in which you want to include the models, such as in <code>src/main/resources</code>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the DMN file to view the decision requirements diagram (DRD) in the Kogito DMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the Kogito DMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN modeler, click the <strong>Included Models</strong> tab.</p>
</li>
<li>
<p>Click <strong>Include Model</strong>, select a PMML model from your directory in the <strong>Models</strong> list, enter a unique name for the included model, and click <strong>Include</strong>:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model-pmml.png" alt="dmn include model pmml">
</div>
<div class="title">Figure 83. Including a PMML model</div>
</div>
<div class="paragraph">
<p>The PMML model is added to this DMN file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model-list-pmml.png" alt="dmn include model list pmml">
</div>
<div class="title">Figure 84. DMN file with included PMML model</div>
</div>
</div>
</div>
</li>
<li>
<p>In the <strong>Editor</strong> tab of the DMN modeler, select or create the decision node or business knowledge model node in which you want to invoke the PMML model and click the <strong>Edit</strong> icon to open the DMN boxed expression editor:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-edit.png" alt="dmn decision edit">
</div>
<div class="title">Figure 85. Opening a new decision node boxed expression</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-bkm-edit.png" alt="dmn bkm edit">
</div>
<div class="title">Figure 86. Opening a new business knowledge model boxed expression</div>
</div>
</div>
</div>
</li>
<li>
<p>Set the expression type to <strong>Function</strong> (default for business knowledge model nodes), click the upper-left function cell, and select <strong>PMML</strong>.</p>
</li>
<li>
<p>In the <strong>document</strong> and <strong>model</strong> rows in the table, double-click the undefined cells to specify the included PMML document and the relevant PMML model within that document:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-include-model-expression-pmml.png" alt="dmn include model expression pmml">
</div>
<div class="title">Figure 87. Adding a PMML model in a DMN business knowledge model</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-function-expression-example5.png" alt="dmn function expression example5">
</div>
<div class="title">Figure 88. Example PMML definition in a DMN business knowledge model</div>
</div>
<div class="paragraph">
<p>If you update the source file for an included PMML model, you must remove and re-include the PMML model in the DMN file to apply the source changes.</p>
</div>
<div class="paragraph">
<p>To edit the included model name or to remove the included model from the DMN file, use the <strong>Included Models</strong> tab in the DMN modeler.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="proc-dmn-model-creating-multiples_kogito-dmn-models"><a class="anchor" href="#proc-dmn-model-creating-multiples_kogito-dmn-models"></a><a class="link" href="#proc-dmn-model-creating-multiples_kogito-dmn-models">2.1.4.4. Creating DMN models with multiple diagrams in the Kogito DMN modeler</a></h5>
<div class="paragraph _abstract">
<p>For complex DMN models, you can use the Kogito DMN modeler in VSCode to design multiple DMN decision requirements diagrams (DRDs) that represent parts of the overall decision requirements graph (DRG) for the DMN decision model. In simple cases, you can use a single DRD to represent all of the overall DRG for the decision model, but in complex cases, a single DRD can become large and difficult to follow. Therefore, to better organize DMN decision models with many decision requirements, you can divide the model into smaller nested DRDs that constitute the larger central DRD representation of the overall DRG.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You understand how to design DRDs in the Kogito DMN modeler. For information about creating DRDs, see <a href="#proc-dmn-model-creating_kogito-dmn-models">Creating and editing DMN models in the Kogito DMN modeler</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, create or import a DMN file in the relevant folder of your Kogito project, typically in <code>src/main/resources</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you finish creating your decision model, you can click <strong>Download</strong> in the <strong>Apache KIE™ Sandbox</strong> page to import your DMN file into your Kogito project.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Open the new or imported DMN file to view the DRD in the Kogito DMN modeler, and begin designing or modifying the DRD using the DMN nodes in the left toolbar.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the DRD does not open in the Kogito DMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito DMN modeler opens only the XML source of the DMN file and displays an error message, review the reported errors and the DMN model file to ensure that all DMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>For any DMN nodes that you want to define in a separate nested DRD, select the node, click the <strong>DRD Actions</strong> icon, and select from the available options.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-actions.png" alt="dmn drd actions">
</div>
<div class="title">Figure 89. DRD actions icon for subdividing a DRD</div>
</div>
<div class="paragraph">
<p>The following options are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Create</strong>: Use this option to create a nested DRD where you can separately define the DMN components and diagram for the selected node.</p>
</li>
<li>
<p><strong>Add to</strong>: If you already created a nested DRD, use this option to add the selected node to an existing DRD.</p>
</li>
<li>
<p><strong>Remove</strong>: If the node that you selected is already within a nested DRD, use this option to remove the node from that nested DRD.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you create a nested DRD within your DMN decision model, the new DRD opens in a separate DRD canvas and the available DRD and components are listed in the <strong>Decision Navigator</strong> right menu. You can use the <strong>Decision Navigator</strong> menu to rename or remove a nested DRD.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-actions-rename.png" alt="dmn drd actions rename">
</div>
<div class="title">Figure 90. Rename new nested DRD in the Decision Navigator menu</div>
</div>
</div>
</div>
</li>
<li>
<p>In the separate canvas for the new nested DRD, design the flow and logic for all required components in this portion of the DMN model, as usual.</p>
</li>
<li>
<p>Continue adding and defining any other nested DRDs for your decision model and save the completed DMN file.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example, the following DRD for a loan prequalification decision model contains all DMN components for the model without any nested DRDs. This example relies on the single DRD for all components and logic, resulting in a large and complex diagram.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-example-drd.png" alt="dmn example drd">
</div>
<div class="title">Figure 91. Single DRD for loan prequalification</div>
</div>
<div class="paragraph">
<p>Alternatively, by following the steps in this procedure, you can divide this example DRD into multiple nested DRDs to better organize the decision requirements, as shown in the following example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple.png" alt="dmn drd multiple">
</div>
<div class="title">Figure 92. Multiple nested DRDs for loan prequalification</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple-front-end.png" alt="dmn drd multiple front end">
</div>
<div class="title">Figure 93. Overview of front end ratio DRD</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple-front-end-details.png" alt="dmn drd multiple front end details">
</div>
<div class="title">Figure 94. DRD for front end ratio</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple-credit-score.png" alt="dmn drd multiple credit score">
</div>
<div class="title">Figure 95. Overview of credit score rating DRD</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple-credit-score-details.png" alt="dmn drd multiple credit score details">
</div>
<div class="title">Figure 96. DRD for credit score rating</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple-back-end.png" alt="dmn drd multiple back end">
</div>
<div class="title">Figure 97. Overview of back end ratio DRD</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-drd-multiple-back-end-details.png" alt="dmn drd multiple back end details">
</div>
<div class="title">Figure 98. DRD for back end ratio</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="con-dmn-documentation_kogito-dmn-models"><a class="anchor" href="#con-dmn-documentation_kogito-dmn-models"></a><a class="link" href="#con-dmn-documentation_kogito-dmn-models">2.1.4.5. DMN model documentation in the Kogito DMN modeler</a></h5>
<div class="paragraph _abstract">
<p>In the Kogito DMN modeler, you can use the <strong>Documentation</strong> tab to generate a report of your DMN model. The DMN model report contains all decision requirements diagrams (DRDs), data types, and boxed expressions in your DMN model. You can use this report to share your DMN model details or as part of your internal reporting workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-documentation.png" alt="dmn documentation">
</div>
<div class="title">Figure 99. Example DMN model report</div>
</div>
</div>
<div class="sect4">
<h5 id="ref-dmn-designer-nav_kogito-dmn-models"><a class="anchor" href="#ref-dmn-designer-nav_kogito-dmn-models"></a><a class="link" href="#ref-dmn-designer-nav_kogito-dmn-models">2.1.4.6. Kogito DMN modeler navigation and properties</a></h5>
<div class="paragraph _abstract">
<p>The Kogito DMN modeler provides the following additional features to help you navigate through the components and properties of decision requirements diagrams (DRDs).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">DMN decision and diagram views</dt>
<dd>
<p>In the upper-right corner of the DMN modeler, select the <strong>Decision Navigator</strong> view to navigate between the decision components, graphs, and boxed expressions of a selected DRD:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-designer-nav-view.png" alt="dmn designer nav view">
</div>
<div class="title">Figure 100. Decision Navigator view</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-designer-nav-view2.png" alt="dmn designer nav view2">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The DRD components from any DMN models included in the DMN file (in the <strong>Included Models</strong> tab) are also listed in the <strong>Decision Components</strong> panel for the DMN file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the upper-right corner of the DMN modeler, select the <strong>Preview</strong> icon to view an elevated preview of the DRD:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-designer-preview.png" alt="dmn designer preview">
</div>
<div class="title">Figure 101. Diagram preview</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">DRD properties and design</dt>
<dd>
<p>In the upper-right corner of the DMN modeler, select the <strong>Properties</strong> icon to modify the identifying information, data types, and appearance of a selected DRD, DRD node, or boxed expression cell:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-designer-properties.png" alt="dmn designer properties">
</div>
<div class="title">Figure 102. DRD node properties</div>
</div>
<div class="paragraph">
<p>To view the properties of the entire DRD, click the DRD canvas background instead of a specific node.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">DRD search</dt>
<dd>
<p>In the upper-right corner of the DMN modeler, use the search bar to search for text that appears in your DRD. The search feature is especially helpful in complex DRDs with many nodes:</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-designer-search.png" alt="dmn designer search">
</div>
<div class="title">Figure 103. DRD search</div>
</div>
</dd>
<dt class="hdlist1">DMN decision service details</dt>
<dd>
<p>Select a decision service node in the DMN designer to view additional properties, including <strong>Input Data</strong>, <strong>Encapsulated Decisions</strong>, and <strong>Output Decisions</strong> in the <strong>Properties</strong> panel.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-decision-service-details.png" alt="dmn decision service details">
</div>
<div class="title">Figure 104. Decision Service details</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-service-execution_kogito-dmn-models"><a class="anchor" href="#con-kogito-service-execution_kogito-dmn-models"></a><a class="link" href="#con-kogito-service-execution_kogito-dmn-models">2.1.5. Kogito service execution</a></h4>
<div class="paragraph _abstract">
<p>After you design your Kogito service, you can build and run your application and then send REST API requests to the application to execute your services. The exact REST API requests that you can use depend on how you set up the application.</p>
</div>
<div class="paragraph">
<p>For example, consider a Kogito service that is set up to generate a <code>/persons</code> REST API endpoint and determines whether a specified customer is an adult or is underage. In this example, you can send the following <code>POST</code> request using a REST client or curl utility to add an adult and execute the service:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that for JSON marshaling, Kogito is relying on the default mappers of <a href="https://quarkus.io/guides/rest-json#jackson">Quarkus</a> and <a href="https://docs.spring.io/spring-boot/docs/1.3.0.M3/reference/html/howto-spring-mvc.html#howto-customize-the-jackson-objectmapper">SpringBoot</a>, which can be configured according to the specific requirements.</p>
</div>
<div class="paragraph">
<p>For information about creating, running, and testing an example application with Kogito services, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</div>
<div class="sect4">
<h5 id="ref-rest-dmn-endpoints_kogito-dmn-models"><a class="anchor" href="#ref-rest-dmn-endpoints_kogito-dmn-models"></a><a class="link" href="#ref-rest-dmn-endpoints_kogito-dmn-models">2.1.5.1. REST endpoints for DMN models in Kogito</a></h5>
<div class="paragraph _abstract">
<p>For each DMN model in a Kogito application, the following REST endpoints are automatically generated based on the content of the model:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>[POST] /{modelName}</code>: A business-domain endpoint for evaluating the entire DMN model</p>
</li>
<li>
<p><code>[POST] /{modelName}/{decisionServiceName}</code>: A business-domain endpoint for evaluating a specified decision service component in the DMN model</p>
</li>
<li>
<p><code>[POST] /{modelName}/dmnresult</code>: An endpoint for evaluating the entire DMN model and returning a <code>DMNResult</code> response, including the business-domain context, helper messages, and helper decision pointers for the DMN model</p>
</li>
<li>
<p><code>[POST] /{modelName}/{decisionServiceName}/dmnresult</code>: An endpoint for evaluating a specified decision service component in the DMN model and returning a <code>DMNResult</code> response, including the business-domain context, helper messages, and helper decision pointers for the decision service</p>
</li>
<li>
<p><code>[GET] /{modelName}</code>: An endpoint for returning the DMN XML without decision logic, typically for DMN model introspection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use these endpoints to interact with a DMN model or a specific decision service within a model. As you decide between using business-domain and <code>dmnresult</code> variants of these REST endpoints, review the following considerations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>REST business-domain endpoints</strong>: Use this endpoint type if a client application is only concerned with a positive evaluation outcome, is not interested in parsing <code>Info</code> or <code>Warn</code> messages, and only needs an HTTP 5xx response for any errors. This type of endpoint is also helpful for single-page application-like clients, due to singleton coercion of decision service results that resemble the DMN modeling behavior.</p>
</li>
<li>
<p><strong>REST <code>dmnresult</code> endpoints</strong>: Use this endpoint type if a client needs to parse <code>Info</code>, <code>Warn</code>, or <code>Error</code> messages in all cases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each endpoint, use a REST client, curl utility, or Swagger UI (if configured for the application) to send requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base URL</strong>: <code>http://<em>HOST</em>:<em>PORT</em>/{modelName}</code></p>
</li>
<li>
<p><strong>Path parameters</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>{modelName}</code>: The string identifier of the DMN model, such as <code>Traffic Violation</code></p>
</li>
<li>
<p><code>{decisionServiceName}</code>: The string identifier of the decision service component in the DMN DRG, such as <code>TrafficViolationDecisionService</code></p>
</li>
<li>
<p><code>dmnresult</code>: The string identifier that enables the endpoint to return a full <code>DMNResult</code> response with more detailed <code>Info</code>, <code>Warn</code>, and <code>Error</code> messaging</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code> or <code>POST</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The examples in the following endpoints are based on a <code>Traffic Violation</code> DMN model that contains a <code>TrafficViolationDecisionService</code> decision service component.</p>
</div>
<div class="paragraph">
<p>For all of these endpoints, if a DMN evaluation <code>Error</code> message occurs, a <code>DMNResult</code> response is returned along with an HTTP 5xx error. If a DMN <code>Info</code> or <code>Warn</code> message occurs, the relevant response is returned along with the business-domain REST body, in the <code>X-Kogito-decision-messages</code> extended HTTP header, to be used for client-side business logic. When more refined client-side business logic is required, the client can use the <code>dmnresult</code> variant of the endpoints.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return the DMN XML without decision logic</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /{modelName}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/Traffic Violation</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (XML)</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;dmn:definitions xmlns:dmn="http://www.omg.org/spec/DMN/20180521/MODEL/" xmlns="https://github.com/apache/incubator-kie-drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF" xmlns:di="http://www.omg.org/spec/DMN/20180521/DI/" xmlns:kie="http://www.drools.org/kie/dmn/1.2" xmlns:feel="http://www.omg.org/spec/DMN/20180521/FEEL/" xmlns:dmndi="http://www.omg.org/spec/DMN/20180521/DMNDI/" xmlns:dc="http://www.omg.org/spec/DMN/20180521/DC/" id="_1C792953-80DB-4B32-99EB-25FBE32BAF9E" name="Traffic Violation" expressionLanguage="http://www.omg.org/spec/DMN/20180521/FEEL/" typeLanguage="http://www.omg.org/spec/DMN/20180521/FEEL/" namespace="https://github.com/apache/incubator-kie-drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF"&gt;
  &lt;dmn:itemDefinition id="_63824D3F-9173-446D-A940-6A7F0FA056BB" name="tDriver" isCollection="false"&gt;
    ...
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:itemDefinition id="_2D4F30EE-21A6-4A78-A524-A5C238D433AE" name="tFine" isCollection="false"&gt;
    ...
  &lt;/dmn:itemDefinition&gt;
  &lt;dmn:decision id="_4055D956-1C47-479C-B3F4-BAEB61F1C929" name="Fine"&gt;
    &lt;dmn:variable id="_8C1EAC83-F251-4D94-8A9E-B03ACF6849CD" name="Fine" typeRef="tFine"&gt;
    &lt;/dmn:variable&gt;
    &lt;dmn:informationRequirement id="_800A3BBB-90A3-4D9D-BA5E-A311DED0134F"&gt;
      &lt;dmn:requiredInput href="#_1929CBD5-40E0-442D-B909-49CEDE0101DC"&gt;
      &lt;/dmn:requiredInput&gt;
    &lt;/dmn:informationRequirement&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:decision id="_8A408366-D8E9-4626-ABF3-5F69AA01F880" name="Should the driver be suspended?"&gt;
    &lt;dmn:question&gt;Should the driver be suspended due to points on his license?&lt;/dmn:question&gt;
    &lt;dmn:allowedAnswers&gt;"Yes", "No"&lt;/dmn:allowedAnswers&gt;
    &lt;dmn:variable id="_40387B66-5D00-48C8-BB90-E83EE3332C72" name="Should the driver be suspended?" typeRef="string"&gt;
    &lt;/dmn:variable&gt;
    &lt;dmn:informationRequirement id="_982211B1-5246-49CD-BE85-3211F71253CF"&gt;
      &lt;dmn:requiredInput href="#_1F9350D7-146D-46F1-85D8-15B5B68AF22A"&gt;
      &lt;/dmn:requiredInput&gt;
    &lt;/dmn:informationRequirement&gt;
    &lt;dmn:informationRequirement id="_AEC4AA5F-50C3-4FED-A0C2-261F90290731"&gt;
      &lt;dmn:requiredDecision href="#_4055D956-1C47-479C-B3F4-BAEB61F1C929"&gt;
      &lt;/dmn:requiredDecision&gt;
    &lt;/dmn:informationRequirement&gt;
  &lt;/dmn:decision&gt;
  &lt;dmn:inputData id="_1929CBD5-40E0-442D-B909-49CEDE0101DC" name="Violation"&gt;
    &lt;dmn:variable id="_C16CF9B1-5FAB-48A0-95E0-5FCD661E0406" name="Violation" typeRef="tViolation"&gt;
    &lt;/dmn:variable&gt;
  &lt;/dmn:inputData&gt;
  &lt;dmn:inputData id="_1F9350D7-146D-46F1-85D8-15B5B68AF22A" name="Driver"&gt;
    &lt;dmn:variable id="_A80F16DF-0DB4-43A2-B041-32900B1A3F3D" name="Driver" typeRef="tDriver"&gt;
    &lt;/dmn:variable&gt;
  &lt;/dmn:inputData&gt;
&lt;/dmn:definitions&gt;</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified DMN model</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}</code></p>
</div>
<div class="paragraph">
<p>For this endpoint, the request body must contain all input data of the DMN model. The response is the resulting DMN context of the model, including the decision values, the original input values, and all other parametric DRG components in serialized form. For example, a business knowledge model is available in string-serialized form in its signature.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-model-traffic-violation.png" alt="Image of Traffic Violation DMN model">
</div>
<div class="title">Figure 105. Example <code>Traffic Violation</code> DMN model</div>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Violation": {
    "Type": "speed",
    "Speed Limit": 100,
    "Actual Speed": 120
  },
  "Driver": {
    "Points": 2
  },
  "Fine": {
    "Points": 3,
    "Amount": 500
  },
  "Should the driver be suspended?": "No"
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified decision service within a DMN model</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}/{decisionServiceName}</code></p>
</div>
<div class="paragraph">
<p>For this endpoint, the request body must contain all the requirements of the decision service. The response is the resulting DMN context of the decision service, including the decision values, the original input values, and all other parametric DRG components in serialized form. For example, a business knowledge model is available in string-serialized form in its signature.</p>
</div>
<div class="paragraph">
<p>If the decision service is composed of a single-output decision, the response is the resulting value of that specific decision. This behavior provides an equivalent value at the API level of a specification feature when invoking the decision service in the model itself. As a result, you can, for example, interact with a DMN decision service from single-page web applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-model-traffic-violation-single-output.png" alt="Image of decision service in Traffic Violation DMN model">
</div>
<div class="title">Figure 106. Example <code>TrafficViolationDecisionService</code> decision service with single-output decision</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/dmn-model-traffic-violation-multi-output.png" alt="Image of decision service in Traffic Violation DMN model">
</div>
<div class="title">Figure 107. Example <code>TrafficViolationDecisionService</code> decision service with multiple-output decision</div>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation/TrafficViolationDecisionService</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation/TrafficViolationDecisionService -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response for single-output decision (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"No"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response for multiple-output decision (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Violation": {
    "Type": "speed",
    "Speed Limit": 100,
    "Actual Speed": 120
  },
  "Driver": {
    "Points": 2
  },
  "Fine": {
    "Points": 3,
    "Amount": 500
  },
  "Should the driver be suspended?": "No"
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified DMN model and return a <code>DMNResult</code> response</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}/dmnresult</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "namespace": "https://github.com/apache/incubator-kie-drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF",
  "modelName": "Traffic Violation",
  "dmnContext": {
    "Violation": {
      "Type": "speed",
      "Speed Limit": 100,
      "Actual Speed": 120,
      "Code": null,
      "Date": null
    },
    "Driver": {
      "Points": 2,
      "State": null,
      "City": null,
      "Age": null,
      "Name": null
    },
    "Fine": {
      "Points": 3,
      "Amount": 500
    },
    "Should the driver be suspended?": "No"
  },
  "messages": [],
  "decisionResults": [
    {
      "decisionId": "_4055D956-1C47-479C-B3F4-BAEB61F1C929",
      "decisionName": "Fine",
      "result": {
        "Points": 3,
        "Amount": 500
      },
      "messages": [],
      "evaluationStatus": "SUCCEEDED"
    },
    {
      "decisionId": "_8A408366-D8E9-4626-ABF3-5F69AA01F880",
      "decisionName": "Should the driver be suspended?",
      "result": "No",
      "messages": [],
      "evaluationStatus": "SUCCEEDED"
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Evaluate a specified decision service within a DMN model and return a <code>DMNResult</code> response</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /{modelName}/{decisionServiceName}/dmnresult</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/Traffic Violation/TrafficViolationDecisionService</code></p>
</div>
<div class="listingblock">
<div class="title">Example POST request body with input data</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "Driver": {
    "Points": 2
  },
  "Violation": {
    "Type": "speed",
    "Actual Speed": 120,
    "Speed Limit": 100
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/Traffic Violation/TrafficViolationDecisionService -H 'content-type: application/json' -H 'accept: application/json' -d '{"Driver": {"Points": 2}, "Violation": {"Type": "speed", "Actual Speed": 120, "Speed Limit": 100}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "namespace": "https://github.com/apache/incubator-kie-drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF",
  "modelName": "Traffic Violation",
  "dmnContext": {
    "Violation": {
      "Type": "speed",
      "Speed Limit": 100,
      "Actual Speed": 120,
      "Code": null,
      "Date": null
    },
    "Driver": {
      "Points": 2,
      "State": null,
      "City": null,
      "Age": null,
      "Name": null
    },
    "Should the driver be suspended?": "No"
  },
  "messages": [],
  "decisionResults": [
    {
      "decisionId": "_8A408366-D8E9-4626-ABF3-5F69AA01F880",
      "decisionName": "Should the driver be suspended?",
      "result": "No",
      "messages": [],
      "evaluationStatus": "SUCCEEDED"
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-audit-console_kogito-dmn-models"><a class="anchor" href="#con-audit-console_kogito-dmn-models"></a><a class="link" href="#con-audit-console_kogito-dmn-models">2.1.6. Kogito Audit Investigation Console</a></h4>
<div class="paragraph _abstract">
<p>The Kogito Audit Investigation Console is a user interface for monitoring and investigating Decision Model and Notation (DMN) model executions in Kogito.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-home.png" alt="Image of Kogito Audit Investigation Console">
</div>
<div class="title">Figure 108. Kogito Audit Investigation Console</div>
</div>
<div class="paragraph">
<p>You can use the Audit Investigation Console to browse DMN model executions, verify execution status, retrieve execution details, such as decision outcomes, input data, and model preview, and obtain explanation information about how the processed decisions were made.</p>
</div>
<div class="paragraph">
<p>The Audit Investigation Console requires your Kogito services to use the following Kogito components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kogito Trusty Service</strong>: Enables the Audit Investigation Console to access stored events related to decision tracing from your Kogito services. The Kogito Trusty Service requires Infinispan persistence and Apache Kafka messaging for your Kogito service. For more information about the Trusty Service, see <a href="https://kie.apache.org/kogito-docs/#con-trusty-service_kogito-configuring"><em>Configuring Kogito supporting services and runtime capabilities</em></a>.</p>
</li>
<li>
<p><strong>Kogito Explainability Service</strong>: Generates explainability data that is stored in the Kogito Trusty Service. The Audit Investigation Console accesses the explainbility information from tracing-event data for decisions in your Kogito services. The Kogito Explainbility Service requires Apache Kafka messaging for your Kogito service.</p>
</li>
<li>
<p><strong>Kogito Tracing decision add-on</strong>: Enables the Kogito service to produce tracing events and publish the events to Apache Kafka. The add-on also exposes the REST endpoint <code>/predict</code> for the Kogito Explainbility Service.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="ref-audit-console-configurations_kogito-dmn-models"><a class="anchor" href="#ref-audit-console-configurations_kogito-dmn-models"></a><a class="link" href="#ref-audit-console-configurations_kogito-dmn-models">2.1.6.1. Supported configurations for the tracing add-on</a></h5>
<div class="paragraph _abstract">
<p>The Kogito Audit Investigation Console requires the following project dependency for the tracing add-on:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable tracing capability on Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-tracing-decision&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable tracing capability on SpringBoot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-tracing-decision&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The tracing add-on enables the Trusty Service to interact with the decision-tracing data through the CloudEvents messages. The default configuration for the add-on pushes the decision-tracing events to the <code>kogito-tracing-decision</code> Apache Kafka topic and pushes the DMN models used by the Kogito service to the <code>kogito-tracing-model</code> topic under the group ID <code>kogito-runtimes</code>.</p>
</div>
<div class="paragraph">
<p>To specify the Kafka bootstrap server for your Kogito service, set the following property in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Application property for Kafka bootstrap server</div>
<div class="content">
<pre class="highlight"><code>kafka.bootstrap.servers=http://<em>HOST</em>:<em>PORT</em></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In a Kubernetes or OpenShift environment, if you specified the <code>KAFKA_BOOTSTRAP_SERVERS</code> environment variable in the relevant container, this application property in your Kogito project is not required.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On Quarkus, to customize the tracing add-on configurations, use the format <code>mp.messaging.outgoing.kogito-tracing-decision.<em>PROPERTY_NAME</em></code> for the decisions, and the format <code>mp.messaging.outgoing.kogito-tracing-model.<em>PROPERTY_NAME</em></code> for the DMN models.</p>
</div>
<div class="paragraph">
<p>For example, to change the topic name for the decision-tracing events, add the following line to the <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="title">Example property to change the topic name for decision-tracing events</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito-tracing-decision.topic=my-kogito-tracing-decision</code></pre>
</div>
</div>
<div class="paragraph">
<p>On SpringBoot, to customize the tracing add-on configurations, set the following properties in the <code>application.properties</code> file of your Kogito project as needed:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 87. Application properties for the tracing add-on on SpringBoot</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.tracing.decision.kafka.bootstrapAddress</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the address used in the initial connection to find a bootstrap server on the cluster of <code>n</code> brokers</p>
<p class="tableblock">Default value: None (must be set by user)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.tracing.decision.kafka.topic.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the topic name for the decision-tracing events</p>
<p class="tableblock">Default value: <code>kogito-tracing-decision</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.tracing.decision.kafka.topic.partitions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the number of partitions to use for the decision-tracing events topic</p>
<p class="tableblock">Default value: <code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.tracing.decision.kafka.topic.replicationFactor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the factor of the data for the decision-tracing events topic</p>
<p class="tableblock">Default value: <code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.tracing.decision.asyncEnabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables asynchronous callback with the results of the send (success or failure) instead of waiting to complete</p>
<p class="tableblock">Default value: <code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.tracing.model.kafka.topic.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the topic name for the DMN models used by the Kogito service</p>
<p class="tableblock">Default value: <code>kogito-tracing-model</code></p></td>
</tr>
</tbody>
</table>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/kafka">Using Apache Kafka with Reactive Messaging</a> in Quarkus documentation</p>
</li>
<li>
<p><a href="https://kafka.apache.org/documentation/#producerconfigs">Producer Configs</a> in Apache Kafka documentation</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="proc-audit-console-using_kogito-dmn-models"><a class="anchor" href="#proc-audit-console-using_kogito-dmn-models"></a><a class="link" href="#proc-audit-console-using_kogito-dmn-models">2.1.6.2. Using the Kogito Audit Investigation Console to view DMN model execution details</a></h5>
<div class="paragraph _abstract">
<p>You can use the Kogito Audit Investigation Console to view DMN model execution details for your Kogito services. You can run the Audit Investigation Console for local Kogito services or add it to your Kogito infrastructure on OpenShift.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Kogito Trusty Service instance and Explainbility Service instance are configured and running for your Kogito service. The Trusty Service enables the Audit Investigation Console to access stored DMN model execution data. The Trusty Service requires Infinispan persistence and Apache Kafka messaging for your Kogito service. For information about the Trusty Service, see <a href="https://kie.apache.org/kogito-docs/#con-trusty-service_kogito-configuring"><em>Configuring Kogito supporting services and runtime capabilities</em></a>.</p>
</li>
<li>
<p>The <code>pom.xml</code> file of your Kogito project contains the following dependency for the tracing add-on:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Project dependency to enable tracing capability on Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-tracing-decision&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable tracing capability SpringBoot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-tracing-decision&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>The <code>application.properties</code> file of your Kogito project contains the following system properties:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Application property for REST URLs</div>
<div class="content">
<pre class="highlight"><code>kogito.service.url=http://<em>HOST</em>:<em>PORT</em></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In a Kubernetes or OpenShift environment, if you specified the <code>KOGITO_SERVICE_URL</code> environment variable in the relevant container, this application property in your Kogito project is not required for the Explainability Service.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Application property for Kafka bootstrap server</div>
<div class="content">
<pre class="highlight"><code>kafka.bootstrap.servers=http://<em>HOST</em>:<em>PORT</em></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In a Kubernetes or OpenShift environment, if you specified the <code>KAFKA_BOOTSTRAP_SERVERS</code> environment variable in the relevant container, this application property in your Kogito project is not required.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The service URL property defines the location where the Kogito service is deployed, such as <code>http://localhost:8080</code>. This property enables the Explainability Service to generate the URLs to interact with Kogito and enrich tracing data with explainbility. The bootstrap property defines the Kafka bootstrap server for your Kogito service.</p>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/trusty-ui/"><code>trusty-ui</code></a> artifacts page, select the latest release of the Kogito Audit Investigation Console, and download the <code>trusty-ui-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>trusty-ui-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Audit Investigation Console:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Running the Audit Investigation Console</div>
<div class="content">
<pre class="highlight"><code>$ java -Dquarkus.http.port=9000 -Dkogito.trusty.http.url=http://<em>HOST</em>:<em>PORT</em> -jar trusty-ui-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The default port for the Audit Investigation Console is 8080, but this example specifies port 9000 to avoid conflicts with the example Kogito service running at port 8080.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-instance.png" alt="Image of Kogito Audit Investigation Console instance on OpenShift">
</div>
<div class="title">Figure 109. Kogito Audit Investigation Console instance on OpenShift web console</div>
</div>
<div class="paragraph">
<p>If you did not already install the required Trusty Service and Explainability Service, you can likewise use the OpenShift web console to add these instances under the <strong>Kogito Supporting Service</strong> tab and try again to add the Audit Investigation Console instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-trusty-explainability-instances.png" alt="Image of Kogito Trusty Service and Explainability Service instances on OpenShift">
</div>
<div class="title">Figure 110. Kogito Trusty Service and Explainability Service instances on OpenShift web console</div>
</div>
</div>
</div>
</li>
<li>
<p>In a web browser, navigate to <code><a href="http://localhost:9000" class="bare">http://localhost:9000</a></code> to open the Audit Investigation Console. If you modified the configured Trusty UI port, use the modified location.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>On OpenShift, navigate to the route URL for the Audit Investigation Console instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-home.png" alt="Image of Kogito Audit Investigation Console">
</div>
<div class="title">Figure 111. Kogito Audit Investigation Console</div>
</div>
<div class="paragraph">
<p>The Audit Investigation Console displays data for all available DMN model executions. By default, executions are filtered to display results from the last month. To modify the list view, you can use the search or sort fields at the top of the screen.</p>
</div>
</div>
</div>
</li>
<li>
<p>In the DMN model executions list, select an execution ID to view and navigate through the details for the selected execution.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-execution-detail.png" alt="Image of execution details page">
</div>
<div class="title">Figure 112. Execution details page</div>
</div>
<div class="paragraph">
<p>At the top of the execution details page, you can hover your cursor over the execution status to view information about execution date, time, and executor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-execution-status-tooltip.png" alt="Image of Execution Status Tooltip" width="303">
</div>
<div class="title">Figure 113. Execution status tooltip</div>
</div>
</div>
</div>
</li>
<li>
<p>In the execution details page, use the following tabs in the top menu to view different aspects of the DMN model execution:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>Outcomes</strong>: Use this page to view a list of the decision outcomes in the current execution. Each outcome is a card containing the output of the decision. You can click <strong>View Details</strong> for each card to open the <strong>Outcome Details</strong> section for that specific outcome.</p>
</li>
<li>
<p><strong>Outcome Details</strong>: Use this page to view information about decision outcomes of the execution.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-outcomes-details.png" alt="Image of Outcome Details page">
</div>
<div class="title">Figure 114. Outcome Details page</div>
</div>
<div class="paragraph">
<p>You can change which outcome to view by selecting from the drop-down options in the top menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-outcomes-switch.png" alt="Image of Outcomes selection">
</div>
<div class="title">Figure 115. Outcomes selection</div>
</div>
<div class="paragraph">
<p>The <strong>Explanation</strong> section provides insight about how the inputs of the model influenced the decision outcome. A score from <code>-1</code> to <code>1</code> is assigned to each input, representing its positive or negative effect on the decision result. Score values are rounded to the second decimal digit. If you hover your cursor over the graph bars, you can also see the full score value. Next to the <strong>Features Score Chart</strong> panel, the <strong>Features Weight</strong> panel contains the same scores in a tabular view, grouped by positive and negative weight.</p>
</div>
<div class="paragraph">
<p>The <strong>Outcome Influencing Inputs</strong> section provides a list of the inputs that were considered during the elaboration of the current decision outcome. The inputs typically consist of a sub-set of the inputs provided to the DMN model, or may consist of all provided inputs. For complex input structures, you can select from the <strong>Browse Sections</strong> options to view different input sections.</p>
</div>
</li>
<li>
<p><strong>Input Data</strong>: Use this page to view all inputs submitted to the DMN model for the current execution, including all inputs that were not incorporated in the outcomes processing. For complex input structures, you can select from the <strong>Browse Sections</strong> options to view different input sections.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-input-data.png" alt="Image of Input Data page">
</div>
<div class="title">Figure 116. Input Data page</div>
</div>
</li>
<li>
<p><strong>Model Lookup</strong>: Use this page to view the decision requirements diagram (DRD) of the executed DMN model.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/dmn/kogito-audit-console-model-lookup.png" alt="Image of Model Lookup page">
</div>
<div class="title">Figure 117. Model Lookup page</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>Model Lookup</strong> viewer currently does not support DMN models that include other DMN models or PMML models.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example Kogito services that use the Trusty Service and Explainability Service, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/dmn-tracing-quarkus"><code>dmn-tracing-quarkus</code></a>: A DMN decision service on Quarkus that uses the <code>kie-addons-quarkus-tracing-decision</code> add-on to generate tracing events that the Kogito Trusty Service and Explainability Service can consume and expose.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3 _additional-resources">
<h4 id="_additional_resources_2"><a class="anchor" href="#_additional_resources_2"></a><a class="link" href="#_additional_resources_2">2.1.7. Additional resources</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="proc-audit-console-security_kogito-developing-decision-services"><a class="anchor" href="#proc-audit-console-security_kogito-developing-decision-services"></a><a class="link" href="#proc-audit-console-security_kogito-developing-decision-services">2.1.7.1. Enabling Kogito Audit Console security with OpenID Connect</a></h5>
<div class="paragraph _abstract">
<p>For Quarkus-based Kogito services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the Kogito Audit Console to enable the console to interact with the Kogito Trusty Service using bearer token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/trusty-ui">Kogito Audit Console</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/trusty-ui">Kogito Audit Console</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the Kogito Audit Console repository and enter the following command to run the application with security enabled:</p>
<div class="listingblock">
<div class="title">Run the Audit Console with security enabled</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure that the service is not started at the same port as the security server. You can change the port by adding <code>-Dquarkus.http.port=<em>PORT_NUMBER</em></code> to the start-up properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Kogito Audit Console contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
</li>
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Audit Console project and add the following properties:</p>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-console-quarkus
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=web-app
%keycloak.quarkus.oidc.logout.path=/logout
%keycloak.quarkus.oidc.logout.post-logout-path=/

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Stop and restart the Kogito Audit Console to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="chap-kogito-using-drl-rules"><a class="anchor" href="#chap-kogito-using-drl-rules"></a><a class="link" href="#chap-kogito-using-drl-rules">2.2. Using DRL rules in Kogito services</a></h3>
<div class="paragraph _abstract">
<p>As a developer of business decisions, you can define business rules using Drools Rule Language (DRL) directly in free-form <code>.drl</code> text files. A DRL file can contain one or more rules that define at a minimum the rule conditions (<code>when</code>) and actions (<code>then</code>).</p>
</div>
<div class="sect3">
<h4 id="ref-decision-authoring-assets_kogito-drl-rules"><a class="anchor" href="#ref-decision-authoring-assets_kogito-drl-rules"></a><a class="link" href="#ref-decision-authoring-assets_kogito-drl-rules">2.2.1. Decision-authoring assets in Kogito</a></h4>
<div class="paragraph _abstract">
<p>Kogito supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.</p>
</div>
<div class="paragraph">
<p>The following table highlights the main decision-authoring assets supported in Kogito projects to help you decide or confirm the best method for defining decisions in your decision service.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 88. Decision-authoring assets supported in Kogito</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Asset</th>
<th class="tableblock halign-left valign-top">Highlights</th>
<th class="tableblock halign-left valign-top">Authoring tools</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision Model and Notation (DMN) models</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are decision models based on a notation standard defined by the Object Management Group (OMG)</p>
</li>
<li>
<p>Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows</p>
</li>
<li>
<p>Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms</p>
</li>
<li>
<p>Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions</p>
</li>
<li>
<p>Can be integrated efficiently with Business Process Model and Notation (BPMN) process models</p>
</li>
<li>
<p>Are optimal for creating comprehensive, illustrative, and stable decision flows</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kogito DMN modeler in VSCode or other DMN-compliant editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-dmn_kogito-dmn-models">Decision Model and Notation (DMN)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DRL rules</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are individual rules that you define directly in <code>.drl</code> text files</p>
</li>
<li>
<p>Provide the most flexibility for defining rules and other technicalities of rule behavior</p>
</li>
<li>
<p>Are optimal for creating rules that require advanced DRL options, such as rule units</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any integrated development environment (IDE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-drl_kogito-drl-rules">Drools Rule Language (DRL)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet decision tables</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are tabular sets of rules that you define in <code>.xls</code> or <code>.xlsx</code> spreadsheet files</p>
</li>
<li>
<p>Support template keys and values for creating rule templates</p>
</li>
<li>
<p>Are optimal for business environments that already rely on decision tables for rules</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly when used in Kogito</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-decision-tables_kogito-decision-tables">Spreadsheet decision tables</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="con-drl_kogito-drl-rules"><a class="anchor" href="#con-drl_kogito-drl-rules"></a><a class="link" href="#con-drl_kogito-drl-rules">2.2.2. Drools Rule Language (DRL)</a></h4>
<div class="paragraph _abstract">
<p>Drools Rule Language (DRL) is a notation established by the <a href="https://www.drools.org/">Drools</a> open source business automation project for defining and describing business rules. You define DRL rules in <code>.drl</code> text files. A DRL file can contain one or more rules that define at a minimum the rule conditions (<code>when</code>) and actions (<code>then</code>).</p>
</div>
<div class="paragraph">
<p>DRL files consist of the following components:</p>
</div>
<div class="listingblock">
<div class="title">Components in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package
unit

import

declare   // Optional

query  // Optional

rule "rule name"
    // Attributes
    when
        // Conditions
    then
        // Actions
end

rule "rule2 name"

...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example DRL rule determines the age limit in a loan application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example rule for loan application age limit</div>
<div class="content">
<pre class="highlight"><code>rule "Underage"
  when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>A DRL file can contain single or multiple rules and queries, and can define resource declarations and attributes that are assigned and used by your rules and queries. The components in a DRL file are grouped in a defined rule unit that serves as a unique namespace for each group of rules. The DRL package followed by the rule unit definition must be listed at the top of a DRL file, and the rules are typically listed last. All other DRL components can follow any order.</p>
</div>
<div class="paragraph">
<p>Each rule must have a unique name within the rule unit. If you use the same rule name more than once in any DRL file in the unit, the rules fail to compile. Rule names generally must follow standard Java identifier conventions. However, you can enclose rule names with double quotation marks (<code>rule "rule name"</code>) to  prevent possible compilation errors, especially if you use spaces in rule names.</p>
</div>
<div class="sect4">
<h5 id="con-drl-packages_kogito-drl-rules"><a class="anchor" href="#con-drl-packages_kogito-drl-rules"></a><a class="link" href="#con-drl-packages_kogito-drl-rules">2.2.2.1. Packages in DRL</a></h5>
<div class="paragraph _abstract">
<p>A package is a folder of related assets in Kogito, such as data objects, DRL files, decision tables, and other asset types. A package also serves as a unique namespace for each group of rules. A single rule base can contain multiple packages. You typically store all the rules for a package in the same file as the package declaration so that the package is self-contained. However, you can import objects from other packages that you want to use in the rules.</p>
</div>
<div class="paragraph">
<p>The following example is a package name and namespace for a DRL file in a mortgage application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example package definition in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following railroad diagram shows all the components that may make up a package:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/package.png" alt="package">
</div>
<div class="title">Figure 118. Package</div>
</div>
<div class="paragraph">
<p>Note that a package <em>must</em> have a namespace and be declared using standard Java conventions for package names; i.e., no spaces, unlike rule names which allow spaces.
In terms of the order of elements, they can appear in any order in the rule file, with the exception of the <code>package</code> and <code>unit</code> statements, which must be at the top of the file.
In all cases, the semicolons are optional.</p>
</div>
<div class="paragraph">
<p>Notice that any rule attribute (as described in the section <a href="#rules-attributes-ref-drl-rules">[rules-attributes-ref-drl-rules]</a>) may also be written at package level, superseding the attribute&#8217;s default value.
The modified default may still be replaced by an attribute setting within a rule.</p>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-rule-units_kogito-drl-rules"><a class="anchor" href="#con-drl-rule-units_kogito-drl-rules"></a><a class="link" href="#con-drl-rule-units_kogito-drl-rules">2.2.2.2. Rule units in DRL</a></h5>
<div class="paragraph _abstract">
<p>A DRL rule unit is a module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained.</p>
</div>
<div class="paragraph">
<p>The following example is a rule unit designated in a DRL file in a mortgage application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example package definition and rule unit designation in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define a rule unit, you declare the relevant fact types and declare the data sources for the types by implementing the <code>RuleUnitData</code> interface, and then define the rules in the unit:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end

declare MortgageRules extends RuleUnitData
  person: DataStream&lt;Person&gt; = DataSource.createStream()
end

rule "Using a rule unit with a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>To separate the fact types from the rule unit for use with other DRL rules, you can declare the types in a separate DRL file and then use the DRL rule file to declare the data sources by using the <code>RuleUnitData</code> interface implementation:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL type declaration as a separate file</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file without explicitly defined types</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MortgageRules extends RuleUnitData
  person: DataStream&lt;Person&gt; = DataSource.createStream()
end

rule "Using a rule unit with a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>persons</code> is a <code>DataStream</code> data source for facts of type <code>Person</code>. Data sources are typed sources of data that rule units can subscribe to for updates. You interact with the rule unit through the data sources it exposes. A data source can be a <code>DataStream</code> source for append-only storage, a <code>DataStore</code> source for writable storage to add or remove data, or a <code>SingletonStore</code> source for writable storage to set and clear a single element.</p>
</div>
<div class="paragraph">
<p>As part of your data source declaration, you also import <code>org.kie.kogito.rules.DataSource</code> and the relevant data source support, such as <code>import org.kie.kogito.rules.DataStream</code> in this example.</p>
</div>
<div class="paragraph">
<p>You can add several rules to the same DRL file, or further break down the rule set and type declarations by creating more files. However you construct your rule sets, ensure that all DRL rule files exist in the same directory and start with the correct <code>package</code> and <code>unit</code> declarations.</p>
</div>
<div class="sect5">
<h6 id="_rule_unit_use_case"><a class="anchor" href="#_rule_unit_use_case"></a><a class="link" href="#_rule_unit_use_case">Rule unit use case</a></h6>
<div class="paragraph">
<p>As an additional rule unit use case, consider the following example decision service that evaluates incoming data from a heat sensor for temperature measurements and produces alerts when the temperature is above a specified threshold.</p>
</div>
<div class="paragraph">
<p>This example service uses the following <code>types.drl</code> file in the <code>src/main/resources/org/acme</code> folder of the Kogito project to declare the <code>Temperature</code> and the <code>Alert</code> fact types:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL type declarations</div>
<div class="content">
<pre class="highlight"><code>package com.acme;

declare Temperature
  value: double
end

declare Alert
    severity: String
    message: String
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define DRL rules that pattern-match against <code>Temperature</code> values, the example service must expose an entry point for the incoming data to the decision engine and publish alerts on a separate channel. To establish this data source for decision data, the example service uses a rule unit with <code>DataStream</code> data sources for <code>Temperature</code> objects and for <code>Alert</code> objects.</p>
</div>
<div class="paragraph">
<p>The <code>DataStream</code> data source is an append-only store for incoming data, similar to a queue. This type of data source is logical for both sources in this example because the temperature data is coming from an external source (the sensor) and the service publishes the alerts externally as they are produced.</p>
</div>
<div class="paragraph">
<p>The example service uses the following <code>MonitoringService.drl</code> file in the same <code>src/main/resources/com/acme</code> folder of the Kogito project to declare the data sources for the fact types and defines the rules for the rule unit:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MonitoringService extends RuleUnitData
  temperature: DataStream&lt;Temperature&gt; = DataSource.createStream()
  alertData: DataStream&lt;Alert&gt; = DataSource.createStream()
end

rule "tooHot"
when
    $temp : /temperature[value &gt;= 80]
then
    alertData.append(new Alert("HIGH", "Temperature exceeds threshold: " + temp.value));
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rule unit implements the required <code>RuleUnitData</code> interface and declares the data sources for the previously defined types. The sample rule raises an alert when the temperature reaches or exceeds 80 degrees.</p>
</div>
</div>
<div class="sect5">
<h6 id="_data_sources_for_drl_rule_units"><a class="anchor" href="#_data_sources_for_drl_rule_units"></a><a class="link" href="#_data_sources_for_drl_rule_units">Data sources for DRL rule units</a></h6>
<div class="paragraph">
<p>Data sources are typed sources of data that rule units can subscribe to for updates. You interact with the rule unit through the data sources it exposes.</p>
</div>
<div class="paragraph">
<p>Kogito supports the following types of data sources. When you declare data sources in DRL rule files, the sources are internally rendered as shown in these examples.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DataStream</code>: An append-only storage option. Use this storage option when you want to publish or share data values. You can use the notation <code>DataSource.createStream()</code> to return a <code>DataStream&lt;T&gt;</code> object and use the method <code>append(T)</code> to add more data.</p>
<div class="listingblock">
<div class="title">Example DataStream data source definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataStream&lt;Temperature&gt; temperature = DataSource.createStream();
// Append value and notify all subscribers
temperature.append(new Temperature(100));</code></pre>
</div>
</div>
</li>
<li>
<p><code>DataStore</code>: A writable storage option for adding or removing data and then notifying all subscribers that mutable data has been modified. Rules can pattern-match against incoming values and update or remove available values.
For users familiar with Drools, this option is equivalent to a typed version of an entry point. In fact, a <code>DataStore&lt;Object&gt;</code> is equivalent to an old-style entry point.</p>
<div class="listingblock">
<div class="title">Example DataStore data source definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">DataStore&lt;Temperature&gt; temperature = DataSource.createStore();
Temperature temp = new Temperature(100);
// Add value `t` and notify all subscribers
DataHandle t = temperature.add(temp);
temp.setValue(50);
// Notify all subscribers that the value referenced by `t` has changed
temperature.update(t, temp);
// Remove value referenced by `t` and notify all subscribers
temperature.remove(t);</code></pre>
</div>
</div>
</li>
<li>
<p><code>SingletonStore</code>: A writable storage option for setting or clearing a single element and then notifying all subscribers that the element has been modified. Rules can pattern-match against the value and update or clear available values.
For users familiar with Drools, this option is equivalent to a global. In fact, a <code>Singleton&lt;Object&gt;</code> is similar to an old-style global, except that when used in conjuction with rules, you can pattern-match against it.</p>
<div class="listingblock">
<div class="title">Example SingletonStore data source definition</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">SingletonStore&lt;Temperature&gt; temperature = DataSource.createSingleton();
Temperature temp = new Temperature(100);
// Add value `temp` and notify all subscribers
temperature.set(temp);
temp.setValue(50);
// Notify all subscribers that the value has changed
temperature.update();

Temperature temp2 = new Temperature(200);
// Overwrite contained value with `temp2` and notify all subscribers
temperature.set(temp2);
temp2.setValue(150);
// Notify all subscribers that the value has changed
temperature.update();

// Clear store and notify all subscribers
temperature.clear();</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Subscribers to a data source are known as <em>data processors</em>. A data processor implements the <code>DataProcessor&lt;T&gt;</code> interface. This interface contains callbacks to all the events that a subscribed data source can trigger.</p>
</div>
<div class="listingblock">
<div class="title">Example DataStream data processor</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public interface DataProcessor&lt;T&gt; {
    void insert(DataHandle handle, T object);
    void update(DataHandle handle, T object);
    void delete(DataHandle handle);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DataHandle</code> method is an internal reference to an object of a data source. Each callaback method might or might not be invoked, depending on whether the corresponding data source implements the capability. For example, a <code>DataStream</code> source invokes only the <code>insert</code> callback, whereas a <code>SingletonStore</code> source invokes the <code>insert</code> callback on <code>set</code> and the <code>delete</code> callback on <code>clear</code> or before an overwriting <code>set</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_drl_rule_unit_declaration_using_java"><a class="anchor" href="#_drl_rule_unit_declaration_using_java"></a><a class="link" href="#_drl_rule_unit_declaration_using_java">DRL rule unit declaration using Java</a></h6>
<div class="paragraph">
<p>As an alternative to declaring fact types and rule units in DRL files, you can also declare types and units using Java classes. In this case, you add the source code to the <code>src/main/java</code> folder of your Kogito project instead of <code>src/main/resources</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following Java classes define the type and rule unit declarations for the example temperature monitoring service:</p>
</div>
<div class="listingblock">
<div class="title">Example Temperature class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

public class Temperature {
    private final double value;
    public Temperature(double value) { this.value = value; }
    public double getValue() { return value; }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Alert class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

public class Alert {
    private final String severity
    private final String message;
    public Temperature(String severity, String message) {
        this.severity = severity;
        this.message = message;
    }
    public String getSeverity() { return severity; }
    public String getMessage() { return message; }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule unit class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

public class MonitoringService implements RuleUnitData {
    private DataStream&lt;Temperature&gt; temperature = DataSource.createStream();
    private DataStream&lt;Alert&gt; alertData = DataSource.createStream();
    public DataStream&lt;Temperature&gt; getTemperature() { return temperature; }
    public DataStream&lt;Alert&gt; getAlertData() { return alertData; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this scenario, the DRL rule files then stand alone in the <code>src/main/resources</code> folder and consist of the <code>unit</code> and the rules, with no direct declarations, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file without declarations</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

rule "tooHot"
  when
    $temp : /temperature[value &gt;= 80]
  then
    alertData.append(new Alert("HIGH", "Temperature exceeds threshold: " + temp.value));
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_drl_rule_units_with_bpmn_processes"><a class="anchor" href="#_drl_rule_units_with_bpmn_processes"></a><a class="link" href="#_drl_rule_units_with_bpmn_processes">DRL rule units with BPMN processes</a></h6>
<div class="paragraph">
<p>If you use a DRL rule unit as part of a business rule task in a Business Process Model and Notation (BPMN) process in your Kogito project, you do not need to create an explicit data type declaration or a rule unit class that implements the <code>RuleUnitData</code> interface. Instead, you designate the rule unit in the DRL file as usual and specify the rule unit in the format <code>unit:<em>PACKAGE_NAME</em>.<em>UNIT_NAME</em></code> in the implementation details for the business rule task in the BPMN process. When you build the project, the business process implicitly declares the rule unit as part of the business rule task to execute the DRL file.</p>
</div>
<div class="paragraph">
<p>For example, the following is a DRL file with a rule unit designation:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

rule "tooHot"
  when
    $temp : Temperature( value &gt;= 80 ) from temperature
  then
    alertData.add(new Alert("HIGH", "Temperature exceeds threshold: " + temp.value));
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the relevant business process in a BPMN 2.0 process modeler, you select the business rule task and for the <strong>Implementation/Execution</strong> property, you set the rule language to <code>DRL</code> and the rule flow group to <code>unit:com.acme.MonitoringService</code>.</p>
</div>
<div class="paragraph">
<p>This rule unit syntax specifies that you are using the <code>com.acme.MonitoringService</code> rule unit instead of a traditional rule flow group. This is the rule unit that you referenced in the example DRL file. When you build the project, the business process implicitly declares the rule unit as part of the business rule task to execute the DRL file.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-imports_kogito-drl-rules"><a class="anchor" href="#con-drl-imports_kogito-drl-rules"></a><a class="link" href="#con-drl-imports_kogito-drl-rules">2.2.2.3. Import statements in DRL</a></h5>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/import.png" alt="import">
</div>
<div class="title">Figure 119. Import</div>
</div>
<div class="paragraph _abstract">
<p>Similar to import statements in Java, imports in DRL files identify the fully qualified paths and type names for any objects that you want to use in the rules. You specify the package and data object in the format <code>packageName.objectName</code>, with multiple imports on separate lines. The decision engine automatically imports classes from the Java package with the same name as the DRL package and from the package <code>java.lang</code>.</p>
</div>
<div class="paragraph">
<p>The following example is an import statement for a loan application object in a mortgage application decision service:</p>
</div>
<div class="listingblock">
<div class="title">Example import statement in a DRL file</div>
<div class="content">
<pre class="highlight"><code>import org.mortgages.LoanApplication;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-declarations_kogito-drl-rules"><a class="anchor" href="#con-drl-declarations_kogito-drl-rules"></a><a class="link" href="#con-drl-declarations_kogito-drl-rules">2.2.2.4. Type declarations and metadata in DRL</a></h5>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/type_declaration.png" alt="type declaration">
</div>
<div class="title">Figure 120. Type declaration</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/meta_data.png" alt="meta data">
</div>
<div class="title">Figure 121. Metadata</div>
</div>
<div class="paragraph _abstract">
<p>Declarations in DRL files define new fact types or metadata for fact types to be used by rules in the DRL file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>New fact types:</strong> The default fact type in the <code>java.lang</code> package of Kogito is <code>Object</code>, but you can declare other types in DRL files as needed. Declaring fact types in DRL files enables you to define a new fact model directly in the decision engine, without creating models in a lower-level language like Java. You can also declare a new type when a domain model is already built and you want to complement this model with additional entities that are used mainly during the reasoning process.</p>
</li>
<li>
<p><strong>Metadata for fact types:</strong> You can associate metadata in the format <code>@<em>KEY</em>( <em>VALUE</em> )</code> with new or existing facts. Metadata can be any kind of data that is not represented by the fact attributes and is consistent among all instances of that fact type. The metadata can be queried at run time by the decision engine and used in the reasoning process.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="con-drl-declarations-without-metadata_kogito-drl-rules"><a class="anchor" href="#con-drl-declarations-without-metadata_kogito-drl-rules"></a><a class="link" href="#con-drl-declarations-without-metadata_kogito-drl-rules">Type declarations without metadata in DRL</a></h6>
<div class="paragraph _abstract">
<p>A declaration of a new fact does not require any metadata, but must include a list of attributes or fields. If a type declaration does not include identifying attributes, the decision engine searches for an existing fact class in the classpath and raises an error if the class is missing.</p>
</div>
<div class="paragraph">
<p>For example, the following DRL file contains a declaration of a new fact type <code>Person</code> from a <code>person</code> data source and uses no metadata:</p>
</div>
<div class="listingblock">
<div class="title">Example declaration of a new fact type with a rule</div>
<div class="content">
<pre class="highlight"><code>declare Person
  name : String
  dateOfBirth : java.util.Date
  address : Address
end

rule "Using a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the new fact type <code>Person</code> has the three attributes <code>name</code>, <code>dateOfBirth</code>, and <code>address</code>. Each attribute has a type that can be any valid Java type, including another class that you create or a fact type that you previously declared. The <code>dateOfBirth</code> attribute has the type <code>java.util.Date</code>, from the Java API, and the <code>address</code> attribute has the previously defined fact type <code>Address</code>.</p>
</div>
<div class="paragraph">
<p>To avoid writing the fully qualified name of a class every time you declare it, you can define the full class name as part of the <code>import</code> clause:</p>
</div>
<div class="listingblock">
<div class="title">Example type declaration with the fully qualified class name in the import</div>
<div class="content">
<pre class="highlight"><code>import java.util.Date

declare Person
    name : String
    dateOfBirth : Date
    address : Address
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you declare a new fact type, the decision engine generates at compile time a Java class representing the fact type. The generated Java class is a one-to-one JavaBeans mapping of the type definition.</p>
</div>
<div class="paragraph">
<p>For example, the following Java class is generated from the example <code>Person</code> type declaration:</p>
</div>
<div class="listingblock">
<div class="title">Generated Java class for the Person fact type declaration</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Person implements Serializable {
    private String name;
    private java.util.Date dateOfBirth;
    private Address address;

    // Empty constructor
    public Person() {...}

    // Constructor with all fields
    public Person( String name, Date dateOfBirth, Address address ) {...}

    // If keys are defined, constructor with keys
    public Person( ...keys... ) {...}

    // Getters and setters
    // `equals` and `hashCode`
    // `toString`
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then use the generated class in your rules like any other fact, as illustrated in the previous rule example with the <code>Person</code> type declaration from a <code>person</code> data source:</p>
</div>
<div class="listingblock">
<div class="title">Example rule that uses the declared Person fact type</div>
<div class="content">
<pre class="highlight"><code>rule "Using a declared type"
  when
    $p : /person[ name == "James" ]
  then   // Insert Mark, who is a customer of James.
    Person mark = new Person();
    mark.setName( "Mark" );
    person.append( mark );
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-drl-declarations-enumerative_kogito-drl-rules"><a class="anchor" href="#con-drl-declarations-enumerative_kogito-drl-rules"></a><a class="link" href="#con-drl-declarations-enumerative_kogito-drl-rules">Enumerative type declarations in DRL</a></h6>
<div class="paragraph _abstract">
<p>DRL supports the declaration of enumerative types in the format <code>declare enum <em>FACT_TYPE</em></code>, followed by a comma-separated list of values ending with a semicolon. You can then use the enumerative list in the rules in the DRL file.</p>
</div>
<div class="paragraph">
<p>For example, the following enumerative type declaration defines days of the week for an employee scheduling rule:</p>
</div>
<div class="listingblock">
<div class="title">Example enumerative type declaration with a scheduling rule</div>
<div class="content">
<pre class="highlight"><code>declare enum DaysOfWeek
   SUN("Sunday"),MON("Monday"),TUE("Tuesday"),WED("Wednesday"),THU("Thursday"),FRI("Friday"),SAT("Saturday");

   fullName : String
end

rule "Using a declared Enum"
  when
    $emp : /employee[ dayOff == DaysOfWeek.MONDAY ]
  then
    ...
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-drl-declarations-extended_kogito-drl-rules"><a class="anchor" href="#con-drl-declarations-extended_kogito-drl-rules"></a><a class="link" href="#con-drl-declarations-extended_kogito-drl-rules">Extended type declarations in DRL</a></h6>
<div class="paragraph _abstract">
<p>DRL supports type declaration inheritance in the format <code>declare <em>FACT_TYPE_1</em> extends <em>FACT_TYPE_2</em></code>. To extend a type declared in Java by a subtype declared in DRL, you repeat the parent type in a declaration statement without any fields.</p>
</div>
<div class="paragraph">
<p>For example, the following type declarations extend a <code>Student</code> type from a top-level <code>Person</code> type, and a <code>LongTermStudent</code> type from the <code>Student</code> subtype:</p>
</div>
<div class="listingblock">
<div class="title">Example extended type declarations</div>
<div class="content">
<pre class="highlight"><code>import org.people.Person

declare Person end

declare Student extends Person
    school : String
end

declare LongTermStudent extends Student
    years : int
    course : String
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="con-drl-declarations-with-metadata_kogito-drl-rules"><a class="anchor" href="#con-drl-declarations-with-metadata_kogito-drl-rules"></a><a class="link" href="#con-drl-declarations-with-metadata_kogito-drl-rules">Type declarations with metadata in DRL</a></h6>
<div class="paragraph _abstract">
<p>You can associate metadata in the format <code>@<em>KEY</em>( <em>VALUE</em> )</code> (the value is optional) with fact types or fact attributes. Metadata can be any kind of data that is not represented by the fact attributes and is consistent among all instances of that fact type. The metadata can be queried at run time by the decision engine and used in the reasoning process. Any metadata that you declare before the attributes of a fact type are assigned to the fact type, while metadata that you declare after an attribute are assigned to that particular attribute.</p>
</div>
<div class="paragraph">
<p>In the following example, the two metadata attributes <code>@author</code> and <code>@dateOfCreation</code> are declared for the <code>Person</code> fact type, and the two metadata items <code>@key</code> (literal) and <code>@maxLength</code> are declared for the <code>name</code> attribute. The <code>@key</code> literal metadata attribute has no required value, so the parentheses and the value are omitted.</p>
</div>
<div class="listingblock">
<div class="title">Example metadata declaration for fact types and attributes</div>
<div class="content">
<pre class="highlight"><code>import java.util.Date

declare Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )

    name : String @key @maxLength( 30 )
    dateOfBirth : Date
    address : Address
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For declarations of metadata attributes for existing types, you can identify the fully qualified class name as part of the <code>import</code> clause for all declarations or as part of the individual <code>declare</code> clause:</p>
</div>
<div class="listingblock">
<div class="title">Example metadata declaration for an imported type</div>
<div class="content">
<pre class="highlight"><code>import org.drools.examples.Person

declare Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example metadata declaration for a declared type</div>
<div class="content">
<pre class="highlight"><code>declare org.drools.examples.Person
    @author( Bob )
    @dateOfCreation( 01-Feb-2009 )
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="ref-drl-declarations-metadata-tags_kogito-drl-rules"><a class="anchor" href="#ref-drl-declarations-metadata-tags_kogito-drl-rules"></a><a class="link" href="#ref-drl-declarations-metadata-tags_kogito-drl-rules">Metadata tags for fact type and attribute declarations in DRL</a></h6>
<div class="paragraph">
<p>Although you can define custom metadata attributes in DRL declarations, the decision engine also supports the following predefined metadata tags for declarations of fact types or fact type attributes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The examples in this section that refer to the <code>VoiceCall</code> class assume that the sample application domain model includes the following class details:</p>
</div>
<div class="listingblock">
<div class="title">VoiceCall fact class in an example Telecom domain model</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class VoiceCall {
  private String  originNumber;
  private String  destinationNumber;
  private Date    callDateTime;
  private long    callDuration;  // in milliseconds

  // Constructors, getters, and setters
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@role</dt>
<dd>
<p>This tag determines whether a given fact type is handled as a regular fact or an event in the decision engine during complex event processing.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: <code>fact</code></p>
</div>
<div class="paragraph">
<p>Supported parameters: <code>fact</code>, <code>event</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@role( fact | event )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall as event type</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@timestamp</dt>
<dd>
<p>This tag is automatically assigned to every event in the decision engine. By default, the time is provided by the session clock and assigned to the event when it is inserted into the working memory of the decision engine. You can specify a custom time stamp attribute instead of the default time stamp added by the session clock.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: The time added by the decision engine session clock</p>
</div>
<div class="paragraph">
<p>Supported parameters: Session clock time or custom time stamp attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@timestamp( <em>ATTRIBUTE_NAME</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall timestamp attribute</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@duration</dt>
<dd>
<p>This tag determines the duration time for events in the decision engine. Events can be interval-based events or point-in-time events. Interval-based events have a duration time and persist in the working memory of the decision engine until their duration time has lapsed. Point-in-time events have no duration and are essentially interval-based events with a duration of zero. By default, every event in the decision engine has a duration of zero. You can specify a custom duration attribute instead of the default.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: Null (zero)</p>
</div>
<div class="paragraph">
<p>Supported parameters: Custom duration attribute</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@duration( <em>ATTRIBUTE_NAME</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall duration attribute</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@expires</dt>
<dd>
<p>This tag determines the time duration before an event expires in the working memory of the decision engine. By default, an event expires when the event can no longer match and activate any of the current rules. You can define an amount of time after which an event should expire. This tag definition also overrides the implicit expiration offset calculated from temporal constraints and sliding windows in the KIE base. This tag is available only when the decision engine is running in stream mode.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: Null (event expires after event can no longer match and activate rules)</p>
</div>
<div class="paragraph">
<p>Supported parameters: Custom <code>timeOffset</code> attribute in the format <code>[<mark>#d][#h][#m][#s][</mark>[ms]]</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@expires( <em>TIME_OFFSET</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare expiration offset for VoiceCall events</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( event )
  @timestamp( callDateTime )
  @duration( callDuration )
  @expires( 1h35m )
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@typesafe</dt>
<dd>
<p>This tab determines whether a given fact type is compiled with or without type safety. By default, all type declarations are compiled with type safety enabled. You can override this behavior to type-unsafe evaluation, where all constraints are generated as MVEL constraints and executed dynamically. This is useful when dealing with collections that do not have any generics or mixed type collections.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: <code>true</code></p>
</div>
<div class="paragraph">
<p>Supported parameters: <code>true</code>, <code>false</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@typesafe( <em>BOOLEAN</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare VoiceCall for type-unsafe evaluation</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @role( fact )
  @typesafe( false )
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@serialVersionUID</dt>
<dd>
<p>This tag defines an identifying <code>serialVersionUID</code> value for a serializable class in a fact declaration. If a serializable class does not explicitly declare a <code>serialVersionUID</code>, the serialization run time calculates a default <code>serialVersionUID</code> value for that class based on various aspects of the class, as described in the <a href="https://docs.oracle.com/javase/10/docs/specs/serialization/index.html">Java Object Serialization Specification</a>. However, for optimal deserialization results and for greater compatibility with serialized KIE sessions, set the <code>serialVersionUID</code> as needed in the relevant class or in your DRL declarations.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: Null</p>
</div>
<div class="paragraph">
<p>Supported parameters: Custom <code>serialVersionUID</code> integer</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@serialVersionUID( <em>INTEGER</em> )</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare serialVersionUID for a VoiceCall class</div>
<div class="content">
<pre class="highlight"><code>declare VoiceCall
  @serialVersionUID( 42 )
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@key</dt>
<dd>
<p>This tag enables a fact type attribute to be used as a key identifier for the fact type. The generated class can then implement the <code>equals()</code> and <code>hashCode()</code> methods to determine if two instances of the type are equal to each other. The decision engine can also generate a constructor using all the key attributes as parameters.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Default parameter: None</p>
</div>
<div class="paragraph">
<p>Supported parameters: None</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code><em>ATTRIBUTE_DEFINITION</em> @key</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Declare Person type attributes as keys</div>
<div class="content">
<pre class="highlight"><code>declare Person
    firstName : String @key
    lastName : String @key
    age : int
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example, the decision engine checks the <code>firstName</code> and <code>lastName</code> attributes to determine if two instances of <code>Person</code> are equal to each other, but it does not check the <code>age</code> attribute. The decision engine also implicitly generates three constructors: one without parameters, one with the <code>@key</code> fields, and one with all fields:</p>
</div>
<div class="listingblock">
<div class="title">Example constructors from the key declarations</div>
<div class="content">
<pre class="highlight"><code>Person() // Empty constructor

Person( String firstName, String lastName )

Person( String firstName, String lastName, int age )</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then create instances of the type based on the key constructors, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example instance using the key constructor</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Person person = new Person( "John", "Doe" );</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-queries_kogito-drl-rules"><a class="anchor" href="#con-drl-queries_kogito-drl-rules"></a><a class="link" href="#con-drl-queries_kogito-drl-rules">2.2.2.5. Queries in DRL</a></h5>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/query.png" alt="query">
</div>
<div class="title">Figure 122. Query</div>
</div>
<div class="paragraph _abstract">
<p>Queries in DRL files search the working memory of the decision engine for facts related to the rules in the DRL file. You add the query definitions in DRL files and then obtain the matching results in your application code. Queries search for a set of defined conditions and do not require <code>when</code> or <code>then</code> specifications. Query names are scoped to the rule unit, so each query name must be unique within the same rule unit. In Kogito, queries are automatically exposed as REST endpoints.</p>
</div>
<div class="paragraph">
<p>The following example is a query definition for an <code>Alert</code> object with a <code>severity</code> field set to <code>HIGH</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example query definition in a DRL file</div>
<div class="content">
<pre class="highlight"><code>package com.acme;
unit MonitoringService;

query highSeverity
    alerts : /alertData[ severity == "HIGH" ]
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kogito automatically exposes this query through an endpoint <code>/high-severity</code>.</p>
</div>
<div class="paragraph">
<p>For this example, assume that the <code>MonitoringService</code> rule unit class has the following form:</p>
</div>
<div class="listingblock">
<div class="title">Example Java rule unit class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.acme;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

public class MonitoringService implements RuleUnitData {
    private DataStream&lt;Temperature&gt; temperature = DataSource.createStream();
    private DataStream&lt;Alert&gt; alertData = DataSource.createStream();
    public DataStream&lt;Temperature&gt; getTemperature() { return temperature; }
    public DataStream&lt;Alert&gt; getAlertData() { return alertData; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, you can invoke the query using the following command:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request to the <code>/high-severity</code> endpoint</div>
<div class="content">
<pre class="highlight"><code>$ curl -X POST \
        -H 'Accept: application/json' \
        -H 'Content-Type: application/json' \
        -d '{ "eventData": [ { "type": "temperature", "value" : 20 }, { "type": "temperature", "value" : 100 } ] }' \
        http://localhost:8080/high-severity</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "alerts" : [
        {
            "severity" : "HIGH",
            "message" : "Temperature exceeds threshold: 100"
        }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example submits the data to the <code>eventData</code> data source and returns the result of the <code>highSeverity</code> query as a response.</p>
</div>
</div>
<div class="sect4">
<h5 id="con-property-change-listeners_kogito-drl-rules"><a class="anchor" href="#con-property-change-listeners_kogito-drl-rules"></a><a class="link" href="#con-property-change-listeners_kogito-drl-rules">2.2.2.6. Property-change settings and listeners for fact types</a></h5>
<div class="paragraph _abstract">
<p>By default, the decision engine does not re-evaluate all fact patterns for fact types each time a rule is triggered, but instead reacts only to modified properties that are constrained or bound inside a given pattern. For example, if a rule calls <code>modify()</code> on a fact as part of the rule actions, this modification does not automatically trigger the re-evaluation of all patterns referring to the modified type. Only the patterns constrained on the changed properties of that fact are re-evaluated. This property reactivity behavior prevents unwanted recursions and results in more efficient rule evaluation. This behavior also avoids the need of using the <code>no-loop</code> rule attribute to prevent infinite recursion.</p>
</div>
<div class="paragraph">
<p>You can modify or disable this property reactivity behavior with the following options, and then use a property-change setting in your Java class or DRL files to fine-tune property reactivity as needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ALWAYS</code>: (Default) All types are property reactive, but you can disable property reactivity for a specific type by using the <code>@classReactive</code> property-change setting.</p>
</li>
<li>
<p><code>ALLOWED</code>: No types are property reactive, but you can enable property reactivity for a specific type by using the <code>@propertyReactive</code> property-change setting.</p>
</li>
<li>
<p><code>DISABLED</code>: No types are property reactive. All property-change listeners are ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To set the property reactivity behavior, update the <code>drools.propertySpecific</code> system property in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Example property reactivity setting in system properties</div>
<div class="content">
<pre class="highlight"><code>drools.propertySpecific=ALLOWED</code></pre>
</div>
</div>
<div class="paragraph">
<p>The decision engine supports the following property-change settings and listeners for fact classes or declared DRL fact types:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@classReactive</dt>
<dd>
<p>If property reactivity is set to <code>ALWAYS</code> in the decision engine (all types are property reactive), this tag disables the default property reactivity behavior for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to re-evaluate all fact patterns for the specified fact type each time the rule is triggered, instead of reacting only to modified properties that are constrained or bound inside a given pattern.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example: Disable default property reactivity in a DRL type declaration</div>
<div class="content">
<pre class="highlight"><code>declare Person
  @classReactive
    firstName : String
    lastName : String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Disable default property reactivity in a Java class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@classReactive
public static class Person {
    private String firstName;
    private String lastName;
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@propertyReactive</dt>
<dd>
<p>If property reactivity is set to <code>ALLOWED</code> in the decision engine (no types are property reactive unless specified), this tag enables property reactivity for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to react only to modified properties that are constrained or bound inside a given pattern for the specified fact type, instead of re-evaluating all fact patterns for the fact each time the rule is triggered.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example: Enable property reactivity in a DRL type declaration (when reactivity is disabled globally)</div>
<div class="content">
<pre class="highlight"><code>declare Person
  @propertyReactive
    firstName : String
    lastName : String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Enable property reactivity in a Java class (when reactivity is disabled globally)</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@propertyReactive
public static class Person {
    private String firstName;
    private String lastName;
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@propertyChangeSupport</dt>
<dd>
<p>For facts that implement support for property changes as defined in the <a href="https://download.oracle.com/otndocs/jcp/7224-javabeans-1.01-fr-spec-oth-JSpec/">JavaBeans Specification</a>, this tag enables the decision engine to monitor changes in the fact properties.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example: Declare property change support in JavaBeans object</div>
<div class="content">
<pre class="highlight"><code>declare Person
    @propertyChangeSupport
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="ref-rules-attributes_kogito-drl-rules"><a class="anchor" href="#ref-rules-attributes_kogito-drl-rules"></a><a class="link" href="#ref-rules-attributes_kogito-drl-rules">2.2.2.7. Rule attributes in DRL</a></h5>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/rule_attributes.png" alt="rule attributes">
</div>
<div class="title">Figure 123. Rule attributes</div>
</div>
<div class="paragraph _abstract">
<p>Rule attributes are additional specifications that you can add to business rules to modify rule behavior.
In DRL files, you typically define rule attributes above the rule conditions and actions, with multiple attributes on separate lines, in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "rule_name"
    // Attribute
    // Attribute
    when
        // Conditions
    then
        // Actions
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table lists the names and supported values of the attributes that you can assign to rules:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 89. Rule attributes</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>salience</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer defining the priority of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue.</p>
<p class="tableblock">Example: <code>salience 10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value. When the option is selected, the rule is enabled. When the option is not selected, the rule is disabled.</p>
<p class="tableblock">Example: <code>enabled true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date-effective</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code>date-effective</code> attribute.</p>
<p class="tableblock">Example: <code>date-effective "4-Sep-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>date-expires</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code>date-expires</code> attribute.</p>
<p class="tableblock">Example: <code>date-expires "4-Oct-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no-loop</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value. When the option is selected, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition. When the condition is not selected, the rule can be looped in these circumstances.</p>
<p class="tableblock">Example: <code>no-loop true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>activation-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.</p>
<p class="tableblock">Example: <code>activation-group "GroupName"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.</p>
<p class="tableblock">Example: <code>duration 10000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying either <code>int</code> (interval) or <code>cron</code> timer definitions for scheduling the rule.</p>
<p class="tableblock">Example: <code>timer ( cron:* 0/15 * * * ? )</code>  (every 15 minutes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>calendar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="http://www.quartz-scheduler.org/">Quartz</a> calendar definition for scheduling the rule.</p>
<p class="tableblock">Example: <code>calendars "* * 0-7,18-23 ? * *"</code>  (exclude non-business hours)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auto-focus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within agenda groups. When the option is selected, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.</p>
<p class="tableblock">Example: <code>auto-focus true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lock-on-active</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within rule flow groups or agenda groups. When the option is selected, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code>no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.</p>
<p class="tableblock">Example: <code>lock-on-active true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dialect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying either <code>JAVA</code> or <code>MVEL</code> as the language to be used for code expressions in the rule. By default, the rule uses the dialect specified at the package level. Any dialect specified here overrides the package dialect setting for the rule.</p>
<p class="tableblock">Example: <code>dialect "JAVA"</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="con-drl-rules-conditions_kogito-drl-rules"><a class="anchor" href="#con-drl-rules-conditions_kogito-drl-rules"></a><a class="link" href="#con-drl-rules-conditions_kogito-drl-rules">2.2.2.8. Rule conditions in DRL</a></h5>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/rule.png" alt="rule">
</div>
<div class="title">Figure 124. Rule</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/lhs.png" alt="lhs">
</div>
<div class="title">Figure 125. Conditional element in a rule</div>
</div>
<div class="paragraph _abstract">
<p>The <code>when</code> part of a DRL rule (also known as the <em>Left Hand Side (LHS)</em> of the rule) contains the conditions that must be met to execute an action. Conditions consist of a series of stated OOPath expressions of patterns and constraints, with optional bindings and supported rule condition elements (keywords), based on the available data objects in the package. OOPath is an object-oriented syntax extension to XPath for navigating through related elements while handling collections and filtering constraints.</p>
</div>
<div class="paragraph">
<p>For example, in a decision service that raises alerts when the temperature reaches or exceeds 80 degrees, a rule <code>tooHot</code> contains the <code>when</code> condition <code>/temperature[value &gt;= 80]</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DRL uses <code>when</code> instead of <code>if</code> because <code>if</code> is typically part of a procedural execution flow during which a condition is checked at a specific point in time. In contrast, <code>when</code> indicates that the condition evaluation is not limited to a specific evaluation sequence or point in time, but instead occurs continually at any time. Whenever the condition is met, the actions are executed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>when</code> section is empty, then the conditions are considered to be true and the actions in the <code>then</code> section are executed the first time the rules are fired. This is useful if you want to use rules to set up the decision engine state.</p>
</div>
<div class="paragraph">
<p>The following example rule uses empty conditions to insert a fact every time the rule is executed:</p>
</div>
<div class="listingblock">
<div class="title">Example rule without conditions</div>
<div class="content">
<pre class="highlight"><code>rule "start-up"
  when
    // Empty
  then   // Actions to be executed once
    alerts.add( new Alert("INFO", "System started") );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Formally, the core grammar of an OOPath expression is defined in extended Backus-Naur form (EBNF) notation in the following way:</p>
</div>
<div class="listingblock">
<div class="title">EBNF notation for OOPath expressions</div>
<div class="content">
<pre class="highlight"><code>OOPExpr = [ID ( ":" | ":=" )] ( "/" | "?/" ) OOPSegment { ( "/" | "?/" | "." ) OOPSegment } ;
OOPSegment = ID ["#" ID] ["[" ( Number | Constraints ) "]"]</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_oopath_expressions_and_constraints"><a class="anchor" href="#_oopath_expressions_and_constraints"></a><a class="link" href="#_oopath_expressions_and_constraints">OOPath expressions and constraints</a></h6>
<div class="paragraph">
<p>An <em>OOPath expression</em> of a pattern in a DRL rule condition is the segment to be matched by the decision engine. An OOPath expression can potentially match each fact that is inserted into the working memory of the decision engine. It can also contain constraints to further define the facts to be matched.</p>
</div>
<div class="paragraph">
<p>In the simplest form, with no constraints, an OOPath expression matches a fact in the given data source. In the following example with a <code>DataSource&lt;Person&gt;</code> named <code>person</code>, the expression matches against all <code>Person</code> objects in the data source of the decision engine:</p>
</div>
<div class="listingblock">
<div class="title">Example expression for a single fact type</div>
<div class="content">
<pre class="highlight"><code>/person</code></pre>
</div>
</div>
<div class="paragraph">
<p>Patterns can also refer to superclasses or even interfaces, potentially matching facts from many different classes. For example, the following pattern matches all <code>Student</code> subtypes of the <code>Person</code> object:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern for subtypes</div>
<div class="content">
<pre class="highlight"><code>/person # Student</code></pre>
</div>
</div>
<div class="paragraph">
<p>Square brackets in a pattern enclose the constraints, such as the following constraint on the person&#8217;s age:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with a constraint</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <em>constraint</em> is an expression that returns <code>true</code> or <code>false</code>. Constraints in DRL are essentially Java expressions with some enhancements, such as property access, and some differences, such as <code>equals()</code> and <code>!equals()</code> semantics for <code>==</code> and <code>!=</code> (instead of the usual <code>same</code> and <code>not same</code> semantics).</p>
</div>
<div class="paragraph">
<p>Any JavaBeans property can be accessed directly from pattern constraints. A JavaBeans property is exposed internally using a standard JavaBeans getter that takes no arguments and returns something. For example, the <code>age</code> property is written as <code>age</code> in DRL instead of the getter <code>getAge()</code>:</p>
</div>
<div class="listingblock">
<div class="title">DRL constraint syntax with JavaBeans properties</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]

// This is equivalent to the following getter format:

/person[ getAge() == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kogito uses the standard JDK <code>Introspector</code> class to achieve this mapping and follows the standard JavaBeans specification. For optimal decision engine performance, use the property access format, such as <code>age</code>, instead of using getters explicitly, such as <code>getAge()</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use property accessors to change the state of the object in a way that might affect the rules because the decision engine caches the results of the match between invocations for higher efficiency.</p>
</div>
<div class="paragraph">
<p>For example, do not use property accessors in the following ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public int getAge() {
    age++; // Do not do this.
    return age;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public int getAge() {
    Date now = DateUtil.now(); // Do not do this.
    return DateUtil.differenceInYears(now, birthday);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of following the second example, insert a fact that wraps the current date in the working memory and update that fact between rule executions as needed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>However, if the getter of a property cannot be found, the compiler uses the property name as a fallback method name, without arguments:</p>
</div>
<div class="listingblock">
<div class="title">Fallback method if object is not found</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]

// If `Person.getAge()` does not exist, the compiler uses the following syntax:

/person[ age() == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also nest access properties in patterns, as shown in the following example. Nested properties are indexed by the decision engine.</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with nested property access</div>
<div class="content">
<pre class="highlight"><code>/person[ address.houseNumber == 50 ]

// This is equivalent to the following expression:

/person[ getAddress().getHouseNumber() == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use any Java expression that returns a <code>boolean</code> value as a constraint inside the parentheses of a pattern. Java expressions can be mixed with other expression enhancements, such as property access:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with a constraint using property access and Java expression</div>
<div class="content">
<pre class="highlight"><code>/person[ age == 50 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can change the evaluation priority by using parentheses, as in any logical or mathematical expression:</p>
</div>
<div class="listingblock">
<div class="title">Example evaluation order of constraints</div>
<div class="content">
<pre class="highlight"><code>/person[ age &gt; 100 &amp;&amp; ( age % 10 == 0 ) ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also reuse Java methods in constraints, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example constraints with reused Java methods</div>
<div class="content">
<pre class="highlight"><code>/person[ Math.round( weight / ( height * height ) ) &lt; 25.0 ]</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use constraints to change the state of the object in a way that might affect the rules because the decision engine caches the results of the match between invocations for higher efficiency. Any method that is executed on a fact in the rule conditions must be a read-only method. Also, the state of a fact should not change between rule invocations unless those facts are marked as updated in the working memory on every change.</p>
</div>
<div class="paragraph">
<p>For example, do not use a pattern constraint in the following ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/person[ incrementAndGetAge() == 10 ] // Do not do this.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/person[ System.currentTimeMillis() % 1000 == 0 ] // Do not do this.</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Standard Java operator precedence applies to constraint operators in DRL, and DRL operators follow standard Java semantics except for the <code>==</code> and <code>!=</code> operators.</p>
</div>
<div class="paragraph">
<p>The <code>==</code> operator uses null-safe <code>equals()</code> semantics instead of the usual <code>same</code> semantics. For example, the pattern <code>/person[ firstName == "John" ]</code> is similar to <code>java.util.Objects.equals(person.getFirstName(), "John")</code>, and because <code>"John"</code> is not null, the pattern is also similar to <code>"John".equals(person.getFirstName())</code>.</p>
</div>
<div class="paragraph">
<p>The <code>!=</code> operator uses null-safe <code>!equals()</code> semantics instead of the usual <code>not same</code> semantics. For example, the pattern <code>/person[ firstName != "John" ]</code> is similar to <code>!java.util.Objects.equals(person.getFirstName(), "John")</code>.</p>
</div>
<div class="paragraph">
<p>If the field and the value of a constraint are of different types, the decision engine uses type coercion to resolve the conflict and reduce compilation errors. For instance, if <code>"ten"</code> is provided as a string in a numeric evaluator, a compilation error occurs, whereas <code>"10"</code> is coerced to a numeric 10. In coercion, the field type always takes precedence over the value type:</p>
</div>
<div class="listingblock">
<div class="title">Example constraint with a value that is coerced</div>
<div class="content">
<pre class="highlight"><code>/person[ age == "10" ] // "10" is coerced to 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>For groups of constraints, you can use a delimiting comma <code>,</code> to use implicit <code>and</code> connective semantics:</p>
</div>
<div class="listingblock">
<div class="title">Example patterns with multiple constraints</div>
<div class="content">
<pre class="highlight"><code>// Person is at least 50 years old and weighs at least 80 kilograms:
/person[ age &gt; 50, weight &gt; 80 ]

// Person is at least 50 years old, weighs at least 80 kilograms, and is taller than 2 meters:
/person[ age &gt; 50, weight &gt; 80, height &gt; 2 ]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although the <code>&amp;&amp;</code> and <code>,</code> operators have the same semantics, they are resolved with different priorities. The <code>&amp;&amp;</code> operator precedes the <code>||</code> operator, and both the <code>&amp;&amp;</code> and <code>||</code> operators together precede the <code>,</code> operator. Use the comma operator at the top-level constraint for optimal decision engine performance and human readability.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You cannot embed a comma operator in a composite constraint expression, such as in parentheses:</p>
</div>
<div class="listingblock">
<div class="title">Example of misused comma in composite constraint expression</div>
<div class="content">
<pre class="highlight"><code>// Do not use the following format:
/person[ ( age &gt; 50, weight &gt; 80 ) || height &gt; 2 ]

// Use the following format instead:
/person[ ( age &gt; 50 &amp;&amp; weight &gt; 80 ) || height &gt; 2 ]</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_bound_variables_in_patterns_and_constraints"><a class="anchor" href="#_bound_variables_in_patterns_and_constraints"></a><a class="link" href="#_bound_variables_in_patterns_and_constraints">Bound variables in patterns and constraints</a></h6>
<div class="paragraph">
<p>You can bind variables to OOPath expressions of patterns and constraints to refer to matched objects in other portions of a rule. Bound variables can help you define rules more efficiently or more consistently with how you annotate facts in your data model.</p>
</div>
<div class="paragraph">
<p>For example, the following DRL rule uses the variable <code>$p</code> for an OOPath expression with the <code>Person</code> fact:</p>
</div>
<div class="listingblock">
<div class="title">Pattern with a bound variable</div>
<div class="content">
<pre class="highlight"><code>rule "simple rule"
  when
    $p : /person
  then
    System.out.println( "Person " + p );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, you can also bind variables to nested properties, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>// Two persons of the same age:
/person[ firstAge : age ]  // Binding
and
/person[ age == firstAge ] // Constraint expression</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that you separate constraint bindings and constraint expressions for clearer and more efficient rule definitions. Although mixed bindings and expressions are supported, they can complicate patterns and affect evaluation efficiency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>// Do not use the following format:
/person[ age : age * 2 &lt; 100 ]

// Use the following format instead:
/person[ age * 2 &lt; 100, $age : age ]</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_nested_constraints_and_inline_casts"><a class="anchor" href="#_nested_constraints_and_inline_casts"></a><a class="link" href="#_nested_constraints_and_inline_casts">Nested constraints and inline casts</a></h6>
<div class="paragraph">
<p>In some cases, you might need to access multiple properties of a nested object, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern to access multiple properties</div>
<div class="content">
<pre class="highlight"><code>/person[ name == "mark", address.city == "london", address.country == "uk" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can group these property accessors to nested objects for more readable rules, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with grouped constraints</div>
<div class="content">
<pre class="highlight"><code>/person[ name == "mark"]/address[ city == "london", country == "uk" ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you work with nested objects, you can use the syntax <code><em>TYPE</em>#<em>SUB_TYPE</em></code> to cast to a subtype and make the getters from the parent type available to the subtype. You can use either the object name or fully qualified class name, and you can cast to one or multiple subtypes, as shown in the following examples:</p>
</div>
<div class="listingblock">
<div class="title">Example patterns with inline casting to a subtype</div>
<div class="content">
<pre class="highlight"><code>// Inline casting with subtype name:
/person[ name == "mark"]/address#LongAddress[ country == "uk" ]

// Inline casting with fully qualified class name:
/person[ name == "mark"]/address#org.domain.LongAddress[ country == "uk" ]

// Multiple inline casts:
/person[ name == "mark" ]/address#LongAddress/country#DetailedCountry[ population &gt; 10000000 ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>These example patterns cast <code>Address</code> to <code>LongAddress</code>, and additionally to <code>DetailedCountry</code> in the last example, making the parent getters available to the subtypes in each case.</p>
</div>
</div>
<div class="sect5">
<h6 id="_date_literal_in_constraints"><a class="anchor" href="#_date_literal_in_constraints"></a><a class="link" href="#_date_literal_in_constraints">Date literal in constraints</a></h6>
<div class="paragraph">
<p>By default, the decision engine supports the date format <code>dd-mmm-yyyy</code>. You can customize the date format, including a time format mask if needed, by providing an alternative format mask with the system property <code>drools.dateformat="dd-mmm-yyyy hh:mm"</code>. You can also customize the date format by changing the language locale with the <code>drools.defaultlanguage</code> and <code>drools.defaultcountry</code> system properties. For example, the locale of Thailand is set as <code>drools.defaultlanguage=th</code> and <code>drools.defaultcountry=TH</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example pattern with a date literal restriction</div>
<div class="content">
<pre class="highlight"><code>/person[ bornBefore &lt; "27-Oct-2009" ]</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_auto_boxing_and_primitive_types"><a class="anchor" href="#_auto_boxing_and_primitive_types"></a><a class="link" href="#_auto_boxing_and_primitive_types">Auto-boxing and primitive types</a></h6>
<div class="paragraph">
<p>Drools attempts to preserve numbers in their primitive or object wrapper form, so a variable bound to an int primitive when used in a code block or expression will no longer need manual unboxing; unlike early Drools versions where all primitives were autoboxed, requiring manual unboxing.
A variable bound to an object wrapper will remain as an object; the existing JDK 1.5 and JDK 5 rules to handle auto-boxing and unboxing apply in this case.
When evaluating field constraints, the system attempts to coerce one of the values into a comparable format; so a primitive is comparable to an object wrapper.</p>
</div>
</div>
<div class="sect5">
<h6 id="ref-drl-operators_kogito-drl-rules"><a class="anchor" href="#ref-drl-operators_kogito-drl-rules"></a><a class="link" href="#ref-drl-operators_kogito-drl-rules">Supported operators in DRL constraints</a></h6>
<div class="paragraph _abstract">
<p>DRL supports standard Java semantics for operators in constraints, with some exceptions and with some additional operators that are unique in DRL. The following list summarizes the operators that are handled differently in DRL constraints than in standard Java semantics or that are unique in DRL constraints.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>/</code>, <code>#</code></dt>
<dd>
<p>Use the <code>/</code> operator to group property accessors to nested objects, and use the <code>#</code> operator to cast to a subtype in nested objects. Casting to a subtype makes the getters from the parent type available to the subtype. You can use either the object name or fully qualified class name, and you can cast to one or multiple subtypes.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with nested objects</div>
<div class="content">
<pre class="highlight"><code>// Ungrouped property accessors:
/person[ name == "mark", address.city == "london", address.country == "uk" ]

// Grouped property accessors:
/person[ name == "mark"]/address[ city == "london", country == "uk" ]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with inline casting to a subtype</div>
<div class="content">
<pre class="highlight"><code>// Inline casting with subtype name:
/person[ name == "mark", address#LongAddress.country == "uk" ]

// Inline casting with fully qualified class name:
/person[ name == "mark", address#org.domain.LongAddress.country == "uk" ]

// Multiple inline casts:
/person[ name == "mark", address#LongAddress.country#DetailedCountry.population &gt; 10000000 ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>!.</code></dt>
<dd>
<p>Use this operator to dereference a property in a null-safe way. The value to the left of the <code>!.</code> operator must be not null (interpreted as <code>!= null</code>) in order to give a positive result for pattern matching.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraint with null-safe dereferencing</div>
<div class="content">
<pre class="highlight"><code>/person[ $streetName : address!.street ]

// This is internally rewritten in the following way:

/person[ address != null, $streetName : address.street ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>[]</code></dt>
<dd>
<p>Use this operator to access a <code>List</code> value by index or a <code>Map</code> value by key.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with <code>List</code> and <code>Map</code> access</div>
<div class="content">
<pre class="highlight"><code>// The following format is the same as `childList(0).getAge() == 18`:
/person[childList[0].age == 18]

// The following format is the same as `credentialMap.get("jdoe").isValid()`:
/person[credentialMap["jdoe"].valid]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code></dt>
<dd>
<p>Use these operators on properties with natural ordering. For example, for <code>Date</code> fields, the <code>&lt;</code> operator means <em>before</em>, and for <code>String</code> fields, the operator means <em>alphabetically before</em>. These properties apply only to comparable properties.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with <code>before</code> operator</div>
<div class="content">
<pre class="highlight"><code>/person[ birthDate &lt; $otherBirthDate ]

/person[ firstName &lt; $otherFirstName ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>==</code>, <code>!=</code></dt>
<dd>
<p>Use these operators as <code>equals()</code> and <code>!equals()</code> methods in constraints, instead of the usual <code>same</code> and <code>not same</code> semantics.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraint with null-safe equality</div>
<div class="content">
<pre class="highlight"><code>/person[ firstName == "John" ]

// This is similar to the following formats:

java.util.Objects.equals(person.getFirstName(), "John")
"John".equals(person.getFirstName())</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraint with null-safe not equality</div>
<div class="content">
<pre class="highlight"><code>/person[ firstName != "John" ]

// This is similar to the following format:

!java.util.Objects.equals(person.getFirstName(), "John")</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>&amp;&amp;</code>, <code>||</code></dt>
<dd>
<p>Use these operators to create an abbreviated combined relation condition that adds more than one restriction on a field. You can group constraints with parentheses <code>()</code> to create a recursive syntax pattern.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with abbreviated combined relation</div>
<div class="content">
<pre class="highlight"><code>// Simple abbreviated combined relation condition using a single `&amp;&amp;`:
/person[age &gt; 30 &amp;&amp; &lt; 40]

// Complex abbreviated combined relation using groupings:
/person[age ((&gt; 30 &amp;&amp; &lt; 40) || (&gt; 20 &amp;&amp; &lt; 25))]

// Mixing abbreviated combined relation with constraint connectives:
/person[age &gt; 30 &amp;&amp; &lt; 40 || location == "london"]</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/abbreviatedCombinedRelationCondition.png" alt="abbreviatedCombinedRelationCondition">
</div>
<div class="title">Figure 126. Abbreviated combined relation condition</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/abbreviatedCombinedRelationConditionGroup.png" alt="abbreviatedCombinedRelationConditionGroup">
</div>
<div class="title">Figure 127. Abbreviated combined relation condition withparentheses</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>matches</code>, <code>not matches</code></dt>
<dd>
<p>Use these operators to indicate that a field matches or does not match a specified Java regular expression. Typically, the regular expression is a <code>String</code> literal, but variables that resolve to a valid regular expression are also supported. These operators apply only to <code>String</code> properties. If you use <code>matches</code> against a <code>null</code> value, the resulting evaluation is always <code>false</code>. If you use <code>not matches</code> against a <code>null</code> value, the resulting evaluation is always <code>true</code>. As in Java, regular expressions that you write as <code>String</code> literals must use a double backslash <code>\\</code> to escape.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraint to match or not match a regular expression</div>
<div class="content">
<pre class="highlight"><code>/person[ country matches "(USA)?\\S*UK" ]

/person[ country not matches "(USA)?\\S*UK" ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>contains</code>, <code>not contains</code></dt>
<dd>
<p>Use these operators to verify whether a field that is an <code>Array</code> or a <code>Collection</code> contains or does not contain a specified value. These operators apply to <code>Array</code> or <code>Collection</code> properties, but you can also use these operators in place of <code>String.contains()</code> and <code>!String.contains()</code> constraints checks.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with <code>contains</code> and <code>not contains</code> for a Collection</div>
<div class="content">
<pre class="highlight"><code>// Collection with a specified field:
/familyTree[ countries contains "UK" ]

/familyTree[ countries not contains "UK" ]


// Collection with a variable:
/familyTree[ countries contains $var ]

/familyTree[ countries not contains $var ]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>contains</code> and <code>not contains</code> for a String literal</div>
<div class="content">
<pre class="highlight"><code>// Sting literal with a specified field:
/person[ fullName contains "Jr" ]

/person[ fullName not contains "Jr" ]


// String literal with a variable:
/person[ fullName contains $var ]

/person[ fullName not contains $var ]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For backward compatibility, the <code>excludes</code> operator is a supported synonym for <code>not contains</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>memberOf</code>, <code>not memberOf</code></dt>
<dd>
<p>Use these operators to verify whether a field is a member of or is not a member of an <code>Array</code> or a <code>Collection</code> that is defined as a variable. The <code>Array</code> or <code>Collection</code> must be a variable.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with <code>memberOf</code> and <code>not memberOf</code> with a Collection</div>
<div class="content">
<pre class="highlight"><code>/familyTree[ person memberOf $europeanDescendants ]

/familyTree[ person not memberOf $europeanDescendants ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>soundslike</code></dt>
<dd>
<p>Use this operator to verify whether a word has almost the same sound, using English pronunciation, as the given value (similar to the <code>matches</code> operator). This operator uses the Soundex algorithm.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraint with <code>soundslike</code></div>
<div class="content">
<pre class="highlight"><code>// Match firstName "Jon" or "John":
/person[ firstName soundslike "John" ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>str</code></dt>
<dd>
<p>Use this operator to verify whether a field that is a <code>String</code> starts with or ends with a specified value. You can also use this operator to verify the length of the <code>String</code>.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example constraints with <code>str</code></div>
<div class="content">
<pre class="highlight"><code>// Verify what the String starts with:
/message[ routingValue str[startsWith] "R1" ]

// Verify what the String ends with:
/message[ routingValue str[endsWith] "R2" ]

// Verify the length of the String:
/message[ routingValue str[length] 17 ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>in</code>, <code>notin</code></dt>
<dd>
<p>Use these operators to specify more than one possible value to match in a constraint (compound value restriction). This functionality of compound value restriction is supported only in the <code>in</code> and <code>not in</code> operators. The second operand of these operators must be a comma-separated list of values enclosed in parentheses. You can provide values as variables, literals, return values, or qualified identifiers. These operators are internally rewritten as a list of multiple restrictions using the operators <code>==</code> or <code>!=</code>.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/compoundValueRestriction.png" alt="compoundValueRestriction">
</div>
<div class="title">Figure 128. compoundValueRestriction</div>
</div>
<div class="listingblock">
<div class="title">Example constraints with <code>in</code> and <code>notin</code></div>
<div class="content">
<pre class="highlight"><code>/person[ $color : favoriteColor ]
/color[ type in ( "red", "blue", $color ) ]

/person[ $color : favoriteColor ]
/color[ type notin ( "red", "blue", $color ) ]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="ref-drl-operator-precedence_kogito-drl-rules"><a class="anchor" href="#ref-drl-operator-precedence_kogito-drl-rules"></a><a class="link" href="#ref-drl-operator-precedence_kogito-drl-rules">Operator precedence in DRL pattern constraints</a></h6>
<div class="paragraph _abstract">
<p>DRL supports standard Java operator precedence for applicable constraint operators, with some exceptions and with some additional operators that are unique in DRL. The following table lists DRL operator precedence where applicable, from highest to lowest precedence:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 90. Operator precedence in DRL pattern constraints</caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operator type</th>
<th class="tableblock halign-left valign-top">Operators</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nested or null-safe property access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/</code>, <code>!.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List</code> or <code>Map</code> access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constraint binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiplicative</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code>, <code>/%</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code>, <code>-</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&gt;&gt;</code>, <code>&gt;&gt;&gt;</code>, <code>&lt;&lt;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>instanceof</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Equality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>== !=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uses <code>equals()</code> and <code>!equals()</code> semantics, not standard Java <code>same</code> and <code>not same</code> semantics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-short-circuiting <code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-short-circuiting exclusive <code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>^</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-short-circuiting inclusive <code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical <code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;&amp;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical <code>OR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>||</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ternary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>? :</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated <code>AND</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>,</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not standard Java semantics</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="ref-drl-rules-conditions-elements_kogito-drl-rules"><a class="anchor" href="#ref-drl-rules-conditions-elements_kogito-drl-rules"></a><a class="link" href="#ref-drl-rules-conditions-elements_kogito-drl-rules">Supported rule condition elements in DRL (keywords)</a></h6>
<div class="paragraph _abstract">
<p>DRL supports the following rule condition elements (keywords) that you can use with the patterns that you define in DRL rule conditions:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>and</code></dt>
<dd>
<p>Use this to group conditional components into a logical conjunction. Infix and prefix <code>and</code> are supported. You can group patterns explicitly with parentheses <code>()</code>. By default, all listed patterns are combined with <code>and</code> when no conjunction is specified.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/infixAnd.png" alt="infixAnd">
</div>
<div class="title">Figure 129. infixAnd</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/prefixAnd.png" alt="prefixAnd">
</div>
<div class="title">Figure 130. prefixAnd</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>and</code></div>
<div class="content">
<pre class="highlight"><code>//Infix `and`:
colorType: /color/type and /person[ favoriteColor == colorType ]

//Infix `and` with grouping:
(colorType: /color/type and (/person[ favoriteColor == colorType ] or /person[ favoriteColor == colorType ])

// Prefix `and`:
(and colorType: /color/type /person[ favoriteColor == colorType ])

// Default implicit `and`:
colorType: /color/type
/person[ favoriteColor == colorType ]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not use a leading declaration binding with the <code>and</code> keyword (as you can with <code>or</code>, for example). A declaration can only reference a single fact at a time, and if you use a declaration binding with <code>and</code>, then when <code>and</code> is satisfied, it matches both facts and results in an error.</p>
</div>
<div class="listingblock">
<div class="title">Example misuse of <code>and</code></div>
<div class="content">
<pre class="highlight"><code>// Causes compile error:
$person : (/person[ name == "Romeo" ] and /person[ name == "Juliet"])</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>or</code></dt>
<dd>
<p>Use this to group conditional components into a logical disjunction. Infix and prefix <code>or</code> are supported. You can group patterns explicitly with parentheses <code>()</code>. You can also use pattern binding with <code>or</code>, but each pattern must be bound separately.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/infixOr.png" alt="infixOr">
</div>
<div class="title">Figure 131. infixOr</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/prefixOr.png" alt="prefixOr">
</div>
<div class="title">Figure 132. prefixOr</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>or</code></div>
<div class="content">
<pre class="highlight"><code>//Infix `or`:
colorType: /color/type or /person[ favoriteColor == colorType]

//Infix `or` with grouping:
colorType: /color/type or (/person[ favoriteColor == colorType] and /person[ favoriteColor == colorType])

// Prefix `or`:
(or colorType: /color/type /person[ favoriteColor == colorType])</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>or</code> and pattern binding</div>
<div class="content">
<pre class="highlight"><code>pensioner : ( /person[ sex == "f", age &gt; 60 ] or /person[ sex == "m", age &gt; 65 ] )

(or pensioner : /person[ sex == "f", age &gt; 60 ]
    pensioner : /person[ sex == "m", age &gt; 65 ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The behavior of the <code>or</code> condition element is different from the connective <code>||</code> operator for constraints and restrictions in field constraints. The decision engine does not directly interpret the <code>or</code> element but uses logical transformations to rewrite a rule with <code>or</code> as a number of sub-rules. This process ultimately results in a rule that has a single <code>or</code> as the root node and one sub-rule for each of its condition elements. Each sub-rule is activated and executed like any normal rule, with no special behavior or interaction between the sub-rules.</p>
</div>
<div class="paragraph">
<p>Therefore, consider the <code>or</code> condition element a shortcut for generating two or more similar rules that, in turn, can create multiple activations when two or more terms of the disjunction are true.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>exists</code></dt>
<dd>
<p>Use this to specify facts and constraints that must exist. This option is triggered on only the first match, not subsequent matches. If you use this element with multiple patterns, enclose the patterns with parentheses <code>()</code>.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/exists.png" alt="exists">
</div>
<div class="title">Figure 133. Exists</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>exists</code></div>
<div class="content">
<pre class="highlight"><code>exists /person[ firstName == "John"]

exists (/person[ firstName == "John", age == 42 ])

exists (/person[ firstName == "John" ] and
        /person[ lastName == "Doe" ])</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>not</code></dt>
<dd>
<p>Use this to specify facts and constraints that must not exist. If you use this element with multiple patterns, enclose the patterns with parentheses <code>()</code>.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/not.png" alt="not">
</div>
<div class="title">Figure 134. Not</div>
</div>
<div class="listingblock">
<div class="title">Example patterns with <code>not</code></div>
<div class="content">
<pre class="highlight"><code>not /person[ firstName == "John"]

not (/person[ firstName == "John", age == 42 )]

not (/person[ firstName == "John" ] and
     /person[ lastName == "Doe" ])</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>forall</code></dt>
<dd>
<p>Use this to verify whether all facts that match the first pattern match all the remaining patterns. When a <code>forall</code> construct is satisfied, the rule evaluates to <code>true</code>. This element is a scope delimiter, so it can use any previously bound variable, but no variable bound inside of it is available for use outside of it.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/forall.png" alt="forall">
</div>
<div class="title">Figure 135. Forall</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code></div>
<div class="content">
<pre class="highlight"><code>rule "All full-time employees have red ID badges"
  when
    forall( $emp : /employee[ type == "fulltime" ]
                   /employee[ this == $emp, badgeColor = "red" ] )
  then
    // True, all full-time employees have red ID badges.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the rule selects all <code>employee</code> objects whose type is <code>"fulltime"</code>. For each fact that matches this pattern, the rule evaluates the patterns that follow (badge color) and if they match, the rule evaluates to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>To state that all facts of a given type in the working memory of the decision engine must match a set of constraints, you can use <code>forall</code> with a single pattern for simplicity.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code> and a single pattern</div>
<div class="content">
<pre class="highlight"><code>rule "All full-time employees have red ID badges"
  when
    forall( /employee[ badgeColor = "red" ] )
  then
    // True, all full-time employees have red ID badges.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>forall</code> constructs with multiple patterns or nest them with other condition elements, such as inside a <code>not</code> element construct.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code> and multiple patterns</div>
<div class="content">
<pre class="highlight"><code>rule "All employees have health and dental care programs"
  when
    forall( $emp : /employee
            /healthCare[ employee == $emp ]
            /dentalCare[ employee == $emp ]
          )
  then
    // True, all employees have health and dental care.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>forall</code> and <code>not</code></div>
<div class="content">
<pre class="highlight"><code>rule "Not all employees have health and dental care"
  when
    not ( forall( $emp : /employee
            /healthCare[ employee == $emp ]
            /dentalCare[ employee == $emp ] )
        )
  then
    // True, not all employees have health and dental care.
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The format <code>forall( p1 p2 p3 &#8230;&#8203;)</code> is equivalent to <code>not( p1 and not( and p2 p3 &#8230;&#8203; ) )</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>accumulate</code></dt>
<dd>
<p>Use this to iterate over a collection of objects, execute custom actions for each of the elements, and return one or more result objects (if the constraints evaluate to <code>true</code>). You can use predefined functions in your <code>accumulate</code> conditions or implement custom functions as needed. You can also use the abbreviation <code>acc</code> for <code>accumulate</code> in rule conditions.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Use the following format to define <code>accumulate</code> conditions in rules:</p>
</div>
<div class="listingblock">
<div class="title">Preferred format for <code>accumulate</code></div>
<div class="content">
<pre class="highlight"><code>accumulate( <em>SOURCE_PATTERN</em>; <em>FUNCTIONS</em> [;<em>CONSTRAINTS</em>] )</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/accumulate.png" alt="accumulate">
</div>
<div class="title">Figure 136. Accumulate</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although the decision engine supports alternate formats for the <code>accumulate</code> element for backward compatibility, this format is preferred for optimal performance in rules and applications.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The decision engine supports the following predefined <code>accumulate</code> functions. These functions accept any expression as input.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>average</code></p>
</li>
<li>
<p><code>min</code></p>
</li>
<li>
<p><code>max</code></p>
</li>
<li>
<p><code>count</code></p>
</li>
<li>
<p><code>sum</code></p>
</li>
<li>
<p><code>collectList</code></p>
</li>
<li>
<p><code>collectSet</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the following example rule, <code>min</code>, <code>max</code>, and <code>average</code> are <code>accumulate</code> functions that calculate the minimum, maximum, and average temperature values over all the readings for each sensor:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>accumulate</code> to calculate temperature values</div>
<div class="content">
<pre class="highlight"><code>rule "Raise alarm"
  when
    s : /sensor
    accumulate( /reading( sensor == $s, $temp : temperature );
                $min : min( $temp ),
                $max : max( $temp ),
                $avg : average( $temp );
                $min &lt; 20, $avg &gt; 70 )
  then
    // Raise the alarm.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example rule uses the <code>average</code> function with <code>accumulate</code> to calculate the average profit for all items in an order:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>accumulate</code> to calculate average profit</div>
<div class="content">
<pre class="highlight"><code>rule "Average profit"
  when
    $order : /order
    accumulate( /orderItem( order == $order, $cost : cost, $price : price );
                $avgProfit : average( 1 - $cost / $price ) )
  then
    // Average profit for `$order` is `$avgProfit`.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use custom, domain-specific functions in <code>accumulate</code> conditions, create a Java class that implements the <code>org.kie.api.runtime.rule.AccumulateFunction</code> interface. For example, the following Java class defines a custom implementation of an <code>AverageData</code> function:</p>
</div>
<div class="listingblock">
<div class="title">Example Java class with custom implementation of <code>average</code> function</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// An implementation of an accumulator capable of calculating average values

public class AverageAccumulateFunction implements org.kie.api.runtime.rule.AccumulateFunction&lt;AverageAccumulateFunction.AverageData&gt; {

    public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {

    }

    public void writeExternal(ObjectOutput out) throws IOException {

    }

    public static class AverageData implements Externalizable {
        public int    count = 0;
        public double total = 0;

        public AverageData() {}

        public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
            count   = in.readInt();
            total   = in.readDouble();
        }

        public void writeExternal(ObjectOutput out) throws IOException {
            out.writeInt(count);
            out.writeDouble(total);
        }

    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#createContext()
     */
    public AverageData createContext() {
        return new AverageData();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#init(java.io.Serializable)
     */
    public void init(AverageData context) {
        context.count = 0;
        context.total = 0;
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#accumulate(java.io.Serializable, java.lang.Object)
     */
    public void accumulate(AverageData context,
                           Object value) {
        context.count++;
        context.total += ((Number) value).doubleValue();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#reverse(java.io.Serializable, java.lang.Object)
     */
    public void reverse(AverageData context, Object value) {
        context.count--;
        context.total -= ((Number) value).doubleValue();
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#getResult(java.io.Serializable)
     */
    public Object getResult(AverageData context) {
        return new Double( context.count == 0 ? 0 : context.total / context.count );
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#supportsReverse()
     */
    public boolean supportsReverse() {
        return true;
    }

    /* (non-Javadoc)
     * @see org.kie.api.runtime.rule.AccumulateFunction#getResultType()
     */
    public Class&lt; ? &gt; getResultType() {
        return Number.class;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the custom function in a DRL rule, import the function using the <code>import accumulate</code> statement:</p>
</div>
<div class="listingblock">
<div class="title">Format to import a custom function</div>
<div class="content">
<pre class="highlight"><code>import accumulate <em>CLASS_NAME</em> <em>FUNCTION_NAME</em></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with the imported <code>average</code> function</div>
<div class="content">
<pre class="highlight"><code>import accumulate AverageAccumulateFunction.AverageData average

rule "Average profit"
  when
    $order : /order
    accumulate( /orderItem[ order == $order, $cost : cost, $price : price ];
                $avgProfit : average( 1 - $cost / $price ) )
  then
    // Average profit for `$order` is `$avgProfit`.
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For backward compatibility, the decision engine also supports the configuration of <code>accumulate</code> functions through configuration files and system properties, but this is a deprecated method. To configure the <code>average</code> function from the previous example using the configuration file or system property, set a property as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>drools.accumulate.function.average = AverageAccumulateFunction.AverageData</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <code>drools.accumulate.function</code> is a required prefix, <code>average</code> is how the function is used in the DRL files, and <code>AverageAccumulateFunction.AverageData</code> is the fully qualified name of the class that implements the function behavior.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="ref-drl-rules-conditions-elements-diagrams_kogito-drl-rules"><a class="anchor" href="#ref-drl-rules-conditions-elements-diagrams_kogito-drl-rules"></a><a class="link" href="#ref-drl-rules-conditions-elements-diagrams_kogito-drl-rules">Railroad diagrams for rule condition elements in DRL</a></h6>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateAction.png" alt="AccumulateAction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateClause.png" alt="AccumulateClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateFunction.png" alt="AccumulateFunction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateInit.png" alt="AccumulateInit">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateResult.png" alt="AccumulateResult">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateReverse.png" alt="AccumulateReverse">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AccumulateSteps.png" alt="AccumulateSteps">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Accumulations.png" alt="Accumulations">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AdditiveExpr.png" alt="AdditiveExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Annotation.png" alt="Annotation">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Arguments.png" alt="Arguments">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ArrayCreatorRest.png" alt="ArrayCreatorRest">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ArrayInitializer.png" alt="ArrayInitializer">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/AssignmentOperator.png" alt="AssignmentOperator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/BindingPattern.png" alt="BindingPattern">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Block.png" alt="Block">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/BooleanLiteral.png" alt="BooleanLiteral">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/CompilationUnit.png" alt="CompilationUnit">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalAnd.png" alt="ConditionalAnd">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalElementAccumulate.png" alt="ConditionalElementAccumulate">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalElementEval.png" alt="ConditionalElementEval">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalElementExists.png" alt="ConditionalElementExists">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalElementForall.png" alt="ConditionalElementForall">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalElementNot.png" alt="ConditionalElementNot">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalElement.png" alt="ConditionalElement">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalExpr.png" alt="ConditionalExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalOrExpr.png" alt="ConditionalOrExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ConditionalOr.png" alt="ConditionalOr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Constraints.png" alt="Constraints">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/CreatedName.png" alt="CreatedName">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Creator.png" alt="Creator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Definition.png" alt="Definition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Digit.png" alt="Digit">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ExplicitGenericInvocationSuffix.png" alt="ExplicitGenericInvocationSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ExplicitGenericInvocation.png" alt="ExplicitGenericInvocation">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Exponent.png" alt="Exponent">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ExpressionList.png" alt="ExpressionList">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Expression.png" alt="Expression">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Field.png" alt="Field">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Fraction.png" alt="Fraction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/FromAccumulateClause.png" alt="FromAccumulateClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/FromClause.png" alt="FromClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/FromCollectClause.png" alt="FromCollectClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/FunctionDefinition.png" alt="FunctionDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/GlobalDefinition.png" alt="GlobalDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/IdentifierSuffix.png" alt="IdentifierSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ImportDefinition.png" alt="ImportDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/InExpr.png" alt="InExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/InlineListExpr.png" alt="InlineListExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/InlineMapExpr.png" alt="InlineMapExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/InnerCreator.png" alt="InnerCreator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/InstanceOfExpr.png" alt="InstanceOfExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/IntLiteral.png" alt="IntLiteral">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Literal.png" alt="Literal">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ModifyStatement.png" alt="ModifyStatement">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/NonWildcardTypeArguments.png" alt="NonWildcardTypeArguments">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/OrRestriction.png" alt="OrRestriction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/OverClause.png" alt="OverClause">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Parameters.png" alt="Parameters">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Pattern.png" alt="Pattern">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Placeholders.png" alt="Placeholders">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Primary.png" alt="Primary">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/PrimitiveType.png" alt="PrimitiveType">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/QualifiedName.png" alt="QualifiedName">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/QueryDefinition.png" alt="QueryDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/QueryOptions.png" alt="QueryOptions">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RealLiteral.png" alt="RealLiteral">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RealTypeSuffix.png" alt="RealTypeSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RelationalExpr.png" alt="RelationalExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RelationalOperator.png" alt="RelationalOperator">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RhsStatement.png" alt="RhsStatement">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RuleAttributes.png" alt="RuleAttributes">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RuleAttribute.png" alt="RuleAttribute">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RuleDefinition.png" alt="RuleDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/RuleOptions.png" alt="RuleOptions">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Selector.png" alt="Selector">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ShiftExpr.png" alt="ShiftExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/SingleRestriction.png" alt="SingleRestriction">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/SourcePattern.png" alt="SourcePattern">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/StringId.png" alt="StringId">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/SuperSuffix.png" alt="SuperSuffix">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/ThenPart.png" alt="ThenPart">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/TypeArguments.png" alt="TypeArguments">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/TypeArgument.png" alt="TypeArgument">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/TypeDefinition.png" alt="TypeDefinition">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/TypeOptions.png" alt="TypeOptions">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Type.png" alt="Type">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/UnaryExprNotPlusMinus.png" alt="UnaryExprNotPlusMinus">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/UnaryExpr.png" alt="UnaryExpr">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/Value.png" alt="Value">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/VariableInitializer.png" alt="VariableInitializer">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/WhenPart.png" alt="WhenPart">
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-rules-actions_kogito-drl-rules"><a class="anchor" href="#con-drl-rules-actions_kogito-drl-rules"></a><a class="link" href="#con-drl-rules-actions_kogito-drl-rules">2.2.2.9. Rule actions in DRL</a></h5>
<div class="paragraph _abstract">
<p>The <code>then</code> part of the rule (also known as the <em>Right Hand Side (RHS)</em> of the rule) contains the actions to be performed when the conditional part of the rule has been met. Rule actions are typically determined by one or more <em>data sources</em> that you define as part of your DRL rule unit. For example, if a bank requires loan applicants to have over 21 years of age (with a rule condition <code>/applicant[ applicantName : name, age &lt; 21 ]</code>) and a loan applicant is under 21 years old, the <code>then</code> action of an <code>"Underage"</code> rule would be <code>setApproved( false )</code> based on a defined data source, declining the loan because the applicant is under age.</p>
</div>
<div class="paragraph">
<p>The main purpose of rule actions is to to insert, delete, or modify data in the working memory of the decision engine. Effective rule actions are small, declarative, and readable. If you need to use imperative or conditional code in rule actions, then divide the rule into multiple smaller and more declarative rules.</p>
</div>
<div class="listingblock">
<div class="title">Example rule for loan application age limit</div>
<div class="content">
<pre class="highlight"><code>rule "Underage"
  when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
  then
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about using data sources for rule actions, see <a href="#con-drl-rule-units_kogito-drl-rules">Rule units in DRL</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-rules-comments_kogito-drl-rules"><a class="anchor" href="#con-drl-rules-comments_kogito-drl-rules"></a><a class="link" href="#con-drl-rules-comments_kogito-drl-rules">2.2.2.10. Comments in DRL files</a></h5>
<div class="paragraph _abstract">
<p>DRL supports single-line comments prefixed with a double forward slash <code>//</code> and multi-line comments enclosed with a forward slash and asterisk <code>/* &#8230;&#8203; */</code>. You can use DRL comments to annotate rules or any related components in DRL files. DRL comments are ignored by the decision engine when the DRL file is processed.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with comments</div>
<div class="content">
<pre class="highlight"><code>rule "Underage"
  // This is a single-line comment.
  when
    /applicant[ applicantName : name, age &lt; 21 ]  // This is an in-line comment
    $application : /loanApplication[ applicant == applicantName ]
  then
    /* This is a multi-line comment
    in the rule actions. */
    $application.setApproved( false );
    $application.setExplanation( "Underage" );
end</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/multi_line_comment.png" alt="multi line comment">
</div>
<div class="title">Figure 137. Multi-line comment</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The hash symbol <code>#</code> is not supported for DRL comments.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="ref-drl-rules-errors_kogito-drl-rules"><a class="anchor" href="#ref-drl-rules-errors_kogito-drl-rules"></a><a class="link" href="#ref-drl-rules-errors_kogito-drl-rules">2.2.2.11. Error messages for DRL troubleshooting</a></h5>
<div class="paragraph _abstract">
<p>Kogito provides standardized messages for DRL errors to help you troubleshoot and resolve problems in your DRL files. The error messages use the following format:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/error_message.png" alt="error message">
</div>
<div class="title">Figure 138. Error message format for DRL file problems</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>1st Block:</strong> Error code</p>
</li>
<li>
<p><strong>2nd Block:</strong> Line and column in the DRL source where the error occurred</p>
</li>
<li>
<p><strong>3rd Block:</strong> Description of the problem</p>
</li>
<li>
<p><strong>4th Block:</strong> Component in the DRL source (rule, function, query) where the error occurred</p>
</li>
<li>
<p><strong>5th Block:</strong> Pattern in the DRL source where the error occurred (if applicable)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Kogito supports the following standardized error messages:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">101: no viable alternative</dt>
<dd>
<p>Indicates that the parser reached a decision point but could not identify an alternative.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example rule with incorrect spelling</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     exists /person
4:     exits /student  // Must be `exists`
5:   then
6: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 101] Line 4:4 no viable alternative at input 'exits' in rule "simple rule"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule without a rule name</div>
<div class="content">
<pre class="highlight"><code>1: package org.drools.examples;
2: rule    // Must be `rule "rule name"` (or `rule rule_name` if no spacing)
3:   when
4:     Object()
5:   then
6:     System.out.println("A RHS");
7: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 101] Line 3:2 no viable alternative at input 'when'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the parser encountered the keyword <code>when</code> but expected the rule name, so it flags <code>when</code> as the incorrect expected token.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with incorrect syntax</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     /student[ name == "Andy ]  // Must be `"Andy"`
4:   then
5: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 101] Line 0:-1 no viable alternative at input '&lt;eof&gt;' in rule "simple rule" in pattern student</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A line and column value of <code>0:-1</code> means the parser reached the end of the source file (<code>&lt;eof&gt;</code>) but encountered incomplete constructs, usually due to missing quotation marks <code>"&#8230;&#8203;"</code>, apostrophes <code>'&#8230;&#8203;'</code>, or parentheses <code>(&#8230;&#8203;)</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">102: mismatched input</dt>
<dd>
<p>Indicates that the parser expected a particular symbol that is missing at the current input position.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example rule with an incomplete rule statement</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     $p : /person[
        // Must be a complete rule statement</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 102] Line 0:-1 mismatched input '&lt;eof&gt;' expecting ']' in rule "simple rule" in pattern person</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A line and column value of <code>0:-1</code> means the parser reached the end of the source file (<code>&lt;eof&gt;</code>) but encountered incomplete constructs, usually due to missing quotation marks <code>"&#8230;&#8203;"</code>, apostrophes <code>'&#8230;&#8203;'</code>, or parentheses <code>(&#8230;&#8203;)</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example rule with incorrect syntax</div>
<div class="content">
<pre class="highlight"><code>1: package org.drools.examples;
2:
3: rule "Wrong syntax"
4:   when
5:     not /car[ ( type == "tesla", price == 10000 ) || ( type == "kia", price == 1000 ) ]
       // Must use `&amp;&amp;` operators instead of commas `,`
6:   then
7:     System.out.println("OK");
8: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error messages</div>
<div class="content">
<pre class="highlight"><code>[ERR 102] Line 5:36 mismatched input ',' expecting ')' in rule "Wrong syntax" in pattern car
[ERR 101] Line 5:57 no viable alternative at input 'type' in rule "Wrong syntax"
[ERR 102] Line 5:106 mismatched input ']' expecting 'then' in rule "Wrong syntax"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the syntactic problem results in multiple error messages related to each other. The single solution of replacing the commas <code>,</code> with <code>&amp;&amp;</code> operators resolves all errors. If you encounter multiple errors, resolve one at a time in case errors are consequences of previous errors.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">103: failed predicate</dt>
<dd>
<p>Indicates that a validating semantic predicate evaluated to <code>false</code>. These semantic predicates are typically used to identify component keywords in DRL files, such as <code>declare</code>, <code>rule</code>, <code>exists</code>, <code>not</code>, and others.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example rule with an invalid keyword</div>
<div class="content">
<pre class="highlight"><code> 1: package nesting;
 2:
 3: import org.drools.compiler.Person
 4: import org.drools.compiler.Address
 5:
 6: Some text  // Must be a valid DRL keyword
 7:
 8: rule "test something"
 9:   when
10:     $p: /person[ name=="Michael" ]
11:   then
12:     $p.name = "other";
13:     System.out.println(p.name);
14: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 103] Line 6:0 rule 'rule_key' failed predicate: {(validateIdentifierKey(DroolsSoftKeywords.RULE))}? in rule</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Some text</code> line is invalid because it does not begin with or is not a part of a DRL keyword construct, so the parser fails to validate the rest of the DRL file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This error is similar to <code>102: mismatched input</code>, but usually involves DRL keywords.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">104: trailing semi-colon not allowed</dt>
<dd>
<p>Indicates that an <code>eval()</code> clause in a rule condition uses a semicolon <code>;</code> but must not use one.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example rule with <code>eval()</code> and trailing semicolon</div>
<div class="content">
<pre class="highlight"><code>1: rule "simple rule"
2:   when
3:     eval( abc(); )  // Must not use semicolon `;`
4:   then
5: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 104] Line 3:4 trailing semi-colon not allowed in rule "simple rule"</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">105: did not match anything</dt>
<dd>
<p>Indicates that the parser reached a sub-rule in the grammar that must match an alternative at least once, but the sub-rule did not match anything. The parser has entered a branch with no way out.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example rule with invalid text in an empty condition</div>
<div class="content">
<pre class="highlight"><code>1: rule "empty condition"
2:   when
3:     None  // Must remove `None` if condition is empty
4:   then
5:      insert( new Person() );
6: end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Error message</div>
<div class="content">
<pre class="highlight"><code>[ERR 105] Line 2:2 required (...)+ loop did not match anything at input 'WHEN' in rule "empty condition"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the condition is intended to be empty but the word <code>None</code> is used. This error is resolved by removing <code>None</code>, which is not a valid DRL keyword, data type, or pattern construct.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="con-drl-legacy_kogito-drl-rules"><a class="anchor" href="#con-drl-legacy_kogito-drl-rules"></a><a class="link" href="#con-drl-legacy_kogito-drl-rules">2.2.2.12. Legacy DRL conventions</a></h5>
<div class="paragraph _abstract">
<p>The following Drools Rule Language (DRL) conventions are no longer applicable or optimal in Kogito but might be available for backward compatibility.</p>
</div>
<div class="sect5">
<h6 id="_legacy_functions_in_drl"><a class="anchor" href="#_legacy_functions_in_drl"></a><a class="link" href="#_legacy_functions_in_drl">Legacy functions in DRL</a></h6>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/function.png" alt="function">
</div>
<div class="title">Figure 139. Function</div>
</div>
<div class="paragraph">
<p>Functions in DRL files put semantic code in your rule source file instead of in Java classes. Functions are especially useful if an action (<code>then</code>) part of a rule is used repeatedly and only the parameters differ for each rule. Above the rules in the DRL file, you can declare the function or import a static method from a helper class as a function, and then use the function by name in an action (<code>then</code>) part of the rule.</p>
</div>
<div class="paragraph">
<p>The following examples illustrate a function that is either declared or imported in a DRL file:</p>
</div>
<div class="listingblock">
<div class="title">Example function declaration with a rule (option 1)</div>
<div class="content">
<pre class="highlight"><code>function String hello(String applicantName) {
    return "Hello " + applicantName + "!";
}

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example function import with a rule (option 2)</div>
<div class="content">
<pre class="highlight"><code>import function my.package.applicant.hello;

rule "Using a function"
  when
    // Empty
  then
    System.out.println( hello( "James" ) );
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_legacy_rule_attributes"><a class="anchor" href="#_legacy_rule_attributes"></a><a class="link" href="#_legacy_rule_attributes">Legacy rule attributes</a></h6>
<div class="paragraph">
<p>The following attributes were used in earlier versions of the decision engine to provide grouping of rules across a rule base. These attributes are superseded by DRL rule units and are only available for backward compatibility reasons. If you need to group your rules, use DRL rule units as a clearer and simpler grouping method.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 91. Legacy rule attributes</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>agenda-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying an agenda group to which you want to assign the rule. Agenda groups allow you to partition the agenda to provide more execution control over groups of rules. Only rules in an agenda group that has acquired a focus are able to be activated.</p>
<p class="tableblock">Example: <code>agenda-group "GroupName"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ruleflow-group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying a rule flow group. In rule flow groups, rules can fire only when the group is activated by the associated rule flow.</p>
<p class="tableblock">Example: <code>ruleflow-group "GroupName"</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_legacy_drl_rule_condition_syntax"><a class="anchor" href="#_legacy_drl_rule_condition_syntax"></a><a class="link" href="#_legacy_drl_rule_condition_syntax">Legacy DRL rule condition syntax</a></h6>
<div class="paragraph">
<p>In Kogito, the preferred syntax for DRL rule conditions is through OOPath expressions. For legacy use cases, you can write rules using traditional pattern matching. In this case, you must explicitly indicate the data source using the <code>from</code> clause, as shown in the following comparative examples:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file using OOPath notation</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: /person[ age &gt; 18 ]
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example <code>PersonRules</code> DRL file using traditional notation</div>
<div class="content">
<pre class="highlight"><code>package org.acme
unit PersonRules;

import org.acme.Person;

rule isAdult
	when
		$person: Person(age &gt; 18) from person
	then
    modify($person) {
    	setAdult(true)
    };
end</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_legacy_drl_rule_condition_elements"><a class="anchor" href="#_legacy_drl_rule_condition_elements"></a><a class="link" href="#_legacy_drl_rule_condition_elements">Legacy DRL rule condition elements</a></h6>
<div class="paragraph">
<p>The following rule condition elements (keywords) are obsolete in Kogito:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>from</code></dt>
<dd>
<p>(Obsolete with OOPath notation)</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Use this to specify a data source for a pattern. This enables the decision engine to reason over data that is not in the working memory. The data source can be a sub-field on a bound variable or the result of a method call. The expression used to define the object source is any expression that follows regular MVEL syntax. Therefore, the <code>from</code> element enables you to easily use object property navigation, execute method calls, and access maps and collection elements.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/from.png" alt="from">
</div>
<div class="title">Figure 140. from</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> and pattern binding</div>
<div class="content">
<pre class="highlight"><code>rule "Validate zipcode"
  when
    Person( $personAddress : address )
    Address( zipcode == "23920W" ) from $personAddress
  then
    // Zip code is okay.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> and a graph notation</div>
<div class="content">
<pre class="highlight"><code>rule "Validate zipcode"
  when
    $p : Person()
    $a : Address( zipcode == "23920W" ) from $p.address
  then
    // Zip code is okay.
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> to iterate over all objects</div>
<div class="content">
<pre class="highlight"><code>rule "Apply 10% discount to all items over US$ 100 in an order"
  when
    $order : Order()
    $item  : OrderItem( value &gt; 100 ) from $order.items
  then
    // Apply discount to `$item`.
end</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For large collections of objects, instead of adding an object with a large graph that the decision engine must iterate over frequently, add the collection directly to the KIE session and then join the collection in the condition, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>when
  $order : Order()
  OrderItem( value &gt; 100, order == $order )</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from</code> and <code>lock-on-active</code> rule attribute</div>
<div class="content">
<pre class="highlight"><code>rule "Assign people in North Carolina (NC) to sales region 1"
  ruleflow-group "test"
  lock-on-active true
  when
    $p : Person()
    $a : Address( state == "NC" ) from $p.address
  then
    modify ($p) {} // Assign the person to sales region 1.
end

rule "Apply a discount to people in the city of Raleigh"
  ruleflow-group "test"
  lock-on-active true
  when
    $p : Person()
    $a : Address( city == "Raleigh" ) from $p.address
  then
    modify ($p) {} // Apply discount to the person.
end</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using <code>from</code> with <code>lock-on-active</code> rule attribute can result in rules not being executed. You can address this issue in one of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid using the <code>from</code> element when you can insert all facts into the working memory of the decision engine or use nested object references in your constraint expressions.</p>
</li>
<li>
<p>Place the variable used in the <code>modify()</code> block as the last sentence in your rule condition.</p>
</li>
<li>
<p>Avoid using the <code>lock-on-active</code> rule attribute when you can explicitly manage how rules within the same ruleflow group place activations on one another.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The pattern that contains a <code>from</code> clause cannot be followed by another pattern starting with a parenthesis. The reason for this restriction is that the DRL parser reads the <code>from</code> expression as <code>"from $l (String() or Number())"</code> and it cannot differentiate this expression from a function call. The simplest workaround to this is to wrap the <code>from</code> clause in parentheses, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example rules with <code>from</code> used incorrectly and correctly</div>
<div class="content">
<pre class="highlight"><code>// Do not use `from` in this way:
rule R
  when
    $l : List()
    String() from $l
    (String() or Number())
  then
    // Actions
end

// Use `from` in this way instead:
rule R
  when
    $l : List()
    (String() from $l)
    (String() or Number())
  then
    // Actions
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>entry-point</code></dt>
<dd>
<p>(Superseded by rule unit data sources)</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Use this to define an entry point, or <em>event stream</em>, corresponding to a data source for the pattern. This element is typically used with the <code>from</code> condition element. You can declare an entry point for events so that the decision engine uses data from only that entry point to evaluate the rules. You can declare an entry point either implicitly by referencing it in DRL rules or explicitly in your Java application.</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>from entry-point</code></div>
<div class="content">
<pre class="highlight"><code>rule "Authorize withdrawal"
  when
    WithdrawRequest( $ai : accountId, $am : amount ) from entry-point "ATM Stream"
    CheckingAccount( accountId == $ai, balance &gt; $am )
  then
    // Authorize withdrawal.
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>collect</code></dt>
<dd>
<p>(Obsolete with OOPath notation)</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Use this to define a collection of objects that the rule can use as part of the condition. The rule obtains the collection either from a specified source or from the working memory of the decision engine. The result pattern of the <code>collect</code> element can be any concrete class that implements the <code>java.util.Collection</code> interface and provides a default no-arg public constructor. You can use Java collections like <code>List</code>, <code>LinkedList</code>, and <code>HashSet</code>, or your own class. If variables are bound before the <code>collect</code> element in a condition, you can use the variables to constrain both your source and result patterns. However, any binding made inside the <code>collect</code> element is not available for use outside of it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/collect.png" alt="collect">
</div>
<div class="title">Figure 141. Collect</div>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>collect</code></div>
<div class="content">
<pre class="highlight"><code>import java.util.List

rule "Raise priority when system has more than three pending alarms"
  when
    $system : System()
    $alarms : List( size &gt;= 3 )
              from collect( Alarm( system == $system, status == 'pending' ) )
  then
    // Raise priority because `$system` has three or more `$alarms` pending.
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the rule assesses all pending alarms in the working memory of the decision engine for each given system and groups them in a <code>List</code>. If three or more alarms are found for a given system, the rule is executed.</p>
</div>
<div class="paragraph">
<p>You can also use the <code>collect</code> element with nested <code>from</code> elements, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example rule with <code>collect</code> and nested <code>from</code></div>
<div class="content">
<pre class="highlight"><code>import java.util.LinkedList;

rule "Send a message to all parents"
  when
    $town : Town( name == 'Paris' )
    $mothers : LinkedList()
               from collect( Person( children &gt; 0 )
                             from $town.getPeople()
                           )
  then
    // Send a message to all parents.
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>accumulate</code> alternate syntax for a single function with return type</dt>
<dd>
<p>The accumulate syntax evolved over time with the goal of becoming more compact and expressive.
Nevertheless, Kogito still supports previous syntaxes for backward compatibility purposes.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In case the rule is using a single accumulate function on a given accumulate, the author may add a pattern for the result object and use the "from" keyword to link it to the accumulate result.</p>
</div>
<div class="paragraph">
<p>Example: a rule to apply a 10% discount on orders over $100 could be written in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Apply 10% discount to orders over US$ 100,00"
when
    $order : /order
    $total : Number( doubleValue &gt; 100 )
             from accumulate( OrderItem( order == $order, $value : value ),
                              sum( $value ) )
then
    // apply discount to $order
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the accumulate element is using only one function (sum), and so, the rules author opted to explicitly write a pattern for the result type of the accumulate function (Number) and write the constraints inside it.
There are no problems in using this syntax over the compact syntax presented before, except that is is a bit more verbose.
Also note that it is not allowed to use both the return type and the functions binding in the same accumulate statement.</p>
</div>
<div class="paragraph">
<p>Compile-time checks are performed in order to ensure the pattern used with the "<code>from</code>" keyword is  assignable from the result of the accumulate function used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>With this syntax, the "<code>from</code>" binds to the single result returned by the accumulate function, and it does not iterate.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the above example, "<code>$total</code>" is bound to the result returned by the accumulate sum() function.</p>
</div>
<div class="paragraph">
<p>As another example however, if the result of the accumulate function is a collection, "<code>from</code>" still binds to the single result and it does not iterate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Person names"
when
  $x : Object() from accumulate(MyPerson( $val : name );
                                collectList( $val ) )
then
  // $x is a List
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bound "<code>$x : Object()</code>" is the List itself, returned by the collectList accumulate function used.</p>
</div>
<div class="paragraph">
<p>This is an important distinction to highlight, as the "<code>from</code>" keyword can also be used separately of accumulate, to iterate over the elements of a collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Iterate the numbers"
when
    $xs : List()
    $x : Integer() from $xs
then
  // $x matches and binds to each Integer in the collection
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>While this syntax is still supported for backward compatibility purposes, for this and other reasons we encourage rule authors to make use instead of the preferred <code>accumulate</code> syntax (described previously), to avoid any potential pitfalls.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>accumulate</code> with inline custom code</dt>
<dd>
<p>Another possible syntax for the <code>accumulate</code> is to define inline custom code, instead of using accumulate functions.</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The use of accumulate with inline custom code is not a good practice for several reasons, including difficulties on maintaining and testing rules that use them, as well as the inability of reusing that code.
Implementing your own accumulate functions is very simple and straightforward, they are easy to unit test and to use.
This form of accumulate is supported for backward compatibility only.</p>
</div>
<div class="paragraph">
<p>Only limited support for inline accumulate is provided while using the executable model.
For example, you cannot use an external binding in the code while using the MVEL dialect:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule R
dialect "mvel"
when
    String( $l : length )
    $sum : Integer() from accumulate (
                           Person( age &gt; 18, $age : age ),
                           init( int sum = 0 * $l; ),
                           action( sum += $age; ),
                           reverse( sum -= $age; ),
                           result( sum )
                     )</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The general syntax of the <code>accumulate</code> CE with inline custom code is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code><em>RESULT_PATTERN</em> from accumulate( <em>SOURCE_PATTERN</em>,
                                  init( <em>INIT_CODE</em> ),
                                  action( <em>ACTION_CODE</em> ),
                                  reverse( <em>REVERSE_CODE</em> ),
                                  result( <em>RESULT_EXPRESSION</em> ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of each of the elements is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>SOURCE_PATTERN</em>: the source pattern is a regular pattern that the decision engine will try to match against each of the source objects.</p>
</li>
<li>
<p><em>INIT_CODE</em>: this is a semantic block of code in the selected dialect that will be executed once for each tuple, before iterating over the source objects.</p>
</li>
<li>
<p><em>ACTION_CODE</em>: this is a semantic block of code in the selected dialect that will be executed for each of the source objects.</p>
</li>
<li>
<p><em>REVERSE_CODE</em>: this is an optional semantic block of code in the selected dialect that if present will be executed for each source object that no longer matches the source pattern. The objective of this code block is to undo any calculation done in the <em>ACTION_CODE</em> block, so that the decision engine can do decremental calculation when a source object is modified or deleted, hugely improving performance of these operations.</p>
</li>
<li>
<p><em>RESULT_EXPRESSION</em>: this is a semantic expression in the selected dialect that is executed after all source objects are iterated.</p>
</li>
<li>
<p><em>RESULT_PATTERN</em>: this is a regular pattern that the decision engine tries to match against the object returned from the <em>RESULT_EXPRESSION</em>. If it matches, the <code>accumulate</code> conditional element evaluates to <em>true</em> and the decision engine proceeds with the evaluation of the next CE in the rule. If it does not matches, the <code>accumulate</code> CE evaluates to <em>false</em> and the decision engine stops evaluating CEs for that rule.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is easier to understand if we look at an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Apply 10% discount to orders over US$ 100,00"
when
    $order : Order()
    $total : Number( doubleValue &gt; 100 )
             from accumulate( OrderItem( order == $order, $value : value ),
                              init( double total = 0; ),
                              action( total += $value; ),
                              reverse( total -= $value; ),
                              result( total ) )
then
    // apply discount to $order
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, for each <code>Order</code> in the Working Memory, the decision engine will execute the <em>INIT_CODE</em> initializing the total variable to zero.
Then it will iterate over all <code>OrderItem</code> objects for that order, executing the <em>action</em> for each one (in the example, it will sum the value of all items into the total variable). After iterating over all <code>OrderItem</code> objects, it will return the value corresponding to the <em>result
          expression</em> (in the above example, the value of variable <code>total</code>). Finally, the decision engine will try to match the result with the <code>Number</code> pattern, and if the double value is greater than 100, the rule will fire.</p>
</div>
<div class="paragraph">
<p>The example used Java as the semantic dialect, and as such, note that the usage of the semicolon as statement delimiter is mandatory in the init, action and reverse code blocks.
The result is an expression and, as such, it does not admit ';'. If the user uses any other dialect, he must comply to that dialect&#8217;s specific syntax.</p>
</div>
<div class="paragraph">
<p>As mentioned before, the <em>REVERSE_CODE</em> is optional, but it is strongly recommended that the user writes it in order to benefit from the <em>improved performance on update
          and delete</em>.</p>
</div>
<div class="paragraph">
<p>The <code>accumulate</code> CE can be used to execute any action on source objects.
The following example instantiates and populates a custom object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Accumulate using custom objects"
when
    $person   : Person( $likes : likes )
    $cheesery : Cheesery( totalAmount &gt; 100 )
                from accumulate( $cheese : Cheese( type == $likes ),
                                 init( Cheesery cheesery = new Cheesery(); ),
                                 action( cheesery.addCheese( $cheese ); ),
                                 reverse( cheesery.removeCheese( $cheese ); ),
                                 result( cheesery ) );
then
    // do something
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>eval</code></dt>
<dd>
<p>The conditional element <code>eval</code> is essentially a catch-all which allows any semantic code (that returns a primitive boolean) to be executed.
This code can refer to variables that were bound in the conditions of the rule and functions in the rule package.
Overuse of <code>eval</code> reduces the declarativeness of your rules and can result in a poorly performing decision engine.
While <code>eval</code> can be used anywhere in the patterns, it is typically added as the last conditional element in the conditions of a rule.</p>
<div class="openblock">
<div class="content">
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/drl/eval.png" alt="eval">
</div>
<div class="title">Figure 142. Eval</div>
</div>
<div class="paragraph">
<p>Instances of <code>eval</code> cannot be indexed and thus are not as efficient as Field Constraints.
However this makes them ideal for being used when functions return values that change over time, which is not allowed within Field Constraints.</p>
</div>
<div class="paragraph">
<p>For those who are familiar with Kogito 2.x lineage, the old Kogito parameter and condition tags are equivalent to binding a variable to an appropriate type, and then using it in an <code>eval</code> node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>p1 : Parameter()
p2 : Parameter()
eval( p1.getList().containsKey( p2.getItem() ) )</code></pre>
</div>
</div>
<div class="paragraph">
<p></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>p1 : Parameter()
p2 : Parameter()
// call function isValid in the LHS
eval( isValid( p1, p2 ) )</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-drl-rules-central-create_kogito-drl-rules"><a class="anchor" href="#proc-drl-rules-central-create_kogito-drl-rules"></a><a class="link" href="#proc-drl-rules-central-create_kogito-drl-rules">2.2.3. Creating DRL rules for your Kogito project</a></h4>
<div class="paragraph _abstract">
<p>You can create and manage DRL rules for your Kogito project in your integrated development environment (IDE). For Kogito service, VSCode is the preferred IDE. In each DRL rule file, you define rule conditions, actions, and other components related to the rule, based on the data objects you create or import in the package.</p>
</div>
<div class="paragraph">
<p>In Kogito, you typically define DRL rules in rule units. A DRL rule unit is a module for rules and a unit of execution. A rule unit collects a set of rules with the declaration of the type of facts that the rules act on. A rule unit also serves as a unique namespace for each group of rules. A single rule base can contain multiple rule units. You typically store all the rules for a unit in the same file as the unit declaration so that the unit is self-contained.</p>
</div>
<div class="paragraph">
<p>For this procedure, create the following example DRL type declarations and DRL rule unit to define DRL rules in a decision service for a loan application:</p>
</div>
<div class="listingblock">
<div class="title">Example DRL type declarations for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;

declare Bankruptcy
    name: String
    yearOfOccurrence: int
end

declare Applicant
    name: String
    age: int
end

declare LoanApplication
    applicant: String
    approved: boolean
    explanation: String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example DRL rule unit file for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MortgageRules extends RuleUnitData
  bankruptcy: DataStore&lt;Bankruptcy&gt; = DataSource.createStore()
  applicant: DataStore&lt;Applicant&gt; = DataSource.createStore()
  application: DataStore&lt;LoanApplication&gt; = DataSource.createStore()
end

rule "Bankruptcy history"
	salience 10
	when
    $a : /loanApplication[ applicantName: applicant ]
    exists (/bankruptcy[ name == applicantName, yearOfOccurrence &gt; 1990 || amountOwed &gt; 100000 ])
	then
		$a.setApproved( false );
		$a.setExplanation( "has been bankrupt" );
		loanApplication.remove( $a );
end

rule "Underage"
	salience 15
	when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
	then
		$application.setApproved( false );
		$application.setExplanation( "Underage" );
		loanApplication.remove( $a );
end</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a Kogito project and have included any Java data objects required for your Kogito service. For information about creating a project, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open your Kogito project and create a <code>src/main/resources/org/mortgages</code> folder. This folder serves as the package for your DRL files in this example.</p>
</li>
<li>
<p>In your new <code>src/main/resources/org/mortgages</code> folder, add the following <code>ApplicationTypes.drl</code> file to define the fact types for the loan application service:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example DRL type declarations for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;

declare Bankruptcy
    name: String
    yearOfOccurrence: int
end

declare Applicant
    name: String
    age: int
end

declare LoanApplication
    applicant: String
    approved: boolean
    explanation: String
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This DRL file defines the fact types that you can declare in any rule units in the same package for the decision service. Declarations in DRL files define new fact types or metadata for fact types to be used by rules in a DRL files. If you declare these types directly in the DRL rule unit file, you cannot declare them in any other rule units.</p>
</div>
<div class="paragraph">
<p>This example defines the following fact types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Bankruptcy</code>: Provides data for bankruptcy status, if applicable</p>
</li>
<li>
<p><code>Applicant</code>: Provides data about the loan applicant</p>
</li>
<li>
<p><code>LoanApplication</code>: Provides data about loan approval status for a specified applicant, with an explanation if needed</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In the same <code>src/main/resources/org/mortgages</code> folder of your Kogito project, create the following <code>LoanApplication.drl</code> file to declare the DRL rule unit and data sources:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example DRL file with rule unit and data sources</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStore;

declare MortgageRules extends RuleUnitData
  bankruptcy: DataStore&lt;Bankruptcy&gt; = DataSource.createStore()
  applicant: DataStore&lt;Applicant&gt; = DataSource.createStore()
  application: DataStore&lt;LoanApplication&gt; = DataSource.createStore()
end
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the rule unit is named <code>MortgageRules</code> and the previously defined fact types are declared as <code>DataStore</code> data sources.</p>
</div>
<div class="paragraph">
<p>Data sources are typed sources of data that rule units can subscribe to for updates. You interact with the rule unit through the data sources it exposes. A data source can be a <code>DataStream</code> source for append-only storage, a <code>DataStore</code> source for writable storage to add or remove data, or a <code>SingletonStore</code> source for writable storage to set and clear a single element.</p>
</div>
<div class="paragraph">
<p>This example uses the <code>DataStore</code> data source to enable application data to be added or removed as part of the decision service.</p>
</div>
</div>
</div>
</li>
<li>
<p>To complete the DRL rule unit file, add the following rules for <code>"Bankruptcy history"</code> and <code>"Underage"</code> logic:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example DRL rule unit file for a loan application</div>
<div class="content">
<pre class="highlight"><code>package org.mortgages;
unit MortgageRules;

import org.kie.kogito.rules.DataSource;
import org.kie.kogito.rules.DataStream;

declare MortgageRules extends RuleUnitData
  bankruptcy: DataStore&lt;Bankruptcy&gt; = DataSource.createStore()
  applicant: DataStore&lt;Applicant&gt; = DataSource.createStore()
  application: DataStore&lt;LoanApplication&gt; = DataSource.createStore()
end

rule "Bankruptcy history"
	salience 10
	when
    $a : /loanApplication[ applicantName: applicant ]
    exists (/bankruptcy[ name == applicantName, yearOfOccurrence &gt; 1990 || amountOwed &gt; 100000 ])
	then
		$a.setApproved( false );
		$a.setExplanation( "has been bankrupt" );
		loanApplication.remove( $a );
end

rule "Underage"
	salience 15
	when
    /applicant[ applicantName : name, age &lt; 21 ]
    $application : /loanApplication[ applicant == applicantName ]
	then
		$application.setApproved( false );
		$application.setExplanation( "Underage" );
		loanApplication.remove( $a );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example rules consist of the following rule components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>rule</code>: Use this segment to define each rule in the DRL file. Rules consist of a rule name in the format <code>rule "rule name"</code>, followed by optional attributes that define rule behavior, such as <code>salience</code> or <code>no-loop</code>, followed by <code>when</code> and <code>then</code> definitions. Each rule must have a unique name within the rule package.</p>
<div class="paragraph">
<p>In this example, the <code>"Bankruptcy history"</code> rule has a defined salience of <code>10</code> and the <code>"Underage"</code> rule has a defined salience of <code>15</code>. These values ensure that the <code>"Bankruptcy history"</code> rule is executed first.</p>
</div>
</li>
<li>
<p><code>when</code> and <code>then</code>: Use the <code>when</code> portion to define the condition patterns and constraints in OOPath syntax and use the <code>then</code> portion to define the actions to be executed when the conditions are met.</p>
<div class="paragraph">
<p>In this example, the <code>"Bankruptcy history"</code> rule states that if an applicant has owed more than 100,000 USD of unresolved debt since 1990 (beginning 1991), then the applicant is considered to have been bankrupt and is not approved for a loan. The application is removed from memory.</p>
</div>
<div class="paragraph">
<p>If the applicant passes the bankruptcy check, then the <code>"Underage"</code> rule states that if the applicant is younger than 21 years old, then the applicant is not approved for the loan. The application is removed from memory.</p>
</div>
<div class="paragraph">
<p>If the applicant passes both checks, then the loan is approved.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>After you define all components of the data sources and rules, save all DRL files.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#con-drl-rule-units_kogito-drl-rules">Rule units in DRL</a></p>
</li>
<li>
<p><a href="#con-drl-rules-conditions_kogito-drl-rules">Rule conditions in DRL</a></p>
</li>
<li>
<p><a href="#con-drl-rules-actions_kogito-drl-rules">Rule actions in DRL</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-service-execution_kogito-drl-rules"><a class="anchor" href="#con-kogito-service-execution_kogito-drl-rules"></a><a class="link" href="#con-kogito-service-execution_kogito-drl-rules">2.2.4. Kogito service execution</a></h4>
<div class="paragraph _abstract">
<p>After you design your Kogito service, you can build and run your application and then send REST API requests to the application to execute your services. The exact REST API requests that you can use depend on how you set up the application.</p>
</div>
<div class="paragraph">
<p>For example, consider a Kogito service that is set up to generate a <code>/persons</code> REST API endpoint and determines whether a specified customer is an adult or is underage. In this example, you can send the following <code>POST</code> request using a REST client or curl utility to add an adult and execute the service:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that for JSON marshaling, Kogito is relying on the default mappers of <a href="https://quarkus.io/guides/rest-json#jackson">Quarkus</a> and <a href="https://docs.spring.io/spring-boot/docs/1.3.0.M3/reference/html/howto-spring-mvc.html#howto-customize-the-jackson-objectmapper">SpringBoot</a>, which can be configured according to the specific requirements.</p>
</div>
<div class="paragraph">
<p>For information about creating, running, and testing an example application with Kogito services, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</div>
</div>
<div class="sect3 _additional-resources">
<h4 id="_additional_resources_3"><a class="anchor" href="#_additional_resources_3"></a><a class="link" href="#_additional_resources_3">2.2.5. Additional resources</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="chap-kogito-using-spreadsheet-decision-tables"><a class="anchor" href="#chap-kogito-using-spreadsheet-decision-tables"></a><a class="link" href="#chap-kogito-using-spreadsheet-decision-tables">2.3. Using spreadsheet decision tables in Kogito services</a></h3>
<div class="paragraph _abstract">
<p>As a developer of business decisions, you can define business rules in a tabular format in spreadsheet decision tables and then include the spreadsheet file in your Kogito project. These rules are compiled into Drools Rule Language (DRL) for the decision service in your project.</p>
</div>
<div class="sect3">
<h4 id="ref-decision-authoring-assets_kogito-decision-tables"><a class="anchor" href="#ref-decision-authoring-assets_kogito-decision-tables"></a><a class="link" href="#ref-decision-authoring-assets_kogito-decision-tables">2.3.1. Decision-authoring assets in Kogito</a></h4>
<div class="paragraph _abstract">
<p>Kogito supports several assets that you can use to define business decisions for your decision service. Each decision-authoring asset has different advantages, and you might prefer to use one or a combination of multiple assets depending on your goals and needs.</p>
</div>
<div class="paragraph">
<p>The following table highlights the main decision-authoring assets supported in Kogito projects to help you decide or confirm the best method for defining decisions in your decision service.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 92. Decision-authoring assets supported in Kogito</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Asset</th>
<th class="tableblock halign-left valign-top">Highlights</th>
<th class="tableblock halign-left valign-top">Authoring tools</th>
<th class="tableblock halign-left valign-top">Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decision Model and Notation (DMN) models</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are decision models based on a notation standard defined by the Object Management Group (OMG)</p>
</li>
<li>
<p>Use graphical decision requirements diagrams (DRDs) that represent part or all of the overall decision requirements graph (DRG) to trace business decision flows</p>
</li>
<li>
<p>Use an XML schema that allows the DMN models to be shared between DMN-compliant platforms</p>
</li>
<li>
<p>Support Friendly Enough Expression Language (FEEL) to define decision logic in DMN decision tables and other DMN boxed expressions</p>
</li>
<li>
<p>Can be integrated efficiently with Business Process Model and Notation (BPMN) process models</p>
</li>
<li>
<p>Are optimal for creating comprehensive, illustrative, and stable decision flows</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kogito DMN modeler in VSCode or other DMN-compliant editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-dmn_kogito-dmn-models">Decision Model and Notation (DMN)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DRL rules</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are individual rules that you define directly in <code>.drl</code> text files</p>
</li>
<li>
<p>Provide the most flexibility for defining rules and other technicalities of rule behavior</p>
</li>
<li>
<p>Are optimal for creating rules that require advanced DRL options, such as rule units</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any integrated development environment (IDE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-drl_kogito-drl-rules">Drools Rule Language (DRL)</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet decision tables</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Are tabular sets of rules that you define in <code>.xls</code> or <code>.xlsx</code> spreadsheet files</p>
</li>
<li>
<p>Support template keys and values for creating rule templates</p>
</li>
<li>
<p>Are optimal for business environments that already rely on decision tables for rules</p>
</li>
<li>
<p>Have strict syntax requirements for rules to be compiled properly when used in Kogito</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spreadsheet editor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#con-decision-tables_kogito-decision-tables">Spreadsheet decision tables</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="con-decision-tables_kogito-decision-tables"><a class="anchor" href="#con-decision-tables_kogito-decision-tables"></a><a class="link" href="#con-decision-tables_kogito-decision-tables">2.3.2. Spreadsheet decision tables</a></h4>
<div class="paragraph _abstract">
<p>Spreadsheet decision tables are XLS or XLSX spreadsheet files that contain business rules defined in a tabular format. You can include spreadsheet decision tables as part of your Kogito project. Each row in a decision table is a rule, and each column is a condition, an action, or another rule attribute. After you create and include your spreadsheet decision tables in your project, the rules you defined are compiled into Drools Rule Language (DRL) rules for the decision service.</p>
</div>
</div>
<div class="sect3">
<h4 id="con-decision-tables-use-case_kogito-decision-tables"><a class="anchor" href="#con-decision-tables-use-case_kogito-decision-tables"></a><a class="link" href="#con-decision-tables-use-case_kogito-decision-tables">2.3.3. Decision table use case</a></h4>
<div class="paragraph _abstract">
<p>An online shopping site lists the shipping charges for ordered items. The site provides free shipping under the following conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of items ordered is 4 or more and the checkout total is $300 or more.</p>
</li>
<li>
<p>Standard shipping is selected (4 or 5 business days from the date of purchase).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following are the shipping rates under these conditions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 93. For orders less than $300</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of items</th>
<th class="tableblock halign-left valign-top">Delivery day</th>
<th class="tableblock halign-left valign-top">Shipping charge in USD, N = Number of items</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 or fewer</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>35</p>
</div>
<div class="paragraph">
<p>15</p>
</div>
<div class="paragraph">
<p>10</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 or more</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N*7.50</p>
</div>
<div class="paragraph">
<p>N*3.50</p>
</div>
<div class="paragraph">
<p>N*2.50</p>
</div></div></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 94. For orders more than $300</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of items</th>
<th class="tableblock halign-left valign-top">Delivery day</th>
<th class="tableblock halign-left valign-top">Shipping charge in USD, N = Number of items</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 or fewer</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>25</p>
</div>
<div class="paragraph">
<p>10</p>
</div>
<div class="paragraph">
<p>N*1.50</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 or more</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Next day</p>
</div>
<div class="paragraph">
<p>2nd day</p>
</div>
<div class="paragraph">
<p>Standard</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N*5</p>
</div>
<div class="paragraph">
<p>N*2</p>
</div>
<div class="paragraph">
<p>FREE</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These conditions and rates are shown in the following example spreadsheet decision table:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/decision-tables/decision-table-example-02.png" alt="Decision table example">
</div>
<div class="title">Figure 143. Decision table for shipping charges</div>
</div>
<div class="paragraph">
<p>In order for a decision table to be compiled in your Kogito project, the table must comply with certain structure and syntax requirements within an XLS or XLSX spreadsheet, as shown in this example. For more information, see <a href="#proc-decision-tables-creating_kogito-decision-tables">Creating spreadsheet decision tables for your Kogito project</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-decision-tables-creating_kogito-decision-tables"><a class="anchor" href="#proc-decision-tables-creating_kogito-decision-tables"></a><a class="link" href="#proc-decision-tables-creating_kogito-decision-tables">2.3.4. Creating spreadsheet decision tables for your Kogito project</a></h4>
<div class="paragraph _abstract">
<p>Spreadsheet decision tables (XLS or XLSX) require two key areas that define rule data: a <code>RuleSet</code> area and a <code>RuleTable</code> area. The <code>RuleSet</code> area of the spreadsheet defines elements that you want to apply globally to all rules in the same package (not only the spreadsheet), such as a rule set name or universal rule attributes. The <code>RuleTable</code> area defines the actual rules (rows) and the conditions, actions, and other rule attributes (columns) that constitute that rule table within the specified rule set. A spreadsheet of decision tables can contain multiple <code>RuleTable</code> areas, but only one <code>RuleSet</code> area.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For each Kogito project, try to include only one spreadsheet of decision tables, containing all necessary <code>RuleTable</code> definitions. Although you can include separate decision table spreadsheets, including multiple spreadsheets in the same project package can cause compilation errors from conflicting <code>RuleSet</code> or <code>RuleTable</code> attributes and is therefore not recommended.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Refer to the following sample spreadsheet as you define your decision table:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/decision-tables/decision-table-example-02.png" alt="Decision table example">
</div>
<div class="title">Figure 144. Sample spreadsheet decision table for shipping charges</div>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have added the following dependency to the <code>pom.xml</code> file of your Kogito project to enable decision tables for decision services:</p>
<div class="listingblock">
<div class="title">Dependency to enable decision tables for decision services</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.drools&lt;/groupId&gt;
    &lt;artifactId&gt;drools-decisiontables&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a new XLS or XLSX spreadsheet, go to the second or third column and label a cell <code>RuleSet</code> (row 1 in example). Reserve the column or columns to the left for descriptive metadata (optional).</p>
</li>
<li>
<p>In the next cell to the right, enter a name for the <code>RuleSet</code>. This named rule set will contain all <code>RuleTable</code> rules defined in the rule package.</p>
</li>
<li>
<p>Under the <code>RuleSet</code> cell, define any rule attributes (one per cell) that you want to apply globally to all rule tables in the package. Specify attribute values in the cells to the right. For example, you can enter an <code>Import</code> label and in the cell to the right, specify relevant data objects from other packages that you want to import into the package for the decision table (in the format <code>package.name.object.name</code>). For supported cell labels and values, see <a href="#ref-decision-tables-rule-set-entries_kogito-decision-tables">RuleSet definitions</a>.</p>
</li>
<li>
<p>Below the <code>RuleSet</code> area and in the same column as the <code>RuleSet</code> cell, skip a row and label a new cell <code>RuleTable</code> (row 7 in example) and enter a table name in the same cell. The name is used as the initial part of the name for all rules derived from this rule table, with the row number appended for distinction. You can override this automatic naming by inserting a <code>NAME</code> attribute column.</p>
</li>
<li>
<p>Use the next four rows to define the following elements as needed (rows 8-11 in example):</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule attributes:</strong> Conditions, actions, or other attributes. For supported cell labels and values, see <a href="#ref-decision-tables-rule-table-entries_kogito-decision-tables">RuleTable definitions</a>.</p>
</li>
<li>
<p><strong>Object types:</strong> The data objects to which the rule attributes apply. If the same object type applies to multiple columns, merge the object cells into one cell across multiple columns (as shown in the sample decision table), instead of repeating the object type in multiple cells. When an object type is merged, all columns below the merged range will be combined into one set of constraints within a single pattern for matching a single fact at a time. When an object is repeated in separate columns, the separate columns can create different patterns, potentially matching different or identical facts.</p>
</li>
<li>
<p><strong>Constraints:</strong> Constraints on the object types.</p>
</li>
<li>
<p><strong>Column label:</strong> (Optional) Any descriptive label for the column, as a visual aid. Leave blank if unused.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As an alternative to populating both the object type and constraint cells, you can leave the object type cell or cells empty and enter the full expression in the corresponding constraint cell or cells. For example, instead of <code>Order</code> as the object type and <code>itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code>Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for other constraint cells.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>After you have defined all necessary rule attributes (columns), enter values for each column as needed, row by row, to generate rules (rows 12-17 in example). Cells with no data are ignored (such as when a condition or action does not apply).</p>
<div class="paragraph">
<p>If you need to add more rule tables to this decision table spreadsheet, skip a row after the last rule in the previous table, label another <code>RuleTable</code> cell in the same column as the previous <code>RuleTable</code> and  <code>RuleSet</code> cells, and create the new table following the same steps in this section (rows 19-29 in example).</p>
</div>
</li>
<li>
<p>Save your XLS or XLSX spreadsheet to finish.</p>
</li>
<li>
<p>In your VSCode IDE, import the XLS or XLSX spreadsheet file in the relevant folder of your Kogito project, typically in <code>src/main/resources</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only the first worksheet in a spreadsheet workbook is processed as a decision table when you include the spreadsheet in your Kogito project. Each <code>RuleSet</code> name combined with the <code>RuleTable</code> name must be unique across all decision table files in the same package.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After you include the decision table in your Kogito project, the rules are rendered as DRL rules like the following example, from the sample spreadsheet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>//row 12
rule "Basic_12"
salience 10
  when
    $order : /orders[ itemsCount &gt; 0, itemsCount &lt;= 3, deliverInDays == 1 ]
  then
    insert( new Charge( 35 ) );
end</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Enabling white space used in cell values</div>
<div class="paragraph">
<p>By default, any white space before or after values in decision table cells is removed before the decision table is processed by the decision engine. To retain white space that you use intentionally before or after values in cells, set the <code>drools.trimCellsInDTable</code> system property to <code>false</code> in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Enable white space in <code>application.properties</code></div>
<div class="content">
<pre class="highlight"><code>drools.trimCellsInDTable=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also set this property as a start-up option when you build your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn compile quarkus:dev -Ddrools.trimCellsInDTable=false</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>mvn spring-boot:run -Ddrools.trimCellsInDTable=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="ref-decision-tables-rule-set-entries_kogito-decision-tables"><a class="anchor" href="#ref-decision-tables-rule-set-entries_kogito-decision-tables"></a><a class="link" href="#ref-decision-tables-rule-set-entries_kogito-decision-tables">2.3.4.1. RuleSet definitions</a></h5>
<div class="paragraph _abstract">
<p>Entries in the <code>RuleSet</code> area of a decision table define DRL constructs and rule attributes that you want to apply to all rules in a package (not only in the spreadsheet). Entries must be in a vertically stacked sequence of cell pairs, where the first cell contains a label and the cell to the right contains the value. A decision table spreadsheet can have only one <code>RuleSet</code> area.</p>
</div>
<div class="paragraph">
<p>The following table lists the supported labels and values for <code>RuleSet</code> definitions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 95. Supported <code>RuleSet</code> definitions</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 40%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RuleSet</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The package name for the generated DRL file. Optional, the default is <code>rule_table</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Must be the first entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Unit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the rule unit for the generated DRL file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Recommended for optimal rule grouping and execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Sequential</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code>. If <code>true</code>, then salience is used to ensure that rules fire from the top down.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. If omitted, no firing order is imposed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SequentialMaxPriority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer numeric value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. In sequential mode, this option is used to set the start value of the salience. If omitted, the default value is <code>65535</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SequentialMinPriority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer numeric value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. In sequential mode, this option is used to check if this minimum salience value is not violated. If omitted, the default value is <code>0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EscapeQuotes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code>. If <code>true</code>, then quotation marks are escaped so that they appear literally in the DRL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, at most once. If omitted, quotation marks are escaped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of Java classes to import from another package.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, may be used repeatedly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Queries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more query definitions, according to DRL syntax.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, may be used repeatedly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Declare</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more declarative types, according to DRL syntax.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, may be used repeatedly.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
In some cases, Microsoft Office, LibreOffice, and OpenOffice might encode a double quotation mark differently, causing a compilation error. For example, <code>&#8220;A&#8221;</code> fails, but <code>"A"</code> succeeds.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="ref-decision-tables-rule-table-entries_kogito-decision-tables"><a class="anchor" href="#ref-decision-tables-rule-table-entries_kogito-decision-tables"></a><a class="link" href="#ref-decision-tables-rule-table-entries_kogito-decision-tables">2.3.4.2. RuleTable definitions</a></h5>
<div class="paragraph _abstract">
<p>Entries in the <code>RuleTable</code> area of a decision table define conditions, actions, and other rule attributes for the rules in that rule table. A spreadsheet of decision tables can contain multiple <code>RuleTable</code> areas.</p>
</div>
<div class="paragraph">
<p>The following table lists the supported labels (column headers) and values for <code>RuleTable</code> definitions. For column headers, you can use either the given labels or any custom labels that begin with the letters listed in the table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 96. Supported <code>RuleTable</code> definitions</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 35%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Or custom label that begins with</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides the name for the rule generated from that row. The default is constructed from the text following the <code>RuleTable</code> tag and the row number.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At most one column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DESCRIPTION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Results in a comment within the generated rule.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At most one column.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONDITION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code snippet and interpolated values for constructing a constraint within a pattern in a condition.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At least one per rule table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACTION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code snippet and interpolated values for constructing an action for the consequence of the rule.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At least one per rule table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>METADATA</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code snippet and interpolated values for constructing a metadata entry for the rule.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional, any number of columns.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following sections provide more details about how condition, action, and metadata columns use cell data:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Conditions</dt>
<dd>
<p>For columns headed <code>CONDITION</code>, the cells in consecutive lines result in a conditional element:</p>
<div class="ulist">
<ul>
<li>
<p><strong>First cell:</strong> Text in the first cell below <code>CONDITION</code> develops into a pattern for the rule condition, and uses the snippet in the next line as a constraint. If the cell is merged with one or more neighboring cells, a single pattern with multiple constraints is formed. All constraints are combined into a parenthesized list and appended to the text in this cell.</p>
<div class="paragraph">
<p>If this cell is empty, the code snippet in the cell below it must result in a valid conditional element on its own. For example, instead of <code>Order</code> as the object type and <code>itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code>Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for any other constraint cells.</p>
</div>
<div class="paragraph">
<p>To include a pattern without constraints, you can write the pattern in front of the text of another pattern, with or without an empty pair of parentheses. You can also append a <code>from</code> clause to the pattern.</p>
</div>
<div class="paragraph">
<p>If the pattern ends with <code>eval</code>, code snippets produce boolean expressions for inclusion into a pair of parentheses after <code>eval</code>.</p>
</div>
</li>
<li>
<p><strong>Second cell:</strong> Text in the second cell below <code>CONDITION</code> is processed as a constraint on the object reference in the first cell. The code snippet in this cell is modified by interpolating values from cells farther down in the column. If you want to create a constraint consisting of a comparison using <code>==</code> with the value from the cells below, then the field selector alone is sufficient. Any other comparison operator must be specified as the last item within the snippet, and the value from the cells below is appended. For all other constraint forms, you must mark the position for including the contents of a cell with the symbol <code>$param</code>. Multiple insertions are possible if you use the symbols <code>$1</code>, <code>$2</code>, and so on, and a comma-separated list of values in the cells below. However, do not separate <code>$1</code>, <code>$2</code>, and so on, by commas, or the table will fail to process.</p>
<div class="paragraph">
<p>To expand a text according to the pattern <code>forall($delimiter){$snippet}</code>, repeat the <code>$snippet</code> once for each of the values of the comma-separated list in each of the cells below, insert the value in place of the symbol <code>$</code>, and join these expansions by the given <code>$delimiter</code>. Note that the <code>forall</code> construct may be surrounded by other text.</p>
</div>
<div class="paragraph">
<p>If the first cell contains an object, the completed code snippet is added to the conditional element from that cell. A pair of parentheses is provided automatically, as well as a separating comma if multiple constraints are added to a pattern in a merged cell. If the first cell is empty, the code snippet in this cell must result in a valid conditional element on its own. For example, instead of <code>Order</code> as the object type and <code>itemsCount &gt; $1</code> as a constraint (separate cells), you can leave the object type cell empty and enter <code>Order( itemsCount &gt; $1 )</code> in the constraint cell, and then do the same for any other constraint cells.</p>
</div>
</li>
<li>
<p><strong>Third cell:</strong> Text in the third cell below <code>CONDITION</code> is a descriptive label that you define for the column, as a visual aid.</p>
</li>
<li>
<p><strong>Fourth cell:</strong> From the fourth row on, non-blank entries provide data for interpolation. A blank cell omits the condition or constraint for this rule.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Actions</dt>
<dd>
<p>For columns headed <code>ACTION</code>, the cells in consecutive lines result in an action statement:</p>
<div class="ulist">
<ul>
<li>
<p><strong>First cell:</strong> Text in the first cell below <code>ACTION</code> is optional. If present, the text is interpreted as an object reference.</p>
</li>
<li>
<p><strong>Second cell:</strong> Text in the second cell below <code>ACTION</code> is a code snippet that is modified by interpolating values from cells farther down in the column. For a singular insertion, mark the position for including the contents of a cell with the symbol <code>$param</code>. Multiple insertions are possible if you use the symbols <code>$1</code>, <code>$2</code>, and so on, and a comma-separated list of values in the cells below. However, do not separate <code>$1</code>, <code>$2</code>, and so on, by commas, or the table will fail to process.</p>
<div class="paragraph">
<p>A text without any marker symbols can execute a method call without interpolation. In this case, use any non-blank entry in a row below the cell to include the statement. The <code>forall</code> construct is supported.</p>
</div>
<div class="paragraph">
<p>If the first cell contains an object, then the cell text (followed by a period), the text in the second cell, and a terminating semicolon are strung together, resulting in a method call that is added as an action statement for the consequence. If the first cell is empty, the code snippet in this cell must result in a valid action element on its own.</p>
</div>
</li>
<li>
<p><strong>Third cell:</strong> Text in the third cell below <code>ACTION</code> is a descriptive label that you define for the column, as a visual aid.</p>
</li>
<li>
<p><strong>Fourth cell:</strong> From the fourth row on, non-blank entries provide data for interpolation. A blank cell omits the condition or constraint for this rule.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Metadata</dt>
<dd>
<p>For columns headed <code>METADATA</code>, the cells in consecutive lines result in a metadata annotation for the generated rules:</p>
<div class="ulist">
<ul>
<li>
<p><strong>First cell:</strong> Text in the first cell below <code>METADATA</code> is ignored.</p>
</li>
<li>
<p><strong>Second cell:</strong> Text in the second cell below <code>METADATA</code> is subject to interpolation, using values from the cells in the rule rows. The metadata marker character <code>@</code> is prefixed automatically, so you do not need to include that character in the text for this cell.</p>
</li>
<li>
<p><strong>Third cell:</strong> Text in the third cell below <code>METADATA</code> is a descriptive label that you define for the column, as a visual aid.</p>
</li>
<li>
<p><strong>Fourth cell:</strong> From the fourth row on, non-blank entries provide data for interpolation. A blank cell results in the omission of the metadata annotation for this rule.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="ref-decision-tables-attributes_kogito-decision-tables"><a class="anchor" href="#ref-decision-tables-attributes_kogito-decision-tables"></a><a class="link" href="#ref-decision-tables-attributes_kogito-decision-tables">2.3.4.3. Additional rule attributes for RuleSet or RuleTable definitions</a></h5>
<div class="paragraph _abstract">
<p>The <code>RuleSet</code> and <code>RuleTable</code> areas also support labels and values for other rule attributes, such as <code>PRIORITY</code> or <code>NO-LOOP</code>. Rule attributes specified in a <code>RuleSet</code> area will affect all rule assets in the same package (not only in the spreadsheet). Rule attributes specified in a <code>RuleTable</code> area will affect only the rules in that rule table. You can use each rule attribute only once in a <code>RuleSet</code> area and once in a <code>RuleTable</code> area. If the same attribute is used in both <code>RuleSet</code> and <code>RuleTable</code> areas within the spreadsheet, then <code>RuleTable</code> takes priority and the attribute in the <code>RuleSet</code> area is overridden.</p>
</div>
<div class="paragraph">
<p>The following table lists the supported labels (column headers) and values for additional <code>RuleSet</code> or <code>RuleTable</code> definitions. For column headers, you can use either the given labels or any custom labels that begin with the letters listed in the table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 97. Additional rule attributes for <code>RuleSet</code> or <code>RuleTable</code> definitions</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 20%;">
<col style="width: 55%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Or custom label that begins with</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PRIORITY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An integer defining the <code>salience</code> value of the rule. Rules with a higher salience value are given higher priority when ordered in the activation queue. Overridden by the <code>Sequential</code> flag.</p>
<p class="tableblock">Example: <code>PRIORITY 10</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE-EFFECTIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule can be activated only if the current date and time is after a <code>DATE-EFFECTIVE</code> attribute.</p>
<p class="tableblock">Example: <code>DATE-EFFECTIVE "4-Sep-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DATE-EXPIRES</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing a date and time definition. The rule cannot be activated if the current date and time is after the <code>DATE-EXPIRES</code> attribute.</p>
<p class="tableblock">Example: <code>DATE-EXPIRES "4-Oct-2018"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NO-LOOP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value. When this option is set to <code>true</code>, the rule cannot be reactivated (looped) if a consequence of the rule re-triggers a previously met condition.</p>
<p class="tableblock">Example: <code>NO-LOOP true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACTIVATION-GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying an activation (or XOR) group to which you want to assign the rule. In activation groups, only one rule can be activated. The first rule to fire will cancel all pending activations of all rules in the activation group.</p>
<p class="tableblock">Example: <code>ACTIVATION-GROUP "GroupName"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DURATION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long integer value defining the duration of time in milliseconds after which the rule can be activated, if the rule conditions are still met.</p>
<p class="tableblock">Example: <code>DURATION 10000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TIMER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string identifying either <code>int</code> (interval) or <code>cron</code> timer definitions for scheduling the rule.</p>
<p class="tableblock">Example: <code>TIMER "*/5 * * * *"</code>  (every 5 minutes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CALENDAR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Quartz calendar definition for scheduling the rule.</p>
<p class="tableblock">Example: <code>CALENDAR "* * 0-7,18-23 ? * *"</code>  (exclude non-business hours)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AUTO-FOCUS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within agenda groups. When this option is set to <code>true</code>, the next time the rule is activated, a focus is automatically given to the agenda group to which the rule is assigned.</p>
<p class="tableblock">Example: <code>AUTO-FOCUS true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOCK-ON-ACTIVE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean value, applicable only to rules within rule flow groups or agenda groups. When this option is set to <code>true</code>, the next time the ruleflow group for the rule becomes active or the agenda group for the rule receives a focus, the rule cannot be activated again until the ruleflow group is no longer active or the agenda group loses the focus. This is a stronger version of the <code>no-loop</code> attribute, because the activation of a matching rule is discarded regardless of the origin of the update (not only by the rule itself). This attribute is ideal for calculation rules where you have a number of rules that modify a fact and you do not want any rule re-matching and firing again.</p>
<p class="tableblock">Example: <code>LOCK-ON-ACTIVE true</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="./kogito/decision-tables/decision-table-example-03.png" alt="Example decision table with definitions used">
</div>
<div class="title">Figure 145. Sample decision table spreadsheet with attribute columns</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-kogito-service-execution_kogito-decision-tables"><a class="anchor" href="#con-kogito-service-execution_kogito-decision-tables"></a><a class="link" href="#con-kogito-service-execution_kogito-decision-tables">2.3.5. Kogito service execution</a></h4>
<div class="paragraph _abstract">
<p>After you design your Kogito service, you can build and run your application and then send REST API requests to the application to execute your services. The exact REST API requests that you can use depend on how you set up the application.</p>
</div>
<div class="paragraph">
<p>For example, consider a Kogito service that is set up to generate a <code>/persons</code> REST API endpoint and determines whether a specified customer is an adult or is underage. In this example, you can send the following <code>POST</code> request using a REST client or curl utility to add an adult and execute the service:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that for JSON marshaling, Kogito is relying on the default mappers of <a href="https://quarkus.io/guides/rest-json#jackson">Quarkus</a> and <a href="https://docs.spring.io/spring-boot/docs/1.3.0.M3/reference/html/howto-spring-mvc.html#howto-customize-the-jackson-objectmapper">SpringBoot</a>, which can be configured according to the specific requirements.</p>
</div>
<div class="paragraph">
<p>For information about creating, running, and testing an example application with Kogito services, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</div>
</div>
<div class="sect3 _additional-resources">
<h4 id="_additional_resources_4"><a class="anchor" href="#_additional_resources_4"></a><a class="link" href="#_additional_resources_4">2.3.6. Additional resources</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="chap-kogito-decision-engine"><a class="anchor" href="#chap-kogito-decision-engine"></a><a class="link" href="#chap-kogito-decision-engine">2.4. Decision engine in Kogito</a></h3>
<div class="paragraph _abstract">
<p>As a developer of business decisions, your understanding of the decision engine in Kogito can help you design more effective business assets and a more scalable decision management architecture. The decision engine is the Kogito component that stores, processes, and evaluates data to execute business rules and to reach the decisions that you define. This document describes basic concepts and functions of the decision engine to consider as you create your business rule system and decision services in Kogito.</p>
</div>
<div class="sect3">
<h4 id="con-decision-engine_kogito-decision-engine"><a class="anchor" href="#con-decision-engine_kogito-decision-engine"></a><a class="link" href="#con-decision-engine_kogito-decision-engine">2.4.1. Decision engine in Kogito</a></h4>
<div class="paragraph _abstract">
<p>The decision engine is the rules engine in Kogito. The decision engine stores, processes, and evaluates data to execute the business rules or decision models that you define. The basic function of the decision engine is to match incoming data, or <em>facts</em>, to the conditions of rules and determine whether and how to execute the rules.</p>
</div>
<div class="paragraph">
<p>The decision engine operates using the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Rules:</strong> Business rules or DMN decisions that you define. All rules must contain at a minimum the conditions that trigger the rule and the actions that the rule dictates.</p>
</li>
<li>
<p><strong>Facts:</strong> Data that enters or changes in the decision engine that the decision engine matches to rule conditions to execute applicable rules.</p>
</li>
<li>
<p><strong>Production memory:</strong> Location where rules are stored in the decision engine.</p>
</li>
<li>
<p><strong>Working memory:</strong> Location where facts are stored in the decision engine.</p>
</li>
<li>
<p><strong>Agenda:</strong> Location where activated rules are registered and sorted (if applicable) in preparation for execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a business user or an automated system adds or updates rule-related information in Kogito, that information is inserted into the working memory of the decision engine in the form of one or more facts. The decision engine matches those facts to the conditions of the rules that are stored in the production memory to determine eligible rule executions. (This process of matching facts to rules is often referred to as <em>pattern matching</em>.) When rule conditions are met, the decision engine activates and registers rules in the agenda, where the decision engine then sorts prioritized or conflicting rules in preparation for execution.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates these basic components of the decision engine:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/rule-engine-inkscape_enterprise.png" alt="rule engine inkscape enterprise">
</div>
<div class="title">Figure 146. Overview of basic decision engine components</div>
</div>
<div class="paragraph">
<p>These core concepts can help you to better understand other more advanced components, processes, and subprocesses of the decision engine, and as a result, to design more effective business assets in Kogito.</p>
</div>
</div>
<div class="sect3">
<h4 id="con-execution-control_kogito-decision-engine"><a class="anchor" href="#con-execution-control_kogito-decision-engine"></a><a class="link" href="#con-execution-control_kogito-decision-engine">2.4.2. Execution control in the decision engine</a></h4>
<div class="paragraph _abstract">
<p>When new rule data enters the working memory of the decision engine, rules may become fully matched and eligible for execution. A single working memory action can result in multiple eligible rule executions. When a rule is fully matched, the decision engine creates an activation instance, referencing the rule and the matched facts, and adds the activation onto the decision engine agenda. The agenda controls the execution order of these rule activations using a conflict resolution strategy.</p>
</div>
<div class="paragraph">
<p>When rules are executed, the decision engine cycles repeatedly through two phases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Agenda evaluation.</strong> In this phase, the decision engine selects all rules that can be executed. If no executable rules exist, the execution cycle ends. If an executable rule is found, the decision engine registers the activation in the agenda and then moves on to the working memory actions phase to perform rule consequence actions.</p>
</li>
<li>
<p><strong>Working memory actions.</strong> In this phase, the decision engine performs the rule consequence actions (the <code>then</code> portion of each rule) for all activated rules previously registered in the agenda. After all the consequence actions are complete or the rules are executed again, the decision engine returns to the agenda evaluation phase to reassess rules.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/Two_Phase_enterprise.png" alt="Two Phase enterprise">
</div>
<div class="title">Figure 147. Two-phase execution process in the decision engine</div>
</div>
<div class="paragraph">
<p>When multiple rules exist on the agenda, the execution of one rule may cause another rule to be removed from the agenda. To avoid this, you can define how and when rules are executed in the decision engine. Some common methods for defining rule execution order are by using rule salience, agenda groups, activation groups, or rule units for DRL rule sets.</p>
</div>
<div class="sect4">
<h5 id="_salience_for_rules"><a class="anchor" href="#_salience_for_rules"></a><a class="link" href="#_salience_for_rules">2.4.2.1. Salience for rules</a></h5>
<div class="paragraph">
<p>Each rule has an integer <code>salience</code> attribute that determines the order of execution. Rules with a higher salience value are given higher priority when ordered in the activation queue. The default salience value for rules is zero, but the salience can be negative or positive.</p>
</div>
<div class="paragraph">
<p>For example, the following sample DRL rules are listed in the decision engine stack in the order shown:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "RuleA"
salience 95
  when
    $fact : /myFact[ field1 == true ]
  then
    System.out.println("Rule2 : " + $fact);
    update($fact);
end

rule "RuleB"
salience 100
  when
    $fact : /myFact[ field1 == false ]
  then
    System.out.println("Rule1 : " + $fact);
    $fact.setField1(true);
    update($fact);
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>RuleB</code> rule is listed second, but it has a higher salience value than the <code>RuleA</code> rule and is therefore executed first.</p>
</div>
</div>
<div class="sect4">
<h5 id="_activation_groups_for_rules"><a class="anchor" href="#_activation_groups_for_rules"></a><a class="link" href="#_activation_groups_for_rules">2.4.2.2. Activation groups for rules</a></h5>
<div class="paragraph">
<p>An activation group is a set of rules bound together by the same <code>activation-group</code> rule attribute. In this group, only one rule can be executed. After conditions are met for a rule in that group to be executed, all other pending rule executions from that activation group are removed from the agenda.</p>
</div>
<div class="paragraph">
<p>For example, the following sample DRL rules belong to the specified activation group and are listed in the decision engine stack in the order shown:</p>
</div>
<div class="listingblock">
<div class="title">Sample DRL rules for banking</div>
<div class="content">
<pre class="highlight"><code>rule "Print balance for AccountPeriod1"
activation-group "report"
  when
    ap : AccountPeriod1()
    acc : Account()
  then
    System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>rule "Print balance for AccountPeriod2"
activation-group "report"
  when
    ap : AccountPeriod2()
    acc : Account()
  then
    System.out.println( acc.accountNo +
                      " : " + acc.balance );
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example, if the first rule in the <code>"report"</code> activation group is executed, the second rule in the group and all other executable rules on the agenda are removed from the agenda.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-phreak-algorithm_kogito-decision-engine"><a class="anchor" href="#con-phreak-algorithm_kogito-decision-engine"></a><a class="link" href="#con-phreak-algorithm_kogito-decision-engine">2.4.3. Phreak rule algorithm in the decision engine</a></h4>
<div class="paragraph _abstract">
<p>The decision engine in Kogito uses the Phreak algorithm for rule evaluation. Phreak evolved from the Rete algorithm, including the enhanced Rete algorithm ReteOO that was introduced in previous versions of Drools for object-oriented systems. Overall, Phreak is more scalable than Rete and ReteOO, and is faster in large systems.</p>
</div>
<div class="paragraph">
<p>While Rete is considered eager (immediate rule evaluation) and data oriented, Phreak is considered lazy (delayed rule evaluation) and goal oriented. The Rete algorithm performs many actions during the insert, update, and delete actions in order to find partial matches for all rules. This eagerness of the Rete algorithm during rule matching requires a lot of time before eventually executing rules, especially in large systems. With Phreak, this partial matching of rules is delayed deliberately to handle large amounts of data more efficiently.</p>
</div>
<div class="paragraph">
<p>The Phreak algorithm adds the following set of enhancements to previous Rete algorithms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Three layers of contextual memory: Node, segment, and rule memory types</p>
</li>
<li>
<p>Rule-based, segment-based, and node-based linking</p>
</li>
<li>
<p>Lazy (delayed) rule evaluation</p>
</li>
<li>
<p>Stack-based evaluations with pause and resume</p>
</li>
<li>
<p>Isolated rule evaluation</p>
</li>
<li>
<p>Set-oriented propagations</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="con-phreak-rule-evaluation_kogito-decision-engine"><a class="anchor" href="#con-phreak-rule-evaluation_kogito-decision-engine"></a><a class="link" href="#con-phreak-rule-evaluation_kogito-decision-engine">2.4.3.1. Rule evaluation in Phreak</a></h5>
<div class="paragraph _abstract">
<p>When the decision engine starts, all rules are considered to be <em>unlinked</em> from pattern-matching data that can trigger the rules. At this stage, the Phreak algorithm in the decision engine does not evaluate the rules. The rule actions are queued, and Phreak uses a heuristic, based on the rule most likely to result in execution, to calculate and select the next rule for evaluation. When all the required input values are populated for a rule, the rule is considered to be <em>linked</em> to the relevant pattern-matching data. Phreak then creates a goal that represents this rule and places the goal into a priority queue that is ordered by rule salience. Only the rule for which the goal was created is evaluated, and other potential rule evaluations are delayed. While individual rules are evaluated, node sharing is still achieved through the process of segmentation.</p>
</div>
<div class="paragraph">
<p>Unlike the tuple-oriented Rete, the Phreak propagation is collection oriented. For the rule that is being evaluated, the decision engine accesses the first node and processes all queued insert, update, and delete actions. The results are added to a set, and the set is propagated to the child node. In the child node, all queued insert, update, and delete actions are processed, adding the results to the same set. The set is then propagated to the next child node and the same process repeats until it reaches the terminal node. This cycle creates a batch process effect that can provide performance advantages for certain rule constructs.</p>
</div>
<div class="paragraph">
<p>The linking and unlinking of rules happens through a layered bit-mask system, based on network segmentation. When the rule network is built, segments are created for rule network nodes that are shared by the same set of rules. A rule is composed of a path of segments. In case a rule does not share any node with any other rule, it becomes a single segment.</p>
</div>
<div class="paragraph">
<p>A bit-mask offset is assigned to each node in the segment. Another bit mask is assigned to each segment in the path of the rule according to these requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If at least one input for a node exists, the node bit is set to the <code>on</code> state.</p>
</li>
<li>
<p>If each node in a segment has the bit set to the <code>on</code> state, the segment bit is also set to the <code>on</code> state.</p>
</li>
<li>
<p>If any node bit is set to the <code>off</code> state, the segment is also set to the <code>off</code> state.</p>
</li>
<li>
<p>If each segment in the path of the rule is set to the <code>on</code> state, the rule is considered linked, and a goal is created to schedule the rule for evaluation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The same bit-mask technique is used to track modified nodes, segments, and rules. This tracking ability enables an already linked rule to be unscheduled from evaluation if it has been modified since the evaluation goal for it was created. As a result, no rules can ever evaluate partial matches.</p>
</div>
<div class="paragraph">
<p>This process of rule evaluation is possible in Phreak because, as opposed to a single unit of memory in Rete, Phreak has three layers of contextual memory with node, segment, and rule memory types. This layering enables much more contextual understanding during the evaluation of a rule.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/LayeredMemory_enterprise.png" alt="LayeredMemory enterprise">
</div>
<div class="title">Figure 148. Phreak three-layered memory system</div>
</div>
<div class="paragraph">
<p>The following examples illustrate how rules are organized and evaluated in this three-layered memory system in Phreak.</p>
</div>
<div class="paragraph">
<p><strong>Example 1:</strong> A single rule (R1) with three patterns: A, B and C. The rule forms a single segment, with bits 1, 2, and 4 for the nodes. The single segment has a bit offset of 1.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/segment1_enterprise.png" alt="segment1 enterprise">
</div>
<div class="title">Figure 149. Example 1: Single rule</div>
</div>
<div class="paragraph">
<p><strong>Example 2:</strong> Rule R2 is added and shares pattern A.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/segment2_enterprise.png" alt="segment2 enterprise">
</div>
<div class="title">Figure 150. Example 2: Two rules with pattern sharing</div>
</div>
<div class="paragraph">
<p>Pattern A is placed in its own segment, resulting in two segments for each rule. Those two segments form a path for their respective rules. The first segment is shared by both paths. When pattern A is linked, the segment becomes linked. The segment then iterates over each path that the segment is shared by, setting the bit 1 to <code>on</code>. If patterns B and C are later turned on, the second segment for path R1 is linked, and this causes bit 2 to be turned on for R1. With bit 1 and bit 2 turned on for R1, the rule is now linked and a goal is created to schedule the rule for later evaluation and execution.</p>
</div>
<div class="paragraph">
<p>When a rule is evaluated, the segments enable the results of the matching to be shared. Each segment has a staging memory to queue all inserts, updates, and deletes for that segment. When R1 is evaluated, the rule processes pattern A, and this results in a set of tuples. The algorithm detects a segmentation split, creates peered tuples for each insert, update, and delete in the set, and adds them to the R2 staging memory. Those tuples are then merged with any existing staged tuples and are executed when R2 is eventually evaluated.</p>
</div>
<div class="paragraph">
<p><strong>Example 3:</strong> Rules R3 and R4 are added and share patterns A and B.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/segment3_enterprise.png" alt="segment3 enterprise">
</div>
<div class="title">Figure 151. Example 3: Three rules with pattern sharing</div>
</div>
<div class="paragraph">
<p>Rules R3 and R4 have three segments and R1 has two segments. Patterns A and B are shared by R1, R3, and R4, while pattern D is shared by R3 and R4.</p>
</div>
<div class="paragraph">
<p><strong>Example 4:</strong> A single rule (R1) with a subnetwork and no pattern sharing.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/segment4_enterprise.png" alt="segment4 enterprise">
</div>
<div class="title">Figure 152. Example 4: Single rule with a subnetwork and no pattern sharing</div>
</div>
<div class="paragraph">
<p>Subnetworks are formed when a <code>Not</code>, <code>Exists</code>, or <code>Accumulate</code> node contains more than one element. In this example, the element <code>B not( C )</code> forms the subnetwork. The element <code>not( C )</code> is a single element that does not require a subnetwork and is therefore merged inside of the <code>Not</code> node. The subnetwork uses a dedicated segment. Rule R1 still has a path of two segments and the subnetwork forms another inner path. When the subnetwork is linked, it is also linked in the outer segment.</p>
</div>
<div class="paragraph">
<p><strong>Example 5:</strong> Rule R1 with a subnetwork that is shared by rule R2.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/segment5_enterprise.png" alt="segment5 enterprise">
</div>
<div class="title">Figure 153. Example 5: Two rules, one with a subnetwork and pattern sharing</div>
</div>
<div class="paragraph">
<p>The subnetwork nodes in a rule can be shared by another rule that does not have a subnetwork. This sharing causes the subnetwork segment to be split into two segments.</p>
</div>
<div class="paragraph">
<p>Constrained <code>Not</code> nodes and <code>Accumulate</code> nodes can never unlink a segment, and are always considered to have their bits turned on.</p>
</div>
<div class="paragraph">
<p>The Phreak evaluation algorithm is stack based instead of method-recursion based. Rule evaluation can be paused and resumed at any time when a <code>StackEntry</code> is used to represent the node currently being evaluated.</p>
</div>
<div class="paragraph">
<p>When a rule evaluation reaches a subnetwork, a <code>StackEntry</code> object is created for the outer path segment and the subnetwork segment. The subnetwork segment is evaluated first, and when the set reaches the end of the subnetwork path, the segment is merged into a staging list for the outer node that the segment feeds into. The previous <code>StackEntry</code> object is then resumed and can now process the results of the subnetwork. This process has the added benefit, especially for <code>Accumulate</code> nodes, that all work is completed in a batch, before propagating to the child node.</p>
</div>
<div class="paragraph">
<p>The same stack system is used for efficient backward chaining. When a rule evaluation reaches a query node, the evaluation is paused and the query is added to the stack. The query is then evaluated to produce a result set, which is saved in a memory location for the resumed <code>StackEntry</code> object to pick up and propagate to the child node. If the query itself called other queries, the process repeats, while the current query is paused and a new evaluation is set up for the current query node.</p>
</div>
<div class="sect5">
<h6 id="con-forward-and-backward-chaining_kogito-decision-engine"><a class="anchor" href="#con-forward-and-backward-chaining_kogito-decision-engine"></a><a class="link" href="#con-forward-and-backward-chaining_kogito-decision-engine">Rule evaluation with forward and backward chaining</a></h6>
<div class="paragraph _abstract">
<p>The decision engine in Kogito is a hybrid reasoning system that uses both forward chaining and backward chaining to evaluate rules. A forward-chaining rule system is a data-driven system that starts with a fact in the working memory of the decision engine and reacts to changes to that fact. When objects are inserted into working memory, any rule conditions that become true as a result of the change are scheduled for execution by the agenda.</p>
</div>
<div class="paragraph">
<p>In contrast, a backward-chaining rule system is a goal-driven system that starts with a conclusion that the decision engine attempts to satisfy, often using recursion. If the system cannot reach the conclusion or goal, it searches for subgoals, which are conclusions that complete part of the current goal. The system continues this process until either the initial conclusion is satisfied or all subgoals are satisfied.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates how the decision engine evaluates rules using forward chaining overall with a backward-chaining segment in the logic flow:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/decision-engine/RuleEvaluation_enterprise.png" alt="RuleEvaluation enterprise">
</div>
<div class="title">Figure 154. Rule evaluation logic using forward and backward chaining</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="con-property-change-listeners_kogito-decision-engine"><a class="anchor" href="#con-property-change-listeners_kogito-decision-engine"></a><a class="link" href="#con-property-change-listeners_kogito-decision-engine">2.4.3.2. Property-change settings and listeners for fact types</a></h5>
<div class="paragraph _abstract">
<p>By default, the decision engine does not re-evaluate all fact patterns for fact types each time a rule is triggered, but instead reacts only to modified properties that are constrained or bound inside a given pattern. For example, if a rule calls <code>modify()</code> on a fact as part of the rule actions, this modification does not automatically trigger the re-evaluation of all patterns referring to the modified type. Only the patterns constrained on the changed properties of that fact are re-evaluated. This property reactivity behavior prevents unwanted recursions and results in more efficient rule evaluation. This behavior also avoids the need of using the <code>no-loop</code> rule attribute to prevent infinite recursion.</p>
</div>
<div class="paragraph">
<p>You can modify or disable this property reactivity behavior with the following options, and then use a property-change setting in your Java class or DRL files to fine-tune property reactivity as needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ALWAYS</code>: (Default) All types are property reactive, but you can disable property reactivity for a specific type by using the <code>@classReactive</code> property-change setting.</p>
</li>
<li>
<p><code>ALLOWED</code>: No types are property reactive, but you can enable property reactivity for a specific type by using the <code>@propertyReactive</code> property-change setting.</p>
</li>
<li>
<p><code>DISABLED</code>: No types are property reactive. All property-change listeners are ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To set the property reactivity behavior, update the <code>drools.propertySpecific</code> system property in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Example property reactivity setting in system properties</div>
<div class="content">
<pre class="highlight"><code>drools.propertySpecific=ALLOWED</code></pre>
</div>
</div>
<div class="paragraph">
<p>The decision engine supports the following property-change settings and listeners for fact classes or declared DRL fact types:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@classReactive</dt>
<dd>
<p>If property reactivity is set to <code>ALWAYS</code> in the decision engine (all types are property reactive), this tag disables the default property reactivity behavior for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to re-evaluate all fact patterns for the specified fact type each time the rule is triggered, instead of reacting only to modified properties that are constrained or bound inside a given pattern.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example: Disable default property reactivity in a DRL type declaration</div>
<div class="content">
<pre class="highlight"><code>declare Person
  @classReactive
    firstName : String
    lastName : String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Disable default property reactivity in a Java class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@classReactive
public static class Person {
    private String firstName;
    private String lastName;
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">@propertyReactive</dt>
<dd>
<p>If property reactivity is set to <code>ALLOWED</code> in the decision engine (no types are property reactive unless specified), this tag enables property reactivity for a specific Java class or a declared DRL fact type. You can use this tag if you want the decision engine to react only to modified properties that are constrained or bound inside a given pattern for the specified fact type, instead of re-evaluating all fact patterns for the fact each time the rule is triggered.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example: Enable property reactivity in a DRL type declaration (when reactivity is disabled globally)</div>
<div class="content">
<pre class="highlight"><code>declare Person
  @propertyReactive
    firstName : String
    lastName : String
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example: Enable property reactivity in a Java class (when reactivity is disabled globally)</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@propertyReactive
public static class Person {
    private String firstName;
    private String lastName;
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@propertyChangeSupport</dt>
<dd>
<p>For facts that implement support for property changes as defined in the <a href="https://download.oracle.com/otndocs/jcp/7224-javabeans-1.01-fr-spec-oth-JSpec/">JavaBeans Specification</a>, this tag enables the decision engine to monitor changes in the fact properties.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Example: Declare property change support in JavaBeans object</div>
<div class="content">
<pre class="highlight"><code>declare Person
    @propertyChangeSupport
end</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-engine-event-listeners_kogito-decision-engine"><a class="anchor" href="#con-engine-event-listeners_kogito-decision-engine"></a><a class="link" href="#con-engine-event-listeners_kogito-decision-engine">2.4.4. Decision engine event listeners and debug logging</a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The APIs for decision engine event listeners in Kogito are subject to change.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph _abstract">
<p>In Kogito, you can add or remove listeners for decision engine events, such as fact insertions and rule executions. With decision engine event listeners, you can be notified of decision engine activity and separate your logging and auditing work from the core of your application.</p>
</div>
<div class="paragraph">
<p>The decision engine supports the following default event listeners for the agenda and working memory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AgendaEventListener</code></p>
</li>
<li>
<p><code>WorkingMemoryEventListener</code></p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./UserGuide/WorkingMemoryEventManager.png" alt="WorkingMemoryEventManager">
</div>
<div class="title">Figure 155. WorkingMemoryEventManager</div>
</div>
<div class="paragraph">
<p>For each event listener, the decision engine also supports the following specific events that you can specify to be monitored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MatchCreatedEvent</code></p>
</li>
<li>
<p><code>MatchCancelledEvent</code></p>
</li>
<li>
<p><code>BeforeMatchFiredEvent</code></p>
</li>
<li>
<p><code>AfterMatchFiredEvent</code></p>
</li>
<li>
<p><code>AgendaGroupPushedEvent</code></p>
</li>
<li>
<p><code>AgendaGroupPoppedEvent</code></p>
</li>
<li>
<p><code>ObjectInsertEvent</code></p>
</li>
<li>
<p><code>ObjectDeletedEvent</code></p>
</li>
<li>
<p><code>ObjectUpdatedEvent</code></p>
</li>
<li>
<p><code>ProcessCompletedEvent</code></p>
</li>
<li>
<p><code>ProcessNodeLeftEvent</code></p>
</li>
<li>
<p><code>ProcessNodeTriggeredEvent</code></p>
</li>
<li>
<p><code>ProcessStartEvent</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following code uses a <code>DefaultAgendaEventListener</code> listener and specifies the <code>AfterMatchFiredEvent</code> event to be monitored. The code prints pattern matches after the rules are executed (fired):</p>
</div>
<div class="listingblock">
<div class="title">Example code to monitor and print <code>AfterMatchFiredEvent</code> events in the agenda</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyListener extends DefaultAgendaEventListener {
    public void afterMatchFired(AfterMatchFiredEvent event) {
        super.afterMatchFired( event );
        System.out.println( event );
    }
}

@ApplicationScoped
public class RuleEventListenerConfig extends DefaultRuleEventListenerConfig {
    public RuleEventListenerConfig() {
        super(new MyListener());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The decision engine also supports the following agenda and working memory event listeners for debug logging:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DebugAgendaEventListener</code></p>
</li>
<li>
<p><code>DebugRuleRuntimeEventListener</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These event listeners implement the same supported event-listener methods and include a debug print statement by default. You can add a specific supported event to be monitored and documented, or monitor all agenda or working memory activity.</p>
</div>
<div class="paragraph">
<p>For example, the following code uses the <code>DebugRuleRuntimeEventListener</code> event listener to monitor and print all working memory events:</p>
</div>
<div class="listingblock">
<div class="title">Example code to monitor and print all working memory events</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class RuleEventListenerConfig extends DefaultRuleEventListenerConfig {
    public RuleEventListenerConfig() {
        super(new DebugRuleRuntimeEventListener());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3 _additional-resources">
<h4 id="_additional_resources_5"><a class="anchor" href="#_additional_resources_5"></a><a class="link" href="#_additional_resources_5">2.4.5. Additional resources</a></h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-kogito-developing-process-services"><a class="anchor" href="#chap-kogito-developing-process-services"></a><a class="link" href="#chap-kogito-developing-process-services">3. Developing process services with Kogito</a></h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As a developer of business processes, you can use Kogito business automation to develop process services using Business Process Model and Notation (BPMN) 2.0 models. BPMN process models are graphical representations of the steps required to achieve a business goal. You can design your BPMN processes with the Kogito BPMN modeler in VSCode or import existing BPMN processes into your Kogito projects for deployment and execution.</p>
</div>
<div class="paragraph">
<p>For more information about BPMN, see the Object Management Group (OMG) <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation 2.0 specification</a>.</p>
</div>
<div class="sect2">
<h3 id="con-bpmn_kogito-developing-process-services"><a class="anchor" href="#con-bpmn_kogito-developing-process-services"></a><a class="link" href="#con-bpmn_kogito-developing-process-services">3.1. Business Process Model and Notation (BPMN) 2.0</a></h3>
<div class="paragraph _abstract">
<p>Business Process Model and Notation (BPMN) 2.0 is a standard established by the Object Management Group (OMG) for describing and modeling business processes. BPMN defines an XML schema that enables BPMN models to be shared between BPMN-compliant platforms and across organizations so that business analysts and business process developers can collaborate in designing and implementing BPMN process services. The BPMN standard is similar to and can be used together with the Decision Model and Notation (DMN) standard for designing and modeling business decisions.</p>
</div>
<div class="paragraph">
<p>For more information about BPMN, see the Object Management Group (OMG) <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation 2.0 specification</a>.</p>
</div>
<div class="sect3">
<h4 id="ref-bpmn-model-example_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-model-example_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-model-example_kogito-developing-process-services">3.1.1. BPMN model example</a></h4>
<div class="paragraph _abstract">
<p>A typical BPMN business process consists of the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start events to initiate the process</p>
</li>
<li>
<p>Tasks or other steps that are completed as part of the process</p>
</li>
<li>
<p>Connectors to link the process nodes and create a sequence flow</p>
</li>
<li>
<p>End events to terminate the process</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example is a real-world BPMN model scenario that demonstrates how you can use process modeling to reach a business goal based on business decisions, tasks, or other services. In this scenario, an order service uses business processes for ordering items, for verifying the order, and for evaluating customer age.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This example is based on the <code>process-quarkus-example</code> application in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub. However, this example may differ from the exact example source code as Kogito continues to be developed. Be sure to explore this and other Kogito examples in GitHub to help you develop your own applications.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>orders.bpmn2</code> process in the example describes the steps that need to be followed when ordering items. The process includes a script task for writing debug information and a call activity for invoking a subprocess, using a custom <code>Order</code> data object.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-model-example-orders.png" alt="Image of `orders.bpmn` example process">
</div>
<div class="title">Figure 156. Example <code>orders.bpmn2</code> process</div>
</div>
<div class="paragraph">
<p>The <code>Add items</code> subprocess invokes the following <code>orderItems.bpmn2</code> process, which uses a <code>CalculationService.calculateTotal</code> custom Java service and a user task to verify the order.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-model-example-order-items.png" alt="Image of `orderItems.bpmn` example process">
</div>
<div class="title">Figure 157. Example <code>orderItems.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>The <code>persons.bpmn2</code> process invokes a Decision Model and Notation (DMN) model in a business rule task to determine customer age, followed by a user task for special handling requirements for children, if applicable.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of `persons.bpmn` example process">
</div>
<div class="title">Figure 158. Example <code>persons.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>Based on these processes and on application configurations, Kogito generates a set of REST operations to create new orders, to list and delete active orders, and to determine the age of a specified person.</p>
</div>
<div class="paragraph">
<p>For example, the following REST operations use the endpoint <code>/orders</code> to interact with customer orders. You can use a REST client, curl utility, or the Swagger UI configured for the application (such as http://localhost:8080/q/swagger-ui or http://localhost:8080/swagger-ui.html) to send API requests to interact with the running application.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-swagger-example-jbpm.png" alt="Image of Swagger UI for example application">
</div>
<div class="title">Figure 159. Swagger UI to interact with all application endpoints (such as http://localhost:8080/q/swagger-ui or http://localhost:8080/swagger-ui.html)</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the predefined Kogito example applications, the Swagger UI for interacting with service endpoints is available only on Quarkus examples that you run in
development mode or in native mode.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example POST request body to create an order (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "approver": "john",
  "order": {
    "orderNumber": "12345",
    "shipped": false
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to create an order</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json' -d '{"approver" : "john", "order" : {"orderNumber" : "12345", "shipped" : false}}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned order displays an <code>"id"</code> field with a generated UUID that you can use to retrieve details about this specific order, if needed.</p>
</div>
<div class="listingblock">
<div class="title">Example curl command to view active orders</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orders -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to view order details by returned UUID</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orders/6b53c227-6d5e-40b7-8c8c-a541a2a47d58 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You use the <code>"id"</code> value for the order that was returned when you created the order or when you retrieved active orders.</p>
</div>
<div class="listingblock">
<div class="title">Example curl command to cancel the order by returned UUID</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE http://localhost:8080/orders/6b53c227-6d5e-40b7-8c8c-a541a2a47d58 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is the BPMN source file for the <code>orders.bpmn2</code> process model, as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!-- origin at X=0.0 Y=0.0 --&gt;
&lt;bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmn20="http://www.omg.org/bpmn20" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:bpsim="http://www.bpsim.org/schemas/1.0" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:drools="http://www.jboss.org/drools" xmlns="http://www.jboss.org/drools" xmlns:ns="http://www.w3.org/2001/XMLSchema" xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd http://www.jboss.org/drools drools.xsd http://www.bpsim.org/schemas/1.0 bpsim.xsd" id="_gfw8oEcJEemyodG9iPy-Bw" exporter="org.eclipse.bpmn2.modeler.core" exporterVersion="1.5.0.Final-v20180515-1642-B1" targetNamespace="http://www.omg.org/bpmn20"&gt;
  &lt;bpmn2:itemDefinition id="_OrderItem" isCollection="false" structureRef="org.kie.kogito.examples.demo.Order"/&gt;
  &lt;bpmn2:itemDefinition id="_approverItem" isCollection="false" structureRef="String"/&gt;
  &lt;bpmn2:itemDefinition id="__9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderInputXItem" isCollection="false" structureRef="org.kie.kogito.examples.demo.Order"/&gt;
  &lt;bpmn2:itemDefinition id="__9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderOutputXItem" isCollection="false" structureRef="org.kie.kogito.examples.demo.Order"/&gt;
  &lt;bpmn2:process id="demo.Orders" drools:packageName="org.kie.kogito.examples" drools:version="1.0" drools:adHoc="false" name="Orders" isExecutable="true"&gt;
    &lt;bpmn2:documentation id="_gfw8oUcJEemyodG9iPy-Bw"&gt;&lt;![CDATA[Deals with orders created by customer]]&gt;&lt;/bpmn2:documentation&gt;
    &lt;bpmn2:property id="order" itemSubjectRef="_OrderItem" name="order"/&gt;
    &lt;bpmn2:property id="approver" itemSubjectRef="_approverItem" name="approver"/&gt;
    &lt;bpmn2:sequenceFlow id="_8216C810-34D8-4BFA-B814-1AA01907810F" sourceRef="_9484CB12-FE52-434C-AE9F-3C3C267D1C96" targetRef="_2D876EF2-93F4-4CBE-959A-04EF7BFA9CED"/&gt;
    &lt;bpmn2:sequenceFlow id="_58684613-0155-48B2-8746-7675AFF24439" sourceRef="_0617D7DF-047A-4EC4-85E7-E201D640F4F5" targetRef="_9484CB12-FE52-434C-AE9F-3C3C267D1C96"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="isAutoConnection.target"&gt;
          &lt;drools:metaValue&gt;&lt;![CDATA[true]]&gt;&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
    &lt;/bpmn2:sequenceFlow&gt;
    &lt;bpmn2:sequenceFlow id="_B7B4282B-F317-4BF9-95E9-962B046EE815" sourceRef="_B44545AB-8B78-4FE4-B6B9-1D467954C070" targetRef="_0617D7DF-047A-4EC4-85E7-E201D640F4F5"/&gt;
    &lt;bpmn2:scriptTask id="_0617D7DF-047A-4EC4-85E7-E201D640F4F5" name="Dump order" scriptFormat="http://www.java.com/java"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;&lt;![CDATA[Dump order]]&gt;&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;_B7B4282B-F317-4BF9-95E9-962B046EE815&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;_58684613-0155-48B2-8746-7675AFF24439&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:script&gt;System.out.println(&amp;quot;Order has been created &amp;quot; + order + &amp;quot; with assigned approver &amp;quot; + approver.toUpperCase());&lt;/bpmn2:script&gt;
    &lt;/bpmn2:scriptTask&gt;
    &lt;bpmn2:endEvent id="_2D876EF2-93F4-4CBE-959A-04EF7BFA9CED"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;&lt;![CDATA[]]&gt;&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;_8216C810-34D8-4BFA-B814-1AA01907810F&lt;/bpmn2:incoming&gt;
    &lt;/bpmn2:endEvent&gt;
    &lt;bpmn2:callActivity id="_9484CB12-FE52-434C-AE9F-3C3C267D1C96" drools:independent="false" drools:waitForCompletion="true" name="Add items" calledElement="demo.orderItems"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;&lt;![CDATA[Add items]]&gt;&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:incoming&gt;_58684613-0155-48B2-8746-7675AFF24439&lt;/bpmn2:incoming&gt;
      &lt;bpmn2:outgoing&gt;_8216C810-34D8-4BFA-B814-1AA01907810F&lt;/bpmn2:outgoing&gt;
      &lt;bpmn2:ioSpecification id="_gfw8okcJEemyodG9iPy-Bw"&gt;
        &lt;bpmn2:dataInput id="_9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderInputX" drools:dtype="org.kie.kogito.examples.demo.Order" itemSubjectRef="__9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderInputXItem" name="order"/&gt;
        &lt;bpmn2:dataOutput id="_9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderOutputX" drools:dtype="org.kie.kogito.examples.demo.Order" itemSubjectRef="__9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderOutputXItem" name="order"/&gt;
        &lt;bpmn2:inputSet id="_gfw8o0cJEemyodG9iPy-Bw"&gt;
          &lt;bpmn2:dataInputRefs&gt;_9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderInputX&lt;/bpmn2:dataInputRefs&gt;
        &lt;/bpmn2:inputSet&gt;
        &lt;bpmn2:outputSet id="_gfw8pEcJEemyodG9iPy-Bw"&gt;
          &lt;bpmn2:dataOutputRefs&gt;_9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderOutputX&lt;/bpmn2:dataOutputRefs&gt;
        &lt;/bpmn2:outputSet&gt;
      &lt;/bpmn2:ioSpecification&gt;
      &lt;bpmn2:dataInputAssociation id="_gfw8pUcJEemyodG9iPy-Bw"&gt;
        &lt;bpmn2:sourceRef&gt;order&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;_9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderInputX&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataInputAssociation&gt;
      &lt;bpmn2:dataOutputAssociation id="_gfw8pkcJEemyodG9iPy-Bw"&gt;
        &lt;bpmn2:sourceRef&gt;_9484CB12-FE52-434C-AE9F-3C3C267D1C96_orderOutputX&lt;/bpmn2:sourceRef&gt;
        &lt;bpmn2:targetRef&gt;order&lt;/bpmn2:targetRef&gt;
      &lt;/bpmn2:dataOutputAssociation&gt;
    &lt;/bpmn2:callActivity&gt;
    &lt;bpmn2:startEvent id="_B44545AB-8B78-4FE4-B6B9-1D467954C070"&gt;
      &lt;bpmn2:extensionElements&gt;
        &lt;drools:metaData name="elementname"&gt;
          &lt;drools:metaValue&gt;&lt;![CDATA[]]&gt;&lt;/drools:metaValue&gt;
        &lt;/drools:metaData&gt;
      &lt;/bpmn2:extensionElements&gt;
      &lt;bpmn2:outgoing&gt;_B7B4282B-F317-4BF9-95E9-962B046EE815&lt;/bpmn2:outgoing&gt;
    &lt;/bpmn2:startEvent&gt;
  &lt;/bpmn2:process&gt;
  &lt;bpmndi:BPMNDiagram id="_gfw8p0cJEemyodG9iPy-Bw"&gt;
    &lt;bpmndi:BPMNPlane id="_gfw8qEcJEemyodG9iPy-Bw" bpmnElement="demo.Orders"&gt;
      &lt;bpmndi:BPMNShape id="shape__B44545AB-8B78-4FE4-B6B9-1D467954C070" bpmnElement="_B44545AB-8B78-4FE4-B6B9-1D467954C070"&gt;
        &lt;dc:Bounds height="56.0" width="56.0" x="100.0" y="100.0"/&gt;
        &lt;bpmndi:BPMNLabel/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape__9484CB12-FE52-434C-AE9F-3C3C267D1C96" bpmnElement="_9484CB12-FE52-434C-AE9F-3C3C267D1C96" isExpanded="true"&gt;
        &lt;dc:Bounds height="101.0" width="153.0" x="458.5" y="78.0"/&gt;
        &lt;bpmndi:BPMNLabel&gt;
          &lt;dc:Bounds height="11.0" width="41.0" x="514.0" y="123.0"/&gt;
        &lt;/bpmndi:BPMNLabel&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape__2D876EF2-93F4-4CBE-959A-04EF7BFA9CED" bpmnElement="_2D876EF2-93F4-4CBE-959A-04EF7BFA9CED"&gt;
        &lt;dc:Bounds height="56.0" width="56.0" x="712.0" y="100.0"/&gt;
        &lt;bpmndi:BPMNLabel/&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNShape id="shape__0617D7DF-047A-4EC4-85E7-E201D640F4F5" bpmnElement="_0617D7DF-047A-4EC4-85E7-E201D640F4F5"&gt;
        &lt;dc:Bounds height="102.0" width="154.0" x="236.0" y="77.0"/&gt;
        &lt;bpmndi:BPMNLabel&gt;
          &lt;dc:Bounds height="11.0" width="48.0" x="289.0" y="122.0"/&gt;
        &lt;/bpmndi:BPMNLabel&gt;
      &lt;/bpmndi:BPMNShape&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape__B44545AB-8B78-4FE4-B6B9-1D467954C070_to_shape__0617D7DF-047A-4EC4-85E7-E201D640F4F5" bpmnElement="_B7B4282B-F317-4BF9-95E9-962B046EE815" sourceElement="shape__B44545AB-8B78-4FE4-B6B9-1D467954C070" targetElement="shape__0617D7DF-047A-4EC4-85E7-E201D640F4F5"&gt;
        &lt;di:waypoint xsi:type="dc:Point" x="156.0" y="128.0"/&gt;
        &lt;di:waypoint xsi:type="dc:Point" x="236.0" y="128.0"/&gt;
        &lt;bpmndi:BPMNLabel/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape__0617D7DF-047A-4EC4-85E7-E201D640F4F5_to_shape__9484CB12-FE52-434C-AE9F-3C3C267D1C96" bpmnElement="_58684613-0155-48B2-8746-7675AFF24439" sourceElement="shape__0617D7DF-047A-4EC4-85E7-E201D640F4F5" targetElement="shape__9484CB12-FE52-434C-AE9F-3C3C267D1C96"&gt;
        &lt;di:waypoint xsi:type="dc:Point" x="313.0" y="128.0"/&gt;
        &lt;di:waypoint xsi:type="dc:Point" x="458.5" y="128.5"/&gt;
        &lt;bpmndi:BPMNLabel/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
      &lt;bpmndi:BPMNEdge id="edge_shape__9484CB12-FE52-434C-AE9F-3C3C267D1C96_to_shape__2D876EF2-93F4-4CBE-959A-04EF7BFA9CED" bpmnElement="_8216C810-34D8-4BFA-B814-1AA01907810F" sourceElement="shape__9484CB12-FE52-434C-AE9F-3C3C267D1C96" targetElement="shape__2D876EF2-93F4-4CBE-959A-04EF7BFA9CED"&gt;
        &lt;di:waypoint xsi:type="dc:Point" x="535.0" y="128.5"/&gt;
        &lt;di:waypoint xsi:type="dc:Point" x="740.0" y="128.0"/&gt;
        &lt;bpmndi:BPMNLabel/&gt;
      &lt;/bpmndi:BPMNEdge&gt;
    &lt;/bpmndi:BPMNPlane&gt;
  &lt;/bpmndi:BPMNDiagram&gt;
&lt;/bpmn2:definitions&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-support_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-support_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-support_kogito-developing-process-services">3.1.2. BPMN2 support in Kogito</a></h4>
<div class="paragraph _abstract">
<p>Kogito currently supports a subset of the <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation 2.0 specification</a>. Although the Kogito BPMN modeler displays many BPMN components in the canvas palette, the process engine (process runtime component) in Kogito currently executes only the supported subset of components. If you use any BPMN components from the Kogito BPMN modeler palette that are not supported by the process engine, your Kogito project might fail to compile or execute. Additional BPMN components are added to Kogito runtime support with every release.</p>
</div>
<div class="paragraph">
<p>The following tables list the components from the BPMN2 specification that are currently supported by the Kogito runtime:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 98. Support status icons</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported by Kogito runtime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported by Kogito runtime</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 99. BPMN2 components</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 30%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">Component type</th>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Support status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="12"><p class="tableblock">Start events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escalation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conditional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="32"><p class="tableblock">Intermediate events</p></td>
<td class="tableblock halign-left valign-top" rowspan="11"><p class="tableblock">Catching</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escalation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conditional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="10"><p class="tableblock">Boundary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escalation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conditional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="11"><p class="tableblock">Throwing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escalation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conditional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="9"><p class="tableblock">End events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escalation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="6"><p class="tableblock">Tasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business rule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Send</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Receive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="4"><p class="tableblock">Subprocesses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Reusable
                    (call activity)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ad hoc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="6"><p class="tableblock">Gateways</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inclusive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclusive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event-based</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chaining</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="3"><p class="tableblock">Connectors</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sequence flow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/grn_check.png" alt="grn check"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message flow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Association</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="2"><p class="tableblock">Collaborators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lane</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2" rowspan="3"><p class="tableblock">Artifacts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Text annotation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bk_x.png" alt="bk x"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For more information about BPMN components, see the Object Management Group (OMG) <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation 2.0 specification</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-start-events_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-start-events_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-start-events_kogito-developing-process-services">3.1.3. Start events supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN start events initiate a business process. A start event cannot have an incoming sequence flow and must have only one outgoing sequence flow. You can use start events in top-level processes, embedded subprocess, and callable subprocesses where applicable.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following start events:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 100. Supported start events</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Start event type</th>
<th class="tableblock halign-left valign-top">Top-level processes</th>
<th class="tableblock halign-left valign-top" colspan="2">Subprocesses</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<th class="tableblock halign-left valign-top"><p class="tableblock">Interrupt</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Non-interrupt</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-start-node.png" alt="bpmn start node"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-message-node.png" alt="bpmn message node"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-message-node.png" alt="bpmn message node"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-message-non-interrupt.png" alt="bpmn message non interrupt"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-timer-start.png" alt="bpmn timer start"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-timer-start.png" alt="bpmn timer start"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-timer-non-interrupt.png" alt="bpmn timer non interrupt"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-signal-start.png" alt="bpmn signal start"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-signal-start.png" alt="bpmn signal start"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-signal-non-interrupt.png" alt="bpmn signal non interrupt"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">None</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The none start event is a start event without a trigger condition. A process or a subprocess can contain at most one none start event, which is triggered on process or subprocess start by default, and the outgoing flow is taken immediately.</p>
</div>
<div class="paragraph">
<p>When you use a none start event in a subprocess, the execution of the process flow is transferred from the parent process into the subprocess and the none start event is triggered. This means that the token (the current location within the process flow) is passed from the parent process into the subprocess activity and the none start event of the subprocess generates a token of its own.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Message</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A process can contain multiple message start events, which are triggered by a particular message. The process instance with a message start event starts its execution from this event after it has received the respective message. After the message is received, the process is instantiated and its message start event is executed immediately (its outgoing flow is taken).</p>
</div>
<div class="paragraph">
<p>Because a message can be consumed by an arbitrary number of processes and process elements, including no elements, one message can trigger multiple message start events and therefore instantiate multiple processes.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Timer</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The timer start event is a start event with a timing mechanism that is triggered at the start of the process. A process can contain multiple timer start events.</p>
</div>
<div class="paragraph">
<p>When you use a timer start event in a subprocess, execution of the process flow is transferred from the parent process into the subprocess and the timer start event is triggered. The token is taken from the parent subprocess activity and the timer start event of the subprocess is triggered and waits for the timer to trigger.</p>
</div>
<div class="paragraph">
<p>After the time defined by the timer definition is reached, the outgoing flow is taken.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Signal</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The signal start event is triggered by a signal with a particular signal code. The signal start event is triggered when the process instance receives the required signal, and then the signal start event is executed and its outgoing flow is taken. A process can contain multiple signal start events.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-intermediate-events_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-intermediate-events_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-intermediate-events_kogito-developing-process-services">3.1.4. Intermediate events supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN intermediate events drive the flow of a business process. Intermediate events catch or throw an event during the execution of the business process. You can add these events between start and end events or as a catch event on the boundary of an activity, such as a subprocess or a user task. You can configure boundary catch events as interrupting or non-interrupting events. An interrupting boundary catch event cancels the bound activity whereas a non-interrupting event does not.</p>
</div>
<div class="paragraph">
<p>An intermediate event handles a particular situation that occurs during process execution. The situation is a trigger for an intermediate event. In a process, you can add an intermediate event with one outgoing flow to an activity boundary.</p>
</div>
<div class="paragraph">
<p>If the event occurs while the activity is being executed, the event triggers its execution to the outgoing flow. One activity may have multiple boundary intermediate events. Note that depending on the behavior you require from the activity with the boundary intermediate event, you can use either of the following intermediate event types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interrupting: The activity execution is interrupted and the execution of the intermediate event is triggered.</p>
</li>
<li>
<p>Non-interrupting: The intermediate event is triggered and the activity execution continues.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Kogito currently supports the following intermediate events:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 101. Supported intermediate events</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Intermediate event type</th>
<th class="tableblock halign-left valign-top">Catching</th>
<th class="tableblock halign-left valign-top">Boundary</th>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Throwing</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Interrupt</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Non-interrupt</p></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-message.png" alt="bpmn intermediate message"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-message.png" alt="bpmn intermediate message"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-message-noninterrupt.png" alt="bpmn message noninterrupt"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-message-throwing.png" alt="bpmn message throwing"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-timer.png" alt="bpmn intermediate timer"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-timer.png" alt="bpmn intermediate timer"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-timer-noninterrupt.png" alt="bpmn timer noninterrupt"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-signal.png" alt="bpmn intermediate signal"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-signal.png" alt="bpmn intermediate signal"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-signal-noninterrupt.png" alt="bpmn signal noninterrupt"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-link-catching.png" alt="bpmn link catching"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-link-throwing.png" alt="bpmn link throwing"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-catch.png" alt="bpmn intermediate catch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-catch.png" alt="bpmn intermediate catch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-intermediate-compensation-throwing.png" alt="bpmn intermediate compensation throwing"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Message</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A message intermediate event is an intermediate event that enables you to manage a message object. Use one of the following events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A throwing message intermediate event produces a message object based on the defined properties.</p>
</li>
<li>
<p>A catching message intermediate event listens for a message object with the defined properties.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Timer</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A timer intermediate event enables you to delay workflow execution or to trigger the workflow execution periodically. It represents a timer that can trigger one or multiple times after a specified period of time. When the timer intermediate event is triggered, the defined timer condition is checked and the outgoing flow is taken.</p>
</div>
<div class="paragraph">
<p>When you add a timer intermediate event in the process workflow, it has one incoming flow and one outgoing flow. Its execution starts when the incoming flow transfers to the event. When you add a timer intermediate event on an activity boundary, the execution is triggered at the same time as the activity execution.</p>
</div>
<div class="paragraph">
<p>The timer is canceled if the timer element is canceled, for example, by completing or aborting the enclosing process instance.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Signal</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A signal intermediate event enables you to produce or consume a signal object. Use either of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A throwing signal intermediate event produces a signal object based on the defined properties.</p>
</li>
<li>
<p>A catching signal intermediate event listens for a signal object with the defined properties.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Link</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A link intermediate event enables you to jump from one place of the diagram to another. A link intermediate event is equivalent to the <code>goto</code> functionality in older programming languages.</p>
</div>
<div class="paragraph">
<p>Use throwing and catching link intermediate events together, where each functions in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A throwing link intermediate event refers to the target catching node.</p>
</li>
<li>
<p>A catching link intermediate event refers to the source throwing node.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Compensation</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A compensation intermediate event is a boundary event attached to an activity in a transaction subprocess. It can finish with a compensation end event or a cancel end event. The compensation intermediate event must be associated with a flow, which is connected to the compensation activity.</p>
</div>
<div class="paragraph">
<p>The activity associated with the boundary compensation intermediate event is executed if the transaction subprocess finishes with the compensation end event. The execution continues with the respective flow.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-end-events_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-end-events_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-end-events_kogito-developing-process-services">3.1.5. End events supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN end events terminate a business process. An end event has one or more incoming sequence flows and typically has no outgoing flows. A business process can contain multiple end events. All end events, with the exception of the none and terminate end events, are throw events. A process must contain at least one end event.</p>
</div>
<div class="paragraph">
<p>During runtime, an end event finishes the process workflow. The end event can finish only the workflow that reached it, or all workflows in the process instance, depending on the end event type.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following end events:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 102. Supported end events</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">End event type</th>
<th class="tableblock halign-left valign-top">Icon</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-end-node.png" alt="bpmn end node"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-end-message.png" alt="bpmn end message"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-end-error.png" alt="bpmn end error"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-end-terminate.png" alt="bpmn end terminate"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compensation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-end-compensation.png" alt="bpmn end compensation"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">None</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The none end event specifies that no other special behavior is associated with the end of the process.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Message</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When a flow enters a message end event, the flow finishes and the end event produces a message as defined in its properties.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Error</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The throwing error end event finishes the incoming workflow (consumes the incoming token) and produces an error object. Any other running workflows in the process or subprocess remain uninfluenced.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Terminate</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The terminate end event finishes all execution flows in the specified process or subprocess instance. Activities being executed are canceled. A terminate end event inside a subprocess ends the subprocess instance but does not automatically end the parent process instance.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Compensation</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A compensation end event is used to finish a transaction subprocess and trigger the compensation defined by the compensation intermediate event attached to the boundary of the subprocess activities.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-tasks_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-tasks_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-tasks_kogito-developing-process-services">3.1.6. Tasks supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN tasks identify actions to be completed in a business process model and are the smallest unit of work in a process flow.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following tasks:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 103. Supported tasks</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Task type</th>
<th class="tableblock halign-left valign-top">Task node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Business rule task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-business-rule-task.png" alt="bpmn business rule task"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Script task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-script-task.png" alt="bpmn script task"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-user-task.png" alt="bpmn user task"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-service-task.png" alt="bpmn service task"></span></p></td>
</tr>
</tbody>
</table>
<div id="ref-bpmn-businessruletask_kogito-developing-process-services" class="dlist">
<dl>
<dt class="hdlist1">Business rule task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A business rule task specifies a business decision to be executed either through a Decision Model and Notation (DMN) model or a Drools Rule Language (DRL) rule unit.</p>
</div>
<div class="paragraph">
<p>When a process reaches a business rule task defined by a DMN model, the process engine executes the DMN model decision with the inputs provided.</p>
</div>
<div class="paragraph">
<p>When a process reaches a business rule task defined by a DRL rule unit, the process engine begins executing the rules in the designated rule unit group. When there are no more active rules in the rule unit, the execution continues to the next element. During the rule unit execution, new activations in the rule unit are added to the decision engine agenda because these activations are changed by other rules.</p>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected business rule task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 104. Business rule task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rule Language</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the task invokes a decision from a Decision Model and Notation (DMN) model or a Drools Rule Language (DRL) rule unit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rule Flow Group</strong> (for DRL)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the DRL rule unit in the format <code>unit:<em>PACKAGE_NAME</em>.<em>UNIT_NAME</em></code>, such as <code>unit:org.acme.PersonRules</code>. This rule unit syntax specifies that you are using a rule unit instead of a traditional rule flow group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Namespace</strong>, <strong>Decision Name</strong>, <strong>DMN Model Name</strong> (for DMN)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the relevant DMN model as found in the DMN model file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the task, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the task, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall task.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">Script task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A script task represents a script to be executed during the process execution. The associated script can access process variables. When a script task is reached during execution, the script is executed and the outgoing flow is taken.</p>
</div>
<div class="paragraph">
<p>Review the following list of suggestions before using a script task:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Avoid low-level implementation details in the process. Although you can use a script task to manipulate variables, consider using a service task when modeling more complex operations.</p>
</li>
<li>
<p>Ensure that the script is executed immediately. If the script is not intended to be executed immediately, consider using an asynchronous service task.</p>
</li>
<li>
<p>Avoid contacting external services through a script task. Use a service task to model communication with an external service.</p>
</li>
<li>
<p>Ensure scripts do not generate exceptions. Runtime exceptions should be caught and managed inside the script or transformed into signals or errors that can then be handled inside the process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected script task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 105. Script task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Script</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a Java, JavaScript, or MVEL script to be executed by the task and specifies the script type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall task.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">User task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A user task is an activity in the process workflow that cannot be performed automatically by the system and therefore requires the intervention of a human user, or <em>actor</em>.</p>
</div>
<div class="paragraph">
<p>On execution, the user task element is instantiated as a task that appears in the list of tasks of one or more actors. If a user task element defines the <code>Groups</code> property, the task is displayed in task lists of all users that are members of the group. Any user who is a member of the group can claim the task. After a user task is claimed, the task disappears from the task list of the other users.</p>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected user task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 106. User task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Task Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task as it is displayed to human user (actor).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Subject</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the subject for the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Actors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the authorized human users (actors) who can complete the user task. Click <strong>Add</strong> to add a row and then select an actor from the list or click <strong>New</strong> to add a new actor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the authorized group of human users (actors) who can complete the user task. Click <strong>Add</strong> to add a row and then select a group from the list or click <strong>New</strong> to add a new group. Any actor in the group can complete the user task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Reassignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a different actor to complete the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Notifications</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines notifications associated with the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Skippable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the task is optional and can be skipped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Priority</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a priority for the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task as it is displayed to a human user (actor).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Created By</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the human user (actor) who created the task. Click <strong>Add</strong> to add a row and then select a user from the list or click <strong>New</strong> to add a new user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multiple Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task has multiple instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the task, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the task, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Content</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the content of the script.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall task.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">Service task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A service task is an activity that is completed automatically by an external software service and does not require human interaction.</p>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected service task:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 107. Service task properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the task. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Implementation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the task is implemented in Java or is a web service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Interface</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the class used to implement the script, for example, <code>org.xyz.HelloWorld</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Operation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the method called by the interface, for example, <code>sayHello()</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc task that is started automatically. This option enables the task to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task is invoked asynchronously. Make tasks asynchronous if they cannot be executed instantaneously, such as a task performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multiple Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this task has multiple instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the task, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the task, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall task.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A service task also allows you to add a parameter of type <code>org.kie.kogito.internal.process.runtime.KogitoProcessContext</code> in your method signature to receive the process context, in which the task is executed. The following is an example of a service task using the process context:</p>
</div>
<div class="listingblock">
<div class="title">Example service task using process context</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class CalculationService {

    public Order calculateTotal(Order order, KogitoProcessContext context) {
        System.out.println("Process Id = " + context.getProcessInstance().getStringId());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-custom-tasks_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-custom-tasks_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-custom-tasks_kogito-developing-process-services">3.1.7. Custom tasks supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>The BPMN specification supports the ability to extend the <code>bpmn2:task</code> element to create custom tasks in a software implementation. Similar to standard BPMN tasks, custom tasks identify actions to be completed in a business process model, but they also include specialized functionality, such as compatibility with an external service of a specific type (REST, email, or web service) or checkpoint behavior within a process (milestone).</p>
</div>
<div class="paragraph">
<p>Kogito provides predefined custom tasks under <strong>Custom Tasks</strong> in the BPMN modeler palette, but currently does not support the ability for you to define your own custom task extensions.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following predefined custom tasks:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 108. Supported custom tasks</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Custom task type</th>
<th class="tableblock halign-left valign-top">Custom task node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Milestone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-milestone.png" alt="bpmn milestone"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Milestone</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A milestone represents a single point of achievement within a process instance. You can use milestones to flag certain events to trigger other tasks or track the progress of the process. Milestones are useful for Key Performance Indicator (KPI) tracking or for identifying the tasks that are still to be completed. Milestones can occur at the end of a stage in a process or they can be the result of achieving other milestones.</p>
</div>
<div class="paragraph">
<p>A milestone typically uses a defined input condition that must be met in order to complete the milestone. If no input condition is defined, the milestone is completed automatically when the process reaches the milestone. You can also configure milestones with the <code>AdHoc Autostart</code> property to be triggered automatically when the process starts or you can set the <strong>Signal</strong> definition in a signal event in the process to trigger the milestone explicitly. Milestones can be triggered as many times as required. A milestone is achieved when the condition is met or is achieved automatically if no condition is defined.</p>
</div>
<div class="paragraph">
<p>In the following example process, several milestones control the process for IT hardware orders. For example, when the condition for the <code>Order placed</code> milestone is met, the completed milestone triggers a notification script task and leads to an end signal event that triggers the next <code>Order shipped</code> milestone, and so on to subsequent milestones until the process is complete.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-milestone-example.png" alt="Image of example process with milestones">
</div>
<div class="title">Figure 160. Example process with milestones</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-milestone-example-signal.png" alt="Image of example signal configuration with a milestone">
</div>
<div class="title">Figure 161. Example end signal event configured to trigger the next milestone</div>
</div>
<div class="paragraph">
<p>Milestones can reach the following states during process execution:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Active</code>: A milestone condition has been defined for the milestone node but it has not been met.</p>
</li>
<li>
<p><code>Completed</code>: A milestone condition has been met (if applicable), the milestone has been achieved, and the process can proceed to the next task or can end.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected milestone:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 109. Milestone properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the milestone.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the milestone. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this milestone is invoked asynchronously. Make milestones asynchronous if they cannot be executed instantaneously, such as in a process performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this is an ad hoc milestone that is started automatically. This option enables the milestone to automatically start when the process is created instead of being started by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the milestone, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the milestone, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines data input and output for the milestone. Click to open the <strong>Data I/O</strong> window and add data input and output as required. A milestone typically uses a defined input condition that must be met in order to complete the milestone. If no input condition is defined, the milestone is completed automatically when the process reaches the milestone.</p>
</div>
<div class="paragraph">
<p>For each milestone that requires a condition, enter at least one input data assignment with the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: <code>Condition</code></p>
</li>
<li>
<p><strong>Data Type</strong>: <code>String</code></p>
</li>
<li>
<p><strong>Source</strong>: Enter a Java expression for the condition to be met, such as <code>order.isShipped()</code> in a process that uses an <code>order</code> process variable.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall task.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-subprocesses_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-subprocesses_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-subprocesses_kogito-developing-process-services">3.1.8. Subprocesses supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN subprocesses are portions of a parent process that contain process nodes. You can embed part of the parent process within a subprocess. You can also include variable definitions within the subprocess. These variables are accessible to all nodes inside the subprocess.</p>
</div>
<div class="paragraph">
<p>A subprocess must have one incoming connection and one outgoing connection. A terminate end event inside a subprocess ends the subprocess instance but does not automatically end the parent process instance. A subprocess ends when there are no more active elements in it.</p>
</div>
<div class="paragraph">
<p>In the following example, the <code>Place order</code> subprocess checks whether sufficient stock is available to place the order and updates the stock information if the order can be placed. The customer is then notified through the main process based on whether the order was placed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/subprocess.png" alt="subprocess">
</div>
<div class="title">Figure 162. Example subprocess</div>
</div>
<div class="paragraph">
<p>Kogito currently supports the following subprocesses:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 110. Supported subprocesses</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Subprocess type</th>
<th class="tableblock halign-left valign-top">Subprocess node</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Embedded subprocess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-embedded-subprocess.png" alt="bpmn embedded subprocess"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ad hoc subprocess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-adhoc-subprocess.png" alt="bpmn adhoc subprocess"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reusable subprocess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-reusable-subprocess.png" alt="bpmn reusable subprocess"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Embedded subprocess</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>An embedded subprocess encapsulates a part of the parent process and shares the parent process data. This subprocess must contain a start event and at least one end event. You can define local subprocess variables that are accessible to all elements inside this container.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Multiple-instance behavior is currently not supported for embedded subprocesses in Kogito.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected embedded subprocess:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 111. Embedded subprocess properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the subprocess.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the subprocess. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this subprocess is invoked asynchronously. Make subprocesses asynchronous if they cannot be executed instantaneously, such as a subprocess performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines any process variables for the subprocess. Process variables are visible within the specific subprocess instance. Process variables are initialized at subprocess creation and destroyed on subprocess completion. Variable <strong>Tags</strong> provide greater control over the variable behavior, such as whether the variable is <code>required</code> or <code>internal</code>. For more information about variable tags, see <a href="#con-bpmn-variables_kogito-developing-process-services">Variables in Kogito processes</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall subprocess.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">Ad hoc subprocess</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>An ad hoc subprocess contains embedded inner activities and is intended to be executed with a more flexible ordering compared to the typical routing of processes. Unlike typical processes, an ad hoc subprocess does not contain a complete, structured BPMN diagram description, such as from a start event to an end event. Instead, the ad hoc subprocess contains only activities, sequence flows, gateways, and intermediate events. An ad hoc subprocess can also contain data objects and data associations.</p>
</div>
<div class="paragraph">
<p>The activities within ad hoc subprocesses are not required to have incoming and outgoing sequence flows. However, you can specify sequence flows between some of the contained activities. Sequence flows provide the same ordering constraints in ad hoc subprocesses as in a typical process. Any intermediate events must have outgoing sequence flows and they can be triggered multiple times while the ad hoc subprocess is active.</p>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected ad hoc subprocess:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 112. Ad hoc subprocess properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the subprocess.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the subprocess. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHocActivationCondition</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines a Java expression that determines when the subprocess is activated, such as <code>order.isShipped()</code> in a process that uses an <code>order</code> process variable. To activate the subprocess automatically when the parent process starts, leave this field empty with no condition specified.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This field supports only Java expressions and does not support Drools expressions as indicated in the field label. This label will be updated in a future release.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHocCompletionCondition</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines a Java expression that determines when the subprocess is completed, such as <code>order.isDelivered()</code> in a process that uses an <code>order</code> process variable. By default, this field contains the value <code>autocomplete</code> to complete the subprocess automatically when the subprocess ends.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This field supports only Java expressions and does not support Drools and MVEL expressions as indicated in the field label. This label will be updated in a future release.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHocOrdering</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property specifies whether the subprocess is executed in <strong>Sequential</strong> or <strong>Parallel</strong> order in the parent process, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>AdHoc Autostart</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this ad hoc subprocess is started automatically. This option enables the subprocess to automatically start when the subprocess is created instead of being started by the completion of the previous node or by a signal event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this subprocess is invoked asynchronously. Make subprocesses asynchronous if they cannot be executed instantaneously, such as a subprocess performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines any process variables for the subprocess. Process variables are visible within the specific subprocess instance. Process variables are initialized at subprocess creation and destroyed on subprocess completion. Variable <strong>Tags</strong> provide greater control over the variable behavior, such as whether the variable is <code>required</code> or <code>internal</code>. For more information about variable tags, see <a href="#con-bpmn-variables_kogito-developing-process-services">Variables in Kogito processes</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall subprocess.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">Reusable subprocess</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A reusable subprocess calls another process or subprocess instance to be used within a parent process. This subprocess enables you to reuse the same process repeatedly without manually duplicating the subprocess.  This subprocess typically appears collapsed within the parent process.</p>
</div>
<div class="paragraph">
<p>In the Kogito BPMN modeler, you can modify the following properties for a selected reusable subprocess:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 113. Reusable subprocess properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the name of the subprocess.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the subprocess. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Called Element</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the ID of the process or subprocess that the activity calls and instantiates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Independent</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the subprocess is started and completed independently of the parent process or whether the subprocess is canceled when the parent process is terminated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Abort Parent</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Available only when <strong>Independent</strong> is not selected.) Determines whether a dependent reusable subprocess can abort the parent process when the subprocess is aborted or when an error occurs during the subprocess execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Wait for completion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether the parent process must wait for this subprocess to complete before continuing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Is Async</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether this subprocess is invoked asynchronously. Make subprocesses asynchronous if they cannot be executed instantaneously, such as a subprocess performed by an outside service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multiple Instance</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determines whether the subprocess is executed multiple times. When you select this option, the following additional options appear:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>MI Execution mode</strong>: Specifies whether the multiple subprocess instances are executed in <strong>Sequential</strong> or <strong>Parallel</strong> order as each instance is triggered. In sequential order, a triggered subprocess starts only after the previous subprocess instance completes. In parallel order, a subprocess instance starts whenever it is triggered and can run in parallel with any other triggered subprocesses.</p>
</li>
<li>
<p><strong>MI Collection input</strong>: Specifies the process variable that represents a collection of elements for which new instances are created. The subprocess is instantiated as many times as needed according to the size of the collection.</p>
</li>
<li>
<p><strong>MI Data Input</strong>: Specifies the name of the process variable that contains the selected element in the collection. The variable is used to access elements in the collection.</p>
</li>
<li>
<p><strong>MI Collection output</strong>: (Optional) Specifies the process variable that represents the collection of elements that gather the output of the multi-instance node.</p>
</li>
<li>
<p><strong>MI Data Output</strong>: Specifies the name of the process variable that is added to the output collection that you selected in the <strong>MI Collection output</strong> property.</p>
</li>
<li>
<p><strong>MI Completion Condition</strong>: Not supported in Kogito. This property defines a Java expression that is evaluated on each completed subprocess instance, and is currently available only in distributions of the BPMN modeler in jBPM.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Entry Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the start of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>On Exit Action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. This property defines a Java, JavaScript, or MVEL script that directs an action at the end of the subprocess, and is currently available only in distributions of the BPMN modeler in jBPM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Assignments</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines data input and output for the task. Click to open the <strong>Data I/O</strong> window and add data input and output as required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">The <strong>Metadata Attributes</strong> enable the new <code>metaData</code> extensions to BPMN diagrams and modify the behavior of the overall subprocess.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-gateways_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-gateways_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-gateways_kogito-developing-process-services">3.1.9. Gateways supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN gateways create or synchronize branches in a process workflow using a set of conditions in a gating mechanism. BPMN2 supports <em>converging gateways</em> that merge multiple flows into one flow, and <em>diverging gateways</em> that split one flow into multiple flows. One gateway cannot have multiple incoming and multiple outgoing flows.</p>
</div>
<div class="paragraph">
<p>In the following business process diagram, the exclusive (XOR) gateway evaluates only the incoming flow whose condition evaluates to true:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/gateway.png" alt="gateway">
</div>
<div class="title">Figure 163. Example process with exclusive gateway</div>
</div>
<div class="paragraph">
<p>In this example, the customer details are verified by a user and the process is assigned to a user for approval. If the request is approved, an approval notification is sent to the user. If the request is rejected, a rejection notification is sent to the user.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following gateways:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 114. Supported gateways</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Gateway type</th>
<th class="tableblock halign-left valign-top">Icon</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclusive (XOR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-gateway-exclusive.png" alt="bpmn gateway exclusive"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inclusive (OR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-gateway-inclusive.png" alt="bpmn gateway inclusive"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel (AND)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-gateway-parallel.png" alt="bpmn gateway parallel"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event (AND)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="./kogito/bpmn/bpmn-gateway-event.png" alt="bpmn gateway event"></span></p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Exclusive</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A diverging exclusive gateway selects only the first incoming flow that evaluates to true and that contains the lowest <code>priority</code> number, if applicable. A converging exclusive gateway activates the next node for each triggered incoming flow.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that at least one of the outgoing flows evaluates to true at runtime. If no outgoing flows evaluate to true, the process instance terminates with a runtime exception.</p>
</div>
<div class="paragraph">
<p>Although priorities are evaluated in Kogito, the BPMN2 specification does not guarantee the priority order. Avoid depending on the <code>priority</code> attribute in your workflow.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A converging exclusive gateway also enables a workflow branch to continue to its outgoing flow as soon as it reaches the gateway. When one of the incoming flows triggers the gateway, the workflow continues to the outgoing flow of the gateway. If a gateway is triggered by more than one incoming flow, the gateway activates the next node for each trigger.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Inclusive</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A diverging inclusive gateway selects the incoming flow and all outgoing flows that evaluate to true. Connections with lower <code>priority</code> numbers are triggered before triggering higher <code>priority</code> connections. Although priorities are evaluated, the BPMN2 specification does not guarantee the priority order. Avoid depending on the <code>priority</code> attribute in your workflow.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that at least one of the outgoing flows evaluates to true at runtime. If no outgoing flows evaluate to true, the process instance terminates with a runtime exception.</p>
</div>
<div class="paragraph">
<p>Although priorities are evaluated in Kogito, the BPMN2 specification does not guarantee the priority order. Avoid depending on the <code>priority</code> attribute in your workflow.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A converging inclusive gateway also merges all incoming flows previously created by an inclusive diverging gateway. A converging inclusive gateway acts as a synchronizing entry point for the inclusive gateway branches.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Parallel</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A parallel gateway synchronizes and creates parallel flows. A diverging parallel gateway selects the incoming flow and all outgoing flows simultaneously. A converging parallel gateway waits until all incoming flows have entered and then triggers the outgoing flow.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Event</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>An event gateway is only diverging and reacts to possible events, as opposed to the data-based exclusive gateway that reacts to the process data. An event gateway selects the outgoing flow based on the event that occurs, and selects only one outgoing flow at a time. An event gateway might act as a start event, where the process is instantiated only if one of the intermediate events connected to the event-based gateway occurs.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="ref-bpmn-connectors_kogito-developing-process-services"><a class="anchor" href="#ref-bpmn-connectors_kogito-developing-process-services"></a><a class="link" href="#ref-bpmn-connectors_kogito-developing-process-services">3.1.10. Connectors supported in Kogito</a></h4>
<div class="paragraph _abstract">
<p>BPMN connectors create an association between two components in a process. When a connector is directed, the association is sequential and indicates that one of the elements is executed immediately before the other within an instance of the process. Connectors can start and end at the top, bottom, right, or left of the process components being associated. The BPMN2 specification allows you to use your discretion, placing connectors in a way that makes the process behavior easy to follow and understand.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports only sequence flow connectors. A sequence flow connects elements of a process and defines the order in which those elements are executed within an instance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-bpmn-model-creating_kogito-developing-process-services"><a class="anchor" href="#proc-bpmn-model-creating_kogito-developing-process-services"></a><a class="link" href="#proc-bpmn-model-creating_kogito-developing-process-services">3.2. Creating and editing BPMN models in the Kogito BPMN modeler</a></h3>
<div class="paragraph _abstract">
<p>You can use the <strong>Apache KIE™ Kogito Bundle</strong> in VSCode to design BPMN process models and define process logic for a complete and functional BPMN model.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports a subset of the <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation 2.0 specification</a>. Although the Kogito BPMN modeler displays many BPMN components in the canvas palette, the process engine (process runtime component) in Kogito currently executes only the supported subset of components. If you use any BPMN components from the Kogito BPMN modeler palette that are not supported by the process engine, your Kogito project might fail to compile or execute. Additional BPMN components are added to Kogito runtime support with every release.</p>
</div>
<div class="paragraph">
<p>For more information about BPMN2 support in Kogito, see <a href="#ref-bpmn-support_kogito-developing-process-services">BPMN2 support in Kogito</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://code.visualstudio.com/">VSCode</a>  is installed.</p>
</li>
<li>
<p>The <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension is installed and enabled in your VSCode IDE. For information about enabling the VSCode extension, see <a href="https://kie.apache.org/kogito-docs/#proc-kogito-vscode-extension_kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</li>
<li>
<p>You have created a Kogito project and have included any Java objects required for your Kogito service. For information about creating a project, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, create or import a BPMN file in the relevant folder of your Kogito project, typically in <code>src/main/resources</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you finish creating your process model, you can click <strong>Download</strong> in the <strong>Apache KIE™ Sandbox</strong> page to import your BPMN file into your Kogito project.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Open the new or imported BPMN file to view the process diagram in the Kogito BPMN modeler.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If the process diagram does not open in the Kogito BPMN modeler, ensure that you have installed and enabled the <strong>Apache KIE™ Kogito Bundle</strong> VSCode extension.</p>
</div>
<div class="paragraph">
<p>If the Kogito BPMN modeler opens only the XML source of the BPMN file and displays an error message, review the reported errors and the BPMN model file to ensure that all BPMN elements are correctly defined.</p>
</div>
</div>
</div>
</li>
<li>
<p>Select the background of the BPMN modeler canvas and, in the upper-right corner of the modeler, click <strong>Properties</strong> to add or verify information for the BPMN file as described in the following table:</p>
<div class="openblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 115. General process properties</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Label</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the name of the process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Documentation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the process. The text in this field is included in the process documentation, if applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ID</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter an identifier for this process, such as <code>orderItems</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Package</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the package location for this process in your Kogito project, such as <code>org.acme</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ProcessType</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify whether the process is public or private (or null, if not applicable).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Version</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the artifact version for the process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Ad hoc</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this option if this process is a flexible process that uses other ad hoc auto-start fragments and that does not require strict start and end events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Instance Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter a description of the process purpose.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Imports</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click to open the <strong>Imports</strong> window and add any data object classes required for your process.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Executable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this option to make the process executable as part of your Kogito project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SLA Due Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the date when the service level agreement (SLA) expires.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add any process variables for the process. Process variables are visible within the specific process instance. Process variables are initialized at process creation and destroyed on process completion. Variable <strong>Tags</strong> provide greater control over the variable behavior, such as whether the variable is <code>required</code> or <code>internal</code>. For more information about variable tags, see <a href="#con-bpmn-variables_kogito-developing-process-services">Variables in Kogito processes</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Metadata Attributes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add any custom metadata attribute name and value that you want to use for custom event listeners, such as a listener to implement some action when a metadata attribute is present.</p>
<p class="tableblock">You can also use this field to configure role-based access to the process. To configure role-based access, set the attribute <strong>Name</strong> to <code>securityRoles</code> and set the attribute value to the relevant group or groups defined for the process, such as <code>employees,managers</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Global Variables</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported in Kogito. Global variables are visible to all process instances and assets in a project, and apply only to distributions of the BPMN modeler in jBPM.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Metadata Attributes</strong> entries are similar to <strong>Process Variables</strong> tags in that they enable new <code>metaData</code> extensions to BPMN diagrams. However, process variable tags modify the behavior of specific process variables, such as whether a certain variable is <code>required</code> or <code>internal</code>, whereas metadata attributes are key-value definitions that modify the behavior of the overall process, such as whether the process contains <code>securityRoles</code> or is used in conjunction with a custom event listener.</p>
</div>
<div class="paragraph">
<p>For example, the following custom metadata attribute <code>riskLevel</code> and value <code>low</code> in a BPMN process correspond to a custom event listener for starting the process:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-metadata-attributes-custom.png" alt="Image of custom metadata attribute and value">
</div>
<div class="title">Figure 164. Example metadata attribute and value in the BPMN modeler</div>
</div>
<div class="listingblock">
<div class="title">Example metadata attribute and value in the BPMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bpmn2:process id="approvals" name="approvals" isExecutable="true" processType="Public"&gt;
  &lt;bpmn2:extensionElements&gt;
    &lt;tns:metaData name="riskLevel"&gt;
      &lt;tns:metaValue&gt;&lt;![CDATA[low]]&gt;&lt;/tns:metaValue&gt;
    &lt;/tns:metaData&gt;
  &lt;/bpmn2:extensionElements&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example event listener with metadata value</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyListener implements ProcessEventListener {
    ...
    @Override
    public void beforeProcessStarted(ProcessStartedEvent event) {
        Map &lt; String, Object &gt; metadata = event.getProcessInstance().getProcess().getMetaData();
        if (metadata.containsKey("low")) {
            // Implement some action for that metadata attribute
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Begin adding components to your new or imported BPMN process model by clicking and dragging one of the BPMN nodes from the left palette:</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-drag-nodes.png" alt="bpmn drag nodes">
</div>
<div class="title">Figure 165. Adding BPMN components</div>
</div>
<div class="paragraph">
<p>Although the Kogito BPMN modeler displays many BPMN components in the canvas palette, the process engine (process runtime component) in Kogito currently supports only the following BPMN components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Start events</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Start</strong></p>
</li>
<li>
<p><strong>Start Signal</strong></p>
</li>
<li>
<p><strong>Start Timer</strong></p>
</li>
<li>
<p><strong>Start Message</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Intermediate events</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Intermediate Signal</strong> (catching and boundary)</p>
</li>
<li>
<p><strong>Intermediate Timer</strong> (catching and boundary)</p>
</li>
<li>
<p><strong>Intermediate Message</strong> (catching, boundary, and throwing)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>End events</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>End</strong></p>
</li>
<li>
<p><strong>End Error</strong></p>
</li>
<li>
<p><strong>End Terminate</strong></p>
</li>
<li>
<p><strong>End Message</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Tasks</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Business Rule</strong></p>
</li>
<li>
<p><strong>User</strong></p>
</li>
<li>
<p><strong>Service</strong></p>
</li>
<li>
<p><strong>Script</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Subprocesses</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Embedded</strong></p>
</li>
<li>
<p><strong>Reusable</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Gateways</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>Parallel</strong></p>
</li>
<li>
<p><strong>Event</strong></p>
</li>
<li>
<p><strong>Exclusive</strong></p>
</li>
<li>
<p><strong>Inclusive</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In the BPMN modeler canvas, for each new BPMN component that you add, select the new node, and in the upper-right corner of the BPMN modeler, click <strong>Properties</strong> to define the node identity and behavior.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For more information about BPMN component properties, see <a href="#ref-bpmn-support_kogito-developing-process-services">BPMN2 support in Kogito</a>.</p>
</div>
<div class="paragraph">
<p>For this example, use a business rule task based on a Decision Model and Notation (DMN) decision model as your first activity node.</p>
</div>
<div class="paragraph">
<p>This example assumes that you have the following assets in your Kogito project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Java object <code>org.acme.Person</code></p>
</li>
<li>
<p>A DMN model <code>PersonDecisions.dmn</code> with the namespace <code><a href="https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36" class="bare">https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36</a></code></p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>Business Rule</strong>, drag the task to the canvas, and link to it from a start event.</p>
</li>
<li>
<p>Select the business rule task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Name the rule task <code>Evaluate person</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Rule Language</strong>: <code>DMN</code></p>
</li>
<li>
<p><strong>Namespace</strong>: <code><a href="https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36" class="bare">https://kie.org/dmn/_F322E39A-1EF2-470E-BD8C-960352D1EA36</a></code></p>
</li>
<li>
<p><strong>Decision Name</strong>: <code>isAdult</code></p>
</li>
<li>
<p><strong>DMN Model Name</strong>: <code>PersonDecisions</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Data Assignments</strong>: Add the following assignments:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Data Input</strong>: Add a data input with the name <code>Person</code>, with the type <code>org.acme.Person</code>, and with the source <code>person</code>.</p>
</li>
<li>
<p><strong>Data Output</strong>: Add a data output with the name <code>isAdult</code>, with the type <code>Boolean</code>, and with the source <code>isAdult</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>Gateways</strong> &#8594; <strong>Exclusive</strong>, drag the gateway to the canvas, and link to it from the rule task.</p>
</li>
<li>
<p>In the left palette, select <strong>Activities</strong> &#8594; <strong>User</strong>, drag the user task to the canvas, and link to it from the exclusive gateway.</p>
</li>
<li>
<p>Select the user task and define the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><strong>General</strong>: Name the user task <code>Special handling for children</code>.</p>
</li>
<li>
<p><strong>Implementation/Execution</strong>: Set the task name to <code>ChildrenHandling</code>, and add a data input with the name <code>person</code>, the type <code>org.acme.Person</code>, and the source <code>person</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the left palette, select <strong>End Events</strong> &#8594; <strong>End</strong>, drag two end events to the canvas, and link to one end event from the user task and to the other end event from the exclusive gateway.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the end event and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition <code>return isAdult == true;</code>.</p>
</li>
<li>
<p>Select the connector that connects the exclusive gateway to the user task and for the <strong>Implementation/Execution</strong> property, set the <strong>Condition Expression</strong> to <code>Java</code> and enter the condition to <code>return isAdult == false;</code></p>
</li>
<li>
<p>Save the BPMN process file.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following is the BPMN model for applicant age evaluation in this example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/creating-running/kogito-bpmn-example-person.png" alt="Image of `persons.bpmn2` process diagram">
</div>
<div class="title">Figure 166. Example <code>persons.bpmn2</code> BPMN process</div>
</div>
<div class="paragraph">
<p>You can continue adding or modifying any remaining components and properties of your BPMN process or create a separate example.</p>
</div>
<div class="paragraph">
<p>The following are additional BPMN models that are used with the <code>persons.bpmn2</code> process as part of the same example application:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-model-example-orders.png" alt="Image of `orders.bpmn2` example process">
</div>
<div class="title">Figure 167. Example <code>orders.bpmn2</code> process</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-model-example-order-items.png" alt="Image of `orderItems.bpmn` example process">
</div>
<div class="title">Figure 168. Example <code>orderItems.bpmn2</code> process invoked as a subprocess</div>
</div>
<div class="paragraph">
<p>As an illustration of a more complex use case, the following is an example BPMN model from a separate mortgage loan application for determining loan approval:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-model-example-mortgage-application.png" alt="Image of mortgage application business process.">
</div>
<div class="title">Figure 169. Example business process for a mortgage loan application</div>
</div>
<div class="paragraph">
<p>For more Kogito examples and instructions for using them, see the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="con-bpmn-variables_kogito-developing-process-services"><a class="anchor" href="#con-bpmn-variables_kogito-developing-process-services"></a><a class="link" href="#con-bpmn-variables_kogito-developing-process-services">3.3. Variables in Kogito processes</a></h3>
<div class="paragraph _abstract">
<p>Variables in Kogito processes store data that is used during runtime. The Kogito BPMN modeler supports the following types of variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process variables</strong>: Variables that are visible within a specific process instance. Process variables are initialized at process creation and destroyed on process completion.</p>
</li>
<li>
<p><strong>Local variables</strong>: Variables that are visible within a specific process component, such as a task. Local variables are initialized when the element context is initialized (when the execution workflow enters the node and execution of the <code>onEntry</code> action has finished, if applicable). Local variables are destroyed when the element context is destroyed (when the execution workflow leaves the element).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A BPMN component, such as a process, subprocess, or task, can only access variables in its own context or in its parent context. A component cannot access a variable defined in a child component. When a BPMN component requires access to a variable during runtime, its own context is searched first.</p>
</div>
<div class="paragraph">
<p>If the variable cannot be found directly in the component context, the immediate parent context is searched. The search continues until the process context is reached.</p>
</div>
<div class="paragraph">
<p>If the variable cannot be found, a read access request returns <code>null</code>, a write access produces an error message, and the process continues its execution. Variables are searched for based on their unique ID.</p>
</div>
<div class="sect3">
<h4 id="_variable_tags_in_bpmn_process_files"><a class="anchor" href="#_variable_tags_in_bpmn_process_files"></a><a class="link" href="#_variable_tags_in_bpmn_process_files">3.3.1. Variable tags in BPMN process files</a></h4>
<div class="paragraph">
<p>For greater control over variable behavior, you can tag process variables and local variables in the  BPMN process file. Tags are simple string values that you add as metadata to a specific variable.</p>
</div>
<div class="paragraph">
<p>Kogito supports the following tags for process variables and local variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>internal</code>: Sets the variable as internal only for a process instance and hides the variable from the exposed REST model. For example, you can use this tag with intermediate variables that help hold some state during the execution of the process but are not part of the domain.</p>
</li>
<li>
<p><code>required</code>: Sets the variable as a requirement in order to start a process instance. If a process instance starts without the required variable, Kogito generates a <code>VariableViolationException</code> error.</p>
</li>
<li>
<p><code>readonly</code>: Indicates that the variable is for informational purposes only and can be set only once during process instance execution. If the value of a read-only variable is modified at any time, Kogito generates a <code>VariableViolationException</code> error.</p>
</li>
<li>
<p><code>input</code>: Sets the variable as an input of the process and therefore is not exposed in the returned data model. As a result, the value of an input variable is not returned in response to REST requests.</p>
</li>
<li>
<p><code>output</code>: Sets the variable as an output of the process and therefore is not expected for a process start and is included in the returned data model. As a result, the value of an output variable is returned in response to REST requests.</p>
</li>
<li>
<p><code>business-relevant</code>: Indicates that the variable is relevant for a particular item of business value. This tag is helpful for monitoring purposes or for implying that the variable is relevant to another application.</p>
</li>
<li>
<p><code>tracked</code>: Sets a variable to be tracked for changes so that Kogito generates events anytime the value of this variable is changed. Events are published to the <code>kogito-variables-events</code> topic in Kogito, where you can access the previous and new values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define a variable tag in the {KOGITO} BPMN modeler in VSCode, or you can add the tag directly in the BPMN process source file as a <code>customTags</code> metadata property with the tag value defined in the format <code>![CDATA[<em>TAG_NAME</em>]]</code>.</p>
</div>
<div class="paragraph">
<p>For example, the following BPMN process applies the <code>required</code> tag to an <code>approver</code> process variable:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-variable-tags-ui.png" alt="Image of variable tags in BPMN modeler">
</div>
<div class="title">Figure 170. Example variable tagged in the BPMN modeler</div>
</div>
<div class="listingblock">
<div class="title">Example variable tagged in a BPMN file</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bpmn2:property id="approver" itemSubjectRef="ItemDefinition_9" name="approver"&gt;
  &lt;bpmn2:extensionElements&gt;
    &lt;tns:metaData name="customTags"&gt;
      &lt;tns:metaValue&gt;&lt;![CDATA[required]]&gt;&lt;/tns:metaValue&gt;
    &lt;/tns:metaData&gt;
  &lt;/bpmn2:extensionElements&gt;
&lt;/bpmn2:property&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use multiple tags for a variable where applicable, but use caution and ensure that the tags are logical and do not conflict. For example, avoid tagging a variable as both <code>internal</code> and <code>required</code>.</p>
</div>
<div class="paragraph">
<p>By default, if a process variable has no tag assigned to it, Kogito assigns an <code>input</code> and an <code>output</code> tag to it.</p>
</div>
<div class="paragraph">
<p>You can also define custom variable tags in your BPMN files to make variable data available to Kogito process event listeners. Custom tags do not influence the Kogito runtime as the standard variable tags do and are for informational purposes only. You define custom variable tags in the same <code>customTags</code> metadata property format that you use for standard Kogito variable tags.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-bpmn-variables-process_kogito-developing-process-services"><a class="anchor" href="#proc-bpmn-variables-process_kogito-developing-process-services"></a><a class="link" href="#proc-bpmn-variables-process_kogito-developing-process-services">3.3.2. Defining process variables in Kogito processes</a></h4>
<div class="paragraph _abstract">
<p>Process variables are visible within a specific process instance. Process variables are initialized at process creation and destroyed on process completion. You can map process variables to local variables.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the relevant BPMN process file to view the process in the Kogito BPMN modeler.</p>
</li>
<li>
<p>Select the background of the BPMN modeler canvas and, in the upper-right corner of the modeler, click <strong>Properties</strong>.</p>
</li>
<li>
<p>Under <strong>Process Data</strong> &#8594; <strong>Process Variables</strong>, click the plus icon to add a new process variable and enter the following values:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter the name of the process variable, such as <code>order</code> for a process variable with order information shared by all applicable nodes in the process.</p>
</li>
<li>
<p><strong>Data Type</strong>: Enter a custom or standard data type of the variable, such as <code>org.acme.Order</code>.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-process-variables.png" alt="Image of process variable example">
</div>
<div class="title">Figure 171. Example process variables in BPMN modeler</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-bpmn-variables-local_kogito-developing-process-services"><a class="anchor" href="#proc-bpmn-variables-local_kogito-developing-process-services"></a><a class="link" href="#proc-bpmn-variables-local_kogito-developing-process-services">3.3.3. Defining local variables in Kogito processes</a></h4>
<div class="paragraph _abstract">
<p>Local variables are visible within a specific process component, typically a task. Local variables are initialized when the element context is initialized (when the execution workflow enters the node and execution of the <code>onEntry</code> action has finished, if applicable). Local variables are destroyed when the element context is destroyed (when the execution workflow leaves the element).</p>
</div>
<div class="paragraph">
<p>You can map local variables to global or process variables. This mapping enables you to maintain relative independence from the parent context that accommodates the local variable. This isolation helps prevent technical exceptions.</p>
</div>
<div class="paragraph">
<p>For tasks, with the exception of script tasks, you define local variables as data input or output assignments under <strong>Assignments</strong> in the task properties. Data input assignments define variables that enter the task and provide the entry data required for the task execution. Data output assignments refer to the context of the task after execution to acquire output data.</p>
</div>
<div class="paragraph">
<p>User tasks present data related to the actor who is completing the user task. User tasks also require the actor to provide result data related to the execution.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your VSCode IDE, open the relevant BPMN process file to view the process in the Kogito BPMN modeler.</p>
</li>
<li>
<p>Select the relevant task (non-script task) and, in the upper-right corner of the modeler, click <strong>Properties</strong>.</p>
</li>
<li>
<p>Under <strong>Assignments</strong>, click the edit icon to open the <strong>Data I/O</strong> window, and click <strong>Add</strong> to begin adding local variables as data input or output:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Enter the name of the data input or output, such as <code>person</code> for a local variable with person information as the input and <code>isAdult</code> for a local variable with adult status as the output.</p>
</li>
<li>
<p><strong>Data Type</strong>: Enter a custom or standard data type of the data input or output, such as <code>org.acme.Person</code>.</p>
</li>
<li>
<p><strong>Source</strong> or <strong>Target</strong>: Enter the source object for the data input or the target object for the data output, such as <code>person</code> for a Java class with person information.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-local-variables.png" alt="Image of local variable example">
</div>
<div class="title">Figure 172. Example local variables in BPMN modeler</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-persistence_kogito-developing-process-services"><a class="anchor" href="#con-persistence_kogito-developing-process-services"></a><a class="link" href="#con-persistence_kogito-developing-process-services">3.4. Persistence in Kogito services</a></h3>
<div class="paragraph _abstract">
<p>Kogito supports runtime persistence for preserving process data in your services, such as active process nodes and process instance variables, across application restarts.</p>
</div>
<div class="paragraph">
<p>For Kogito persistence, you can use one of the following supported persistence stores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://infinispan.org/"><strong>Infinispan</strong></a>: (Default) Persists data using configured key-value storage definitions</p>
</li>
<li>
<p><a href="https://www.mongodb.com/"><strong>MongoDB</strong></a>: Persists data using a document-based format</p>
</li>
<li>
<p><a href="https://kafka.apache.org/documentation/streams/"><strong>Kafka Streams</strong></a>: (Quarkus only) Persists data in Kafka clusters</p>
</li>
<li>
<p><strong>JDBC</strong>: Persists data to different relational databases such as <a href="https://www.postgresql.org/">PostgreSQL</a> and <a href="https://www.oracle.com/database/">Oracle</a> using JDBC driver.</p>
</li>
<li>
<p><strong>File system</strong>: Persists data to files in the file system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Runtime persistence is intended primarily for storing data that is required to resume workflow execution for a particular process instance. Persistence applies to both public and private processes that are not yet complete. Once a process completes, persistence is no longer applied. This persistence behavior means that only the information that is required to resume execution is persisted.</p>
</div>
<div class="paragraph">
<p>Node instances that are currently active or in wait states are persisted. When a process instance finishes execution but has not reached the end state (completed or aborted), the node instance data is persisted.</p>
</div>
<div class="paragraph">
<p>Persistence setup scripts for Kogito runtimes and Kogito runtimes supporting services are included in the <a href="https://repository.jboss.org/org/kie/kogito/kogito-ddl/10.0.0.0/">kogito-ddl-10.0.0.0-db-scripts.zip</a> artifact.</p>
</div>
<div class="sect3">
<h4 id="_persistence_workflow_in_kogito"><a class="anchor" href="#_persistence_workflow_in_kogito"></a><a class="link" href="#_persistence_workflow_in_kogito">3.4.1. Persistence workflow in Kogito</a></h4>
<div class="paragraph">
<p>In Kogito, a process instance is persisted when the process reaches a wait state, where the process does not execute anymore but has not reached the end state (completed or aborted).</p>
</div>
<div class="paragraph">
<p>For example, when a process reaches a user task or a catching signal event, the process instance pauses and the Kogito process engine takes a complete snapshot of the process, including the following data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Process instance metadata, such as process instance ID, process definition ID, state, description, and start date</p>
</li>
<li>
<p>Process instance variables</p>
</li>
<li>
<p>Active node instances, including local variables</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Process instance metadata is persisted with a predefined protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema that is aware of the metadata and supports node instances that are in wait states.</p>
</div>
<div class="paragraph">
<p>For straight-through process instances that do not trigger any activity, persistence is not invoked and no data is stored.</p>
</div>
<div class="paragraph">
<p>Each persistence provider stores data according to their underlying mechanism.
For instance, when using Infinispan, each process definition has its own cache for storing runtime information. The cache is based on the process definition ID and is named in the Infinispan Server.
MongoDB creates a separated document collection per process definition whereas JDBC provider will use a single table for all processes but include the process definition ID in order to isolate operations.
This setup facilitates maintenance of process instance data and reduces concurrency on the cache instances.</p>
</div>
</div>
<div class="sect3">
<h4 id="_persisted_process_instance_variables_and_data_types"><a class="anchor" href="#_persisted_process_instance_variables_and_data_types"></a><a class="link" href="#_persisted_process_instance_variables_and_data_types">3.4.2. Persisted process instance variables and data types</a></h4>
<div class="paragraph">
<p>Persisted process variables, local variables, and other process data are stored with the process instance. The stored data is marshalled into bytes format so it can be transferred and persisted into one of the supported persistence providers.
The marshalling and unmarshalling is implemented based on protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>).</p>
</div>
<div class="paragraph">
<p>Kogito will persist all process instance variables defined in the process model once the execution reaches a wait state.
Once the wait state is reached, marshalling will take place in order to transform all process variables into bytes, which can be accomplished using one of the following methods:</p>
</div>
<div class="sect4">
<h5 id="_persistence_using_protobuf_marshalling"><a class="anchor" href="#_persistence_using_protobuf_marshalling"></a><a class="link" href="#_persistence_using_protobuf_marshalling">3.4.2.1. Persistence using Protobuf marshalling</a></h5>
<div class="paragraph">
<p>Kogito generates both the protobuf schema (as PROTO files) and marshallers for persisting variables. The Kogito marshallers are based on the <a href="https://github.com/infinispan/protostream">ProtoStream</a> subproject of Infinispan.</p>
</div>
<div class="paragraph">
<p>When you build your Kogito project, Kogito scans all process definitions and extracts information about the data within the business assets. Based on the unique data types (regardless of how many processes reference a specified type), PROTO files are generated that build a complete schema for the application. These files are stored inside the <code>/META-INF/resources/persistence/protobuf/</code> folder of the generated JAR file (e.g. quarkus-apps/quarkus/generated-bytecode.jar) and also in the <code>target/classes/META-INF/resources/persistence/protobuf/</code> folder of your project after successful build.</p>
</div>
<div class="listingblock">
<div class="title">Example PROTO file generated by Kogito to persist process data</div>
<div class="content">
<pre class="highlight"><code>syntax = "proto2";
package org.kie.kogito.examples.demo.orders;
import "kogito-index.proto";
import "kogito-types.proto";
option kogito_model = "Orders";
option kogito_id = "demo.orders";

/* @Indexed */
message Order {
	option java_package = "org.kie.kogito.examples.demo.orders";
	/* @Field(store = Store.YES) @SortableField */
	optional string orderNumber = 1;
	/* @Field(store = Store.YES) @SortableField */
	optional bool shipped = 2;
	/* @Field(store = Store.YES) @SortableField */
	optional double total = 3;
}
/* @Indexed */
message Orders {
	option java_package = "org.kie.kogito.examples.demo.orders";
	/* @Field(store = Store.YES) @SortableField
 @VariableInfo(tags="") */
	optional string approver = 1;
	/* @Field(store = Store.YES) @SortableField */
	optional string id = 2;
	/* @Field(store = Store.YES) @SortableField
 @VariableInfo(tags="") */
	optional Order order = 3;
	/* @Field(store = Store.YES) @SortableField */
	optional org.kie.kogito.index.model.KogitoMetadata metadata = 4;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Each PROTO file imports <code>kogito-types.proto</code> and <code>kogito-index.proto</code> files that automatically define the base types managed by Kogito.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on the PROTO files, marshallers are also generated and configured in the application so that whenever a particular data type is used in a process instance, the data is successfully marshalled and unmarshalled.</p>
</div>
</div>
<div class="sect4">
<h5 id="_persistence_using_java_serialization"><a class="anchor" href="#_persistence_using_java_serialization"></a><a class="link" href="#_persistence_using_java_serialization">3.4.2.2. Persistence using Java serialization</a></h5>
<div class="paragraph">
<p>To enable Java serialization, you should make sure all data types can be serialized. This means that classes should implement <code>java.io.Serializable</code> as well as have an empty constructor. It is also necessary to set <code>kogito.persistence.proto.marshaller=false</code> in your application.properties file.</p>
</div>
<div class="paragraph">
<p>In case you would like to use Quarkus native compilation, it is also necessary to follow the instructions so your data types can be serialized in native mode.
For more details, visit (<a href="https://quarkus.io/guides/writing-native-applications-tips#registering-for-reflection">Quarkus registering for reflection</a>)</p>
</div>
<div class="paragraph">
<p>The following annotation is usually required for Quarkus native mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.quarkus.runtime.annotations.RegisterForReflection;

@RegisterForReflection(serialization = true)
public class MyPojo implements Serializable {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_supported_data_types_for_persisted_variables"><a class="anchor" href="#_supported_data_types_for_persisted_variables"></a><a class="link" href="#_supported_data_types_for_persisted_variables">3.4.3. Supported data types for persisted variables</a></h4>
<div class="paragraph">
<p>For optimal persistence with process data and variables, use Java objects as data types that represent your process variables. If you use other formats for data types, your data might not be persisted or your Kogito project might fail to compile.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following data types for process variables:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 116. Supported data types</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic text type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended size number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic floating point number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended size floating point number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic date type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic boolean type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.Serializable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom data types and other Java types such as Collections and Enums</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="proc-jdbc-persistence-enabling_kogito-developing-process-services"><a class="anchor" href="#proc-jdbc-persistence-enabling_kogito-developing-process-services"></a><a class="link" href="#proc-jdbc-persistence-enabling_kogito-developing-process-services">3.4.4. Enabling JDBC persistence for Kogito services</a></h4>
<div class="paragraph _abstract">
<p>As an alternative to using Infinispan or MongoDB for Kogito runtime persistence, you can enable persistence for your Kogito services using JDBC.
JDBC allows Kogito to persist data using different relational databases. We recommend using <a href="https://www.postgresql.org/">PostgreSQL</a>.
The complete list of supported databases is dependent on the target runtime you use, for instance, Quarkus supports the following <a href="https://quarkus.io/guides/datasource#jdbc-datasource">JDBC datasources</a>.</p>
</div>
<div class="paragraph">
<p>Kogito provides two ways to manage the database schema, either via manually applying the provided DDL <a href="https://repository.jboss.org/org/kie/kogito/kogito-ddl/10.0.0.0/">kogito-ddl-10.0.0.0-db-scripts.zip</a>, or via <a href="https://flywaydb.org/">Flyway</a> integration. The service does not create a schema by default.</p>
</div>
<div class="paragraph">
<p>Please check examples below on how to enable different databases using JDBC data sources.</p>
</div>
<div class="sect4">
<h5 id="_enabling_postgresql_persistence_using_jdbc_driver_for_kogito_services"><a class="anchor" href="#_enabling_postgresql_persistence_using_jdbc_driver_for_kogito_services"></a><a class="link" href="#_enabling_postgresql_persistence_using_jdbc_driver_for_kogito_services">3.4.4.1. Enabling PostgreSQL persistence using JDBC driver for Kogito services</a></h5>
<div class="paragraph">
<p>You can enable PostgreSQL persistence for your Kogito services using JDBC driver.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.postgresql.org/">PostgreSQL</a> is installed. For information about PostgreSQL installation and configuration, see <a href="https://www.postgresql.org/docs/current/">PostgreSQL documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-jdbc-postgresql&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-agroal&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.postgresql&lt;/groupId&gt;
  &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure PostgreSQL and to connect to the PostgreSQL server.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Replace the server host, port, and database information according to your PostgreSQL Server installation. By default, the database is named <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
quarkus.datasource.username=kogito-user
quarkus.datasource.password=kogito-pass
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/kogito
# Below properties are required to create database schema with Flyway at startup.
quarkus.flyway.migrate-at-start=true
quarkus.datasource.db-kind=postgresql</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
spring.datasource.username=kogito-user
spring.datasource.password=kogito-pass
spring.datasource.url=jdbc:postgresql://localhost:5432/kogito
# Below properties are required to create database schema with Flyway at startup.
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/{vendor}</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For an example Kogito service with PostgreSQL persistence using JDBC driver, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-postgresql-persistence-quarkus"><code>process-postgresql-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-postgresql-persistence-springboot"><code>process-postgresql-persistence-springboot</code></a>: Example on SpringBoot</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_enabling_oracle_persistence_using_jdbc_driver_for_kogito_services"><a class="anchor" href="#_enabling_oracle_persistence_using_jdbc_driver_for_kogito_services"></a><a class="link" href="#_enabling_oracle_persistence_using_jdbc_driver_for_kogito_services">3.4.4.2. Enabling Oracle persistence using JDBC driver for Kogito services</a></h5>
<div class="paragraph">
<p>You can enable Oracle persistence for your Kogito services using JDBC driver.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.oracle.com/database/">Oracle Database</a> is installed and running.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-jdbc-oracle&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-agroal&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.oracle.database.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;ojdbc8&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure and to connect to the Oracle database.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Replace the server host, port, and database information according to your Oracle Server installation. By default, the database is named as <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
quarkus.datasource.username=kogito
quarkus.datasource.password=kogito
quarkus.datasource.jdbc.url=jdbc:oracle://oracle:1521/kogito
# Below properties are required to create database schema with Flyway at startup.
quarkus.flyway.migrate-at-start=true
quarkus.datasource.db-kind=oracle</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
spring.datasource.username=kogito
spring.datasource.password=kogito
spring.datasource.url=jdbc:oracle://oracle:1521/kogito
# Below properties are required to create database schema with Flyway at startup.
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/{vendor}</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-infinispan-persistence-enabling_kogito-developing-process-services"><a class="anchor" href="#proc-infinispan-persistence-enabling_kogito-developing-process-services"></a><a class="link" href="#proc-infinispan-persistence-enabling_kogito-developing-process-services">3.4.5. Enabling Infinispan persistence for Kogito services</a></h4>
<div class="paragraph _abstract">
<p>You can enable persistence for your Kogito services using <a href="https://infinispan.org/">Infinispan</a> to persist data, such as active process nodes and process instance variables, so that the data is preserved across application restarts. For Kogito persistence with Infinispan, you must have a an Infinispan Server installed and running in order to enable persistence.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://infinispan.org/">Infinispan Server</a> 13.0.2 or later is installed and running. For information about Infinispan installation and configuration, see the <a href="https://infinispan.org/documentation/">Infinispan documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-infinispan&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-infinispan&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.infinispan&lt;/groupId&gt;
  &lt;artifactId&gt;infinispan-spring-boot-starter-remote&lt;/artifactId&gt;
  &lt;version&gt;<em>INFINISPAN_SPRING_BOOT_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add following property to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the connection to the Infinispan Server.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Replace the server host and port information according to your Infinispan Server installation.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>quarkus.infinispan-client.server-list=localhost:11222</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>infinispan.remote.server-list=127.0.0.1:11222</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example Kogito services with Infinispan persistence, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-infinispan-persistence-quarkus"><code>process-infinispan-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-infinispan-persistence-springboot"><code>process-infinispan-persistence-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-mongodb-persistence-enabling_kogito-developing-process-services"><a class="anchor" href="#proc-mongodb-persistence-enabling_kogito-developing-process-services"></a><a class="link" href="#proc-mongodb-persistence-enabling_kogito-developing-process-services">3.4.6. Enabling MongoDB persistence for Kogito services</a></h4>
<div class="paragraph _abstract">
<p>As an alternative to using Infinispan for Kogito runtime persistence, you can enable persistence for your Kogito services using <a href="https://www.mongodb.com/">MongoDB</a>. MongoDB is a general purpose, document-based database that enables you to store data in JSON-like documents instead of key-value storage definitions in Infinispan-based persistence storage. For Kogito persistence with MongoDB, you must have a MongoDB Server installed and running in order to enable persistence.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.mongodb.com/try/download">MongoDB Server</a> 4.4 or later is installed and running. For information about MongoDB installation and configuration, see the <a href="https://docs.mongodb.com/manual/installation/">MongoDB documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>MONGODB_SPRING_BOOT_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure MongoDB persistence and to connect to the relevant MongoDB Server and database.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Replace the server host, port, and database information according to your MongoDB Server installation. By default, the database is named <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=mongodb
quarkus.mongodb.connection-string = mongodb://localhost:27017
quarkus.mongodb.database=kogito_db</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=mongodb
spring.data.mongodb.uri=mongodb://localhost:27017
spring.data.mongodb.database=kogito_db</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally, enable MongoDB transactions by adding the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kogito.persistence.transaction.enabled=true</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example Kogito services with MongoDB persistence, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-mongodb-persistence-quarkus"><code>process-mongodb-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-mongodb-persistence-springboot"><code>process-mongodb-persistence-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-kafka-streams-persistence-enabling_kogito-developing-process-services"><a class="anchor" href="#proc-kafka-streams-persistence-enabling_kogito-developing-process-services"></a><a class="link" href="#proc-kafka-streams-persistence-enabling_kogito-developing-process-services">3.4.7. Enabling Kafka Streams persistence for Kogito services</a></h4>
<div class="paragraph _abstract">
<p>For Quarkus-based Kogito services, as an alternative to using Infinispan or MongoDB for Kogito runtime persistence, you can enable persistence using <a href="https://kafka.apache.org/documentation/streams/">Kafka Streams</a>. Kafka Streams is a client library for building applications and microservices, where the input and output data are stored in Kafka topics.
For Kogito persistence with Kafka Streams, you must have Kafka installed and running in order to enable persistence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Kafka Streams persistence is supported for only Quarkus-based Kogito services.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed and includes any required topics. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependency to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Project dependency to enable Kafka Streams persistence (Quarkus only)</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-kafka&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure Kafka persistence and to connect to the relevant Kafka server.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Replace the server host and port information according to your Kafka installation.</p>
</div>
<div class="listingblock">
<div class="title">Application properties to enable Kafka Streams persistence (Quarkus only)</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=kafka
kafka.bootstrap.servers=localhost:9092</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For an example Kogito service with Kafka persistence, see the following example application in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-kafka-persistence-quarkus"><code>process-kafka-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-locking-persistence-enabling_kogito-developing-process-services"><a class="anchor" href="#proc-locking-persistence-enabling_kogito-developing-process-services"></a><a class="link" href="#proc-locking-persistence-enabling_kogito-developing-process-services">3.4.8. Enabling optimistic locking with persistence</a></h4>
<div class="paragraph">
<p>Kogito runtimes need to safely handle concurrent requests to shared instances such as process instances or tasks. Kogito handles these requests using persistence enabled optimistic locking for concurrency control with the version on record (using the version field in the database or the metadata version in the case of Infinispan). This feature is optional and can be activated only with persistence by adding the following properties to the src/main/resources/application.properties file in your Kogito project,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kogito.persistence.optimistic.lock=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below are the persistence providers that support optimistic locking</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Infinispan</p>
</li>
<li>
<p>MongoDB</p>
</li>
<li>
<p>JDBC</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-messaging-enabling_kogito-developing-process-services"><a class="anchor" href="#proc-messaging-enabling_kogito-developing-process-services"></a><a class="link" href="#proc-messaging-enabling_kogito-developing-process-services">3.5. Enabling Kafka messaging for Kogito services</a></h3>
<div class="paragraph _abstract">
<p>Kogito supports the <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> specification for messaging in your services. You can enable messaging to configure message events as either input or output of business process execution.</p>
</div>
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-example.png" alt="Image of message-based process">
</div>
<div class="title">Figure 173. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>In this example, the message start and end events require the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Message name that maps to the channel that delivers messages</p>
</li>
<li>
<p>Message payload that maps to a process instance variable</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-start-event.png" alt="Image of message start event data">
</div>
<div class="title">Figure 174. Example message configuration for start event</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-end-event.png" alt="Image of message end event data">
</div>
<div class="title">Figure 175. Example message configuration for end event</div>
</div>
<div class="paragraph">
<p>For this procedure, the messaging is based on <a href="https://kafka.apache.org/">Apache Kafka</a> as the event publisher, so you must have Kafka installed in order to enable messaging. Your marshalling configuration depends on the messaging solution that you use.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed and includes any required topics. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kogito-addons-quarkus-events-process&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
  &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-events-process-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
  &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Configure the incoming and outgoing messaging channels and properties:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><strong>On Quarkus</strong>: Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the incoming and outgoing messages and channels:</p>
<div class="listingblock">
<div class="title">Configure incoming and outgoing messages and channels</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka
mp.messaging.incoming.kogito_incoming_stream.topic=travellers
mp.messaging.incoming.kogito_incoming_stream.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-kafka
mp.messaging.outgoing.kogito_outgoing_stream.topic=processedtravellers
mp.messaging.outgoing.kogito_outgoing_stream.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace <code>travellers</code> with the name of the message start event.
Replace <code>processedtravellers</code> with the name of the message end event.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To prevent execution errors due to long wait times with messaging, you can also use the following property to disable waiting for message completion:</p>
</div>
<div class="listingblock">
<div class="title">Disable message wait time</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.[channel-name].waitForWriteCompletion=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>On Spring Boot</strong>: Add the following property to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the messaging channel:</p>
<div class="listingblock">
<div class="title">Configure messaging channel</div>
<div class="content">
<pre class="highlight"><code>kafka.bootstrapAddress=localhost:9092
kogito.addon.cloudevents.kafka.kogito_incoming_stream=travellers
kogito.addon.cloudevents.kafka.kogito_outgoing_stream=processedtravellers</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example Kogito services with Kafka messaging, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-kafka-quickstart-quarkus"><code>process-kafka-quickstart-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-kafka-quickstart-springboot"><code>process-kafka-quickstart-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="con-knative-eventing_kogito-developing-process-services"><a class="anchor" href="#con-knative-eventing_kogito-developing-process-services"></a><a class="link" href="#con-knative-eventing_kogito-developing-process-services">3.6. Knative Eventing in Kogito services</a></h3>
<div class="paragraph _abstract">
<p><a href="https://knative.dev/docs/eventing/">Knative Eventing</a> is a serverless platform that enables you to create event producers and consumers for your applications. Knative Eventing uses standard HTTP POST requests to send and receive events between event producers and consumers. These events conform to the <a href="https://github.com/cloudevents/spec">CloudEvents specification</a>, which enables creating, parsing, sending, and receiving events in any programming language.</p>
</div>
<div class="paragraph">
<p>Kogito provides the <a href="https://github.com/apache/incubator-kie-kogito-runtimes/tree/main/addons/common/knative/eventing">Knative Eventing add-on</a> that enables you to use Knative Eventing with Kogito services that consume or publish messages within a Business Process Model and Notation (BPMN) process model, Serverless Workflow, or decisions. Kogito runtime events for messages, processes, tasks, and other application activities are published in <a href="https://cloudevents.io/">CloudEvents</a> format so that they can be consumed efficiently by other entities, such as the Knative Eventing system.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Knative Eventing is currently supported for Kogito services on Quarkus only.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-example.png" alt="Image of BPMN process receiving and publishing messages">
</div>
<div class="title">Figure 176. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>When the Knative Eventing add-on is enabled in the Kogito project that contains this example process, an event consumer is generated from the message start node and an event producer is generated from the message end node at build time.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates a scenario with Knative Eventing and a Kogito service that contains event consumers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-knative-impl-listening-event.png" alt="Kogito service listening to events">
</div>
<div class="title">Figure 177. Knative Eventing and a Kogito service with event consumers</div>
</div>
<div class="paragraph">
<p>In this scenario, three Knative Eventing <a href="https://knative.dev/docs/eventing/triggers/">Triggers</a> are generated to filter the messages that are received by the Kogito service. These messages are sent to the default Kogito service port. A message-routing mechanism in the generated code redirects the message to an inner channel based on the name of the message start event in the BPMN process model. The names of message start and end events serve as unique CloudEvents <a href="https://github.com/cloudevents/spec/blob/v1.0/spec.md#type"><code>type</code> attribute</a> definitions in Knative Eventing.</p>
</div>
<div class="paragraph">
<p>In the example <code>handle-travlers.bpmn2</code> process, the message start node is named <code>travelers</code>, so a message with a <code>type</code> named <code>travelers</code> triggers the message start node, as shown in the following example curl request:</p>
</div>
<div class="listingblock">
<div class="title">Example request to trigger the <code>travelers</code> message start event</div>
<div class="content">
<pre class="highlight"><code>$ curl -X POST \
      -H "content-type: application/json"  \
      -H "ce-specversion: 1.0"  \
      -H "ce-source: /from/localhost"  \
      -H "ce-type: travelers"  \
      -H "ce-id: 12346"  \
      -d '{"firstName": "Jane", "lastName": "Doe", "email": "jane.doe@example.com", "nationality": "German"}' \
  http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following diagram illustrates a scenario with Knative Eventing and a Kogito service that contains event producers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-knative-impl-producing-event.png" alt="Kogito service producing events">
</div>
<div class="title">Figure 178. Knative Eventing and a Kogito service with event producers</div>
</div>
<div class="paragraph">
<p>In this scenario, the Kogito service sends HTTP POST messages to the Knative Eventing <a href="https://knative.dev/docs/eventing/broker/">Broker</a> through the <code>SinkBinding</code> resource. The <code>SinkBinding</code> endpoint is generated by the Knative Eventing platform and is injected in the Kogito service container as an environment variable named <code>${K_SINK}</code>. Alternatively, you can use the Knative <code>KogitoSource</code>. For more information about the Knative Eventing component, see the <a href="https://github.com/knative-sandbox/eventing-kogito">project website</a>.</p>
</div>
<div class="paragraph">
<p>The following example message is generated by the Kogito service:</p>
</div>
<div class="listingblock">
<div class="title">Example message generated by the Kogito service</div>
<div class="content">
<pre class="highlight"><code>Context Attributes,
  specversion: 1.0
  type: process/travelers/processedtravellers
  source: /process/Travelers/2f692fd9-fff8-4b0a-bb64-96d1a4772490
  id: 29e43b17-3a70-4b46-aca0-7ab8e2133eee
  time: 2020-08-10T20:52:39.383346Z
Extensions,
  knativearrivaltime: 2020-08-10T20:52:39.391404032Z
  knativehistory: default-kne-trigger-kn-channel.kogito.svc.cluster.local
  kogitoprocid: Travelers
  kogitoprocinstanceid: 2f692fd9-fff8-4b0a-bb64-96d1a4772490
  kogitoprocist: 1
Data,
  {"firstName":"Jan","lastName":"Kowalski","email":"jan.kowalski@example.com","nationality":"German","processed":true}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the CloudEvents <code>type</code> attribute uses the format <code>process/<em>PROCESS_ID</em>/<em>NODE_NAME</em></code>. This format prevents the messages generated by the Kogito service from conflicting with other messages being generated within the cluster, and enables the Knative <code>Triggers</code> objects to filter these messages by a unique <code>type</code>. The generated CloudEvents message also contains information about the process instance, such as the process ID, process instance ID, and process instance state.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates the overall architecture of a Kogito service deployed in a Knative Eventing environment on a Kubernetes or OpenShift cluster:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-knative-deployment-architecture.png" alt="Kogito service deployed on Knative Eventing environment">
</div>
<div class="title">Figure 179. Kogito service deployed in Knative Eventing environment on Kubernetes or OpenShift</div>
</div>
<div class="sect3">
<h4 id="proc-knative-eventing-process-services_kogito-developing-process-services"><a class="anchor" href="#proc-knative-eventing-process-services_kogito-developing-process-services"></a><a class="link" href="#proc-knative-eventing-process-services_kogito-developing-process-services">3.6.1. Enabling Knative Eventing for Kogito services</a></h4>
<div class="paragraph _abstract">
<p>You can enable <a href="https://knative.dev/docs/eventing/">Knative Eventing</a> support for Kogito services that consume or publish messages within a Business Process Model and Notation (BPMN) process model or Serverless Workflow. When you enable Knative Eventing for a Kogito project, event consumers and producers are generated from message start and end nodes in BPMN processes at build time. You can use these event consumers and producers as part of your Kogito service deployment in a Knative Eventing environment on Kubernetes or OpenShift clusters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Knative Eventing is currently supported for Kogito services on Quarkus only.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have installed and deployed Knative Eventing 0.20.0 or later on a Kubernetes or an OpenShift cluster. For information about Knative Eventing on OpenShift, see <a href="https://docs.openshift.com/container-platform/4.5/serverless/installing_serverless/installing-knative-eventing.html">Installing Knative Eventing</a> in the OpenShift documentation.</p>
</li>
<li>
<p>You have created a BPMN model in your Kogito project with message start or end events that you want to integrate with Knative Eventing. For information about creating BPMN models, see <a href="#proc-bpmn-model-creating_kogito-developing-process-services">Creating and editing BPMN models in the Kogito BPMN modeler</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Knative Eventing dependencies</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;!-- Enables Knative integration with Kogito --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.kie&lt;/groupId&gt;
      &lt;artifactId&gt;kie-addons-quarkus-knative-eventing&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!-- Enables Kubernetes and Knative resources generation for Kogito --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-kubernetes&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This dependency enable Knative Eventing add-on and messaging requirements. When a Kogito service has the Knative Eventing add-on enabled, Kogito generates code based on <a href="http://www.smallrye.io/smallrye-reactive-messaging/">Smallrye Reactive Messaging</a> to publish messages.</p>
</div>
<div class="paragraph">
<p>Optionally, you can add the <a href="https://quarkus.io/guides/deploying-to-kubernetes">Quarkus Kubernetes</a> dependency as exemplified. In this case, the add-on also generates Knative and Kubernetes resources to deploy the Kogito Service on any cluster. The exemplification assumes that you are using the <code>quarkus-kubernetes</code> extension.</p>
</div>
</div>
</div>
</li>
<li>
<p>In your Kogito project, open the BPMN file that you want to use for consuming or producing messages in the Knative Eventing environment. BPMN files are typically in <code>src/main/resources</code>.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-example.png" alt="Image of BPMN process receiving and publishing messages">
</div>
<div class="title">Figure 180. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>The names of message start and end events serve as CloudEvents <a href="https://github.com/cloudevents/spec/blob/v1.0/spec.md#type"><code>type</code> attribute</a> definitions in Knative Eventing and must be unique.</p>
</div>
</div>
</div>
</li>
<li>
<p>For each message event in the BPMN process model, select the node, click <strong>Properties</strong> in the upper-right corner of the modeler, and verify that the node name is clear and unique.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example, consider adding the project or process name as a prefix to the message node name, such as <code>travelagency.travelers</code> in the following example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-knative-set-node-name.png" alt="Image of a message node property name">
</div>
<div class="title">Figure 181. Set a unique message node name</div>
</div>
</div>
</div>
</li>
<li>
<p>The Knative Eventing Add-on automatically configures your Kogito service by default with the following properties:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Required application properties for publishing</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito_outgoing_stream.connector=quarkus-http
mp.messaging.outgoing.kogito_outgoing_stream.url=${K_SINK}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can override these properties anytime by adding them to <code>src/main/resources/application.properties</code> file in your project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>quarkus-http</code> property defines the HTTP endpoint for the published messages. The <code>${K_SINK}</code> property is an environment variable injected by Knative Eventing when you deploy a Kogito service that references a Knative Eventing <a href="https://knative.dev/docs/eventing/samples/sinkbinding/"><code>SinkBinding</code></a> or <a href="https://github.com/knative-sandbox/eventing-kogito#kogito-source"><code>KogitoSource</code></a> object.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you run the environment variable <code>K_SINK</code> locally for test purposes, ensure that <code>K_SINK</code> is available in your environment. You can change the property to a constant value as follows:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito_outgoing_stream.url=${K_SINK:http://localhost:8080/}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Build your Kogito project locally using your usual method, such as <code>mvn clean package</code>, and navigate to the <code>target/generated-sources/kogito</code> directory in your project and verify the following contents:</p>
<div class="ulist">
<ul>
<li>
<p>Generated classes with the suffixes <code>MessageConsumer</code> and <code>MessageProducer</code>. These classes are generated based on the message start and end events in your BPMN model.</p>
</li>
<li>
<p>Generated <code>app</code> folder containing a <code>CloudEventListenerResource.java</code> file. This file detects any CloudEvents messages produced by the Knative Eventing source that targets your Kogito service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any of these items are missing, ensure that you have configured all required dependencies, applications properties, and message event name. After all checks are complete, rebuild the project.</p>
</div>
</li>
<li>
<p>After you configure and test your Kogito project locally, in your Kubernetes or OpenShift environment, add the following custom resources to deploy your Kogito project. These resources are generated automatically by the Kogito Knative Eventing add-on and can be found in <code>target/kubernetes/kogito.yml</code> and <code>target/kubernetes/kubernetes.yml</code> files. These resources are required for consuming or producing events in a Knative Eventing environment.</p>
<div class="paragraph">
<p>If you plan to run the application locally, please take a look at the example <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/process-knative-quickstart-quarkus">"Process Knative Quickstart Quarkus"</a>. You will understand how to configure the enviroment in your local machine using <a href="https://knative.dev/docs/eventing/samples/container-source/#create-a-knative-service">Knative Event Display</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>Broker</code>: When you deploy a Kogito service that uses the Knative Eventing add-on, you can also deploy a Knative Eventing <a href="https://knative.dev/docs/eventing/broker/">Broker</a> in the same namespace. The Kogito service uses this Broker to publish or listen to CloudEvents messages. You can use any Broker channel for the Kogito service, such as InMemoryChannel, KafkaChannel, or NatssChannel.</p>
<div class="paragraph">
<p>By default, the InMemoryChannel channel is used when no channel is specified, as shown in the following <code>Broker</code> custom resource example:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>Broker</code> custom resource for Knative Eventing with default InMemoryChannel</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Broker
metadata:
  name: default</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
InMemoryChannel channels are for development use only. Do not use this channel in a production deployment.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about available Broker channels and how to install them, see <a href="https://knative.dev/docs/eventing/channels/channels-crds/">Available Channels</a> in the Knative documentation.</p>
</div>
</li>
<li>
<p>Knative <code>Trigger</code>: To make our service aware of the events of type <code>travellers</code> that are arriving in the <code>Broker</code>:</p>
<div class="listingblock">
<div class="title">Example Knative <code>Trigger</code> custom resource for a Kogito service with <code>Broker</code> binding</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: travellers-trigger-process-knative-quickstart-quarkus
spec:
  broker: default
  filter:
    attributes:
      type: travellers
  subscriber:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: process-knative-quickstart-quarkus</code></pre>
</div>
</div>
</li>
<li>
<p>Knative <code>SinkBinding</code>: The <code>SinkBinding</code> resource is used to sink the generated events of a Kogito service to the Knative Broker. Alternatively, you can set the property <code>org.kie.kogito.addons.knative.eventing.generate-kogito-source</code> as <code>true</code>. Using this approach, the add-on generates a Knative <code>KogitoSource</code> as shown in the following example:</p>
<div class="listingblock">
<div class="title">Example <code>KogitoSource</code> custom resource for a Kogito service with the default <code>Broker</code></div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: kogito.knative.dev/v1alpha1
kind: KogitoSource
metadata:
  name: process-knative-quickstart-quarkus
spec:
  sink:
    ref:
      apiVersion: eventing.knative.dev/v1
      kind: Broker
      name: default
      namespace: ""
  subject:
    apiVersion: serving.knative.dev/v1
    kind: Service
    name: process-knative-quickstart-quarkus</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you apply the auto-generated resources to the Kubernetes or OpenShift namespace, the events in the BPMN or Serverless Workflow files (if any) are dispatched to the default Broker.</p>
</div>
<div class="paragraph">
<p>The Knative Eventing <code>Trigger</code> resource filters all messages that are delivered to the default Broker and sends the messages to the Kogito service.</p>
</div>
<div class="paragraph">
<p>This Knative Eventing <code>SinkBinding</code> resource injects the <code>${K_SINK}</code> environment variable to the <code>Deployment</code> or Knative <code>Service</code> resource created by the add-on. Each message that is generated by the Kogito service is redirected to the default Knative Broker.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you do not want to use the auto-generated resources, you must create <code>Trigger</code> and <code>SinkBinding</code> resources manually.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If any other components need to consume the messages produced by the Kogito service, you must create an additional Knative Eventing <code>Trigger</code> resource as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Knative Eventing resource for other consuming components</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: event-display-trigger
spec:
  # The default Broker is enabled in the namespace.
  broker: default
  filter:
    # Listens only to events of type `success` emitted by the CloudEvents-processing service.
    attributes:
      # The same type being generated by the custom service.
      type: /process/travelers/processedtravellers
      # The subscriber is the deployed displayer service. Any event that matches the filter in the Broker is sent here.
  subscriber:
    ref:
      apiVersion: serving.knative.dev/v1
      kind: Service
      name: event-display</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>spec.filter.attributes.type</code> value defined in the <code>Trigger</code> resource is the same as the value generated by the Kogito service.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For an example Kogito service with Knative Eventing enabled, see the <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/process-knative-quickstart-quarkus"><code>process-knative-quickstart-quarkus</code></a> example application.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#ref-kogito-add-ons_kogito-creating-running"><em>Creating and running your first Kogito services</em></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-task-lifecycle_kogito-developing-process-services"><a class="anchor" href="#con-task-lifecycle_kogito-developing-process-services"></a><a class="link" href="#con-task-lifecycle_kogito-developing-process-services">3.7. Task lifecycle in Kogito processes</a></h3>
<div class="paragraph _abstract">
<p>In Kogito business processes, tasks are implemented as work items and their execution is defined by work item handlers. User tasks in particular are a core construct in Kogito processes. When a user task is reached in a process, the task progresses through phases of a defined lifecycle until it reaches an end state.</p>
</div>
<div class="paragraph">
<p>Kogito supports the following default phases in a work item (task) lifecycle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Active</strong>: Indicates initial state when the work item is activated</p>
</li>
<li>
<p><strong>Abort</strong>: Indicates abnormal completion of the work item</p>
</li>
<li>
<p><strong>Complete</strong>: Indicates normal completion of the work item</p>
</li>
<li>
<p><strong>Claim</strong>: Assigns the work item to a specific actor, restricting access to anyone else</p>
</li>
<li>
<p><strong>Release</strong>: Unassigns the work item from a specific actor, releasing it to any other potential user or group to work on it (by claiming or completing)</p>
</li>
<li>
<p><strong>Skip</strong>: Skips the work item</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With Kogito, you can also add custom lifecycles and lifecycle phases to meet your business needs.</p>
</div>
<div class="paragraph">
<p>A lifecycle moves a work item across various phases that are not defined by the <code>WorkItem</code> interface and defines the behavior of a work item at runtime. You typically add a lifecycle on top of the <code>WorkItemHandler</code> interface so that the lifecycle is pluggable with more flexible runtime characteristics.</p>
</div>
<div class="paragraph">
<p>The <code>WorkItemHandler</code> interface provides the option to move between task phases, as shown in the following method example:</p>
</div>
<div class="listingblock">
<div class="title">WorkItemHandler support for moving between task phases</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public void transitionToPhase(WorkItem workItem, WorkItemManager manager, Transition&lt;?&gt; transition)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This method is a default method that does nothing when not implemented. This functionality maintains backward compatibility with existing work item handler implementations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You typically implement the <code>transitionToPhase</code> method as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example implementation of transitionToPhase method</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Override
public void transitionToPhase(WorkItem workItem, WorkItemManager manager, Transition&lt;?&gt; transition) {

    lifeCycle.transitionTo(workItem, manager, (Transition&lt;Map&lt;String, Object&gt;&gt;) transition);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>lifeCycle</code> element is an implementation of <code>org.kie.Kogito.process.workitem.LifeCycle&lt;T&gt;</code> that defines the execution semantics.</p>
</div>
<div class="sect3">
<h4 id="_user_task_authorization"><a class="anchor" href="#_user_task_authorization"></a><a class="link" href="#_user_task_authorization">3.7.1. User task authorization</a></h4>
<div class="paragraph">
<p>The <code>org.jbpm.process.instance.impl.humantask.BaseHumanTaskLifeCycle</code> implementation in Kogito ensures that a user task is worked on by authorized users, based on the user or group assignments that you provide.</p>
</div>
<div class="paragraph">
<p>You can use the following parameters to provide assignments for authorized users or groups in the relevant BPMN process model. All of the listed parameters support expressions.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 117. Parameters for authorized users or groups</caption>
<colgroup>
<col style="width: 35%;">
<col style="width: 35%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ActorId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of authorized users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>John,Mary,#{actor}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GroupId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of authorized groups of users</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mangers,#{mygroup}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BusinessAdministratorId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of authorized administrators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>administrator,#{adminuser}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BusinessAdministratorGroupId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of groups of administrators</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admins,#{admingroup}</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ExcludedOwnerId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-separated list of unauthorized users who cannot work on this task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>paul,#{lastactor}</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Authorization is only enforced when the method that calls the work item lifecycle methods uses a security context. This security behavior is dependent on the API that you use.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_rest_endpoints_for_tasks_in_kogito"><a class="anchor" href="#_rest_endpoints_for_tasks_in_kogito"></a><a class="link" href="#_rest_endpoints_for_tasks_in_kogito">3.7.2. REST endpoints for tasks in Kogito</a></h4>
<div class="paragraph">
<p>When a process execution reaches the associated user task node, the user task enters the <code>Active</code> phase and the execution is paused. In the user task active phase, related input properties are passed to the task. After the user task is completed, the generated results are mapped with the process properties and then the process execution resumes.</p>
</div>
<div class="paragraph">
<p>When a user task is in the <code>Active</code> phase, you can change the task phase, update task results, and manage comments and attachments of a task using the following REST endpoints.</p>
</div>
<div class="paragraph">
<p>For each endpoint, use a REST client, curl utility, or Swagger UI (if configured for the application) to send requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base URL</strong>: <code>http://<em>HOST</em>:<em>PORT</em>/{processId}/{processInstanceId}/{taskName}/{taskInstanceId}</code></p>
</li>
<li>
<p><strong>Path parameters</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>{processId}</code>: The string identifier of the process definition, such as <code>approval</code></p>
</li>
<li>
<p><code>{processInstanceId}</code>: The integer identifier of the process instance, such as <code>ec44f890-d21d-444f-a4ec-cb88589bd79</code></p>
</li>
<li>
<p><code>{taskName}</code>: The string identifier of the task definition, such as <code>firstLineApproval</code></p>
</li>
<li>
<p><code>{taskInstanceId}</code>: The integer identifier of the node instance, such as <code>7a520588-d5ab-464a-8378-d34fda3ff7e9</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, <code>PUT</code>, or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_task_phases"><a class="anchor" href="#_task_phases"></a><a class="link" href="#_task_phases">3.7.2.1. Task phases</a></h5>
<div class="paragraph">
<p>Use the following REST endpoints to change phases for a task:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Change the current phase for a task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /phase/{phaseName}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/phase/complete</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/phase/complete -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_comments"><a class="anchor" href="#_comments"></a><a class="link" href="#_comments">3.7.2.2. Comments</a></h5>
<div class="paragraph">
<p>Use the following endpoints to manage comments for a user task:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve list of comments related to a task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /comments</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Create a comment with the text passed in the request body</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /comments</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Update a comment with the text passed in the request body</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[PUT] /comments/{commentId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments/firstComment</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X PUT http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments/firstComment -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Delete a comment</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[DELETE] /comments/{commentId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments/firstComment</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/comments/firstComment -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_attachments"><a class="anchor" href="#_attachments"></a><a class="link" href="#_attachments">3.7.2.3. Attachments</a></h5>
<div class="paragraph">
<p>Use the following REST endpoints to manage attachments for a user task:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve list of attachments related to a task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /attachments</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Create an attachment with the URL passed in the request body</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /attachments</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Update an attachment with the URL passed in the request body</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[PUT] /attachments/{attachmentId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments/firstAttachment</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X PUT http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments/firstAttachment -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Delete an attachment</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[DELETE] /attachments/{attachmentId}`</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments/firstAttachment</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE http://localhost:8080/approval/ec44f890-d21d-444f-a4ec-cb88589bd79/firstLineApproval/7a520588-d5ab-464a-8378-d34fda3ff7e9/attachments/firstAttachment -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_task_management"><a class="anchor" href="#_task_management"></a><a class="link" href="#_task_management">3.7.2.4. Task management</a></h5>
<div class="paragraph">
<p>The REST endpoints for task management in Kogito enable you to manage the predefined information of a task, which cannot be modified using the tasks API endpoints. The predefined information of a task includes Description, Priority, Potential Owners, Administrators, and Input Parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The REST API endpoints for task management are accessible to system administrators and users with enough privileges.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The task management REST endpoints support the following HTTP methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GET</code> method is used to retrieve information about a task.</p>
</li>
<li>
<p><code>PUT</code> method is used to replace the entire task information, indicating that you need to pass the entire task information. Therefore, if you do not include a field in the request, then that field is set as null.</p>
</li>
<li>
<p><code>PATCH</code> method is used to replace certain task information, indicating that you need to pass only those fields that you want to modify.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The task management REST API base URL is <code>http://<em>HOST</em>:<em>PORT</em>/management/processes/approvals</code>. Use the following REST endpoints to manage a task:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve a task information</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /instances/{processInstanceId}/tasks/{taskId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/approvals/instances/ec44f890-d21d-444f-a4ec-cb88589bd79/tasks/8B62D3CA-5D03-4B2B-832B-126469288BB4</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/management/processes/approvals/instances/ec44f890-d21d-444f-a4ec-cb88589bd79/tasks/8B62D3CA-5D03-4B2B-832B-126469288BB4 -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "description": null,
  "priority": null,
  "potentialUsers": [
    "manager"
  ],
  "potentialGroups": [
    "managers"
  ],
  "excludedUsers": [],
  "adminUsers": [],
  "adminGroups": [],
  "inputParams": {
    "TaskName": "firstLineApproval",
    "NodeName": "First Line Approval",
    "Skippable": "true",
    "ActorId": "manager",
    "traveller": {
      "firstName": "John",
      "lastName": "Doe",
      "email": "jon.doe@example.com",
      "nationality": "American",
      "address": {
        "street": "main street",
        "city": "Boston",
        "zipCode": "10005",
        "country": "US"
      }
    },
    "GroupId": "managers"
  }
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Modify specific fields of a task</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[PATCH] /instances/{processInstanceId}/tasks/{taskId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/approvals/instances/ec44f890-d21d-444f-a4ec-cb88589bd79/tasks/8B62D3CA-5D03-4B2B-832B-126469288BB4</code></p>
</div>
<div class="listingblock">
<div class="title">Example request body (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
	"inputParams": {
		"Skippable": false
	},
	"description": " Real Betis Balompie is the best soccer team in the world",
	"potentialUsers": ["manager", "meganito"]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
	"description": " Real Betis Balompie is the best soccer team in the world",
	"priority": null,
	"potentialUsers": [
		"manager", "menganito"
	],
	"potentialGroups": [
		"managers"
	],
	"excludedUsers": [],
	"adminUsers": [],
	"adminGroups": [],
	"inputParams": {
		"TaskName": "firstLineApproval",
		"NodeName": "First Line Approval",
		"Skippable": false,
		"ActorId": "manager",
		"traveller": {
			"firstName": "John",
			"lastName": "Doe",
			"email": "jon.doe@example.com",
			"nationality": "American",
			"address": {
				"street": "main street",
				"city": "Boston",
				"zipCode": "10005",
				"country": "US"
			}
		},
		"GroupId": "managers",

	}
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_interaction_with_task_lifecycle_phases"><a class="anchor" href="#_api_interaction_with_task_lifecycle_phases"></a><a class="link" href="#_api_interaction_with_task_lifecycle_phases">3.7.3. API interaction with task lifecycle phases</a></h4>
<div class="paragraph">
<p>The following example API interacts with user tasks (work items) using lifecycle phases:</p>
</div>
<div class="listingblock">
<div class="title">Example API to interact with task lifecycle phases</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// Start process instance
ProcessInstance&lt;?&gt; processInstance = approvalsProcess.createInstance(m);
processInstance.start();

// Set up security policy with identity information
StaticIdentityProvider identity = new StaticIdentityProvider("admin", Collections.singletonList("managers"));
SecurityPolicy policy = SecurityPolicy.of(identity);

// Get list of work items, taking security restrictions into account
List&lt;WorkItem&gt; workItems = processInstance.workItems(policy);

// Work on a task
final String wiId = workItems.get(0).getId();
processInstance.transitionWorkItem(wiId,
                                   new HumanTaskTransition(Claim.ID, null, policy));

processInstance.transitionWorkItem(wiId,
                                   new HumanTaskTransition(Complete.ID, Collections.singletonMap("approved", false), policy));</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you interact with user tasks through a REST API, you can also provide the following query parameters for user and group information:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 118. Query parameters for user or group information in REST APIs</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Multi-value support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>user</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User name to be used for the user task authorization check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zero or more group names to be used for the user task authorization check</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, the following REST endpoints interact with user tasks in an <code>orderItems.bpmn2</code> process for verifying customer orders:</p>
</div>
<div class="listingblock">
<div class="title">Example GET request to retrieve open tasks using the process UUID</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orderItems/66c11e3e-c211-4cee-9a07-848b5e861bc5/tasks</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"62f1c985-d31c-4ead-9906-2fe8d05937f0":"Verify order"}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example GET request to retrieve task details by process and task UUID</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/orderItems/66c11e3e-c211-4cee-9a07-848b5e861bc5/Verify_order/62f1c985-d31c-4ead-9906-2fe8d05937f0</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"62f1c985-d31c-4ead-9906-2fe8d05937f0","input1":{"orderNumber":"12345","shipped":false,"total":0.537941914075738},"name":"Verify order"}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example POST request to complete the task and define the authorized group and user</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/orderItems/66c11e3e-c211-4cee-9a07-848b5e861bc5/Verify_order/62f1c985-d31c-4ead-9906-2fe8d05937f0?group=managers&amp;user=john -H "accept: application/json" -H "content-type: application/json"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code>{"id":"66c11e3e-c211-4cee-9a07-848b5e861bc5","order":{"orderNumber":"12345","shipped":false,"total":0.537941914075738}}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-task-lifecycle-custom_kogito-developing-process-services"><a class="anchor" href="#proc-task-lifecycle-custom_kogito-developing-process-services"></a><a class="link" href="#proc-task-lifecycle-custom_kogito-developing-process-services">3.7.4. Creating a custom task lifecycle and phase</a></h4>
<div class="paragraph _abstract">
<p>You can extend the user task lifecycle and lifecycle phases in Kogito to implement a custom lifecycle and phases as needed.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To add custom lifecycle phases, implement the <code>org.kie.kogito.process.workitem.LifeCyclePhase</code> resource in the Java class for your custom lifecycle phases.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>This resource implements the following key methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: Assigns a unique ID that is used when transitioning through phases</p>
</li>
<li>
<p><code>canTransition</code>: Provides a checkpoint between phases, if this phase can be transitioned from a specified phase</p>
</li>
<li>
<p><code>status</code>: Defines a human-readable status for this phase</p>
</li>
<li>
<p><code>isTerminating</code>: Determines if this phase is a completion stage, and if so, completes the work item and moves on to the next activity in the process</p>
</li>
<li>
<p><code>apply</code>: Enables additional updates to the work item when transitioning through phases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can implement as many phases as needed or extend existing phases.</p>
</div>
</div>
</div>
</li>
<li>
<p>To add a custom lifecycle, implement the <code>org.kie.kogito.process.workitem.LifeCycle&lt;Map&lt;String, Object&gt;&gt;</code> resource in the Java class for your custom lifecycle.</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To support user tasks, the parameterized type <code>LifeCycle</code> must be <code>Map&lt;String, Object&gt;</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This resource implements the following key methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>phaseById</code>: Retrieves the lifecycle phase by ID to verify if the phase is supported by the lifecycle implementation</p>
</li>
<li>
<p><code>phases</code>: Returns all supported phases by a specified lifecycle implementation</p>
</li>
<li>
<p><code>transitionTo</code>: Provides the main logic to handle phase transition</p>
</li>
<li>
<p><code>data</code>: Returns the current state of data for the work item</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following is an example Java class that extends the <code>Complete</code> lifecycle phase from a custom lifecycle implementation:</p>
</div>
<div class="listingblock">
<div class="title">Example Java class to extend the <code>Complete</code> lifecycle phase</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.acme.travels.usertasks;

import java.util.Arrays;
import java.util.List;

import org.jbpm.process.instance.impl.workitem.Complete;
import org.kie.kogito.process.workitem.LifeCyclePhase;

public class CompleteStartedOnly extends Complete {

    private List&lt;String&gt; allowedTransitions = Arrays.asList(Start.ID);

    @Override
    public boolean canTransition(LifeCyclePhase phase) {
        return allowedTransitions.contains(phase.id());
    }

}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>After you implement your custom lifecycle or lifecycle phases, create a Java configuration class to enable the process engine to use the new lifecycle or phase instead of the default lifecycle.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>In this configuration, you use the <code>WorkItemHandlerConfig</code> class as you do for any other work item handler, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example configuration class for a custom lifecycle phase</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class CustomWorkItemHandlerConfig extends DefaultWorkItemHandlerConfig {
 {
  register("Human Task", new HumanTaskWorkItemHandler(new CustomHumanTaskLifeCycle()));
 }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The work item handler is the same as the default, but instead of the default lifecycle, you pass as a constructor argument the custom implementation of the <code>LifeCycle</code> interface.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example Kogito services with custom task lifecycle configurations, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/process-usertasks-custom-lifecycle-quarkus"><code>process-usertasks-custom-lifecycle-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/process-usertasks-custom-lifecycle-springboot"><code>process-usertasks-custom-lifecycle-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="con-task-notification-addon_kogito-developing-process-services"><a class="anchor" href="#con-task-notification-addon_kogito-developing-process-services"></a><a class="link" href="#con-task-notification-addon_kogito-developing-process-services">3.7.5. Kogito task notification add-on</a></h4>
<div class="paragraph _abstract">
<p>Kogito provides different task notification add-ons for Quarkus and Spring Boot, enabling you to manage the notifications related to a task when the task is not started or not completed. The task notification add-ons include <code>jbpm-addons-quarkus-task-notification</code>, <code>task-notification-springboot-addon</code>, <code>jbpm-addons-quarkus-mail</code>, and <code>mail-springboot-addon</code>.</p>
</div>
<div class="paragraph">
<p>When a user task deadline is reached and the <strong>Task state type</strong> is still <strong>Not started</strong> or <strong>Not completed</strong>, then a notification is triggered using the configured add-ons. To publish an event on Apache Kafka, Kogito provides <code>jbpm-addons-quarkus-task-notification</code> and <code>task-notification-springboot-addon</code> addons, and to send an email notification, Kogito provides <code>jbpm-addons-quarkus-mail</code> and <code>mail-springboot-addon</code>. The <code>jbpm-addons-quarkus-mail</code> and <code>mail-springboot-addon</code> add-ons send the email notification using the information added on the <strong>Notification</strong> page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/task-notification-page.png" alt="Notification setting in Kogito">
</div>
</div>
<div class="paragraph">
<p>In the previous example, a notification is set to be triggered every minute till the task is completed. When the defined <strong>Task expiration definition</strong> expires, an email notification is sent to the added user.</p>
</div>
<div class="paragraph">
<p>To configure the add-ons for your Kogito services, you can add the task notification add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable task notifications in Quarkus projects</div>
<div class="content">
<pre class="highlight"><code>&lt;profile&gt;
	&lt;id&gt;notification&lt;/id&gt;
	&lt;dependencies&gt;
    	 &lt;dependency&gt;
        	 &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
        	 &lt;artifactId&gt;jbpm-addons-quarkus-mail&lt;/artifactId&gt;
    	 &lt;/dependency&gt;
    	 &lt;dependency&gt;
        	 &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
        	 &lt;artifactId&gt;jbpm-addons-quarkus-task-notification&lt;/artifactId&gt;
    	&lt;/dependency&gt;
    	&lt;dependency&gt;
        	 &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
        	 &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
    	&lt;/dependency&gt;
  	&lt;/dependencies&gt;
&lt;/profile&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous configuration, <code>jbpm-addons-quarkus-task-notification</code> is added as a dependency that uses the <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/2/connectors/connectors.html">Smallrye library</a> to define a channel named <code>kogito-deadline-events</code>. In the <code>kogito-deadline-events</code> channel, as <code>quarkus-smallrye-reactive-messaging-kafka</code> dependency is added, an event that contains the notification data is published into the configured Apache Kafka topic.</p>
</div>
<div class="paragraph">
<p>Once the event is published into the configured Apache Kafka topic, you can configure a listener that publishes the email on event reception. To configure an event listener, add the <code>jbpm-addons-quarkus-mail</code> in the <code>pom.xml</code> file of your Kogito project. The <code>jbpm-addons-quarkus-mail</code> accesses the Apache Kafka records that are published on <code>kogito-deadline-events</code> and sends an email using the information in the Apache Kafka record.</p>
</div>
<div class="paragraph">
<p>To send an email notification, you need to add the following properties to the <code>application.properties</code> file. For more information about email configuration, see <a href="https://quarkus.io/guides/mailer-reference#configuration-reference">Quarkus mailer configuration</a>.</p>
</div>
<div class="listingblock">
<div class="title">Example properties to enable mail notification in <code>application.properties</code> file</div>
<div class="content">
<pre class="highlight"><code>quarkus.mailer.host=localhost
quarkus.mailer.port=25
quarkus.mailer.mock=false
quarkus.mailer.ssl=false
quarkus.mailer.start-tls=disabled</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-process-decisions-integration_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration_kogito-developing-process-services">3.8. Processes and decisions integration in Kogito</a></h3>
<div class="paragraph _abstract">
<p>When you design a business process in Kogito, you can define decisions as distinct services using DMN and DRL. For more information about defining decision services, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-using-dmn-models"><em>Developing decision services with Kogito</em></a> and <a href="https://kie.apache.org/kogito-docs/#chap-kogito-using-drl-rules"><em>Developing decision services with Kogito</em></a>.</p>
</div>
<div class="paragraph">
<p>Kogito enables the integration of processes and decisions using different ways, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Embedded method</p>
</li>
<li>
<p>Remote method</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Based on the use cases, you can either use the embedded or remote method, or you can combine both methods in the same process.</p>
</div>
<div class="sect3">
<h4 id="con-process-decisions-integration-embedded_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration-embedded_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration-embedded_kogito-developing-process-services">3.8.1. Embedded method to integrate processes and decisions</a></h4>
<div class="paragraph">
<p>The embedded method to integrate the processes and decisions uses business rule tasks that use the communication between a local process and decision engine that is running in the same application. The embedded method does not require any remote call but requires the decision services to be deployed in the same application as the process running.</p>
</div>
<div class="paragraph">
<p>For more information about business rule tasks, see <a href="#ref-bpmn-tasks_kogito-developing-process-services">Tasks supported in Kogito</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/process-decisions-embedded-integration.png" alt="Image of Embedded process integration with decisions">
</div>
<div class="title">Figure 182. Embedded method to integrate a process with decisions</div>
</div>
<div class="paragraph">
<p>For more information, you can see <a href="#con-process-decisions-integration-traffic-violation-process-embedded_kogito-developing-process-services">Traffic violations example for embedded method</a>.</p>
</div>
<div class="paragraph">
<p>You can also use the example applications for Quarkus and Spring Boot, such as <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/main/kogito-quarkus-examples/process-decisions-quarkus"><code>process-decisions-quarkus</code></a> and <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/main/kogito-springboot-examples/process-decisions-springboot"><code>process-decisions-springboot</code></a>.</p>
</div>
<div class="paragraph">
<p>The example of a traffic violations project describes how to use decisions within the processes and how to integrate decisions in an embedded way using the business rule tasks, which must be deployed with a process in the same application.</p>
</div>
<div class="paragraph">
<p>In Kogito, the decisions can be expressed in different domains or assets, such as DMN and DRL. All the assets including BPMN, DMN, and DRL must be placed in the <code>resources</code> folder.</p>
</div>
<div class="paragraph">
<p>When the example application is running, there also must be different running processes, such as a process using a business rule task, containing the URL as <code><a href="http://localhost:8080/traffic" class="bare">http://localhost:8080/traffic</a></code>.</p>
</div>
<div class="sect4">
<h5 id="con-process-decisions-integration-traffic-violation-process-embedded_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration-traffic-violation-process-embedded_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration-traffic-violation-process-embedded_kogito-developing-process-services">3.8.1.1. Traffic violations example for embedded method</a></h5>
<div class="paragraph">
<p>The traffic violations project is based on the evaluation process of the traffic violations. In the traffic violations example, first, the information of the driver is fetched, and based on the fetched information, it is determined whether the driver has a valid driving license using a RuleUnit in a DRL. After the validation of the driving license, the violation evaluation is executed, which is defined as a DMN decision, and the output provides the information of whether the driver is suspended or not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-rules-dmn.png" alt="Image of Traffic Process in process designer">
</div>
<div class="title">Figure 183. Traffic violations example</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Processes in traffic violation example</dt>
<dd>
<p>In the traffic violations project, the interactions with the defined decisions are executed using the decision engine. Also, the information that is required to execute the decision evaluation must be defined in the <strong>Data Assignments</strong> property of the business rule task.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The ID property of a process is used in the REST endpoint generation, which refers to the path that is used to interact with the process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Also, the classes in the process are used to define the Plain Old Java Objects (POJOs) that enable the interaction between the process and decisions. The process classes include <code>Violation</code>, <code>Driver</code>, <code>Fine</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Decisions in traffic violation example</dt>
<dd>
<p>The traffic violations process contains license validation as a decision that is created using DRL. The license validation consists of rules that are evaluated to verify that the license is expired or not. The result of the license validation is added for the <code>driver</code> variable.
The rule units are declared in the <code>LicenseValidationService.drl</code> file and the rule unit data is added to the <code>LicenseValidationService</code> class.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">Example <code>LicenseValidationService.drl</code> file</div>
<div class="content">
<pre class="highlight"><code>unit LicenseValidationService

rule "Is driver license valid"
when
    $driver: /driver[licenseExpiration.after(currentTime)]
then
    $driver.setValidLicense(true);
end

rule "Is driver license expired"
when
    $driver: /driver[licenseExpiration.before(currentTime)]
then
    $driver.setValidLicense(false);
end

query "validation"
  $driver : /driver
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example <code>LicenseValidationService</code> class</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class LicenseValidationService implements RuleUnitData {
    private SingletonStore&lt;Driver&gt; driver;

    public LicenseValidationService() {
        this(DataSource.createSingleton());
    }

    public LicenseValidationService(SingletonStore&lt;Driver&gt; driver) {
        this.driver = driver;
    }

    public void setDriver(SingletonStore&lt;Driver&gt; driver) {
        this.driver = driver;
    }

    public SingletonStore&lt;Driver&gt; getDriver() {
        return driver;
    }

    public Date getCurrentTime() {
        return new Date();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the license validation task, the traffic violations process contains traffic violation as a decision that is created using DMN. The traffic violation decision verifies whether the driver is suspended or not based on the points in the driver’s license.</p>
</div>
<div class="paragraph">
<p>The traffic violation decision is declared in the <code>TrafficViolation.dmn</code> file.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-dmn.png" alt="Image of Traffic Violation - DMN in DMN designer">
</div>
<div class="title">Figure 184. Example <code>TrafficViolation.dmn</code> file</div>
</div>
<div class="sect5">
<h6 id="con-process-decisions-integration-traffic-violation-data-mapping-embedded_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration-traffic-violation-data-mapping-embedded_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration-traffic-violation-data-mapping-embedded_kogito-developing-process-services">Data mapping between a process and decisions</a></h6>
<div class="paragraph">
<p>To map the data between a process and decisions, you can align all the attributes names in a Java class, which is used as process variables. If the names of the attributes contain spaces or the names of the attributes are not following Java conventions, then you can use <a href="https://github.com/FasterXML/jackson">Jackson</a> annotations. The Jackson annotations align the process variables with the data types of the DMN model. For example, in the traffic violations project, the <code>Violation</code> class is mapped with the <code>speedLimit</code> attribute using the <code>@JsonProperty</code> annotation. Therefore, the <code>speedLimit</code> attribute can be integrated with the <code>Violation</code> data type defined in the DMN model.</p>
</div>
<div class="listingblock">
<div class="title">Violation class defined in the Traffic Violations example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Violation {

    @JsonProperty("Code")
    private String code;

    @JsonProperty("Date")
    private Date date;

    @JsonProperty("Type")
    private String type;

    @JsonProperty("Speed Limit")
    private BigDecimal speedLimit;

    @JsonProperty("Actual Speed")
    private BigDecimal actualSpeed;

    //Getters / Setters
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/violation-dmn-data-types.png" alt="Image of Violation Data Type in DMN in DMN designer">
</div>
<div class="title">Figure 185. Violation data type in DMN</div>
</div>
<div class="paragraph">
<p>When the driver information is fetched, an external call to a service task is performed to retrieve the driver information from the database. In this case, the service task implementation is performed using the <code>DriverService</code> class. In the Data Assignments, <code>driverId</code> is defined as an input variable and <code>driver</code> is defined as an output variable, consisting of the driver information.</p>
</div>
<div class="paragraph">
<p>Fetching the driver information leads to the license validation task, which represents the task of calling a DRL service.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/license-validation-drl-businessrule.png" alt="Image of License Validation Task in process designer">
</div>
<div class="title">Figure 186. License validation task (DRL)</div>
</div>
<div class="paragraph">
<p>The properties that are required to set for the DRL service task include <code>Rule Language</code>, which must be set as <code>DRL</code> and the <code>Rule Flow Group</code>. You can set the value of <code>Rule Flow Group</code> using the following format:</p>
</div>
<div class="paragraph">
<p><code>unit:</code> + <code>[the FQCN of the Rule Unit Data class]</code>
For example: <code>unit:org.kie.kogito.traffic.LicenseValidationService</code></p>
</div>
<div class="paragraph">
<p>In this case, the <code>driver</code> variable contains the license validation information.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/license-validation-dmn-businessrule-data.png" alt="Image of License Validation Task data assignment in process designer">
</div>
<div class="title">Figure 187. License validation task data assignments</div>
</div>
<div class="paragraph">
<p>Similar to the license validation task, the traffic violation task represents the task of calling a DMN service.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-dmn-businessrule.png" alt="raffic Violation Task data in process designer">
</div>
<div class="title">Figure 188. Traffic violation task (DMN)</div>
</div>
<div class="paragraph">
<p>The properties that are required to set for the DMN service task include <code>Rule Language</code>, which must be set as <code>DMN</code>. Also, you must set the values for <code>Namespace</code>, <code>Decision Name</code> and <code>DMN Model Name</code> properties as defined in the DMN model, such as <code>TrafficViolation.dmn</code>. For example, you can set the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rule Language: <code>DMN</code></p>
</li>
<li>
<p>Namespace: <code><a href="https://github.com/apache/incubator-kie-drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF" class="bare">https://github.com/apache/incubator-kie-drools/kie-dmn/_A4BCA8B8-CF08-433F-93B2-A2598F19ECFF</a></code></p>
</li>
<li>
<p>Decision Name: <code>Traffic Violation</code></p>
</li>
<li>
<p>DMN Model Name: <code>Traffic Violation</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The input for the traffic violation task includes <code>Driver</code> and <code>Violation</code> variables, and the output includes <code>Suspended</code> and <code>Fine</code> in the Data Assignment property.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-dmn-businessrule-data.png" alt="Traffic Violation Task data assignment in process designer">
</div>
<div class="title">Figure 189. Traffic Violation Task data assignment</div>
</div>
<div class="paragraph">
<p>In both cases, whether the driver is suspended or not, the related information is logged in the console.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-process-decisions-integration-remote_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration-remote_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration-remote_kogito-developing-process-services">3.8.2. Remote method to integrate processes and decisions</a></h4>
<div class="paragraph">
<p>The remote method to integrate the processes and decisions uses REST endpoints from the decision services. In the REST endpoints, the process can use the BPMN to send HTTP requests, such as a service task or a REST work item.</p>
</div>
<div class="paragraph">
<p>In the remote method, it is not required for the process and decision services to run in the same application, as the communication between the process and decision services is performed using the network.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/process-decisions-rest-integration.png" alt="Image of Process integration with decisions through REST">
</div>
<div class="title">Figure 190. Process integration with decisions through REST</div>
</div>
<div class="paragraph">
<p>You can also use the example applications for Quarkus and Spring Boot, such as <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/main/kogito-quarkus-examples/process-decisions-rest-quarkus"><code>process-decisions-rest-quarkus</code></a> and <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/main/kogito-springboot-examples/process-decisions-rest-springboot"><code>process-decisions-rest-springboot</code></a>.</p>
</div>
<div class="paragraph">
<p>You can define the decisions in different domains or assets, such as DMN and DRL. Here, we can consider the example of traffic violations, which describes how to integrate decisions in a remote environment using REST endpoints. In the REST endpoints, the decisions are deployed from the process service.</p>
</div>
<div class="paragraph">
<p>For convenience, the decision assets in the traffic violations example are under the same project as the process. The endpoints are generated differently for the process and decisions but under the same application. However, the endpoints can be placed in different applications.</p>
</div>
<div class="paragraph">
<p>The traffic violations example of the remote method covers the following processes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DMN to define a decision service</p>
</li>
<li>
<p>DRL to define rules decision service</p>
</li>
<li>
<p>To integrate the process with decisions using REST endpoints</p>
</li>
<li>
<p>Service task to call an external decision service</p>
</li>
<li>
<p>REST work item to call an external decision service</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the example application is running, there also must be different running processes, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A process using a service task, containing the URL as <code><a href="http://HOST:PORT/{serviceTask}" class="bare">http://HOST:PORT/{serviceTask}</a></code>. For example, <code><a href="http://localhost:8080/traffic_service" class="bare">http://localhost:8080/traffic_service</a></code>.</p>
</li>
<li>
<p>A process using a REST work item, containing the URL as <code><a href="http://HOST:PORT/{workItem}" class="bare">http://HOST:PORT/{workItem}</a></code>. For example, <code><a href="http://localhost:8080/traffic_wih" class="bare">http://localhost:8080/traffic_wih</a></code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the application, you can send requests to the URL. For example:</p>
</div>
<div class="listingblock">
<div class="title">Example JSON request</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "driverId": "12345",
  "violation": {
    "Type": "speed",
    "Speed Limit": 100,
    "Actual Speed": 140
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example CURL request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST -H 'Content-Type:application/json' -H 'Accept:application/json' -d '{"driverId": "12345","violation":{"Type":"speed","Speed Limit": 100,"Actual Speed":140}}' http://localhost:8080/traffic_service</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "e499326d-3bd2-4ddb-93b7-0f68f74a9673",
  "driverId": "12345",
  "driver": {
    "licenseExpiration": "2021-08-12T19:35:48.971+00:00",
    "validLicense": true,
    "Name": "Arthur",
    "State": "SP",
    "City": "Campinas",
    "Points": 13,
    "Age": 30
  },
  "trafficViolationResponse": {
    "Fine": {
      "Amount": 1000,
      "Points": 7
    },
    "Suspended": "Yes"
  },
  "violation": {
    "Code": null,
    "Date": null,
    "Type": "speed",
    "Speed Limit": 100,
    "Actual Speed": 140
  }
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="con-process-decisions-integration-traffic-violation-process-remote_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration-traffic-violation-process-remote_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration-traffic-violation-process-remote_kogito-developing-process-services">3.8.2.1. Traffic violations example for remote method</a></h5>
<div class="paragraph">
<p>The traffic violations example for remote method is similar to the <a href="#con-process-decisions-integration-traffic-violation-process-embedded_kogito-developing-process-services">Traffic violations example for embedded method</a>. However, in the remote method, you need to use different tasks to perform the calls to the decision services.</p>
</div>
<div class="paragraph">
<p>The traffic violations example is based on the evaluation process of the traffic violations. In the traffic violations example, first, the information of the driver is fetched, and based on the fetched information, it is determined whether the driver has a valid driving license using a RuleUnit in a DRL. After the validation of the driving license, the violation evaluation is executed, which is defined as a DMN decision, and the output provides the information of whether the driver is suspended or not.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The ID property of a process is used in the REST endpoint generation, which refers to the path that is used to interact with the process.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/process-variables.png" alt="Image of Traffic Process with service tasks for REST in process designer">
</div>
<div class="title">Figure 191. Traffic process variables</div>
</div>
<div class="paragraph">
<p>Also, the classes in the process are used to define the Plain Old Java Objects (POJOs) that enable the interaction between the process and decisions. The process classes include  <code>Violation</code>, <code>Driver</code>, <code>Fine</code> and <code>TrafficViolationResponse</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Traffic process using service tasks</dt>
<dd>
<p>When using service tasks for defining a process, it requires coding to provide an implementation in the application that is responsible to execute the task, and in this case a REST or HTTP call.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-rules-dmn-service-task.png" alt="Image of Traffic Process with service tasks for REST in process designer">
</div>
<div class="title">Figure 192. Traffic Process with service tasks for REST</div>
</div>
<div class="paragraph">
<p>For more information about implementation, see <a href="https://quarkus.io/guides/rest-client">Quarkus REST Client</a>, and for implementation details, see the following <code>LicenseValidationRestClient</code> and <code>TrafficViolationRestClient</code> classes.</p>
</div>
<div class="listingblock">
<div class="title">LicenseValidationRestClient class in traffic violation example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Path("/validation/first")
@RegisterRestClient
public interface LicenseValidationRestClient {

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    Driver post(Map&lt;String, Object&gt; parameters);

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">TrafficViolationRestClient class in traffic violation example</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Path("/Traffic%20Violation")
@RegisterRestClient
public interface TrafficViolationRestClient {

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    TrafficViolationResponse post(Map&lt;String, Object&gt; parameters);

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The process is declared in the <code>traffic-rules-dmn-service-task.bpmn</code> file.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Traffic process using REST work item</dt>
<dd>
<p>Using the REST work item is a declarative way, which does not require additional implementation. The REST or HTTP call is executed by the decision engine.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-rules-dmn-wih.png" alt="Image of Traffic Process with service tasks for REST in process designer">
</div>
<div class="title">Figure 193. Process using REST work item</div>
</div>
<div class="paragraph">
<p>The information that is required to execute the REST call, such as URL and HTTP method must be set in the <strong>Data Assignments</strong> for the REST work item. The process is declared in the <code>traffic-rules-dmn-wih.bpmn</code> file.</p>
</div>
<div class="sect5">
<h6 id="con-process-decisions-integration-traffic-violation-data-mapping-remote_kogito-developing-process-services"><a class="anchor" href="#con-process-decisions-integration-traffic-violation-data-mapping-remote_kogito-developing-process-services"></a><a class="link" href="#con-process-decisions-integration-traffic-violation-data-mapping-remote_kogito-developing-process-services">Data mapping between a process and decisions</a></h6>
<div class="paragraph">
<p>Data mapping from a process to decisions in the remote method is similar to the embedded method. For more information, see <a href="#con-process-decisions-integration-traffic-violation-data-mapping-embedded_kogito-developing-process-services">Data mapping between a process and decisions</a>.</p>
</div>
<div class="paragraph">
<p>To map the data between a process and decisions, you can align all the attributes names in a Java class, which is used as process variables. If the names of the attributes contain spaces or the names of the attributes are not following Java conventions, then you can use <a href="https://github.com/FasterXML/jackson">Jackson</a> annotations. The Jackson annotations align the process variables with the data types of the DMN model. For example, in the traffic violations project, the <code>Violation</code> class is mapped with the <code>speedLimit</code> attribute using the <code>@JsonProperty</code> annotation. Therefore, the <code>speedLimit</code> attribute can be integrated with the <code>Violation</code> data type defined in the DMN model.</p>
</div>
<div class="listingblock">
<div class="title">Violation class defined in the traffic process</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class Violation {

    @JsonProperty("Code")
    private String code;

    @JsonProperty("Date")
    private Date date;

    @JsonProperty("Type")
    private String type;

    @JsonProperty("Speed Limit")
    private BigDecimal speedLimit;

    @JsonProperty("Actual Speed")
    private BigDecimal actualSpeed;

    //Getters / Setters
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the traffic violation project, when fetching driver information, an external call to a service task is performed to retrieve the driver information from the database. In this case, the service task implementation is performed using the <code>DriverService</code> class. In the Data Assignments, <code>driverId</code> is defined as an input variable and <code>driver</code> is defined as an output variable, consisting of the driver information.</p>
</div>
<div class="paragraph">
<p>Fetching the driver information leads to the license validation task, which represents the task of calling a DRL service. The license validation task can be performed using a service task or REST work item:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When using a service task for the license validation task, the implementation properties must be along with the method. In the implementation properties, it is must to set the Java class to implement the service task that executes the REST call.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/license-validation-drl-service-task.png" alt="Image of License Validation Service Task in process designer">
</div>
<div class="title">Figure 194. License validation service task</div>
</div>
<div class="paragraph">
<p>The input and output mapping for the license validation service task is the <code>driver</code> variable, which contains the validated license information.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/license-drl-service-task-data-mapping.png" alt="Image of License Validation Service Task data assignment in process designer">
</div>
<div class="title">Figure 195. License validation service task data assignment</div>
</div>
</li>
<li>
<p>When using a REST work item, the input and output mapping for the license validation task includes the <code>driver</code> variable that contains the validated license information. Also, the URL and HTTP method is set as input parameters for the process.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/license-validation-drl-wih.png" alt="Image of License Validation Service Task in process designer">
</div>
<div class="title">Figure 196. License validation REST work item</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/license-validation-drl-wih-data-mapping.png" alt="Image of License Validation Service Task data assignment in process designer">
</div>
<div class="title">Figure 197. License validation REST work item data assignment</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similar to the license validation task, the traffic violation task represents the task of calling a DMN service using a service task or REST work item:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When using a service task, the implementation properties must be set along with the method. The implementation properties consist of the Java class that implements the service task.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-drl-service-task.png" alt="Image of License Validation Service Task in process designer">
</div>
<div class="title">Figure 198. Traffic violation service task</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-drl-service-task-properties.png" alt="Image of Traffic Violation Service Task properties in process designer">
</div>
<div class="title">Figure 199. Traffic violation service task properties</div>
</div>
<div class="paragraph">
<p>The input for the traffic violation task includes <code>Driver</code> and <code>Violation</code> variables, and the output includes <code>Suspended</code> and <code>Fine</code>, which is part of <code>TrafficViolationResponse</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-drl-service-task-data.png" alt="Image of Traffic Violation Service Task data assignment in process designer">
</div>
<div class="title">Figure 200. Traffic violation service task data assignment</div>
</div>
</li>
<li>
<p>When using a REST work item, the input for the task violation task includes <code>Driver</code> and <code>Violation</code> variables, and the output includes <code>Suspended</code> and <code>Fine, which is part of `TrafficViolationResponse</code>. Also, the URL and HTTP method is set as input parameters for the process.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-drl-wih.png" alt="Image of Traffic Violation REST Work Item in process designer">
</div>
<div class="title">Figure 201. Traffic violation REST work item</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/decisions/traffic-violation-drl-wih-data.png" alt="Image of Traffic Violation REST Work Item data assignmentg in process designer">
</div>
<div class="title">Figure 202. Traffic violation REST work item data assignment</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In both cases, whether the driver is suspended or not, the related information is logged in the console.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-flex-processes_kogito-developing-process-services"><a class="anchor" href="#con-flex-processes_kogito-developing-process-services"></a><a class="link" href="#con-flex-processes_kogito-developing-process-services">3.9. Flexible processes for case management in Kogito</a></h3>
<div class="paragraph _abstract">
<p>Kogito does not support the <a href="https://www.omg.org/cmmn/">Case Management Model and Notation (CMMN) specification</a> for case management in process services. Instead, Kogito uses Business Process Model and Notation (BPMN) extensions to provide similar case-management functionality through <em>flexible processes</em>.</p>
</div>
<div class="paragraph">
<p>A flexible process in Kogito is any process definition that uses ad hoc components or other features that enable the process to be executed more flexibly than traditional processes. For example, a flexible process does not require a standard start event and does not require all nodes to be connected. Some of the typical components in flexible processes include the <code>Ad-Hoc</code> process property that enables the process to use ad hoc auto-start fragments and to not require strict start and end events, ad hoc subprocesses that contain embedded inner activities within another process, and milestones that flag or trigger tasks and events.</p>
</div>
<div class="paragraph">
<p>Similar to case files in CMMN, flexible processes enable you to define traditional processes with more flexibility when the execution path is not rigid. This flexibility is helpful when the process cannot be fully automated or when the scope of the process is difficult to measure. A typical example of a case or flexible process is related to healthcare. A patient has a file that is accessible to the doctor and to any health professionals (or <em>knowledge workers</em>) who are assigned to the patient. These assigned workers take action and make different decisions and assessments until the patient is diagnosed and treated, completing the case or flexible process.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following key case-related features in flexible processes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ad hoc processes</strong>: An ad hoc process is any process definition that has the <code>Ad-Hoc</code> property enabled in the process diagram <strong>Properties</strong> panel. This property enables the process to use ad hoc auto-start fragments, such as ad hoc subprocesses and ad hoc tasks, and to not require strict start and end events. An ad hoc process is similar to a Case in CMMN.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-ad-hoc-process.png" alt="Image of Ad-Hoc process property">
</div>
<div class="title">Figure 203. Ad hoc process property</div>
</div>
</li>
<li>
<p><strong>Ad hoc subprocesses</strong>: An ad hoc subprocess contains embedded inner activities within another process and is a standard BPMN component that is supported in Kogito. An ad hoc subprocess is similar to a Stage in CMMN.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-adhoc-subprocess.png" alt="Image of ad hoc subprocess node in process designer">
</div>
<div class="title">Figure 204. Ad hoc subprocess node</div>
</div>
</li>
<li>
<p><strong>Ad hoc auto-start fragments</strong>: An ad hoc auto-start fragment is any ad hoc process, ad hoc subprocess, or ad hoc task with the <code>AdHoc Autostart</code> property enabled. This property enables the fragment to automatically start when the process is created instead of being started by the completion of the previous node or by a signal event.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-adhoc-subprocess-autostart.png" alt="Image of ad hoc subprocess node in process designer">
</div>
<div class="title">Figure 205. Ad hoc auto-start property</div>
</div>
</li>
<li>
<p><strong>Milestones</strong>: A milestone is a standard CMMN component that is incorporated in Kogito as a BPMN custom task. A milestone represents a single point of achievement within a process instance. You can use milestones to flag certain events to trigger other tasks or track the progress of the process.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-milestone.png" alt="Image of Mileston node in process designer">
</div>
<div class="title">Figure 206. Milestone node</div>
</div>
</li>
<li>
<p><strong>REST API requests as signals</strong>: A REST API request can serve as a signal event to trigger milestones or to create and start ad hoc fragments such as ad hoc processes, ad hoc subprocesses, or tasks. For non-flexible processes, an empty <code>POST</code> request for a process triggers the start node, whereas in a flexible process, the request creates the process instance. Similarly for ad hoc tasks, an empty <code>POST</code> request instantiates the task node. All ad hoc auto-start fragments with the <code>AdHoc Autostart</code> property enabled are started automatically when the process is created.</p>
<div class="listingblock">
<div class="title">Example curl request to add comments to a ticket</div>
<div class="content">
<pre class="highlight"><code>curl -D -X POST -H 'Content-Type:application/json' -H 'Accept:application/json' http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP/1.1 201 Created
Content-Length: 305
Location: http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment/f3b36cf9-3953-43ae-afe6-2a48fea8a79a
Content-Type: application/json

{
  "id":"b3c75b24-2691-4a76-902c-c9bc29ea076c",
  "supportCase":{
    "product": {
      "name":"Kogito",
      "family":"Middleware"
    },
    "description":"Kogito is not working for some reason.",
    "engineer":"kelly",
    "customer":"Paco the customer",
    "state":"WAITING_FOR_OWNER",
    "comments":null,
    "questionnaire":null
  },
  "supportGroup":"Kogito"
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="ref-flex-process-example_kogito-developing-process-services"><a class="anchor" href="#ref-flex-process-example_kogito-developing-process-services"></a><a class="link" href="#ref-flex-process-example_kogito-developing-process-services">3.9.1. Flexible process example</a></h4>
<div class="paragraph _abstract">
<p>A typical flexible process consists of one or more of the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Optional start event (might or might not be explicit)</p>
</li>
<li>
<p>Optional node connections (might or might not connect all nodes)</p>
</li>
<li>
<p>Enabled <code>Ad-Hoc</code> process property</p>
</li>
<li>
<p>One or more subprocesses, typically ad hoc subprocesses</p>
</li>
<li>
<p>Ad hoc auto-start fragments, such as ad hoc subprocesses or ad hoc tasks</p>
</li>
<li>
<p>Milestones that flag or trigger events</p>
</li>
<li>
<p>End event to terminate the process</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example is a real-world BPMN model scenario that demonstrates how you can use flexible processes for case management. In this scenario, a service desk uses a flexible process for handling customer tickets related to problems or questions about a specific product.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This example is based on the <code>flexible-process-quarkus</code> application in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub. However, this example may differ from the exact example source code as Kogito continues to be developed. Be sure to explore this and other Kogito examples in GitHub to help you develop your own applications.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-flex-process-example.png" alt="Image of `service-desk.bpmn2` example process">
</div>
<div class="title">Figure 207. Example <code>service-desk.bpmn2</code> flexible process</div>
</div>
<div class="paragraph">
<p>To start the process and generate a ticket, a user provides an initial <code>supportCase</code> object in a REST request that contains information about the product, the customer, and the related issue:</p>
</div>
<div class="listingblock">
<div class="title">Example REST request to start the process and generate a ticket</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "supportCase": {
    "customer": "Paco the customer",
    "description": "Kogito is not working for some reason.",
    "product": {
      "family": "Middleware",
      "name": "Kogito"
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the ticket is generated, the <code>Triage</code> ad hoc subprocess is automatically started and the ticket is assigned to a support team and then to a support engineer. If the system cannot determine which team to assign the ticket to, a user assigns the ticket manually to a support engineer.</p>
</div>
<div class="paragraph">
<p>The decision logic for the <code>Triage</code> subprocess is defined in the following <code>SupportGroup</code> decision table in the <code>triage.dmn</code> Decision Model and Notation (DMN) model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-flex-process-example-decision-table.png" alt="Image of `SupportGroup` example DMN decision table">
</div>
<div class="title">Figure 208. Example <code>SupportGroup</code> DMN decision table</div>
</div>
<div class="paragraph">
<p>The <code>Work case</code> ad hoc subprocess is also automatically started when the process is created. Anyone from the <code>customer</code> and <code>support</code> groups can add comments. To create a task that can be used to add a comment, a user can send an empty <code>POST</code> request as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -D -X POST -H 'Content-Type:application/json' -H 'Accept:application/json' http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP/1.1 201 Created
Content-Length: 305
Location: http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment/f3b36cf9-3953-43ae-afe6-2a48fea8a79a
Content-Type: application/json

{
  "id":"b3c75b24-2691-4a76-902c-c9bc29ea076c",
  "supportCase":{
    "product": {
      "name":"Kogito",
      "family":"Middleware"
    },
    "description":"Kogito is not working for some reason.",
    "engineer":"kelly",
    "customer":"Paco the customer",
    "state":"WAITING_FOR_OWNER",
    "comments":null,
    "questionnaire":null
  },
  "supportGroup":"Kogito"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A user can then use the URL in the <code>Location</code> HTTP header when rendering the <code>form action</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example form action for a user comment</div>
<div class="content">
<pre class="highlight"><code>&lt;form action="http://localhost:8080/serviceDesk/b3c75b24-2691-4a76-902c-c9bc29ea076c/ReceiveSupportComment/f3b36cf9-3953-43ae-afe6-2a48fea8a79a" method="post"&gt;
  &lt;label for="comment"&gt;Comment:&lt;/label&gt;
  &lt;input type="text" id="comment" name="comment"&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the customer is satisfied with the ticket response and actions, a user clicks a <strong>Resolve Case</strong> button, which sends an empty <code>POST</code> request to the service task to set the case to <code>Resolved</code> and the process emits a <code>CaseResolved</code> event. This event signals the <code>CaseResolved</code> milestone, which starts the <code>Close</code> ad hoc subprocess that sends, receives, and saves the customer questionnaire and closes the case.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-bpmn-process-management-addon_kogito-developing-process-services"><a class="anchor" href="#con-bpmn-process-management-addon_kogito-developing-process-services"></a><a class="link" href="#con-bpmn-process-management-addon_kogito-developing-process-services">3.10. Kogito process management add-on</a></h3>
<div class="paragraph _abstract">
<p>Kogito provides a <code>kie-addons-quarkus-process-management</code> add-on that enables basic REST operations that you can use to manage process instances. These REST operations are supplemental to any other specific REST operations that you have configured in your application.</p>
</div>
<div class="paragraph">
<p>To configure process management REST capabilities for your Kogito services, you can add the process management add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process management REST operations</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-process-management&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kogito process management add-on provides REST support for the following basic operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process instances</strong>: Abort an active process instance</p>
</li>
<li>
<p><strong>Node instances</strong>:  Cancel or re-trigger a node instance, or trigger a new node instance</p>
</li>
<li>
<p><strong>Error handling</strong>: Retrieve error details for a process instance, or skip or re-trigger a failed node instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to exposed REST operations, the process management add-on also provides the following REST exception mappers to generate more meaningful error messages for typical exception types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ProcessInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeNotFound</code></p>
</li>
<li>
<p><code>ProcessInstanceExecutionError</code></p>
</li>
<li>
<p><code>NotAuthorized</code></p>
</li>
<li>
<p><code>InvalidTransition</code> (for work items)</p>
</li>
<li>
<p><code>InvalidLifeCyclePhase</code> (for work items)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These exception mappers produce a valid HTTP error code with JSON payload with the context that caused the exception.</p>
</div>
<div class="paragraph">
<p>For example, the following is a <code>ProcessInstanceNotFoundException</code> error generated at runtime:</p>
</div>
<div class="listingblock">
<div class="title">Example error with JSON payload at runtime</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP code : 404

{
  "processInstanceId" : "c6862071-0f2e-4f21-9bc8-586245a76c3aa",
  "message" : "Process instance with id c6862071-0f2e-4f21-9bc8-586245a76c3aa not found"
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_rest_endpoints_for_the_process_management_add_on"><a class="anchor" href="#_rest_endpoints_for_the_process_management_add_on"></a><a class="link" href="#_rest_endpoints_for_the_process_management_add_on">3.10.1. REST endpoints for the process management add-on</a></h4>
<div class="paragraph">
<p>After you add the <code>kie-addons-quarkus-process-management</code> dependency to your Kogito project and run your Kogito services, you can use the following REST endpoints to manage your process and node instances. These REST operations are supplemental to any other specific REST operations that you have configured in your application.</p>
</div>
<div class="paragraph">
<p>For each endpoint, use a REST client, curl utility, or Swagger UI (if configured for the application) to send requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base URL</strong>: <code>http://<em>HOST</em>:<em>PORT</em>/management/processes/{processId}/instances/{processInstanceId}</code></p>
</li>
<li>
<p><strong>Path parameters</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>{processId}</code>: The string identifier of the process definition, such as <code>orders</code></p>
</li>
<li>
<p><code>{processInstanceId}</code>: The integer identifier of the process instance, such as <code>ec44f890-d21d-444f-a4ec-cb88589bd79</code></p>
</li>
<li>
<p><code>{nodeId}</code>: The string identifier of the node, such as <code>verifyOrders</code></p>
</li>
<li>
<p><code>{nodeInstanceId}</code>: The integer identifier of the node instance, such as <code>6e46bec2-0273-46f6-ad7d-2ff156e55a6c</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP headers</strong>: For <code>POST</code> requests only:</p>
<div class="ulist">
<ul>
<li>
<p><code>accept</code>: <code>application/json</code></p>
</li>
<li>
<p><code>content-type</code>: <code>application/json</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code>, <code>POST</code>, or <code>DELETE</code></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_process_instances"><a class="anchor" href="#_process_instances"></a><a class="link" href="#_process_instances">3.10.1.1. Process instances</a></h5>
<div class="paragraph">
<p>Use the following REST endpoints from the process management add-on to interact with process instances:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return active node instances for a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /management/processes/{processId}/instances/{processInstanceId}/nodeInstances</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "ec44f890-d21d-444f-a4ec-cb88589bd79a",
  "name": "Verify order",
  "nodeInstanceId": "6e46bec2-0273-46f6-ad7d-2ff156e55a6c",
  "parameters": {
    "Locale": "en-UK",
    "TaskName": "Verify order",
    "NodeName": "Verify order",
    "Priority": "1",
    "input1": {
      "orderNumber": "12345",
      "shipped": false,
      "total": 0.8233575052440095
    },
    "Skippable": "true",
    "ActorId": "john"
  },
  "phase": "active",
  "phaseStatus": "Ready",
  "results": {},
  "state": 0
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Abort a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[DELETE] /management/processes/{processId}/instances/{processInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_nodes"><a class="anchor" href="#_nodes"></a><a class="link" href="#_nodes">3.10.1.2. Nodes</a></h5>
<div class="paragraph">
<p>Use the following REST endpoint from the process management add-on to interact with process nodes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return nodes from a process</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /management/processes/{processId}/nodes</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/nodes</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET localhost:8080/management/processes/orders/nodes -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[
  {
    "name": "End",
    "id": 1,
    "type": "EndNode",
    "uniqueId": "1"
  },
  {
    "name": "End",
    "id": 2,
    "type": "EndNode",
    "uniqueId": "2"
  },
  {
    "name": "Hello2",
    "id": 3,
    "type": "HumanTaskNode",
    "uniqueId": "3"
  },
  {
    "name": "Split",
    "id": 4,
    "type": "Split",
    "uniqueId": "4"
  },
  {
    "name": "End",
    "id": 5,
    "type": "EndNode",
    "uniqueId": "5"
  },
  {
    "name": "End",
    "id": 6,
    "type": "EndNode",
    "uniqueId": "6"
  },
  {
    "name": "Hello1",
    "id": 7,
    "type": "HumanTaskNode",
    "uniqueId": "7"
  },
  {
    "name": "Start",
    "id": 8,
    "type": "StartNode",
    "uniqueId": "8"
  },
  {
    "name": "BoundaryEvent",
    "id": 9,
    "type": "BoundaryEventNode",
    "uniqueId": "9"
  },
  {
    "name": "BoundaryEvent",
    "id": 10,
    "type": "BoundaryEventNode",
    "uniqueId": "10"
  }
]</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_node_instances"><a class="anchor" href="#_node_instances"></a><a class="link" href="#_node_instances">3.10.1.3. Node instances</a></h5>
<div class="paragraph">
<p>Use the following REST endpoints from the process management add-on to interact with node instances:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Cancel a node instance within a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[DELETE] /management/processes/{processId}/instances/{processInstanceId}/nodeInstances/{nodeInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X DELETE localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Re-trigger a node instance within a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/nodeInstances/{nodeInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodeInstances/6e46bec2-0273-46f6-ad7d-2ff156e55a6c -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Trigger a new instance of a node within a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/nodes/{nodeId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodes/verifyOrder</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/nodes/verifyOrder -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_error_handling"><a class="anchor" href="#_error_handling"></a><a class="link" href="#_error_handling">3.10.1.4. Error handling</a></h5>
<div class="paragraph">
<p>Use the following REST endpoints from the process management add-on to troubleshoot errors with process and node instances:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These endpoints function only when a process instance is in an <code>ERROR</code> state.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return error details for a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /management/processes/{processId}/instances/{processInstanceId}/error</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/error</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/error -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "processInstanceId" : "ec44f890-d21d-444f-a4ec-cb88589bd79a",
  "message" : "Process instance with id c6862071-0f2e-4f21-9bc8-586245a76c3aa contains no input assignment"
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Re-trigger any failed nodes within a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/retrigger</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/retrigger</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/retrigger -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Skip any failed nodes within a process instance</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[POST] /management/processes/{processId}/instances/{processInstanceId}/skip</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/skip</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X POST localhost:8080/management/processes/orders/instances/ec44f890-d21d-444f-a4ec-cb88589bd79a/skip -H 'content-type: application/json' -H 'accept: application/json'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-bpmn-process-svg-addon_kogito-developing-process-services"><a class="anchor" href="#con-bpmn-process-svg-addon_kogito-developing-process-services"></a><a class="link" href="#con-bpmn-process-svg-addon_kogito-developing-process-services">3.11. Kogito process SVG add-on</a></h3>
<div class="paragraph _abstract">
<p>Kogito provides an add-on named <code>process-svg-addon</code>, enabling the basic REST operations that you can use to visualize the process diagram and execution path of the related process instances. The REST operations are supplemental to any other specific REST operation that is configured in your application.</p>
</div>
<div class="paragraph">
<p>The add-on requires the access of process SVG files. The process SVG files can be placed in a file system, which is accessible to the service or available in <code>META-INF/processSVG/</code> folder in the class path. For example, when the SVG files are generated, rename the files to <code>{processId}.svg</code>. The <code>{processId}.svg</code> file is used by the add-on and placed in a file system folder (accessible by the service) or in <code>META-INF/processSVG</code> folder in the class path. The configuration property <code>kogito.svg.folder.path</code> of the add-on points to the file system folder, otherwise the files are searched in the class path.</p>
</div>
<div class="paragraph">
<p>The VSCode extension enables you to export the process to SVG format:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-svg-addon-manually-export.png" alt="Manually export to SVG at VSCode">
</div>
<div class="title">Figure 209. Export process diagram at VSCode</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you export a process to SVG format, the generated SVG is named to {processFileName}-svg.svg.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The process code generation searches this export and, if this file exists, copies and renames it to `META-INF/processSVG/{processId}.svg allowing the process SVG addon to consume it directly.</p>
</div>
<div class="paragraph">
<p>To configure process SVG REST capabilities for your Kogito services, you can add the process SVG add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process SVG REST operations in Quarkus projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-process-svg&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process SVG REST operations in Spring Boot projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-process-svg&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The process SVG add-on provides the following set of configuration properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 119. Process SVG add-on configuration properties in Kogito</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.svg.folder.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the folder in which the add-on searches the initial process diagrams. If this property is not enabled, then the add-on searches <code>META-INF/processSVG/</code> folder in the class path.</p>
<p class="tableblock">Default value: <code>empty</code></p>
<p class="tableblock">Example: <code>kogito.svg.folder.path=/home/user/diagrams</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.svg.color.completed</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the color to fill the completed nodes when showing the execution path.</p>
<p class="tableblock">Default value: <code>#C0C0C0</code></p>
<p class="tableblock">Example: <code>kogito.svg.color.completed=#C2C0C1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.svg.color.completed.border</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the color of the border of the completed node when showing the execution path.</p>
<p class="tableblock">Default value: <code>#030303</code></p>
<p class="tableblock">Example: <code>kogito.svg.color.completed.border=#C2C0C1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.svg.color.active.border</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changes the color of the border of the active node when showing the execution path.</p>
<p class="tableblock">Default value: <code>#FF0000</code></p>
<p class="tableblock">Example: <code>kogito.svg.color.active.border=#C2C0C1</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The Kogito process SVG add-on provides REST support for the following basic operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process Diagram</strong>: Return the process SVG diagram</p>
</li>
<li>
<p><strong>Process instance diagram</strong>: Return the process SVG diagram displaying the executed path of a specific process instance</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_rest_endpoints_for_the_process_svg_add_on"><a class="anchor" href="#_rest_endpoints_for_the_process_svg_add_on"></a><a class="link" href="#_rest_endpoints_for_the_process_svg_add_on">3.11.1. REST endpoints for the process SVG add-on</a></h4>
<div class="paragraph">
<p>After you add the <code>kie-addons-quarkus-process-svg</code> or <code>kie-addons-springboot-process-svg</code> dependency to your Kogito project, add the recommended configuration properties, and run your Kogito services. You can use the following REST endpoints to receive the process related SVGs. The REST operations are supplemental to any other specific REST operations that are configured in your application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These REST operations are supplemental to any other specific REST operations that you have configured in your application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For each endpoint, use a REST client, curl utility, or Swagger UI (if configured for the application) to send requests with the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Base URL</strong>: <code>http://<em>HOST</em>:<em>PORT</em>/svg/processes/{processId}</code></p>
</li>
<li>
<p><strong>Path parameters</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>{processId}</code>: The string identifier of the process definition, such as <code>travels</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>HTTP methods</strong>: <code>GET</code></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_process_diagram"><a class="anchor" href="#_process_diagram"></a><a class="link" href="#_process_diagram">3.11.1.1. Process diagram</a></h5>
<div class="paragraph">
<p>Use the following REST endpoint from the process SVG add-on to interact with the process diagram:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return the SVG that shows the process diagram</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /svg/processes/{processId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8380/svg/processes/travels</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8380/svg/processes/travels -H 'content-type: application/json' -H 'accept: image/svg+xml'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_process_instance_diagram"><a class="anchor" href="#_process_instance_diagram"></a><a class="link" href="#_process_instance_diagram">3.11.1.2. Process instance diagram</a></h5>
<div class="paragraph">
<p>Use the following endpoint from the process SVG add-on to interact with the process instance diagram:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Return the process SVG diagram and highlight the executed path</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>[GET] /svg/processes/{processId}/instances/{processInstanceId}</code></p>
</div>
<div class="paragraph">
<div class="title">Example REST endpoint</div>
<p><code>http://localhost:8380/svg/processes/travels/instances/2d115b55-ff30-42f0-ab21-e0651abb4d04</code></p>
</div>
<div class="listingblock">
<div class="title">Example curl request</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8380/svg/processes/travels/instances/2d115b55-ff30-42f0-ab21-e0651abb4d04 -H 'content-type: application/json' -H 'accept: image/svg+xml'</code></pre>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This REST endpoint can be used in environments that hold enabled security at the connected Data Index Service. The SVG add-on generates a query on Data Index Service to retrieve the executed nodes and if the Data Index Service contains enabled security, then it needs to pass a valid bearer token to complete the query.</p>
</div>
<div class="paragraph">
<p>If the SVG add-on detects a known security context enabled, then it retrieves the bearer token, otherwise the add-on reuses the token that is passed directly in the Authorization header.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Currently, the process SVG add-on retrieves the token for systems that contain OpenID Connect using Keycloak.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-bpmn-process-event-addon_kogito-developing-process-services"><a class="anchor" href="#con-bpmn-process-event-addon_kogito-developing-process-services"></a><a class="link" href="#con-bpmn-process-event-addon_kogito-developing-process-services">3.12. Kogito process event add-on</a></h3>
<div class="paragraph">
<p>Kogito provides a process event add-on, which you can use to send processes, tasks, and variable events to an external event listener. In this case, the processes, tasks, and variable events are generated as a result of the execution of an operation, which modifies a process state; such events are known as runtime events.</p>
</div>
<div class="paragraph">
<p>In Kogito, every modifying operation is executed within an abstraction called a unit of work. Examples of such operations include creating a process instance, transitioning a task, and modifying a variable. A runtime event is published when a unit of work is completed.</p>
</div>
<div class="paragraph">
<p>You can use the Kogito process event add-on to build a historical representation of all process instance executions. Also, you can use this add-on with process REST API to build a custom graphical user interface to handle the user tasks.</p>
</div>
<div class="paragraph">
<p>By default, the event format follows <a href="https://cloudevents.io/">CloudEvent</a> specification. The CloudEvent specification allows sending information using the data field, which contains a JSON of one of the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-services/src/main/java/org/kie/kogito/services/event/impl/ProcessInstanceEventBody.java">ProcessInstanceEvent</a>: This event is published when a process instance is created, modified, or completed.</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-services/src/main/java/org/kie/kogito/services/event/impl/UserTaskInstanceEventBody.java">UserTaskInstanceEvent</a>: This event is published when a change occurs on a user task.</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-runtimes/blob/main/api/kogito-services/src/main/java/org/kie/kogito/services/event/impl/VariableInstanceEventBody.java">VariableInstanceEvent</a>: This event is published when a variable is created, modified, or removed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure process event capabilities for your Kogito services, you can add the process event add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process event operations in Quarkus projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-events-process&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process event operations in Spring Boot projects</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  	&lt;groupId&gt;org.kie&lt;/groupId&gt;
  	&lt;artifactId&gt;kie-addons-springboot-events-process-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Kogito process event add-on for Spring Boot is specific to Kafka. Therefore, you do not need to add additional dependencies to your <code>pom.xml</code> file to use an event broker.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For Quarkus, the Kogito process event add-on implementation is based on <a href="https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/2/connectors/connectors.html">Smallrye Messaging</a> library, which provides a set of connectors for event brokers, such as JMS, AMQP, and Kafka. Therefore, the Kogito process event add-on is not specifically combined with any event broker in Quarkus, but requires additional configuration to use a suitable Smallrye connector.</p>
</div>
<div class="paragraph">
<p>For example, to use Kafka as an event broker in Quarkus, you can add the following dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable Kafka event broker in Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;dependency&gt;
  	&lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  	&lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Smallrye defines an abstraction named channel to enable multi-broker support. For every channel that you define in your Kogito application, you can specify the connector to use for that channel using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.connector = &lt;connector name&gt;</code></p>
</div>
<div class="paragraph">
<p>Optionally, for Kafka connector, you can define the Kafka topic to be used for that channel using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.topic = &lt;topic name&gt;</code></p>
</div>
<div class="paragraph">
<p>You can also set up a channel property using the following form:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.[incoming|outgoing].&lt;channel name&gt;.&lt;property name&gt;= &lt;property value&gt;</code></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If the defined property is not found, then the topic name is considered to be the same as Kafka name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Kogito process event add-on defines a channel for each event type, such as <code>kogito-processinstances-events</code>, <code>kogito-usertaskinstances-events</code>, and <code>kogito-variables-events</code>. Therefore, when the process event add-on is enabled, you must add the event types to your <code>application.properties</code> file using the following properties:</p>
</div>
<div class="listingblock">
<div class="title">Properties to define event types in <code>application.properties</code> file</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito-processinstances-events.connector=smallrye-kafka
mp.messaging.outgoing.kogito-processinstances-events.topic=kogito-processinstances-events
mp.messaging.outgoing.kogito-processinstances-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer

mp.messaging.outgoing.kogito-usertaskinstances-events.connector=smallrye-kafka
mp.messaging.outgoing.kogito-usertaskinstances-events.topic=kogito-usertaskinstances-events
mp.messaging.outgoing.kogito-usertaskinstances-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer

mp.messaging.outgoing.kogito-variables-events.connector=smallrye-kafka
mp.messaging.outgoing.kogito-variables-events.topic=kogito-variables-events
mp.messaging.outgoing.kogito-variables-events.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, you can disable the publishing on any channel by setting the related property to false as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Example properties to disable publishing</div>
<div class="content">
<pre class="highlight"><code>kogito.events.usertasks.enabled=false
kogito.events.variables.enabled=false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-management-console_kogito-developing-process-services"><a class="anchor" href="#con-management-console_kogito-developing-process-services"></a><a class="link" href="#con-management-console_kogito-developing-process-services">3.13. Kogito Management Console</a></h3>
<div class="paragraph _abstract">
<p>The Kogito Management Console is a user interface for viewing the state of all available Kogito services and managing process instances:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console.png" alt="Image of Kogito Management Console">
</div>
<div class="title">Figure 210. Kogito Management Console</div>
</div>
<div class="paragraph">
<p>You can use the Management Console to view process, subprocess, and node instance details, abort process instances, and view domain-specific process data.</p>
</div>
<div class="paragraph">
<p>The Management Console requires your Kogito services to use the following Kogito components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kogito Data Index Service</strong>: Enables the Management Console to access stored events related to processes and domain data from your Kogito services. The Kogito Data Index Service requires Infinispan or MongoDB persistence and Apache Kafka messaging for your Kogito service. For more information about the Data Index Service, see <a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Configuring Kogito supporting services and runtime capabilities</em></a>.</p>
</li>
<li>
<p><strong>Kogito process management add-on</strong>: Enables the Management Console to interact with the process data from your Kogito services through the add-on REST endpoint <code>/management/processes</code>. If you do not enable this add-on for your Kogito service, the Management Console provides read-only access to your service data without the ability to modify instances, such as aborting process instances. For more information about the process management add-on, see <a href="#con-bpmn-process-management-addon_kogito-developing-process-services">Kogito process management add-on</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To visualize the process instance execution path at the management console, add the following add-on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kogito process SVG add-on</strong>: Enables the process SVG diagram to visualize the process instance execution path. If this add-on is not enabled for your Kogito service, the management console does not display the diagram panel. For more information about the process SVG add-on, see <a href="#con-bpmn-process-svg-addon_kogito-developing-process-services">Kogito process SVG add-on</a>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="proc-management-console-using_kogito-developing-process-services"><a class="anchor" href="#proc-management-console-using_kogito-developing-process-services"></a><a class="link" href="#proc-management-console-using_kogito-developing-process-services">3.13.1. Using the Kogito Management Console to manage process instances</a></h4>
<div class="paragraph _abstract">
<p>You can use the Kogito Management Console to view and manage process instance details from your Kogito services. You can run the Management Console for local Kogito services or add it to your Kogito infrastructure on OpenShift.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Kogito Data Index Service instance is configured and running for your Kogito service. The Data Index Service enables the Management Console to access stored process data. The Data Index Service requires Infinispan or MongoDB persistence and Apache Kafka messaging for your Kogito service. For information about the Data Index Service, see <a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Configuring Kogito supporting services and runtime capabilities</em></a>.</p>
</li>
<li>
<p>The <code>pom.xml</code> file of your Kogito project contains the following dependency for the process management add-on. This add-on enables the Management Console to interact with the process data through the add-on REST endpoint <code>/management/processes</code>. For more information about the process management add-on, see <a href="#con-bpmn-process-management-addon_kogito-developing-process-services">Kogito process management add-on</a>.</p>
<div class="listingblock">
<div class="title">Project dependency to enable process management REST operations</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-process-management&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>The <code>application.properties</code> file of your Kogito project contains the following system properties for the location where the Kogito service is deployed, such as <code>http://localhost:8080</code>, and for Quarkus Cross-Origin Resource Sharing (CORS) support. These properties enable the Management Console to generate the URLs to execute the REST operations from the process management add-on.</p>
<div class="listingblock">
<div class="title">Application properties for REST URLs</div>
<div class="content">
<pre class="highlight"><code>kogito.service.url=http://<em>HOST</em>:<em>PORT</em>
quarkus.http.cors=true</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/management-console/"><code>management-console</code></a> artifacts page, select the latest release of the Kogito Management Console, and download the <code>management-console-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>management-console-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Management Console:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Running the Management Console</div>
<div class="content">
<pre class="highlight"><code>$ java -Dquarkus.http.port=8280 -jar management-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The default port for the Management Console is 8080, but this example specifies port 8280 to avoid conflicts with the example Kogito service running at port 8080.</p>
</div>
<div class="paragraph">
<p>Also, the Management Console uses the default Data Index Service port 8180. If you modified this port in your Data Index Service instance, you must also modify the port in the Management Console properties by using the start-up property <code>-Dkogito.dataindex.http.url=http://<em>HOST</em>:<em>PORT</em>/graphql</code> when you run the Management Console.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To change the logging level of the Management Console, such as for debugging, you can specify the following start-up properties:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Management Console logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -Dquarkus.http.port=8280  \
  -jar management-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div id="proc-management-console-structure_kogito-developing-process-services" class="paragraph">
<p>=== Kogito Management Console application</p>
</div>
<div class="paragraph">
<p>Kogito Management Console consists of the following tabs that allow you to interact with your process instances and data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process Instances</strong>: Use this tab to find process and subprocess instances by status or business key</p>
</li>
<li>
<p><strong>Jobs</strong>: Use this tab to view a list of available jobs to filter jobs by status and perform actions for individual jobs, such as view details, reschedule, or cancel.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console.png" alt="Image of Kogito Management Console">
</div>
<div class="title">Figure 211. Kogito Management Console</div>
</div>
<div class="paragraph">
<p>In this example, the Management Console displays data for the <code>kogito-travel-agency</code> extended example application in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub.</p>
</div>
<div id="con-process-instances" class="paragraph">
<p>==== Process instances</p>
</div>
<div class="paragraph">
<p>The <strong>Process Instances</strong> tab displays the list of process instances and enables you to add filters to the list.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-instance-section.png" alt="Image of process instance list section">
</div>
<div class="title">Figure 212. Process Instances tab</div>
</div>
<div class="paragraph">
<p>When you select a process instance on the <strong>Process Instances</strong> page, it redirects you to the <strong>Process Details</strong> page, providing the process instance details including interactions with the process instance. You can access the <strong>Process Details</strong> page from a different Kogito Management Console tab, displaying the instance related data and enables you to perform the available actions. You can also sort the results based on the column headers.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-diagram.png" alt="Image of Process Instance details in Management Console">
</div>
<div class="title">Figure 213. Process Details page</div>
</div>
<div class="paragraph">
<p>The <strong>Process Details</strong> page consists of the following panels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Process Diagram panel</p>
</li>
<li>
<p>Details panel</p>
</li>
<li>
<p>Process Variables panel</p>
</li>
<li>
<p>Timeline panel</p>
</li>
<li>
<p>Node Trigger panel</p>
</li>
<li>
<p>Milestones panel</p>
</li>
<li>
<p>Jobs panel</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Process Diagram panel</dt>
</dl>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>This panel enables you to explore the process diagram and execution path of the related process instance. The execution path is displayed when the Management Console finds the <code>.svg</code> resources using the Kogito process SVG add-on configuration included in the Kogito Management Console.</p>
</div>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-diagram-panel.png" alt="Image of process instance diagram panel">
</div>
<div class="title">Figure 214. Process Diagram panel</div>
</div>
<div class="paragraph">
<p>This panel includes different controls to view the process diagram, such as <strong>Selection</strong>, <strong>Pan</strong>, <strong>Zoom in</strong>, <strong>Zoom out</strong>, and <strong>Fit to viewer</strong>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Details panel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>This panel displays the basic process instance information and provides links to the related process runtime UI. If the process instance is related to other process instances, then links to the parent and subprocess instances are also available in the <strong>Details</strong> panel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-details-panel.png" alt="Image of process instance details panel">
</div>
<div class="title">Figure 215. Details panel</div>
</div>
<div class="paragraph">
<p>The Details panel consists of the following fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: The process definition ID related to the process instance.</p>
</li>
<li>
<p><strong>Business key</strong>: Optional business key of the process instance.</p>
</li>
<li>
<p><strong>State</strong>: The state of the process instance. The state of a process instance can be pending, active, completed, aborted, suspended, or error.</p>
</li>
<li>
<p><strong>Id</strong>: The unique identifier of the process instance.</p>
</li>
<li>
<p><strong>Endpoint</strong>: The endpoint of the process instance. You can click the displayed endpoint to view the process or application UI that triggered the process instance.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-details-endpoint.png" alt="Image of process instance details endpoint in Management Console">
</div>
<div class="title">Figure 216. Process instance details endpoint</div>
</div>
</li>
<li>
<p><strong>Start</strong>: Time reference indicating when the process instance is started.</p>
</li>
<li>
<p><strong>Last Updated</strong>: Time reference indicating when the process instance is updated.</p>
</li>
<li>
<p><strong>End</strong>: Time reference indicating when the process instance is completed.</p>
</li>
<li>
<p><strong>Parent Process</strong>: Parent process instance of the instance (if linked). You can click and navigate to the parent process instance.</p>
</li>
<li>
<p><strong>Sub Processes</strong>: Subprocess of the instance (if linked). You can click and navigate to the subprocess instances.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Process Variables panel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The <strong>Process Variables</strong> panel displays the process instance domain data in a tree structure. When you hover the mouse on different elements, the available actions are displayed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-variable-panel.png" alt="Image of process variables panel  in Management Console">
</div>
<div class="title">Figure 217. Process Variables panel</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-variable-actions.png" alt="Image of process variables panel available actions in Management Console">
</div>
<div class="title">Figure 218. Actions in Process Variables panel</div>
</div>
<div class="paragraph">
<p>The process variables in the <strong>Process Variables</strong> panel consists of the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expand or collapse: Enables you to expand or collapse an element.</p>
</li>
<li>
<p>Add item: Enables you to add a new key. When you add a new key, it contains null values, which you can edit if required.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-variable-add.png" alt="Steps to add a new variable to a process instance in Management Console">
</div>
<div class="title">Figure 219. Add new key</div>
</div>
</li>
<li>
<p>Copy: Enables you to copy the selected value in clipboard.</p>
</li>
<li>
<p>Edit: Enables you to edit the selected element value.</p>
</li>
<li>
<p>Remove: Enables you to remove the selected element.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If there are pending changes to be saved, the panel displays <strong>Changes are not saved yet</strong> message. To save the changes that you made to the process variable, click <strong>Save</strong>, or click <strong>Abort</strong> to abort the changes. If you want to revert the changes, click the refresh icon.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Timeline panel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The <strong>Timeline</strong> panel displays the list of node instances related to the process instance sorted by the start time. Each node consists of an icon, indicating the state of the node, such as active, completed, or error.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-process-timeline-panel.png" alt="Image of Timeline panel showing the related node instances">
</div>
<div class="title">Figure 220. Timeline panel</div>
</div>
<div class="paragraph">
<p>The actions that are available for an active node include retriggering and canceling a node. Whereas the actions for an error node include retrying and skipping the node. The node actions in the <strong>Timeline</strong> panel are connected with the Kogito runtime service to perform the requested action.</p>
</div>
<div class="paragraph">
<p>If a node in the <strong>Timeline</strong> panel is associated with a job, then select the clock icon to view the job details or click the menu for additional job operations, such as <strong>Job Reschedule</strong> or <strong>Job Cancel</strong>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Node Trigger panel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The <strong>Node Trigger</strong> panel displays the list of all process definition nodes in a drop-down. When you select a node, the related information is displayed, such as <strong>Node name</strong>, <strong>Node type</strong>, and <strong>Node id</strong>. Click the <strong>Trigger</strong> button, to trigger the selected node.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-node-trigger-panel.png" alt="Image of node trigger panel in Management Console">
</div>
<div class="title">Figure 221. Node Trigger panel</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Milestones panel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The <strong>Milestones</strong> panel displays a list of the milestones for the process instance, if applicable.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-milestones-panel.png" alt="Image of milestones panel in Management Console">
</div>
<div class="title">Figure 222. Milestones panel</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Jobs panel</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>The <strong>Jobs</strong> panel displays the list of available jobs that are related to the process instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-jobs-panel.png" alt="Image of jobs panel in Management Console">
</div>
<div class="title">Figure 223. Jobs panel</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-jobs-panel-details.png" alt="Image of jobs panel details in Management Console">
</div>
<div class="title">Figure 224. Job details</div>
</div>
<div class="paragraph">
<p>You can reschedule or cancel a job that is in scheduled or error state. You can also modify the expiration time for one-time jobs and repeat interval, repeat time, and expiration time for the periodic jobs.</p>
</div>
<div class="openblock">
<div class="content">
<div id="con-jobs-management" class="paragraph">
<p>==== Jobs management</p>
</div>
<div class="paragraph">
<p>The <strong>Jobs Management</strong> tab displays the list of existing jobs, which you can filter and perform related management actions such as viewing job details, rescheduling a job, or canceling a job.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-management-console-jobs-management.png" alt="Image of Jobs Management page in Management Console">
</div>
<div class="title">Figure 225. Jobs Management page</div>
</div>
<div class="paragraph">
<p>You can also cancel the multiple jobs at the same time. To cancel multiple jobs, select the jobs to be canceled and click the <strong>Cancel Selected</strong> button.</p>
</div>
<div id="proc-management-console-security_kogito-developing-process-services" class="paragraph">
<p>=== Configuring Kogito Management Console security</p>
</div>
<div class="paragraph _abstract">
<p>For security, the Kogito Management Console accesses Keycloak as an authentication service. Once a user is authenticated, Management Console uses bearer tokens to communicate with other Kogito services.The bearer tokens are issued using OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/management-console">Kogito Management Console</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/management-console">Kogito Management Console</a> repository from GitHub.</p>
</li>
<li>
<p>An instance of Keycloak server is running.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure that you log in to the administration console of the Keycloak, navigate to the respective client configuration, and add correct URLs of different applications. For easier configuration, you can add <code><strong></code>  in the *Web Origins</strong>, however, it can cause security issues. You can also add the origin URLs as a parameter to the <strong>Web Origins</strong>, which can prevent the issues related to <code>Access-Control-Allow-Origin</code>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-consoles-keycloak-config.png" alt="Image of client config in keycloak server">
</div>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the Kogito Management Console repository and enter the following command to run the application with security enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Management Console with security enabled</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure that the service is not started at the same port as the security server. You can change the port by adding <code>-Dquarkus.http.port=<em>PORT_NUMBER</em></code> to the start-up properties.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Management Console project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
kogito.consoles.keycloak.config.realm=kogito
kogito.consoles.keycloak.config.url=http://localhost:8280/auth/
kogito.consoles.keycloak.config.client-id=kogito-console-quarkus
kogito.consoles.keycloak.config.health-check-url=http://localhost:8280/auth/realms/kogito/.well-known/openid-configuration
kogito.consoles.keycloak.config.disable-health-check=false
kogito.consoles.keycloak.config.update-token-validity=30</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>kogito.consoles.keycloak.config.url</code>: The base URL of the Keycloak server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other Keycloak server pages and service URLs are derived from the base URL.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.client-id</code>: The client ID of the application. Each application contains a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.realm</code>: The realm, containing all the security configurations.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.health-check-url</code>: The health check URL that is used to check if the Keycloak server started properly.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.disable-health-check</code>: The property to disable the health check. By default, the health check is enabled.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.update-token-validity</code>: The property indicates the minimum validity (in seconds) of the token. If the token expires within the specified time, the token is refreshed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
</li>
<li>
<p>Stop and restart the Kogito Management Console to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://www.keycloak.org/documentation">Setting up and configuring keycloak server</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org/docs/latest/securing_apps/#_javascript_adapter">Using keycloak-js-adapter</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="con-task-console_kogito-developing-process-services" class="paragraph">
<p>== Kogito Task Console</p>
</div>
<div class="paragraph _abstract">
<p>The Kogito Task Console is a user interface for viewing and interacting with user tasks in Kogito process services.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console.png" alt="Image of Kogito Task Console">
</div>
<div class="title">Figure 226. Kogito Task Console</div>
</div>
<div class="paragraph">
<p>You can use the Task Console to view your list of assigned tasks, view the task details for each task, and move the task to the next phase of the task lifecycle. For more information about the task lifecycle, see <a href="#con-task-lifecycle_kogito-developing-process-services">Task lifecycle in Kogito processes</a>.</p>
</div>
<div class="paragraph">
<p>The Task Console requires your Kogito services to use the Kogito Data Index Service. The Data Index Service enables the Task Console to access stored events related to tasks and domain data from your Kogito services. The Kogito Data Index Service requires Infinispan or MongoDB persistence and Apache Kafka messaging for your Kogito service. For more information about the Data Index Service, see <a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Configuring Kogito supporting services and runtime capabilities</em></a>.</p>
</div>
<div id="proc-task-console-using_kogito-developing-process-services" class="paragraph">
<p>=== Using the Kogito Task Console to interact with user tasks</p>
</div>
<div class="paragraph _abstract">
<p>You can use the Kogito Task Console to view and interact with user tasks in Kogito process services. You can run the Task Console for local Kogito services or add it to your Kogito infrastructure on OpenShift.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Kogito Data Index Service instance is configured and running for your Kogito service. The Data Index Service enables the Task Console to access stored tasks and process data. The Data Index Service requires Infinispan or MongoDB persistence and Apache Kafka messaging for your Kogito service. For information about the Data Index Service, see <a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Configuring Kogito supporting services and runtime capabilities</em></a>.</p>
</li>
<li>
<p>The <code>application.properties</code> file of your Kogito project contains the following system properties for the location where the Kogito service is deployed, such as <code>http://localhost:8080</code>, and for Quarkus Cross-Origin Resource Sharing (CORS) support.</p>
<div class="listingblock">
<div class="title">Application properties for REST URLs</div>
<div class="content">
<pre class="highlight"><code>kogito.service.url=http://<em>HOST</em>:<em>PORT</em>
quarkus.http.cors=true</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/task-console/"><code>task-console</code></a> artifacts page, select the latest release of the Kogito Task Console, and download the <code>task-console-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>task-console-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Task Console:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Task Console</div>
<div class="content">
<pre class="highlight"><code>$ java -Dquarkus.http.port=8280 -jar task-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The default port for the Task Console is 8080, but this example specifies port 8280 to avoid conflicts with the example Kogito service running at port 8080.</p>
</div>
<div class="paragraph">
<p>Also, the Task Console uses the default Data Index Service port 8180. If you modified this port in your Data Index Service instance, you must also modify the port in the Task Console properties by using the start-up property <code>-Dkogito.dataindex.http.url=http://<em>HOST</em>:<em>PORT</em>/graphql</code> when you run the Task Console.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To change the logging level of the Task Console, such as for debugging, you can specify the following start-up properties:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Task Console logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -Dquarkus.http.port=8280  \
  -jar task-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your Kogito project has a custom task lifecycle that defines custom states, you can use the following properties to
configure the Task Console to use those states and show them in the filters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogito.task.states.list</code>: Comma-separated list of values containing all the states that you want to show in the Task Console.
Without this property, the Task Console shows the default lifecycle states <code>Ready</code>, <code>Reserved</code>, <code>Completed</code>, <code>Aborted</code>, and <code>Skipped</code>.</p>
</li>
<li>
<p><code>kogito.task.active.states.list</code>: Comma-separated list of values containing the active task states. These states are used in the <strong>Task Inbox</strong> default filter. Without this property, the default active states are <code>Ready</code> and <code>Reserved</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Configuring custom task states for the Task Console</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dkogito.task.states.list=Started,Pending,Finished,Cancelled \
  -Dkogito.task.active.states.list=Started,Pending \
  -jar task-console-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information about task lifecycles, see <a href="#con-task-lifecycle_kogito-developing-process-services">Task lifecycle in Kogito processes</a>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console.png" alt="Image of Kogito Task Console">
</div>
<div class="title">Figure 227. Kogito Task Console</div>
</div>
<div class="paragraph">
<p>In this example, the Task Console displays data for the <code>kogito-travel-agency</code> extended example application in the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub.</p>
</div>
<div class="paragraph">
<p>The <strong>Task Inbox</strong> page lists the available user tasks that you can interact with. You can use the upper toolbar options to filter the tasks or use the column headers to sort the tasks as needed. You can also search for tasks by the full name or by partial name, such as <code>Apply</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console-inbox.png" alt="Image of the tasks assigned to the current user">
</div>
<div class="title">Figure 228. Tasks assigned to the current user</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console-filters-status.png" alt="Image of status filtering on *Task Inbox*">
</div>
<div class="title">Figure 229. Available task status filters</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console-filters.png" alt="Image of status and names filtering on *Task Inbox*">
</div>
<div class="title">Figure 230. Applied filters</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select a task name to view task details and interact with the task:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console-details-page.png" alt="Image of *Task Details* page">
</div>
<div class="title">Figure 231. Task details</div>
</div>
<div class="paragraph">
<p>Depending on the current phase of the selected task, you can select from the available actions for that task, such as <strong>Abort</strong>, <strong>Release</strong>, <strong>Skip</strong>, or <strong>Complete</strong>, to move the task to the next phase.</p>
</div>
<div class="paragraph">
<p>For additional task details, you can select <strong>View details</strong>. This panel lists the task ID, state, owner, related process instance ID, and other helpful information about the task.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-task-console-details-expanded.png" alt="Image of task details panel">
</div>
<div class="title">Figure 232. Task details panel</div>
</div>
<div class="openblock">
<div class="content">
<div id="proc-task-console-security_kogito-developing-process-services" class="paragraph">
<p>=== Configuring Kogito Task Console security</p>
</div>
<div class="paragraph _abstract">
<p>For security, Kogito Task Console accesses Keycloak as an authentication service. Once a user is authenticated, Task Console uses bearer tokens to communicate with other Kogito services. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/task-console">Kogito Task Console</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/task-console">Kogito Task Console</a> repository from GitHub.</p>
</li>
<li>
<p>An instance of Keycloak server is running.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure that you log in to the administration console of the Keycloak, navigate to the respective client configuration, and add correct URLs of different applications. For easier configuration, you can add <code><strong></code>  in the *Web Origins</strong>, however, it can cause security issues. You can also add the origin URLs as a parameter to the <strong>Web Origins</strong>, which can prevent the issues related to <code>Access-Control-Allow-Origin</code>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/kogito-consoles-keycloak-config.png" alt="Image of client config in keycloak server">
</div>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the Kogito Task Console repository and enter the following command to run the application with security enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Task Console with security enabled</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure that the service is not started at the same port as the security server. You can change the port by adding <code>-Dquarkus.http.port=<em>PORT_NUMBER</em></code> to the start-up properties.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Task Console project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
kogito.consoles.keycloak.config.realm=kogito
kogito.consoles.keycloak.config.url=http://localhost:8280/auth/
kogito.consoles.keycloak.config.client-id=kogito-console-quarkus
kogito.consoles.keycloak.config.health-check-url=http://localhost:8280/auth/realms/kogito/.well-known/openid-configuration
kogito.consoles.keycloak.config.disable-health-check=false
kogito.consoles.keycloak.config.update-token-validity=30</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>kogito.consoles.keycloak.config.url</code>: The base URL of the Keycloak server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other Keycloak server pages and service URLs are derived from the base URL.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.client-id</code>: The client ID of the application. Each application contains a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.realm</code>: The realm, containing all the security configurations.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.health-check-url</code>: The health check URL that is used to check if the Keycloak server started properly.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.disable-health-check</code>: The property to disable the health check. By default, the health check is enabled.</p>
</li>
<li>
<p><code>kogito.consoles.keycloak.config.update-token-validity</code>: The property indicates the minimum validity (in seconds) of the token. If the token expires within the specified time, the token is refreshed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
</li>
<li>
<p>Stop and restart the Kogito Task Console to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://www.keycloak.org/documentation">Setting up and configuring keycloak server</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org/docs/latest/securing_apps/#_javascript_adapter">Using keycloak-js-adapter</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="con-runtime-tools-dev-ui_kogito-developing-process-services" class="paragraph">
<p>== Runtime Tools Quarkus Extension</p>
</div>
<div class="paragraph">
<p>In Kogito, Runtime Tools Quarkus Extension helps in developing your Kogito applications in Quarkus. This extension adds a new user interface with unified features from the different Kogito Management Console and Task Console, which is accessible in the Quarkus Dev UI. This is intended for the local development environment, can be integrated with Quarkus applications, and allows you to test the Kogito application without the need of a complex setup.</p>
</div>
<div class="paragraph">
<p>=== Setting up the Runtime Tools Quarkus Extension</p>
</div>
<div class="paragraph">
<p>Quarkus Dev UI shows a list of extensions that you can add to your project.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To enable the Runtime Tools Quarkus extension from your Quarkus project, you must add the following dependency to the <code>pom.xml</code> file:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Dependency to access Kogito Runtime Tools Dev UI in Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
    &lt;artifactId&gt;jbpm-quarkus-devui&lt;/artifactId&gt;
    &lt;version&gt;10.0.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following properties to the <code>application.properties</code> file to configure the users and impersonate the users on the task page using the dropdown at the top:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogito.users.&lt;user&gt;.groups</code>: This property creates a list of users and assigns specific roles to the users</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kogito.users.jdoe.groups=admin
kogito.users.admin.groups=admin
kogito.users.user.groups=user</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>=== Accessing Runtime Tools Quarkus Extension</p>
</div>
<div class="paragraph">
<p>After setting up the Runtime Tools Quarkus Extension, you can access the Quarkus extension in your project.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To access the Quarkus extension, run your project in development mode and select the <code><a href="http://localhost:8080/q/dev" class="bare">http://localhost:8080/q/dev</a></code> URL:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/quarkus-dev-ui.png" alt="Image of quarkus dev ui">
</div>
<div class="title">Figure 233. Quarkus Dev UI</div>
</div>
<div class="paragraph">
<p>The Quarkus extension consists of different menus to navigate to different pages, such as Configuration, Kogito Runtime Tools, and Infinispan Client. Using the <strong>Kogito Runtime Tools</strong> menu, you can navigate to <strong>Process Instances</strong>, <strong>Tasks</strong>, <strong>Jobs</strong>, and <strong>Forms</strong>. The features are similar to Kogito Management Console and Task Console.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./kogito/bpmn/kogito-runtime-tools-dev-ui-card.png" alt="kogito runtime tools dev ui card" width="][Image of menus in Quarkus extension">
</div>
<div class="title">Figure 234. Kogito Runtime Tools Dev UI for Quarkus</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process Instances</strong>: Use this section to view process and subprocess instances by status or business key. For more details, see <a href="#con-process-instances">[con-process-instances]</a>.</p>
</li>
<li>
<p><strong>Jobs</strong>: Use this section to view a list of available jobs. You can also filter the jobs by status and perform different actions, such as view details, reschedule, or cancel. For more details, see <a href="#proc-jobs-management">[proc-jobs-management]</a>.</p>
</li>
<li>
<p><strong>Tasks</strong>: Use this section to view the list of available user tasks that you can interact with by filtering based on the status. For more details, see <a href="#con-task-console_kogito-developing-process-services">[con-task-console_kogito-developing-process-services]</a>.</p>
</li>
<li>
<p><strong>Forms</strong>: Use this section to generate and customize the forms directly in the browser.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>=== Forms</p>
</div>
<div class="paragraph">
<p>The Kogito Quarkus extension enables you to customize the forms directly on the browser by using the dedicated code editor, which can compile HTML code and React code that is written in Typescript. You can use Patternfly components to create React forms. These customized forms are used in Task Inbox.</p>
</div>
<div class="paragraph">
<p>The Forms page in the Dev UI contains a list of generated forms in a project. To switch between the table view and gallery view, select the toggle on the top-right corner of the page. You can also filter the list of forms by entering the form name.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/forms-pages-table-view.png" alt="Image of forms in Dev UI table view">
</div>
<div class="title">Figure 235. Forms in Kogito Runtime tools Dev UI</div>
</div>
<div class="paragraph">
<p>When you select a form in the <strong>Forms</strong> page, you are redirected to the form displayer. The form displayer contains a code editor, which compiles the source code and displays the results on the right-side panel.</p>
</div>
<div class="paragraph">
<p>Initially, the form content and the related configuration are added to the code editor. You can make changes to the code in the editor and click the play icon from the toolbar to execute the code immediately on the browser.</p>
</div>
<div class="paragraph">
<p>The <strong>Source</strong> tab loads the source code of the form in HTML or Typescript format based on the selected form. When the configurations of a form are loaded on the <strong>Connections</strong> tab, a set of resources including CDN links, URLs pointing to JS or CSS files are added to the form.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/runtime-tools-dev-ui-code-editor.png" alt="Image of form displayer source code editor">
</div>
<div class="title">Figure 236. Form source in code editor</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/runtime-tools-dev-ui-code-editor-configurations.png" alt="Image of form displayer configuration code editor">
</div>
<div class="title">Figure 237. Form cofigurations in code editor</div>
</div>
<div class="paragraph">
<p>The code editor contains toolbar options, which allow you to undo and redo changes. Clicking on the play button executes the code and changes are applied immediately, while the save option allows you to save the changes on the source or configuration of the forms.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/runtime-tools-dev-ui-code-editor-toolbar.png" alt="Image of code editor toolbar options">
</div>
<div class="title">Figure 238. Toolbar options in code editor</div>
</div>
<div id="con-kogito-service-execution_kogito-developing-process-services" class="paragraph">
<p>== Kogito service execution</p>
</div>
<div class="paragraph _abstract">
<p>After you design your Kogito service, you can build and run your application and then send REST API requests to the application to execute your services. The exact REST API requests that you can use depend on how you set up the application.</p>
</div>
<div class="paragraph">
<p>For example, consider a Kogito service that is set up to generate a <code>/persons</code> REST API endpoint and determines whether a specified customer is an adult or is underage. In this example, you can send the following <code>POST</code> request using a REST client or curl utility to add an adult and execute the service:</p>
</div>
<div class="listingblock">
<div class="title">Example POST request body to add an adult (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "person": {
    "name": "John Quark",
    "age": 20
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to add an adult</div>
<div class="content">
<pre class="highlight"><code>curl -X POST http://localhost:8080/persons -H 'content-type: application/json' -H 'accept: application/json' -d '{"person": {"name":"John Quark", "age": 20}}'</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "3af806dd-8819-4734-a934-728f4c819682",
  "person": {
    "name": "John Quark",
    "age": 20,
    "adult": false
  },
  "isAdult": true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that for JSON marshaling, Kogito is relying on the default mappers of <a href="https://quarkus.io/guides/rest-json#jackson">Quarkus</a> and <a href="https://docs.spring.io/spring-boot/docs/1.3.0.M3/reference/html/howto-spring-mvc.html#howto-customize-the-jackson-objectmapper">SpringBoot</a>, which can be configured according to the specific requirements.</p>
</div>
<div class="paragraph">
<p>For information about creating, running, and testing an example application with Kogito services, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</div>
<div class="paragraph _additional-resources">
<p>== Additional resources
* <a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Developing decision services with Kogito</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</div>
<div id="chap-kogito-orchestrating-serverless" class="paragraph">
<p>= Orchestrating microservices with Serverless Workflow in Kogito
:parent-context: kogito-developing-decision-services
:context: kogito-orchestrating-serverless</p>
</div>
<div class="paragraph _abstract">
<p>As a microservices developer or architect, you can use the <a href="https://github.com/serverlessworkflow/specification/tree/0.8.x">Serverless Workflow specification</a> to orchestrate application services in your Kogito project. The Serverless Workflow specification enables you to define declarative workflow models that orchestrate event-driven, serverless applications. The specification is hosted by the <a href="https://www.cncf.io/">Cloud Native Computing Foundation (CNCF)</a> and is currently a CNCF <a href="https://www.cncf.io/sandbox-projects/">Sandbox project</a> that is progressing to become an <a href="https://www.cncf.io/projects/">Incubating project</a>.</p>
</div>
<div class="paragraph">
<p>The target users of Serverless Workflow orchestration are mostly developers and architects who want to define logical steps of execution declaratively (no code) for cloud-native services. Although you can orchestrate your services using process diagrams in <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation (BPMN)</a>, the Serverless Workflow has less focus on business definition and more focus on function-level steps of execution. Serverless Workflow is also designed specifically for microservice orchestration and therefore has a smaller scope than BPMN. Serverless Workflow also enables you to write workflows in formats (JSON or YAML) that might be better suited for developing and deploying serverless applications in cloud or container environments.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>⚠️ Quarkus is the only supported runtime for Serverless Workflow.</pre>
</div>
</div>
<div class="paragraph">
<p>Ultimately, the choice of which specification to use for orchestrating event-driven microservices depends on your environment needs, development goals, and personal preference.</p>
</div>
<div class="paragraph">
<p>The Serverless Workflow <code>functions</code>, <code>events</code>, and <code>states</code> are the core constructs for defining the orchestration behavior for your services. You can use one or all of these three constructs in your workflow definitions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>functions</code>: Function definitions are reusable constructs that you can use to define invocation information about services that need to be invoked during workflow execution.</p>
</li>
<li>
<p><code>events</code>: Event definitions are reusable constructs that you can use to define all consumed and produced events during workflow execution.</p>
</li>
<li>
<p><code>states</code>: State definitions enable you to define your workflow states (control-logic blocks) and determine what your workflow should do.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about what you can automate using Serverless Workflow, see <a href="https://github.com/serverlessworkflow/specification/tree/0.8.x/usecases">use cases</a>.</p>
</div>
<div class="paragraph">
<p>For more information about Serverless Workflow, see the <a href="https://serverlessworkflow.github.io/">Serverless Workflow</a> website.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Kogito 10.0.0 implements version <a href="https://github.com/serverlessworkflow/specification/tree/0.8.x/specification.md">0.8</a> of the Serverless Workflow specification.
You can find the current implementation status <a href="https://github.com/apache/incubator-kie-kogito-runtimes/tree/10.0.0.x/kogito-serverless-workflow#current-status">here</a>.
</td>
</tr>
</table>
</div>
<div id="con-serverless-workflow-in-kogito_kogito-developing-decision-services" class="paragraph">
<p>== Serverless Workflow orchestration in Kogito</p>
</div>
<div class="paragraph">
<p>You can use Serverless Workflow definition files in your Kogito project to define your domain-specific orchestration services. Your Serverless Workflow files can be in JSON or YAML format with the extension <code>.sw.json</code> or <code>.sw.yaml</code>.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates Serverless Workflow orchestration in Kogito:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/serverless/serverless-workflow-kogito.png" alt="Image of Serverless Workflow orchestration in Kogito">
</div>
<div class="title">Figure 239. Serverless Workflow orchestration in Kogito</div>
</div>
<div class="paragraph">
<p>== Serverless Workflow example in Kogito</p>
</div>
<div class="paragraph">
<p>The following example is a real-world Serverless Workflow scenario in Kogito that demonstrates how you can use Serverless Workflow definitions to orchestrate your Kogito services. In this scenario, an order service uses Serverless Workflow to process orders from multiple sources and approve or deny orders.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more Kogito examples that use Serverless Workflow, see the <a href="https://github.com/apache/incubator-kie-kogito-examples"><code>kogito-examples</code></a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following diagram illustrates the basic architecture of this scenario:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/serverless/serverless-workflow-kogito-orders.png" alt="Image of example Serverless Workflow orchestration for processing orders in Kogito">
</div>
<div class="title">Figure 240. Example Serverless Workflow orchestration for processing orders in Kogito</div>
</div>
<div class="paragraph">
<p>New orders can come from different sources, such as web applications or messaging services. Each order is then converted into <a href="https://cloudevents.io/">CloudEvents</a> messages, which represent the events that need to trigger the workflow execution. The events are pushed to an Apache Kafka topic.</p>
</div>
<div class="paragraph">
<p>New order events that are pushed to Kafka trigger new instances of the workflow. The workflow invokes a business rule service and a human task service to make the order approval decision. The business rule service can be a Kogito service with Decision Model and Notation (DMN) decision models or Drools Rule Language (DRL) rules, or it can be an external service. For this example, the rule service uses a DRL rules in Kogito to verify whether the order can be auto-approved. If the order cannot be auto-approved, then the workflow uses the human task service, which likewise can be a Kogito service or an external service, to notify a manager that the order requires human approval.</p>
</div>
<div class="paragraph">
<p>After the order decision is made, the workflow generates an event in CloudEvents format that notifies other services or other workflows that a decision was made for a particular order.</p>
</div>
<div class="paragraph">
<p>To orchestrate these services in this way, the example uses the following <code>ordersworkflow.sw.json</code> Serverless Workflow definition:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>ordersworkflow.sw.json</code> workflow definition (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "ordersworkflow",
  "name": "Orders Workflow",
  "version": "1.0",
  "events": [
    {
      "name": "NewOrderEvent",
      "source": "neworder",
      "type": "kafka"
    },
    {
      "name": "ApprovalDecisionEvent",
      "source": "out-approvaldecision",
      "type": "kafka"
    }
  ],
  "functions": [
    {
      "name": "AutoAproveOrderFunction",
      "type": "rule",
      "metadata": {
        "ruleflowgroup": "neworder"
      }
    },
    {
      "name": "OrderManagerApprovalFunction",
      "type": "decision",
      "metadata": {
        "taskname": "managerApproval",
        "actorid": "managers",
        "groupid": "managers"
      }
    }
  ],
  "states": [
    {
      "name": "HandleNewOrder",
      "type": "event",
      "start": {
        "kind": "default"
      },
      "eventsActions": [
        {
          "eventRefs": [
            "NewOrderEvent"
          ],
          "actions": [
            {
              "functionRef": {
                "refName": "AutoAproveOrderFunction"
              }
            }
          ]
        }
      ],
      "transition": {
        "nextState": "CheckIfNeedManagerApproval"
      }
    },
    {
      "name": "CheckIfNeedManagerApproval",
      "type": "switch",
      "dataConditions": [
        {
          "path": "$.decision",
          "value": "Approved",
          "operator": "equals",
          "transition": {
            "nextState": "OrderAutoApproved"
          }
        },
        {
          "path": "$.decision",
          "value": "NeedManagerApproval",
          "operator": "equals",
          "transition": {
            "nextState": "OrderManagerApproval"
          }
        }
      ],
      "defaultCondition": {
        "nextState": "OrderManagerApproval"
      }
    },
    {
      "name": "OrderAutoApproved",
      "type": "inject",
      "data": {
        "finalDecision": "Approved"
      },
      "end": {
        "kind": "event",
        "produceEvent": {
          "eventRef": "ApprovalDecisionEvent"
        }
      }
    },
    {
      "name": "OrderManagerApproval",
      "type": "operation",
      "actionMode": "sequential",
      "actions": [
        {
          "name": "managerAprovalAction",
          "functionRef": {
            "refName": "OrderManagerApprovalFunction"
          }
        }
      ],
      "end": {
        "kind": "event",
        "produceEvent": {
          "eventRef": "ApprovalDecisionEvent"
        }
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following diagram illustrates the basic structure and sequence of this example workflow definition:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/serverless/serverless-workflow-kogito-orders-structure.png" alt="Image of `ordersworkflow.sw.json` workflow definition">
</div>
<div class="title">Figure 241. Structure of the example <code>ordersworkflow.sw.json</code> workflow definition</div>
</div>
<div class="paragraph">
<p>The <code>HandleNewOrder</code> state is the workflow starting state. This state is an <code>event</code> type state that requires one or more events to be consumed before the workflow can be invoked. This event state defines the instances of this workflow that are created when the referenced <code>NewOrderEvent</code> is consumed. In this case, events are consumed using Kafka.</p>
</div>
<div class="paragraph">
<p>After the <code>NewOrderEvent</code> is consumed, the state defines a list of <code>actions</code> to be performed. Actions define all the functions or services that must be invoked as part of the workflow. In this case, a single <code>AutoApproveOrderFunction</code> function or service defines how to invoke the rule service.</p>
</div>
<div class="paragraph">
<p>After the execution of the rule service is complete, the event state specifies that the workflow must transition to the <code>CheckIfNeedManagerApprvoal</code> state, which is a <code>switch</code> type state. The order is then either auto-approved if no manager approval is required, or is assigned to a manager to complete the remaining states of the workflow.</p>
</div>
<div class="paragraph">
<p>For more Kogito examples that use Serverless Workflow, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/serverless-workflow-events-quarkus"><code>serverless-workflow-events-quarkus</code></a>: A Serverless Workflow service for processing job applicant approvals and that showcases event-driven services</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/serverless-workflow-greeting-quarkus"><code>serverless-workflow-greeting-quarkus</code></a>: A Serverless Workflow greeting service with both JSON and YAML workflow definitions</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/serverless-workflow-service-calls-quarkus"><code>serverless-workflow-service-calls-quarkus</code></a>: A Serverless Workflow service for returning country information</p>
</li>
</ul>
</div>
<div id="proc-serverless-workflow-definitions_kogito-developing-decision-services" class="paragraph">
<p>=== Creating and editing Serverless Workflow definitions in Kogito</p>
</div>
<div class="paragraph _abstract">
<p>You can use <a href="https://github.com/serverlessworkflow/specification/tree/0.8.x/specification.md">Serverless Workflow</a> definition files in your Kogito project to define your domain-specific orchestration services. Your Serverless Workflow definition files can be in JSON or YAML format with the extension <code>.sw.json</code> or <code>.sw.yaml</code>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a Kogito project and have included any Java objects or other business assets required for your Serverless Workflow service. For information about creating a project, see <a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your Kogito project, create or import a <code>.sw.json</code> or <code>.sw.yaml</code> Serverless Workflow definition file in the relevant folder, typically in <code>src/main/resources</code>.</p>
<div class="paragraph">
<p>Kogito supports both JSON and YAML formats for workflow definitions. You can use multiple workflow definitions in both formats if needed.</p>
</div>
</li>
<li>
<p>Open the workflow definition file and define the following basic components:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Serverless Workflow definition format in JSON</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "sampleWorkflow",
  "version": "1.0",
  "name": "Sample Workflow",
  "description": "Sample Workflow",
  "functions": [],
  "events": [],
  "states": []
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Serverless Workflow definition format in YAML</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: sampleWorkflow
version: '1.0'
name: Sample Workflow
description: Sample Workflow
functions: []
events: []
states: []</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Serverless Workflow <code>functions</code>, <code>events</code>, and <code>states</code> are the core constructs for defining the orchestration behavior for your services. You can use one or all of these three constructs in your workflow definitions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can find more information about the core constructs in the <a href="https://github.com/serverlessworkflow/specification/blob/0.8.x/specification.md#workflow-model">Workflow Model</a> section of the specification.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, the following Serverless Workflow definition performs a customer credit check in a loan application service to approve or deny the customer loan application:</p>
</div>
<div class="listingblock">
<div class="title">Example Serverless Workflow definition for credit check (JSON)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "id": "customercreditcheck",
  "version": "1.0",
  "name": "Customer Credit Check Workflow",
  "description": "Perform Customer Credit Check",
  "functions": [
    {
      "name": "callCreditCheckMicroservice",
      "resource": "creditCheckResource",
      "type": "service"
    },
    {
      "name": "sendRejectionEmailFunction",
      "resource": "rejectEmailResource"
    }
  ],
  "events": [
    {
      "name": "CreditCheckCompletedEvent",
      "type": "creditCheckCompleteType",
      "source": "creditCheckSource",
      "correlation": [
        {
          "contextAttributeName": "customerId"
        }
      ]
    }
  ],
  "states": [
    {
      "name": "CheckCredit",
      "type": "callback",
      "start": {
        "kind": "default"
      },
      "action": {
        "functionRef": {
          "refName": "callCreditCheckMicroservice",
          "parameters": {
            "customer": "{{ $.customer }}"
          }
        }
      },
      "eventRef": "CreditCheckCompletedEvent",
      "transition": {
        "nextState": "EvaluateDecision"
      }
    },
    {
      "name": "EvaluateDecision",
      "type": "switch",
      "dataConditions": [
        {
          "condition": "{{ $.creditCheck[?(@.decision == 'Approved')] }}",
          "transition": {
            "nextState": "StartApplication"
          }
        },
        {
          "condition": "{{ $.creditCheck[?(@.decision == 'Denied')] }}",
          "transition": {
            "nextState": "RejectApplication"
          }
        }
      ],
      "defaultCondition": {
        "transition": {
          "nextState": "RejectApplication"
        }
      }
    },
    {
      "name": "StartApplication",
      "type": "operation",
      "actions": [
        {
          "subFlowRef": "startApplicationWorkflowId"
        }
      ],
      "end": {
        "kind": "default"
      }
    },
    {
      "name": "RejectApplication",
      "type": "operation",
      "actionMode": "sequential",
      "actions": [
        {
          "functionRef": {
            "refName": "sendRejectionEmailFunction",
            "parameters": {
              "applicant": "{{ $.customer }}"
            }
          }
        }
      ],
      "end": {
        "kind": "default"
      }
    }
  ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Serverless Workflow definition for credit check (YAML)</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">id: customercreditcheck
version: '1.0'
name: Customer Credit Check Workflow
description: Perform Customer Credit Check
functions:
- name: callCreditCheckMicroservice
  resource: creditCheckResource
  type: microservice
- name: sendRejectionEmailFunction
  resource: rejectEmailResource
events:
- name: CreditCheckCompletedEvent
  type: creditCheckCompleteType
  source: creditCheckSource
  correlation:
  - contextAttributeName: customerId
states:
- name: CheckCredit
  type: callback
  start:
    kind: default
  action:
    functionRef:
      refName: callCreditCheckMicroservice
      parameters:
        customer: "{{ $.customer }}"
  eventRef: CreditCheckCompletedEvent
  transition:
    nextState: EvaluateDecision
- name: EvaluateDecision
  type: switch
  dataConditions:
  - condition: "{{ $.creditCheck[?(@.decision == 'Approved')] }}"
    transition:
      nextState: StartApplication
  - condition: "{{ $.creditCheck[?(@.decision == 'Denied')] }}"
    transition:
      nextState: RejectApplication
  defaultCondition:
    transition:
      nextState: RejectApplication
- name: StartApplication
  type: operation
  actions:
    - subFlowRef: startApplicationWorkflowId
  end:
    kind: default
- name: RejectApplication
  type: operation
  actionMode: sequential
  actions:
  - functionRef:
      refName: sendRejectionEmailFunction
      parameters:
        applicant: "{{ $.customer }}"
  end:
    kind: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more Serverless Workflow definition examples in Kogito, see the <a href="https://github.com/apache/incubator-kie-kogito-examples">kogito-examples</a> repository in GitHub.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Continue adding and defining any remaining components for your workflow definition files and save the completed files.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you define your serverless workflow definitions, you can build and deploy your Kogito services as usual to your preferred cloud or container platform, such as OpenShift. When an event trigger occurs, your application orchestrates your Kogito services according to the workflow definition or definitions that you have defined. If you are using a serverless deployment platform, such as OpenShift Serverless, your application automatically scales up based on incoming demand, or scales to zero after use.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a></p>
</li>
</ul>
</div>
<div class="paragraph _additional-resources">
<p>== Additional resources
* <a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Developing decision services with Kogito</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Configuring Kogito supporting services and runtime capabilities</em></a></p>
</div>
<div id="con-serverless-workflow-error-handling_kogito-developing-decision-services" class="paragraph">
<p>== Error handling in Serverless Workflow</p>
</div>
<div class="paragraph">
<p>You can handle the exceptions that are thrown by <code>operation</code> nodes as described in the <a href="https://github.com/serverlessworkflow/specification/blob/0.8.x/specification.md#Workflow-Error-Handling">Serverless Workflow Specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You need to specify the qualified name of the exception that might be thrown by the <code>operation</code> in the <code>code</code> field of the error definition.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/serverless-workflow-error-quarkus">serverless-workflow-error-quarkus</a> is an example application that invokes an <code>EvenService</code>, which is throwing <code>IllegalArgumentException</code> if the number in the workflow model is odd.</p>
</div>
<div id="chap-kogito-configuring" class="paragraph">
<p>= Configuring Kogito supporting services and runtime capabilities
:parent-context: kogito-developing-decision-services
:context: kogito-configuring</p>
</div>
<div class="paragraph _abstract">
<p>As a developer of business processes and decisions, you can configure Kogito supporting services and runtime properties for advanced use cases with your Kogito services.</p>
</div>
<div id="con-kogito-supporting-services-and-configuration_kogito-developing-decision-services" class="paragraph">
<p>== Kogito supporting services and runtime configuration</p>
</div>
<div class="paragraph _abstract">
<p>Kogito supporting services consist of middleware infrastructure services and other dedicated services that help you build additional functionality in the Kogito domain-specific services that you develop.</p>
</div>
<div class="paragraph">
<p>Kogito supports the following key middleware infrastructure services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Infinispan persistence</p>
</li>
<li>
<p>Apache Kafka reactive messaging</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Kogito also provides the following dedicated services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kogito Data Index Service indexing and querying</p>
</li>
<li>
<p>Kogito Jobs Service job scheduling</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Kogito runtime supports various configuration options for these supporting services and for other capabilities, such as the following examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom event listeners</p>
</li>
<li>
<p>Prometheus metrics monitoring</p>
</li>
<li>
<p>Process instance management</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These supporting services, runtime configurations, and Kogito add-on components enable you to optimize your Kogito domain-specific services for your business automation requirements.</p>
</div>
<div id="ref-kogito-runtime-properties_kogito-developing-decision-services" class="paragraph">
<p>== Kogito runtime properties quick reference</p>
</div>
<div class="paragraph _abstract">
<p>The following table serves as a quick reference for commonly used runtime configuration properties supported by Kogito. You can define these properties in the <code>src/main/resources/application.properties</code> file of the relevant Kogito project or by using the <code>-D</code> prefix during application start-up.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some of these properties might require accompanying dependencies in the relevant Kogito project to enable the specified capability. For more information about dependency requirements, review the sections of the Kogito configuration documentation that relate to that property.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 120. Common runtime properties in Kogito</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 45%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Relevance</th>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.events.processinstances.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determines whether runtime events are published for process instances, either <code>true</code> or <code>false</code></p>
</div>
<div class="paragraph">
<p>Default value: <code>true</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.events.processinstances.enabled=true</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.events.usertasks.enabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether runtime events are published for user task instances, either <code>true</code> or <code>false</code></p>
<p class="tableblock">Default value: <code>true</code></p>
<p class="tableblock">Example: <code>kogito.events.usertasks.enabled=true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.events.variables.enabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether runtime events are published for process instances variables, either <code>true</code> or <code>false</code></p>
<p class="tableblock">Default value: <code>true</code></p>
<p class="tableblock">Example: <code>kogito.events.variables.enabled=true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.messaging.as-cloudevents</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether messages (sent or received through message events) are published in CloudEvents format, either <code>true</code> of <code>false</code></p>
<p class="tableblock">Example: <code>kogito.messaging.as-cloudevents=true</code></p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Infinispan persistence</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>quarkus.infinispan-client.server-list</code></p>
</div>
<div class="paragraph">
<p>For Spring Boot: <code>infinispan.remote.server-list</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the location where an Infinispan Server is running, typically used to connect your application to Infinispan for persistence</p>
</div>
<div class="paragraph">
<p>Example: <code>quarkus.infinispan-client.server-list=localhost:11222</code></p>
</div>
<div class="paragraph">
<p>For Spring Boot: <code>infinispan.remote.server-list=127.0.0.1:11222</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>quarkus.infinispan-client.auth-username</code></p>
</div>
<div class="paragraph">
<p><code>quarkus.infinispan-client.auth-password</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the Infinispan user name and password to authenticate Infinispan persistence capabilities in the relevant application, if required, such as in the Kogito Data Index Service</p>
<p class="tableblock">Examples:</p>
<p class="tableblock"><code>quarkus.infinispan-client.auth-username=admin</code></p>
<p class="tableblock"><code>quarkus.infinispan-client.auth-password=admin123</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.persistence.infinispan.template</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines an optional template name of the Infinispan cache configuration to be used to persist process instance data</p>
<p class="tableblock">Example: <code>kogito.persistence.infinispan.template=MyTemplate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka messaging</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Incoming:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.connector</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.topic</code> (Optional, defaults to <code>kogito_incoming_stream</code>)</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.value.deserializer</code></p>
</div>
<div class="paragraph">
<p>Outgoing:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.connector</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.topic</code> (Optional, defaults to <code>kogito_outgoing_stream</code>)</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.value.serializer</code></p>
</div>
<div class="paragraph">
<p>Spring Boot:</p>
</div>
<div class="paragraph">
<p><code>kafka.bootstrapAddress</code></p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_incoming_stream</code> (Optional, defaults to <code>kogito_incoming_stream</code>)</p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_outgoing_stream</code> (Optional, defaults to <code>kogito_outgoing_stream</code>)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the connector, topic, and deserializer for the incoming and outgoing messages and channels for reactive messaging with Apache Kafka</p>
</div>
<div class="paragraph">
<p>Examples for incoming:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.topic=travellers</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.incoming.kogito_incoming_stream.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer</code></p>
</div>
<div class="paragraph">
<p>Examples for outgoing:</p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-kafka</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.topic=processedtravellers</code></p>
</div>
<div class="paragraph">
<p><code>mp.messaging.outgoing.kogito_outgoing_stream.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></p>
</div>
<div class="paragraph">
<p>Examples for Spring Boot:</p>
</div>
<div class="paragraph">
<p><code>kafka.bootstrapAddress=localhost:9092</code></p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_incoming_stream=travellers</code></p>
</div>
<div class="paragraph">
<p><code>kogito.addon.cloudevents.kafka.kogito_outgoing_stream=processedtravellers</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="7"><p class="tableblock">Kogito Jobs Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.service.url</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the location where the Kogito service is deployed, typically used by the Jobs Service to find the source of the jobs</p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.service.url=http://localhost:8080</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>kogito.jobs-service.url</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the callback URL that posts to a running Kogito Jobs Service</p>
<p class="tableblock">Example: <code>kogito.jobs-service.url=http://localhost:8085</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.backoffRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Defines the retry back-off time in milliseconds between job execution attempts, in case the execution fails</p>
</div>
<div class="paragraph">
<p>Default value: <code>1000</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.jobs-service.backoffRetryMillis=1000</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.maxIntervalLimitToRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Defines the maximum interval in milliseconds when retrying to execute jobs, in case the execution fails</p>
</div>
<div class="paragraph">
<p>Default value: <code>60000</code></p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.jobs-service.maxIntervalLimitToRetryMillis=60000</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Identifies the Kafka bootstrap server address with the port used to publish events</p>
</div>
<div class="paragraph">
<p>Default value: <code>localhost:9092</code></p>
</div>
<div class="paragraph">
<p>Example: <code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers=localhost:9092</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Specified in Jobs Service) Defines the name of the Kafka topic where the events are published</p>
</div>
<div class="paragraph">
<p>Default value: <code>kogito-jobs-events</code></p>
</div>
<div class="paragraph">
<p>Example: <code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic=kogito-jobs-events</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>resteasy.jaxrs.scan-packages</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>(Spring Boot only) Lists comma-separated package names that contain REST endpoint Java classes. Sub-packages are automatically scanned. Wildcard notation is supported. Packages generated by DMN namespaces typically start with <code>http</code>.</p>
</div>
<div class="paragraph">
<p>Example: <code>resteasy.jaxrs.scan-packages=org.kie.kogito.example,http*</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST endpoint generation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.generate.rest</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Disables the REST endpoints generation globally.</p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.generate.rest=false</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST endpoint generation for a specific resource</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>kogito.generate.rest.decisions</code></p>
</li>
<li>
<p><code>kogito.generate.rest.predictions</code></p>
</li>
<li>
<p><code>kogito.generate.rest.processes</code></p>
</li>
<li>
<p><code>kogito.generate.rest.rules</code></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Disables the REST endpoints generation for a specific resource.</p>
</div>
<div class="paragraph">
<p>Example: In your project, which contains <code>.dmn</code> and <code>.bpmn</code> files, you can disable only the decision REST endpoints using <code>kogito.generate.decisions=false</code> property .</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Index service protobuf generation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.persistence.data-index.proto.generation</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Disables the generation of protobuf files used by Data Index service. The protobuf files are used for domain-specific queries when the storage supports, such as Infinispan and MongoDB. In other cases, the protobuf files are not necessary and can be skipped. The default value of this property is <code>true</code>.</p>
</div>
<div class="paragraph">
<p>Example: <code>kogito.persistence.data-index.proto.generation=false</code> to disable the generation of a protobuf file.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kogito runtime protobuf marshaller generation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.persistence.proto.marshaller</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Disables the generation of domain-specific protobuf marshaller to serialize process variables. When setting this property to <code>false</code>, Kogito leverages Java serialization to persist process variables. The default value of this property is <code>true</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The types of process variables must implement <code>java.io.Serializable</code> when protobuf marshaller generation is disabled.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Java serialization strategy does not work when using native build.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example: <code>kogito.persistence.data-index.proto.generation=false</code> to disable the generation of a protobuf file.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div id="con-kogito-runtime-events_kogito-developing-decision-services" class="paragraph">
<p>== Kogito runtime events</p>
</div>
<div class="paragraph _abstract">
<p>A runtime event is record of a significant change of state in the application domain at a point in time. Kogito emits runtime events as a result of successfully executed requests, or <em>units of work</em>, in a process instance or task instance in a process. Kogito can use these events to notify third parties about changes to the BPMN process instance and its data.</p>
</div>
<div class="paragraph">
<p>=== Process instance events</p>
</div>
<div class="paragraph">
<p>For every executed process instance, an event is generated that contains information for that instance, such as the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Process instance metadata, such as the process definition ID, process instance ID, process instance state, and other identifying information</p>
</li>
<li>
<p>Node instances that have been triggered during the execution</p>
</li>
<li>
<p>Variables used and the current state of variables after the execution</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These events provide a complete view of the process instances being executed and can be consumed by an event listener, such as a <code>ProcessEventListener</code> configuration.</p>
</div>
<div class="paragraph">
<p>If multiple processes are executed within a single request (unit of work), each process instance is given a dedicated event.</p>
</div>
<div class="paragraph">
<p>The following event is an example process instance event generated after the request was executed successfully:</p>
</div>
<div class="listingblock">
<div class="title">Example process instance event</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "specversion": "0.3",
  "id": "f52af50c-4fe2-4581-9184-7ad48137fb3f",
  "source": null,
  "type": "ProcessInstanceEvent",
  "time": "2019-08-05T17:47:49.019494+02:00[Europe/Warsaw]",
  "data": {
    "id": "c1aced49-399b-4938-9071-b2ffa3fb7045",
    "parentInstanceId": null,
    "rootInstanceId": null,
    "processId": "deals",
    "processName": "SubmitDeal",
    "startDate": 1565020069015,
    "endDate": null,
    "state": 1,
    "nodeInstances": [
      {
        "id": "a8fe24c4-27a5-4869-85df-16e9f170f2c4",
        "nodeId": "2",
        "nodeDefinitionId": "CallActivity_1",
        "nodeName": "Call a deal",
        "nodeType": "SubProcessNode",
        "triggerTime": 1565020069015,
        "leaveTime": null
      },
      {
        "id": "7a3bf1b1-b167-4928-969d-20bddf16c87a",
        "nodeId": "1",
        "nodeDefinitionId": "StartEvent_1",
        "nodeName": "StartProcess",
        "nodeType": "StartNode",
        "triggerTime": 1565020069015,
        "leaveTime": 1565020069015
      }
    ],
    "variables": {
      "name": "my fancy deal",
      "traveller": {
        "firstName": "John",
        "lastName": "Doe",
        "email": "jon.doe@example.com",
        "nationality": "American",
        "address": {
          "street": "main street",
          "city": "Boston",
          "zipCode": "10005",
          "country": "US"
        }
      }
    }
  },
  "kogitoprocinstanceid": "c1aced49-399b-4938-9071-b2ffa3fb7045",
  "kogitoparentprociid": null,
  "kogitorootprociid": null,
  "kogitoprocid": "deals",
  "kogitoprocist": "1"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event is in <a href="https://cloudevents.io/">CloudEvents</a> format so that it can be consumed efficiently by other entities.</p>
</div>
<div class="paragraph">
<p>The event data also includes the following extensions to enable event routing based on the event metadata without requiring the body of the event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogitoprocinstanceid</code></p>
</li>
<li>
<p><code>kogitoparentprociid</code></p>
</li>
<li>
<p><code>kogitorootprociid</code></p>
</li>
<li>
<p><code>kogitoprocid</code></p>
</li>
<li>
<p><code>kogitoprocist</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== User task instance events</p>
</div>
<div class="paragraph">
<p>If an executed request (unit of work) in a process instance interacts with a user task, an event is generated for that user task and contains information for the task instance, such as the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Task metadata, such as the task description, priority, start and complete dates, and other identifying information</p>
</li>
<li>
<p>Task input and output data</p>
</li>
<li>
<p>Task assignments, such as the task owner, potential users and groups, business administrator and business administrator groups, or excluded users</p>
</li>
<li>
<p>Task reference name that should be used to interact with the task using the Kogito service endpoints</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following event is an example user task instance event generated after the relevant request was executed successfully:</p>
</div>
<div class="listingblock">
<div class="title">Example user task instance event</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "data": {
    "adminGroups": [],
    "adminUsers": [],
    "excludedUsers": [],
    "id": "4d899471-19dd-485d-b7f4-b313185d430d",
    "inputs": {
      "Locale": "en-UK",
      "trip": {
        "begin": "2019-09-22T22:00:00Z[UTC]",
        "city": "Boston",
        "country": "US",
        "end": "2019-09-26T22:00:00Z[UTC]",
        "visaRequired": true
      },
      "TaskName": "VisaApplication",
      "NodeName": "Apply for visa",
      "Priority": "1",
      "Skippable": "true",
      "traveller": {
        "address": {
          "city": "Krakow",
          "country": "Poland",
          "street": "Polna",
          "zipCode": "12345"
        },
        "email": "jan.kowalski@email.com",
        "firstName": "Jan",
        "lastName": "Kowalski",
        "nationality": "Polish"
      }
    },
    "outputs": {},
    "potentialGroups": [],
    "potentialUsers": [],
    "processId": "travels",
    "processInstanceId": "63c297cb-f5ac-4e20-8254-02f37bd72b80",
    "referenceName": "VisaApplication",
    "startDate": "2019-09-16T15:22:26.658Z[UTC]",
    "state": "Ready",
    "taskName": "Apply for visa",
    "taskPriority": "1"
  },
  "id": "9c340cfa-c9b6-46f2-a048-e1114b077a7f",
  "kogitoprocid": "travels",
  "kogitoprocinstanceid": "63c297cb-f5ac-4e20-8254-02f37bd72b80",
  "kogitousertaskiid": "4d899471-19dd-485d-b7f4-b313185d430d",
  "kogitousertaskist": "Ready",
  "source": "http://localhost:8080/travels",
  "specversion": "0.3",
  "time": "2019-09-16T17:22:26.662592+02:00[Europe/Berlin]",
  "type": "UserTaskInstanceEvent"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The event data also includes the following extensions to enable event routing based on the event metadata without requiring the body of the event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogitousertaskiid</code></p>
</li>
<li>
<p><code>kogitousertaskist</code></p>
</li>
<li>
<p><code>kogitoprocinstanceid</code></p>
</li>
<li>
<p><code>kogitoprocid</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Event publishing</p>
</div>
<div class="paragraph">
<p>Kogito generates events only when at least one publisher is configured. A Kogito service environment can have many event publishers that publish these events into different channels.</p>
</div>
<div class="paragraph">
<p>By default, Kogito includes the following message-based event publishers, depending on your application framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>For Quarkus</strong>: <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a> for sending events using Apache Kafka, Apache Camel, Advanced Message Queuing Protocol (AMQP), or MQ Telemetry Transport (MQTT)</p>
</li>
<li>
<p><strong>For Spring Boot</strong>: <a href="https://spring.io/projects/spring-kafka">Spring for Apache Kafka</a> for sending events using Kafka</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enable or disable event publishing, you can adjust the following properties in the <code>src/main/resources/application.properties</code> file in your Kogito project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>kogito.events.processinstances.enabled</code>: Enables or disables publishing process instance events (default: <code>true</code>)</p>
</li>
<li>
<p><code>kogito.events.usertasks.enabled</code>: Enables or disables publishing user task instance events (default: <code>true</code>)</p>
</li>
<li>
<p><code>kogito.events.variables.enabled</code>: Enables or disables publishing process instances variables events (default: <code>true</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To develop additional event publishers, you can implement the <code>org.kie.kogito.event.EventPublisher</code> implementation and include the required annotations for JavaBeans discovery.</p>
</div>
<div id="proc-messaging-enabling_kogito-developing-decision-services" class="paragraph">
<p>== Enabling Kafka messaging for Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>Kogito supports the <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> specification for messaging in your services. You can enable messaging to configure message events as either input or output of business process execution.</p>
</div>
<div class="paragraph">
<p>For example, the following <code>handle-travelers.bpmn2</code> process uses messaging start and end events to communicate with travelers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-example.png" alt="Image of message-based process">
</div>
<div class="title">Figure 242. Example process with messaging start and end events</div>
</div>
<div class="paragraph">
<p>In this example, the message start and end events require the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Message name that maps to the channel that delivers messages</p>
</li>
<li>
<p>Message payload that maps to a process instance variable</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-start-event.png" alt="Image of message start event data">
</div>
<div class="title">Figure 243. Example message configuration for start event</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/bpmn/bpmn-messaging-end-event.png" alt="Image of message end event data">
</div>
<div class="title">Figure 244. Example message configuration for end event</div>
</div>
<div class="paragraph">
<p>For this procedure, the messaging is based on <a href="https://kafka.apache.org/">Apache Kafka</a> as the event publisher, so you must have Kafka installed in order to enable messaging. Your marshalling configuration depends on the messaging solution that you use.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed and includes any required topics. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-smallrye-reactive-messaging-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kogito-addons-quarkus-events-process&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
  &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-events-process-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
  &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the incoming and outgoing messaging channels and properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>On Quarkus</strong>: Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the incoming and outgoing messages and channels:</p>
<div class="listingblock">
<div class="title">Configure incoming and outgoing messages and channels</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.incoming.kogito_incoming_stream.connector=smallrye-kafka
mp.messaging.incoming.kogito_incoming_stream.topic=travellers
mp.messaging.incoming.kogito_incoming_stream.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.outgoing.kogito_outgoing_stream.connector=smallrye-kafka
mp.messaging.outgoing.kogito_outgoing_stream.topic=processedtravellers
mp.messaging.outgoing.kogito_outgoing_stream.value.serializer=org.apache.kafka.common.serialization.StringSerializer</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace <code>travellers</code> with the name of the message start event.
Replace <code>processedtravellers</code> with the name of the message end event.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To prevent execution errors due to long wait times with messaging, you can also use the following property to disable waiting for message completion:</p>
</div>
<div class="listingblock">
<div class="title">Disable message wait time</div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.[channel-name].waitForWriteCompletion=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>On Spring Boot</strong>: Add the following property to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the messaging channel:</p>
<div class="listingblock">
<div class="title">Configure messaging channel</div>
<div class="content">
<pre class="highlight"><code>kafka.bootstrapAddress=localhost:9092
kogito.addon.cloudevents.kafka.kogito_incoming_stream=travellers
kogito.addon.cloudevents.kafka.kogito_outgoing_stream=processedtravellers</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example Kogito services with Kafka messaging, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-kafka-quickstart-quarkus"><code>process-kafka-quickstart-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-kafka-quickstart-springboot"><code>process-kafka-quickstart-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="proc-events-mongodb-debezium_kogito-developing-decision-services" class="paragraph">
<p>=== Applying outbox pattern in Kogito events using MongoDB and Debezium</p>
</div>
<div class="paragraph _abstract">
<p>To avoid the data inconsistencies in process services, the Kogito services must update the process data and publish events within a unit of work entirely, but not partially. However, Apache Kafka does not support distributed transactions. In order to resolve this problem, you can apply the outbox pattern with Kogito service.</p>
</div>
<div class="paragraph">
<p>When you store the data of a process service in a unit of work, you can also add the records that represent the events to be sent into the outbox tables in the same transaction. After that, a separate message relay process publishes the events that are added into the outbox tables to Kafka broker asynchronously. For more information about the outbox pattern, see <a href="https://debezium.io/blog/2019/02/19/reliable-microservices-data-exchange-with-the-outbox-pattern/">Debezium blog</a>.</p>
</div>
<div class="paragraph">
<p><a href="https://debezium.io/">Debezium</a> is useful for message relay, which comes with <code>Change Data Capture</code> connectors for various databases, such as MongoDB. It captures new entries in MongoDB collections and stream those entries to Apache Kafka.</p>
</div>
<div class="paragraph">
<p>Kogito enables you to store the data of a process and events of the same unit of work in a single transaction using MongoDB.</p>
</div>
<div class="paragraph">
<p>For this procedure, a Kogito service is configured to store the process data and events in a single transaction using MongoDB. Also, a Debezium MongoDB connector is configured and started to stream the events from MongoDB collections to Apache Kafka topics.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed and includes required topics. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
<li>
<p><a href="https://www.mongodb.com/">MongoDB</a> version 4.4 or later is installed, started, and <code>oplog</code> is enabled. For information about MongoDB setting up for Debezium, see the <a href="https://debezium.io/documentation/reference/connectors/mongodb.html#setting-up-mongodb">MongoDB connector documentation</a>.</p>
</li>
<li>
<p><a href="https://debezium.io/">Debezium</a> version 1.7 or later is installed and started. For information about Debezium installation and configuration, see the <a href="https://debezium.io/documentation/reference/">Debezium documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project to store Kogito events to MongoDB:</p>
</li>
</ol>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-addons-quarkus-events-mongodb&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.kie&lt;/groupId&gt;
    &lt;artifactId&gt;kie-addons-springboot-events-mongodb&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the MongoDB database and collections for Kogito services to store the Kogito events to the MongoDB collections:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Add properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the MongoDB database and collections as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">Properties to configure MongoDB database</div>
<div class="content">
<pre class="highlight"><code>kogito.events.database=kogito
kogito.events.processinstances.collection=kogitoprocessinstancesevents
kogito.events.usertasks.collection=kogitousertaskinstancesevents
kogito.events.variables.collection=kogitovariablesevents</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable MongoDB persistence for Kogito services to use MongoDB as a runtime persistence. For more information, see <a href="#proc-mongodb-persistence-enabling_kogito-configuring">[proc-mongodb-persistence-enabling_kogito-configuring]</a>.</p>
</li>
<li>
<p>Build your Kogito project and start the Kogito service.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ensure that you enable MongoDB transaction by adding the following property to the <code>src/main/resources/application.properties</code> file in your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Property to enable MongoDB transaction</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.transaction.enabled=true</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you add the previous property to your Kogito project, the process data and events that are generated in the same unit of work, are stored to MongoDB in the same transaction. This procedure avoids potential inconsistencies.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start Debezium MongoDB connector to stream Kogito events from MongoDB collections to Kafka topics:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Follow the <a href="https://debezium.io/documentation/reference/connectors/mongodb.html#mongodb-deploying-a-connector">Debezium MongoDB connector deployment instructions</a> to install the Debezium MongoDB connector, configure the connector, and start the connector.</p>
</div>
<div class="paragraph">
<p>Use the following example configuration to configure the Debezium MongoDB connector, which captures the events from MongoDB collections and stream the events to Kafka topics:</p>
</div>
<div class="listingblock">
<div class="title">Example configuration for Debezium MongoDB connector</div>
<div class="content">
<pre class="highlight"><code>{
  "name": "kogito-connector",
  "config": {
    "connector.class" : "io.debezium.connector.mongodb.MongoDbConnector",
    "tasks.max" : "1",
    "mongodb.hosts" : "rs0/mongodb:27017",
    "mongodb.name" : "dbserver1",
    "mongodb.user" : "debezium",
    "mongodb.password" : "dbz",
    "database.include" : "kogito",
    "database.history.kafka.bootstrap.servers" : "kafka:9092",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "false",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "false",
    "collection.include.list": "kogito.kogitoprocessinstancesevents,kogito.kogitousertaskinstancesevents,kogito.kogitovariablesevents",
    "transforms": "unwrap,reroute",
    "transforms.unwrap.type": "io.debezium.connector.mongodb.transforms.ExtractNewDocumentState",
    "transforms.unwrap.array.encoding": "array",
    "transforms.unwrap.drop.tombstones": "false",
    "transforms.unwrap.delete.handling.mode": "drop",
    "transforms.unwrap.operation.header": "false",
    "transforms.reroute.type": "io.debezium.transforms.ByLogicalTableRouter",
    "transforms.reroute.topic.regex": "(.*)kogito(.*)events(.*)",
    "transforms.reroute.topic.replacement": "kogito-$2-events",
    "transforms.reroute.key.enforce.uniqueness": "false",
    "skipped.operations": "u,d",
    "tombstones.on.delete": "false"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous example configuration, replace the server host, port, replica set, database, and collections information according to your MongoDB, Kafka installation, and Kogito project configuration.</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can also use the following example applications for consistency in a Kogito service using MongoDB and Debezium:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-outbox-mongodb-quarkus"><code>process-outbox-mongodb-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-outbox-mongodb-springboot"><code>process-outbox-mongodb-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="proc-event-listeners-registering_kogito-developing-decision-services" class="paragraph">
<p>=== Registering event listeners</p>
</div>
<div class="paragraph _abstract">
<p>You can register custom event listeners to detect and publish events that are not published by Kogito by default. Your custom event listener configuration must implement the relevant implementation for either processes or rules.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create an event listener configuration class for either process or rule events, such as a <code>ProcessEventListenerConfig</code> class or a <code>RuleEventListenerConfig</code> class.</p>
</li>
<li>
<p>In your event listener configuration class, extend the default implementation of the configuration class as part of your listener definition:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Implementation for process events: <code>org.kie.kogito.process.impl.DefaultProcessEventListenerConfig</code></p>
</li>
<li>
<p>Implementation for rule events: <code>org.drools.core.config.DefaultRuleEventListenerConfig</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example process event listener with extended default implementation</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class ProcessEventListenerConfig extends DefaultProcessEventListenerConfig {

    public ProcessEventListenerConfig() {
        super(new CustomProcessEventListener());
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example rule event listener with extended default implementation</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@ApplicationScoped
public class RuleEventListenerConfig extends DefaultRuleEventListenerConfig {

    public RuleEventListenerConfig() {
        super(new CustomRuleEventListener());
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These configuration classes must be injectable, so ensure that you properly annotate the classes, such as with the annotations <code>@ApplicationScoped</code> or <code>@Component</code>, so that they can be found and registered.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you can implement the relevant event listener interface instead of extending the default implementation, but this approach excludes other listeners provided by Kogito.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interface for process events: <code>org.kie.kogito.process.ProcessEventListenerConfig</code></p>
</li>
<li>
<p>Interface for rule events: <code>org.kie.kogito.rules.RuleEventListenerConfig</code></p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After the event listener is configured, package the listener configuration class in the <code>src/main/java</code> folder of the relevant application or add it as dependency in the <code>pom.xml</code> file of the application to make the listener available.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>== Metrics monitoring in Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>Kogito supports metrics monitoring modules powered by <a href="https://micrometer.io/">Micrometer</a>, so you can export your metrics to any monitoring system supported by Micrometer. The primary monitoring module in Kogito is based on <a href="https://prometheus.io/">Prometheus</a>, which enables you to collect and store metrics related to your Kogito assets, and then visualize those metrics through a configured data-graphing tool such as <a href="https://grafana.com/">Grafana</a>.</p>
</div>
<div class="paragraph">
<p>As an alternative to Prometheus, you can also use <a href="https://www.elastic.co/elastic-stack">Elasticsearch</a> metrics monitoring with your Kogito services, or you can subscribe to any Micrometer registry using an API exposed by the Kogito monitoring library.</p>
</div>
<div id="proc-prometheus-metrics-monitoring_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Prometheus metrics monitoring in Kogito</p>
</div>
<div class="paragraph _abstract">
<p><a href="https://prometheus.io/">Prometheus</a> is an open source systems monitoring toolkit that you can use with Kogito to collect and store metrics related to the execution of Business Process Model and Notation (BPMN) process models, business rules, and Decision Model and Notation (DMN) decision models. You can access the stored metrics through a REST API call to a configured application endpoint, through the Prometheus expression browser, or using a data-graphing tool such as <a href="https://grafana.com/">Grafana</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Prometheus is installed. For information about downloading and using Prometheus, see the <a href="https://prometheus.io/docs/introduction/overview/">Prometheus documentation page</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your Kogito project, depending on the framework you are using, add one of the following dependencies to the <code>pom.xml</code> file to enable the Prometheus add-on:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Add dependency for Prometheus Quarkus add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-monitoring-prometheus&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Add dependency for Prometheus Springboot add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-monitoring-prometheus&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, all stored metrics are exported to the configured monitoring module. If you want to disable certain metrics from being exported, you can set any of the following properties in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Enable or disable specific metrics from being exported</div>
<div class="content">
<pre class="highlight"><code>kogito.monitoring.rule.useDefault=false
kogito.monitoring.process.useDefault=false
kogito.monitoring.interceptor.useDefault=false</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>prometheus.yaml</code> file of your Prometheus distribution, add the following settings in the <code>scrape_configs</code> section to configure Prometheus to scrape metrics from your Kogito service:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example scrape configurations in <code>prometheus.yaml</code> file</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">scrape_configs:
  job_name: 'kogito-metrics'
metrics_path: /q/metrics
static_configs:
  - targets: ["localhost:8080"]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For Spring Boot application, the metrics path is <code>/actuator/prometheus</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace the values according to your Kogito service settings.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a command terminal, navigate to your Kogito project and run the project using your preferred run mode, such as development mode:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you start your Kogito service, Prometheus begins collecting metrics and Kogito publishes the metrics to the configured REST API endpoint.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To verify the metrics configuration, use a REST client or curl utility to send a <code>GET</code> request to the configured endpoint as follows:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to return Prometheus metrics from a Quarkus application</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/q/metrics</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example curl command to return Prometheus metrics from a Spring Boot application</div>
<div class="content">
<pre class="highlight"><code>curl -X GET http://localhost:8080/actuator/prometheus</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example response</div>
<div class="content">
<pre class="highlight"><code># HELP kogito_process_instance_completed_total Completed Process Instances
# TYPE kogito_process_instance_completed_total counter
# HELP kogito_process_instance_started_total Started Process Instances
# TYPE kogito_process_instance_started_total counter
kogito_process_instance_started_total{app_id="acme-travels",process_id="travels",} 1.0
# HELP kogito_work_item_duration_seconds Work Items Duration
# TYPE kogito_work_item_duration_seconds summary
# HELP drl_match_fired_nanosecond Drools Firing Time
# TYPE drl_match_fired_nanosecond histogram
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="1000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="2000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="3000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="4000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="5000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="6000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="7000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="8000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="9000000.0",} 1.0
drl_match_fired_nanosecond_bucket{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",le="+Inf",} 1.0
drl_match_fired_nanosecond_count{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",} 1.0
drl_match_fired_nanosecond_sum{identifier="acme-travels",rule_name="Brazilian citizens require visa to Australia",} 789941.0
# HELP kogito_process_instance_sla_violated_total Process Instances SLA Violated
# TYPE kogito_process_instance_sla_violated_total counter
# HELP kogito_process_instance_duration_seconds Process Instances Duration
# TYPE kogito_process_instance_duration_seconds summary
# HELP kogito_process_instance_running_total Running Process Instances
# TYPE kogito_process_instance_running_total gauge
kogito_process_instance_running_total{app_id="acme-travels",process_id="travels",} 1.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the metrics are not available at the defined endpoint, review and verify the Kogito and Prometheus configurations described in this section.</p>
</div>
<div class="paragraph">
<p>You can also interact with your collected metrics and application targets in the Prometheus expression browser at <code>http://<em>HOST:PORT</em>/graph</code> and <code>http://<em>HOST:PORT</em>/targets</code>, or integrate your Prometheus data source with a data-graphing tool such as Grafana:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/prometheus-expression-browser-targets.png" alt="Image of targets in Prometheus expression browser">
</div>
<div class="title">Figure 245. Prometheus expression browser with Kogito service targets</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/prometheus-grafana-data.png" alt="Image of application metrics in Grafana">
</div>
<div class="title">Figure 246. Grafana dashboard with Kogito service metrics</div>
</div>
<div class="openblock">
<div class="content">
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://prometheus.io/docs/prometheus/latest/getting_started/">Getting Started with Prometheus</a></p>
</li>
<li>
<p><a href="https://prometheus.io/docs/visualization/grafana/">Grafana Support for Prometheus</a></p>
</li>
<li>
<p><a href="https://grafana.com/docs/grafana/latest/features/datasources/prometheus/">Using Prometheus in Grafana</a></p>
</li>
</ul>
</div>
<div id="con-grafana-dashboards-metrics-monitoring_kogito-developing-decision-services" class="paragraph">
<p>==== Grafana dashboards for default metrics in Kogito</p>
</div>
<div class="paragraph _abstract">
<p>If any of the Prometheus monitoring modules are imported as dependencies in the <code>pom.xml</code> file of your Kogito project, some Grafana dashboards that use the default metrics are generated under the folder <code>target/classes/META-INF/resources/monitoring/dashboards/</code> every time you compile your Kogito service.</p>
</div>
<div class="paragraph">
<p>Two types of dashboards are exported depending on the decision model used on the endpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Operational dashboard</strong>: This dashboard is generated for DMN and DRL endpoints and contains the following metrics:</p>
<div class="ulist">
<ul>
<li>
<p>Total number of requests on the endpoint</p>
</li>
<li>
<p>Average number of requests per minute on the endpoint</p>
</li>
<li>
<p>Quantiles on the elapsed time to evaluate the requests</p>
</li>
<li>
<p>Exception details</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/grafana-operational-dashboard.png" alt="Generated operational dashboard">
</div>
<div class="title">Figure 247. Generated operational dashboard example</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Domain-specific dashboard</strong>: Currently this dashboard is exported only for DMN endpoints. The domain-specific dashboard contains a graph for each type of decision in the DMN model. Only the built-in types <code>number</code>, <code>string</code>, and <code>boolean</code> are currently supported.</p>
<div class="ulist">
<ul>
<li>
<p>If the output of the decision is a <code>number</code> type, the graph contains the quantiles for that metric on a sliding window of 3 minutes.</p>
</li>
<li>
<p>If the output is a <code>boolean</code> or a <code>string</code> type, the graph contains the number of occurrences for each output on a 10-minute average.</p>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/grafana-domain-dashboard.png" alt="Generated domain specific dashboard">
</div>
<div class="title">Figure 248. Generated domain-specific dashboard example</div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Generated dashboards for BPMN resources are currently not supported.
</td>
</tr>
</table>
</div>
<div id="con-grafana-custom-dashboards_kogito-developing-decision-services" class="paragraph">
<p>==== Custom Grafana dashboards in Kogito</p>
</div>
<div class="paragraph _abstract">
<p>You can add custom dashboards that are defined as <code>json</code> files in your project. For format specification and more information, see <a href="https://grafana.com/docs/grafana/latest/dashboards/json-model/">Official documentation</a> page.</p>
</div>
<div class="paragraph">
<p>To add custom dashboards in your Kogito project, you must follow the following conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dashboard files must be stored in <code>/src/main/resources/META-INF/dashboards</code> directory</p>
</li>
<li>
<p>dashboard file names must start with <code>domain-dashoboard</code> (for domain specific dashboards) or <code>operational-dashboard</code> (for operational dashboards)</p>
</li>
<li>
<p>Dashboard file names must end with <code>.json</code></p>
</li>
<li>
<p>Dashboard file names must not conflict with the auto-generated ones</p>
</li>
<li>
<p>The <code>title</code> attribute of custom dashboards must not conflict with the auto-generated attributes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Custom dashboards are available in the Grafana panel along with the auto-generated dashboards.</p>
</div>
<div id="proc-disable-dashboards-metrics-monitoring_kogito-developing-decision-services" class="paragraph">
<p>==== Disabling Grafana dashboards generation in Kogito</p>
</div>
<div class="paragraph _abstract">
<p>You can disable the generation of default dashboards in Prometheus metrics monitoring using the following properties:</p>
</div>
<div class="listingblock">
<div class="title">Properties to disable default dashboards</div>
<div class="content">
<pre class="highlight"><code>kogito.grafana.disabled.operational.dashboards
kogito.grafana.disabled.domain.dashboards</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Prometheus is installed. For information about downloading and using Prometheus, see the <a href="https://prometheus.io/docs/introduction/overview/">Prometheus documentation page</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>To disable Grafana dashboard, add a comma-separated list of dashboard identifiers to the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Properties to disable Grafana dashboard</div>
<div class="content">
<pre class="highlight"><code>kogito.grafana.disabled.operational.dashboards
kogito.grafana.disabled.domain.dashboards</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>kogito.grafana.disabled.operational.dashboards</code> property disables the generation of operational dashboards and <code>kogito.grafana.disabled.domain.dashboards</code> property disables the generation of domain dashboards.</p>
</div>
<div class="paragraph">
<p>For example, a project containing the following resources uses the default configuration and generates the default dashboards:</p>
</div>
<div class="listingblock">
<div class="title">Example project resources</div>
<div class="content">
<pre class="highlight"><code>Hello.drl
LoanEligibility.dmn
Traffic Violation.dmn</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following are the default generated dashboards in Kogito:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 121. Example default generated dashboards for a project</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dashboard type</th>
<th class="tableblock halign-left valign-top">Dashboard name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Operational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Hello</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LoanEligibility</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Traffic Violation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Hello</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LoanEligibility</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Traffic Violation</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you use the following configuration in the <code>application.properties</code> file, the generation of <code>Hello</code> and <code>Traffic Violation</code> operational dashboards, and <code>LoanEligibility</code> domain dashboard is avoided.</p>
</div>
<div class="listingblock">
<div class="title">Configuration for disabling specific dashboards</div>
<div class="content">
<pre>kogito.grafana.disabled.operational.dashboards=Hello,Traffic Violation
kogito.grafana.disabled.domain.dashboards=LoanEligibility</pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 122. Customized generation of dashboards in Kogito</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Dashboard type</th>
<th class="tableblock halign-left valign-top">Dashboard name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operational</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LoanEligibility</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Hello</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Traffic Violation</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The spaces between the dashboard identifiers are eliminated as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example dashboard identifiers with spaces</div>
<div class="content">
<pre class="highlight"><code>Hello, Traffic Violation, LoanEligibility</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example dashboard identifiers without spaces</div>
<div class="content">
<pre class="highlight"><code>"Hello"
"Traffic Violation"
"LoanEligibility"</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, the spaces within a dashboard identifier are maintained as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example dashboard identifiers with spaces</div>
<div class="content">
<pre class="highlight"><code>Traffic Violation, Traffic    Violation, Tra ffic Violation</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example dashboard identifiers without spaces</div>
<div class="content">
<pre class="highlight"><code>"Traffic Violation"
"Traffic    Violation"
"Tra ffic Violation"</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div id="proc-elastic-metrics-monitoring_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Elasticsearch metrics monitoring in Kogito</p>
</div>
<div class="paragraph _abstract">
<p><a href="https://www.elastic.co/elastic-stack">Elasticsearch</a> is a distributed, open source search and analytics engine that you can use with Kogito to collect and store metrics as an alternative to Prometheus.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Elastic is installed. For information about downloading and using Elastic, see the <a href="https://www.elastic.co/guide/index.html">Elastic Stack and Product Documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your Kogito project, depending on the framework you are using, add one of the following dependencies to the <code>pom.xml</code> file to enable the Elastic add-on:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Add dependency for Elastic Quarkus add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-monitoring-elastic&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Add dependency for Elastic Springboot add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-monitoring-elastic&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, all stored metrics are exported to the configured monitoring module. If you want to disable certain metrics from being exported, you can set any of the following properties in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Enable or disable specific metrics from being exported</div>
<div class="content">
<pre class="highlight"><code>kogito.monitoring.rule.useDefault=false
kogito.monitoring.process.useDefault=false
kogito.monitoring.interceptor.useDefault=false</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>application.properties</code> file of your Kogito project, edit the following properties as needed to configure the Elastic add-on:</p>
</li>
</ol>
</div>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 123. Application properties for Elastic monitoring add-on</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the host to send metrics to.</p>
<p class="tableblock">Default value: <code>http://localhost:9200</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.index</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the index to store metrics in.</p>
<p class="tableblock">Default value: <code>micrometer-metrics</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.step</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the interval at which metrics are sent to Elastic.</p>
<p class="tableblock">Default value: Every 1 minute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.indexDateFormat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the index date format used for rolling indices. This is appended to the index name, separated by the <code>indexDateSeparator</code>.</p>
<p class="tableblock">Default value: <code>yyyy-MM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.timestampFieldName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name of the <code>timestamp</code> field.</p>
<p class="tableblock">Default value: <code>@timestamp</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.autoCreateIndex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether to create the index automatically if it does not exist.</p>
<p class="tableblock">Default value: <code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.userName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the Basic Authentication user name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the Basic Authentication password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.pipeline</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the ingest pipeline name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.indexDateSeparator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the separator between the index name and the date part.</p>
<p class="tableblock">Default value: <code>-</code> (hyphen)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.addon.monitoring.elastic.documentType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type to be used when writing metrics documents to an index. This configuration is only used with Elasticsearch versions 6 and earlier.</p>
<p class="tableblock">Default value: <code>doc</code></p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div id="proc-custom-micrometer-metrics-monitoring_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling metrics monitoring with a custom Micrometer registry in Kogito</p>
</div>
<div class="paragraph">
<p>As an alternative to using the metrics monitoring modules provided in Kogito, you can subscribe to any Micrometer registry using an API exposed by the Kogito monitoring library. For the complete list of monitoring systems supported by Micrometer, see the <a href="https://micrometer.io/docs">Micrometer Documentation</a>.</p>
</div>
<div class="paragraph">
<p>As an example, this procedure demonstrates how you can export metrics to the <a href="https://micrometer.io/docs/registry/atlas">Micrometer Atlas</a> metrics database.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In your Kogito project, depending on the framework you are using, add one of the following dependencies to the <code>pom.xml</code> file to enable the monitoring core add-on:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Add dependency for monitoring core Quarkus add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-monitoring-core&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Add dependency for monitoring core Springboot add-on</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-monitoring-core&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, all stored metrics are exported to the configured monitoring module. If you want to disable certain metrics from being exported, you can set any of the following properties in the <code>application.properties</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Enable or disable specific metrics from being exported</div>
<div class="content">
<pre class="highlight"><code>kogito.monitoring.rule.useDefault=false
kogito.monitoring.process.useDefault=false
kogito.monitoring.interceptor.useDefault=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>As an alternative, if you do not want to use the default listeners and the default metrics, you can import the core common module directly:</p>
</div>
<div class="listingblock">
<div class="title">Add dependency for monitoring core common module</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-monitoring-core&lt;/artifactId&gt;
  &lt;version&gt;<em>KOGITO_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To write custom metrics, you can create custom event listeners and then register your Micrometer <code>Meter</code> object to the global <code>CompositeMeterRegistry</code> using the method <code>getDefaultMeterRegistry</code> of the class <code>io.micrometer.core.instrument.Metrics.globalRegistry</code>. For more information about registering custom event listeners in Kogito, see <a href="#proc-event-listeners-registering_kogito-configuring">[proc-event-listeners-registering_kogito-configuring]</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Depending on the registry that you want to use, add the relevant dependency to the <code>pom.xml</code> file of your Kogito project. For this example, the Atlas registry requires the following dependency:</p>
<div class="listingblock">
<div class="title">Add dependency for Atlas registry</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
  &lt;artifactId&gt;micrometer-registry-atlas&lt;/artifactId&gt;
  &lt;version&gt;<em>MICROMETER_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Subscribe to your registry using the method <code>add</code> of the globalRegistry of <code>io.micrometer.core.instrument.Metrics</code>. For example, on Quarkus, create the following <code>AtlasProvider.java</code> class in your Kogito project:</p>
<div class="listingblock">
<div class="title">Example Java class on Quarkus to subscribe to a custom Micrometer registry for Kogito core monitoring</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import java.time.Duration;

import javax.annotation.PostConstruct;
import javax.inject.Singleton;

import com.netflix.spectator.atlas.AtlasConfig;
import io.micrometer.atlas.AtlasMeterRegistry;
import io.micrometer.core.instrument.Clock;
import io.micrometer.core.instrument.Metrics
import io.quarkus.runtime.Startup;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@Singleton
@Startup
public class AtlasProvider {

    private AtlasMeterRegistry registry;
    private static final Logger logger = LoggerFactory.getLogger(AtlasProvider.class);

    private AtlasProvider() {
    }

    @PostConstruct
    public void setUp() {
        AtlasConfig atlasConfig = new AtlasConfig() {
            @Override
            public Duration step() {
                return Duration.ofSeconds(10);
            }

            @Override
            public String get(String k) {
                return null; // accept the rest of the defaults
            }
        };
        registry = new AtlasMeterRegistry(atlasConfig, Clock.SYSTEM);
        Metrics.globalRegistry.add(registry);
        registry.start();
        logger.info("Atlas registry added to monitoring addon and started.");
    }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div id="con-persistence_kogito-developing-decision-services" class="paragraph">
<p>== Persistence in Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>Kogito supports runtime persistence for preserving process data in your services, such as active process nodes and process instance variables, across application restarts.</p>
</div>
<div class="paragraph">
<p>For Kogito persistence, you can use one of the following supported persistence stores:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://infinispan.org/"><strong>Infinispan</strong></a>: (Default) Persists data using configured key-value storage definitions</p>
</li>
<li>
<p><a href="https://www.mongodb.com/"><strong>MongoDB</strong></a>: Persists data using a document-based format</p>
</li>
<li>
<p><a href="https://kafka.apache.org/documentation/streams/"><strong>Kafka Streams</strong></a>: (Quarkus only) Persists data in Kafka clusters</p>
</li>
<li>
<p><strong>JDBC</strong>: Persists data to different relational databases such as <a href="https://www.postgresql.org/">PostgreSQL</a> and <a href="https://www.oracle.com/database/">Oracle</a> using JDBC driver.</p>
</li>
<li>
<p><strong>File system</strong>: Persists data to files in the file system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Runtime persistence is intended primarily for storing data that is required to resume workflow execution for a particular process instance. Persistence applies to both public and private processes that are not yet complete. Once a process completes, persistence is no longer applied. This persistence behavior means that only the information that is required to resume execution is persisted.</p>
</div>
<div class="paragraph">
<p>Node instances that are currently active or in wait states are persisted. When a process instance finishes execution but has not reached the end state (completed or aborted), the node instance data is persisted.</p>
</div>
<div class="paragraph">
<p>Persistence setup scripts for Kogito runtimes and Kogito runtimes supporting services are included in the <a href="https://repository.jboss.org/org/kie/kogito/kogito-ddl/10.0.0.0/">kogito-ddl-10.0.0.0-db-scripts.zip</a> artifact.</p>
</div>
<div class="paragraph">
<p>=== Persistence workflow in Kogito</p>
</div>
<div class="paragraph">
<p>In Kogito, a process instance is persisted when the process reaches a wait state, where the process does not execute anymore but has not reached the end state (completed or aborted).</p>
</div>
<div class="paragraph">
<p>For example, when a process reaches a user task or a catching signal event, the process instance pauses and the Kogito process engine takes a complete snapshot of the process, including the following data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Process instance metadata, such as process instance ID, process definition ID, state, description, and start date</p>
</li>
<li>
<p>Process instance variables</p>
</li>
<li>
<p>Active node instances, including local variables</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Process instance metadata is persisted with a predefined protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema that is aware of the metadata and supports node instances that are in wait states.</p>
</div>
<div class="paragraph">
<p>For straight-through process instances that do not trigger any activity, persistence is not invoked and no data is stored.</p>
</div>
<div class="paragraph">
<p>Each persistence provider stores data according to their underlying mechanism.
For instance, when using Infinispan, each process definition has its own cache for storing runtime information. The cache is based on the process definition ID and is named in the Infinispan Server.
MongoDB creates a separated document collection per process definition whereas JDBC provider will use a single table for all processes but include the process definition ID in order to isolate operations.
This setup facilitates maintenance of process instance data and reduces concurrency on the cache instances.</p>
</div>
<div class="paragraph">
<p>=== Persisted process instance variables and data types</p>
</div>
<div class="paragraph">
<p>Persisted process variables, local variables, and other process data are stored with the process instance. The stored data is marshalled into bytes format so it can be transferred and persisted into one of the supported persistence providers.
The marshalling and unmarshalling is implemented based on protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>).</p>
</div>
<div class="paragraph">
<p>Kogito will persist all process instance variables defined in the process model once the execution reaches a wait state.
Once the wait state is reached, marshalling will take place in order to transform all process variables into bytes, which can be accomplished using one of the following methods:</p>
</div>
<div class="paragraph">
<p>==== Persistence using Protobuf marshalling</p>
</div>
<div class="paragraph">
<p>Kogito generates both the protobuf schema (as PROTO files) and marshallers for persisting variables. The Kogito marshallers are based on the <a href="https://github.com/infinispan/protostream">ProtoStream</a> subproject of Infinispan.</p>
</div>
<div class="paragraph">
<p>When you build your Kogito project, Kogito scans all process definitions and extracts information about the data within the business assets. Based on the unique data types (regardless of how many processes reference a specified type), PROTO files are generated that build a complete schema for the application. These files are stored inside the <code>/META-INF/resources/persistence/protobuf/</code> folder of the generated JAR file (e.g. quarkus-apps/quarkus/generated-bytecode.jar) and also in the <code>target/classes/META-INF/resources/persistence/protobuf/</code> folder of your project after successful build.</p>
</div>
<div class="listingblock">
<div class="title">Example PROTO file generated by Kogito to persist process data</div>
<div class="content">
<pre class="highlight"><code>syntax = "proto2";
package org.kie.kogito.examples.demo.orders;
import "kogito-index.proto";
import "kogito-types.proto";
option kogito_model = "Orders";
option kogito_id = "demo.orders";

/* @Indexed */
message Order {
	option java_package = "org.kie.kogito.examples.demo.orders";
	/* @Field(store = Store.YES) @SortableField */
	optional string orderNumber = 1;
	/* @Field(store = Store.YES) @SortableField */
	optional bool shipped = 2;
	/* @Field(store = Store.YES) @SortableField */
	optional double total = 3;
}
/* @Indexed */
message Orders {
	option java_package = "org.kie.kogito.examples.demo.orders";
	/* @Field(store = Store.YES) @SortableField
 @VariableInfo(tags="") */
	optional string approver = 1;
	/* @Field(store = Store.YES) @SortableField */
	optional string id = 2;
	/* @Field(store = Store.YES) @SortableField
 @VariableInfo(tags="") */
	optional Order order = 3;
	/* @Field(store = Store.YES) @SortableField */
	optional org.kie.kogito.index.model.KogitoMetadata metadata = 4;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Each PROTO file imports <code>kogito-types.proto</code> and <code>kogito-index.proto</code> files that automatically define the base types managed by Kogito.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Based on the PROTO files, marshallers are also generated and configured in the application so that whenever a particular data type is used in a process instance, the data is successfully marshalled and unmarshalled.</p>
</div>
<div class="paragraph">
<p>==== Persistence using Java serialization</p>
</div>
<div class="paragraph">
<p>To enable Java serialization, you should make sure all data types can be serialized. This means that classes should implement <code>java.io.Serializable</code> as well as have an empty constructor. It is also necessary to set <code>kogito.persistence.proto.marshaller=false</code> in your application.properties file.</p>
</div>
<div class="paragraph">
<p>In case you would like to use Quarkus native compilation, it is also necessary to follow the instructions so your data types can be serialized in native mode.
For more details, visit (<a href="https://quarkus.io/guides/writing-native-applications-tips#registering-for-reflection">Quarkus registering for reflection</a>)</p>
</div>
<div class="paragraph">
<p>The following annotation is usually required for Quarkus native mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.quarkus.runtime.annotations.RegisterForReflection;

@RegisterForReflection(serialization = true)
public class MyPojo implements Serializable {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>=== Supported data types for persisted variables</p>
</div>
<div class="paragraph">
<p>For optimal persistence with process data and variables, use Java objects as data types that represent your process variables. If you use other formats for data types, your data might not be persisted or your Kogito project might fail to compile.</p>
</div>
<div class="paragraph">
<p>Kogito currently supports the following data types for process variables:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 124. Supported data types</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Data type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic text type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended size number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic floating point number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended size floating point number type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Date</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic date type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.lang.Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic boolean type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.Serializable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom data types and other Java types such as Collections and Enums</p></td>
</tr>
</tbody>
</table>
<div id="proc-locking-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling optimistic locking with persistence</p>
</div>
<div class="paragraph">
<p>Kogito runtimes need to safely handle concurrent requests to shared instances such as process instances or tasks. Kogito handles these requests using persistence enabled optimistic locking for concurrency control with the version on record (using the version field in the database or the metadata version in the case of Infinispan). This feature is optional and can be activated only with persistence by adding the following properties to the src/main/resources/application.properties file in your Kogito project,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kogito.persistence.optimistic.lock=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below are the persistence providers that support optimistic locking</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Infinispan</p>
</li>
<li>
<p>MongoDB</p>
</li>
<li>
<p>JDBC</p>
</li>
</ul>
</div>
<div id="proc-infinispan-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Infinispan persistence for Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>You can enable persistence for your Kogito services using <a href="https://infinispan.org/">Infinispan</a> to persist data, such as active process nodes and process instance variables, so that the data is preserved across application restarts. For Kogito persistence with Infinispan, you must have a an Infinispan Server installed and running in order to enable persistence.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://infinispan.org/">Infinispan Server</a> 13.0.2 or later is installed and running. For information about Infinispan installation and configuration, see the <a href="https://infinispan.org/documentation/">Infinispan documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-infinispan&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-infinispan&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.infinispan&lt;/groupId&gt;
  &lt;artifactId&gt;infinispan-spring-boot-starter-remote&lt;/artifactId&gt;
  &lt;version&gt;<em>INFINISPAN_SPRING_BOOT_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add following property to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure the connection to the Infinispan Server.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host and port information according to your Infinispan Server installation.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>quarkus.infinispan-client.server-list=localhost:11222</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>infinispan.remote.server-list=127.0.0.1:11222</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example Kogito services with Infinispan persistence, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-infinispan-persistence-quarkus"><code>process-infinispan-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-infinispan-persistence-springboot"><code>process-infinispan-persistence-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="proc-mongodb-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling MongoDB persistence for Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>As an alternative to using Infinispan for Kogito runtime persistence, you can enable persistence for your Kogito services using <a href="https://www.mongodb.com/">MongoDB</a>. MongoDB is a general purpose, document-based database that enables you to store data in JSON-like documents instead of key-value storage definitions in Infinispan-based persistence storage. For Kogito persistence with MongoDB, you must have a MongoDB Server installed and running in order to enable persistence.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.mongodb.com/try/download">MongoDB Server</a> 4.4 or later is installed and running. For information about MongoDB installation and configuration, see the <a href="https://docs.mongodb.com/manual/installation/">MongoDB documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;
  &lt;version&gt;<em>MONGODB_SPRING_BOOT_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure MongoDB persistence and to connect to the relevant MongoDB Server and database.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host, port, and database information according to your MongoDB Server installation. By default, the database is named <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=mongodb
quarkus.mongodb.connection-string = mongodb://localhost:27017
quarkus.mongodb.database=kogito_db</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=mongodb
spring.data.mongodb.uri=mongodb://localhost:27017
spring.data.mongodb.database=kogito_db</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally, enable MongoDB transactions by adding the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>kogito.persistence.transaction.enabled=true</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example Kogito services with MongoDB persistence, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-mongodb-persistence-quarkus"><code>process-mongodb-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-mongodb-persistence-springboot"><code>process-mongodb-persistence-springboot</code></a>: Example on Spring Boot</p>
</li>
</ul>
</div>
<div id="proc-kafka-streams-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kafka Streams persistence for Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based Kogito services, as an alternative to using Infinispan or MongoDB for Kogito runtime persistence, you can enable persistence using <a href="https://kafka.apache.org/documentation/streams/">Kafka Streams</a>. Kafka Streams is a client library for building applications and microservices, where the input and output data are stored in Kafka topics.
For Kogito persistence with Kafka Streams, you must have Kafka installed and running in order to enable persistence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Kafka Streams persistence is supported for only Quarkus-based Kogito services.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed and includes any required topics. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependency to the <code>pom.xml</code> file of your Kogito project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable Kafka Streams persistence (Quarkus only)</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-kafka&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure Kafka persistence and to connect to the relevant Kafka server.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host and port information according to your Kafka installation.</p>
</div>
<div class="listingblock">
<div class="title">Application properties to enable Kafka Streams persistence (Quarkus only)</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=kafka
kafka.bootstrap.servers=localhost:9092</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For an example Kogito service with Kafka persistence, see the following example application in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-kafka-persistence-quarkus"><code>process-kafka-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
</ul>
</div>
<div id="proc-jdbc-persistence-enabling_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling JDBC persistence for Kogito services</p>
</div>
<div class="paragraph _abstract">
<p>As an alternative to using Infinispan or MongoDB for Kogito runtime persistence, you can enable persistence for your Kogito services using JDBC.
JDBC allows Kogito to persist data using different relational databases. We recommend using <a href="https://www.postgresql.org/">PostgreSQL</a>.
The complete list of supported databases is dependent on the target runtime you use, for instance, Quarkus supports the following <a href="https://quarkus.io/guides/datasource#jdbc-datasource">JDBC datasources</a>.</p>
</div>
<div class="paragraph">
<p>Kogito provides two ways to manage the database schema, either via manually applying the provided DDL <a href="https://repository.jboss.org/org/kie/kogito/kogito-ddl/10.0.0.0/">kogito-ddl-10.0.0.0-db-scripts.zip</a>, or via <a href="https://flywaydb.org/">Flyway</a> integration. The service does not create a schema by default.</p>
</div>
<div class="paragraph">
<p>Please check examples below on how to enable different databases using JDBC data sources.</p>
</div>
<div class="paragraph">
<p>==== Enabling PostgreSQL persistence using JDBC driver for Kogito services</p>
</div>
<div class="paragraph">
<p>You can enable PostgreSQL persistence for your Kogito services using JDBC driver.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.postgresql.org/">PostgreSQL</a> is installed. For information about PostgreSQL installation and configuration, see <a href="https://www.postgresql.org/docs/current/">PostgreSQL documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-jdbc-postgresql&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-agroal&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.postgresql&lt;/groupId&gt;
  &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure PostgreSQL and to connect to the PostgreSQL server.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host, port, and database information according to your PostgreSQL Server installation. By default, the database is named <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
quarkus.datasource.username=kogito-user
quarkus.datasource.password=kogito-pass
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/kogito
# Below properties are required to create database schema with Flyway at startup.
quarkus.flyway.migrate-at-start=true
quarkus.datasource.db-kind=postgresql</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
spring.datasource.username=kogito-user
spring.datasource.password=kogito-pass
spring.datasource.url=jdbc:postgresql://localhost:5432/kogito
# Below properties are required to create database schema with Flyway at startup.
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/{vendor}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For an example Kogito service with PostgreSQL persistence using JDBC driver, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-quarkus-examples/process-postgresql-persistence-quarkus"><code>process-postgresql-persistence-quarkus</code></a>: Example on Quarkus</p>
</li>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/kogito-springboot-examples/process-postgresql-persistence-springboot"><code>process-postgresql-persistence-springboot</code></a>: Example on SpringBoot</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>==== Enabling Oracle persistence using JDBC driver for Kogito services</p>
</div>
<div class="paragraph">
<p>You can enable Oracle persistence for your Kogito services using JDBC driver.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.oracle.com/database/">Oracle Database</a> is installed and running.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following dependencies to the <code>pom.xml</code> file of your Kogito project:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-jdbc-oracle&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-agroal&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-persistence-jdbc&lt;/artifactId&gt;
  &lt;version&gt;<em>Kogito_VERSION</em>&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.oracle.database.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;ojdbc8&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following properties to the <code>src/main/resources/application.properties</code> file in your Kogito project to configure and to connect to the Oracle database.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>Replace the server host, port, and database information according to your Oracle Server installation. By default, the database is named as <code>kogito</code>.</p>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
quarkus.datasource.username=kogito
quarkus.datasource.password=kogito
quarkus.datasource.jdbc.url=jdbc:oracle://oracle:1521/kogito
# Below properties are required to create database schema with Flyway at startup.
quarkus.flyway.migrate-at-start=true
quarkus.datasource.db-kind=oracle</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code>kogito.persistence.type=jdbc
spring.datasource.username=kogito
spring.datasource.password=kogito
spring.datasource.url=jdbc:oracle://oracle:1521/kogito
# Below properties are required to create database schema with Flyway at startup.
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/{vendor}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-data-index-service_kogito-developing-decision-services" class="paragraph">
<p>== Kogito Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>Kogito provides a Data Index Service that stores all Kogito events related to processes, tasks, and domain data. The Data Index Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from Kogito services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all Kogito search, insight, and management capabilities.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/data-index-architecture_enterprise.png" alt="Diagram of an example Kogito service using Data Index Service">
</div>
<div class="title">Figure 249. Data Index Service architecture in an example Kogito service</div>
</div>
<div class="paragraph">
<p>The Kogito Data Index Service has the following key attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Distinct focus on domain data</p>
</li>
<li>
<p>Flexible data structure</p>
</li>
<li>
<p>Distributable and cloud-ready format</p>
</li>
<li>
<p>Infinispan-based persistence support</p>
</li>
<li>
<p>Message-based communication with Kogito runtime (Apache Kafka, cloud events )</p>
</li>
<li>
<p>Powerful querying API using GraphQL</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Kogito Data Index Service is not intended for permanent storage or audit log purposes. The Data Index Service is designed to make business domain data accessible for processes that are currently in progress.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>=== Data Index Service workflow in Kogito</p>
</div>
<div class="paragraph">
<p>The Kogito Data Index Service is a Quarkus application, based on <a href="https://vertx.io/">Vert.x</a> with <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a>, that exposes a <a href="https://graphql.org">GraphQL</a> endpoint that client applications use to access business domain-specific data and other information about running process instances.</p>
</div>
<div class="paragraph">
<p>The Data Index Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from Kogito services, and then indexes the returned data for future GraphQL queries. These events contain information about units of work executed for a process.</p>
</div>
<div class="paragraph">
<p>Indexed data from the Data Index Service is parsed and pushed into the following Infinispan caches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Domain cache</strong>: Generic cache for each process definition where the process instance variables are pushed as the root content. This cache also includes some process instance metadata, which enables data correlation between domain and process instances. Data is transferred in JSON format to an Infinispan Server.</p>
</li>
<li>
<p><strong>Process instance cache</strong>: Cache for each process instance. This cache contains all process instance information, including all metadata and other detailed information such as executed nodes.</p>
</li>
<li>
<p><strong>User task instance cache</strong>: Cache for each user task instance. This cache contains all task instance information, including all metadata and other detailed information such as data input and output.</p>
</li>
<li>
<p><strong>Jobs cache</strong>: Cache for each scheduled job instance. This cache contains all job instance information, including all detailed information related to a specific job, such as the number of times a job is fired and next time the same job will be fired.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The indexing functionality in the Data Index Service is provided by choosing one of the following persistent providers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://infinispan.org/">Infinispan</a></p>
</li>
<li>
<p><a href="https://www.mongodb.com/">MongoDB</a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/">PostgreSQL</a></p>
</li>
<li>
<p><a href="https://www.oracle.com/database/">Oracle</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When using Infinispan, <a href="https://lucene.apache.org/">Apache Lucene</a> provides indexing and a protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema and generated marshallers manage the communication between the Data Index Service and Infinispan.</p>
</div>
<div class="paragraph">
<p>After the data is indexed and stored in a cache, the Data Index Service inspects the process model to update the GraphQL schema and enable a type-checked query system that consumer clients can use to access the data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Infinispan indexing</div>
<div class="paragraph">
<p>Infinispan also supports data indexing through an embedded Apache Lucene engine. To determine which attributes must be indexed, Inifinispan requires <code>@Indexed</code> and <code>@Field</code> Hibernate Search parameters that annotate the relevant protobuf file attributes:</p>
</div>
<div class="listingblock">
<div class="title">Example indexed model in Infinispan Server configuration</div>
<div class="content">
<pre class="highlight"><code>/* @Indexed */
message ProcessInstanceMeta {
    /* @Field(store = Store.YES) */
    optional string id = 1;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Infinispan indexing, see <a href="https://infinispan.org/docs/stable/titles/developing/developing.html#enable_indexing">Indexing of protobuf encoded entries</a> in the Infinispan documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>==== Index the domain-specific data in Data Index Service</p>
</div>
<div class="paragraph">
<p>You can enable or disable the domain-specific types or custom types indexing in Kogito. To achieve this, you can change the value of the <code>kogito.data-index.domain-indexing</code> property to <code>true</code> or <code>false</code>, based on the behavior you want to achieve. By default, the domain indexing is enabled on Data Index Service using MongoDB and Infinispan persistence type. When you disable the domain indexing, the Data Index Service stops creating custom types in GraphQL queries, and the GraphQL schema starts exposing queries only for <code>ProcessInstances</code>, <code>UserTaskInstances</code>, and <code>Jobs</code> types.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Data Index PostgreSQL persistence provider does not support indexing for custom types. Therefore, setting the <code>kogito.data-index.domain-indexing</code> property to <code>true</code> does not have any impact.
</td>
</tr>
</table>
</div>
<div id="proc-data-index-service-using_kogito-developing-decision-services" class="paragraph">
<p>=== Using the Kogito Data Index Service to query application data</p>
</div>
<div class="paragraph _abstract">
<p>Kogito provides a Data Index Service that stores all Kogito events related to processes, tasks, and domain data. The Data Index Service uses Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from Kogito services, and then indexes the returned data for future GraphQL queries and stores the data in the Infinispan persistence store. The Data Index Service is at the core of all Kogito search, insight, and management capabilities.</p>
</div>
<div class="paragraph">
<p>You can use the Kogito Data Index Service to index, store, and query process data in your Kogito services.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://infinispan.org/">Infinispan Server</a> 13.0.2 or later is installed and running. For information about Infinispan installation and configuration, see the <a href="https://infinispan.org/documentation/">Infinispan documentation</a>.</p>
</li>
<li>
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is installed, including required topics, and the Kafka messaging server is running. For information about Kafka installation and configuration, see the <a href="https://kafka.apache.org/documentation/">Apache Kafka documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>For a list of configuration options for setting up the Kafka consumer, see <a href="https://kafka.apache.org/documentation/#consumerconfigs">Consumer Configs</a> in the Kafka documentation.</p>
</div>
<div class="paragraph">
<p>For more information about using Kafka messaging on Quarkus, see <a href="https://quarkus.io/guides/kafka">Using Apache Kafka with reactive messaging</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Configure your Kogito project to enable Infinispan persistence and Apache Kafka messaging.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For instructions on enabling persistence, see <a href="#proc-infinispan-persistence-enabling_kogito-configuring">[proc-infinispan-persistence-enabling_kogito-configuring]</a>.</p>
</div>
<div class="paragraph">
<p>For instructions on enabling messaging, see <a href="#proc-messaging-enabling_kogito-configuring">[proc-messaging-enabling_kogito-configuring]</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/data-index-service-infinispan/"><code>data-index-service-infinispan</code></a> artifacts page, select the latest release of the Data Index Service, and download the <code>data-index-service-infinispan-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>data-index-service-infinispan-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Data Index Service with the required Infinispan credentials:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Data Index Service</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.infinispan-client.auth-username=<em>INFINISPAN_USER_NAME</em> \
  -Dquarkus.infinispan-client.auth-password=<em>INFINISPAN_PASSWORD</em> \
  -jar data-index-service-infinispan-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Infinispan authentication on Quarkus, see <a href="https://quarkus.io/guides/infinispan-client">Infinispan client</a> in the Quarkus documentation.</p>
</div>
<div class="paragraph">
<p>To change the logging level of the Data Index Service, such as for debugging, you can specify the following start-up properties as needed when you run the Data Index Service:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Data Index Service logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -jar data-index-service-infinispan-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a separate command terminal window, navigate to your Kogito project and run the project using your preferred run mode, such as development mode:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the Data Index Service and your Kogito project both configured and running, the Data Index Service starts consuming messages from the defined Kafka topics, such as <code>kogito-processinstances-events</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, navigate to the <code>http://<em>HOST</em>:<em>PORT</em></code> location configured for your running Kogito service, such as <code>http://localhost:8080/</code>, to explore the exposed data model.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>To query the available data using the <a href="https://github.com/graphql/graphiql">GraphiQL</a> interface, navigate to <code>http://<em>HOST</em>:<em>PORT</em>/graphql</code>, such as <code>http://localhost:8080/graphql</code> in this example, and begin executing supported queries to interact with your application data.</p>
</div>
<div class="listingblock">
<div class="title">Example query for process instance data</div>
<div class="content">
<pre class="highlight"><code>{ ProcessInstances {
  id,
  processId,
  processName,
  state,
  nodes {
    name,
    type,
    enter,
    exit
  }
} }</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/openshift/kogito-data-index-graphiql-process-instances.png" alt="Image of GraphQL query and response for process instances">
</div>
<div class="title">Figure 250. Example response</div>
</div>
<div class="paragraph">
<p>For available query types, click <strong>Docs</strong> in the upper-right corner of the GraphiQL interface.</p>
</div>
<div class="paragraph">
<p>For more information about supported queries with the Data Index Service, see <a href="#ref-data-index-service-queries_kogito-configuring">[ref-data-index-service-queries_kogito-configuring]</a>.</p>
</div>
<div class="openblock">
<div class="content">
<div id="ref-data-index-service-queries_kogito-developing-decision-services" class="paragraph">
<p>=== Supported GraphQL queries with the Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>After you configure and run your Kogito service and the Kogito Data Index Service, you can query the available data using the <a href="https://github.com/graphql/graphiql">GraphiQL</a> interface displayed at <code>http://<em>HOST</em>:<em>PORT</em>/graphql</code>, such as <code>http://localhost:8080/graphql</code>.</p>
</div>
<div class="paragraph">
<p>The Kogito Data Index Service supports GraphQL queries for domain-specific (domain cache) types and for process instances, task instances, and jobs.</p>
</div>
<div class="paragraph">
<p>==== GraphQL queries for domain-specific types (domain cache)</p>
</div>
<div class="paragraph">
<p>Use the following GraphQL queries to retrieve data about process definitions. These example queries assume that a <code>Travels</code> Business Process Model and Notation (BPMN) process model is running or has been executed.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from process definitions</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data about a specified process definition from your Kogito service.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels {
    visaApplication {
      duration
    }
    flight {
      flightNumber
      gate
    }
    hotel {
      name
      address {
        city
        country
      }
    }
    traveller {
      firstName
      lastName
      nationality
      email
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Correlate data using the <code>metadata</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>metadata</code> parameter to correlate data from domain-specific types (domain cache) with data from process instances and task instances. This parameter is added to all root models that are deployed in the Data Index Service and enables you to retrieve and filter query data.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels {
    flight {
      flightNumber
      arrival
      departure
    }
    metadata {
      lastUpdate
      userTasks {
        name
      }
      processInstances {
        processId
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Filter query results using the <code>where</code> and <code>metadata</code> parameters</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>where</code> parameter with multiple combinations to filter query results based on process definition attributes. The attributes available for search depend on the BPMN process model that is deployed, such as a <code>Travels</code> process model in this example.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {traveller: {firstName: {like: "Cri*"}}}) {
    flight {
      flightNumber
      arrival
      departure
    }
    traveller {
      email
    }
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>like</code> operator is case sensitive.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also use the <code>metadata</code> parameter to filter correlated query results from related process instances or tasks.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {metadata: {processInstances: {id: {equal: "1aee8ab6-d943-4dfb-b6be-8ea8727fcdc5"}}}}) {
    flight {
      flightNumber
      arrival
      departure
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {metadata: {userTasks: {id: {equal: "de52e538-581f-42db-be65-09e8739471a6"}}}}) {
    flight {
      flightNumber
      arrival
      departure
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Sort query results using the <code>orderBy</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>orderBy</code> parameter to sort query results based on process definition attributes. You can also specify the direction of sorting in ascending <code>ASC</code> order or descending <code>DESC</code> order. Multiple attributes are applied to the database query in the order they are specified in the query filter.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(orderBy: {trip: {begin: ASC}}) {
    flight {
      flightNumber
      arrival
      departure
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Limit and offset query results using the <code>pagination</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>pagination</code> parameter to specify a <code>limit</code> and <code>offset</code> for query results.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Travels(where: {traveller: {firstName: {like: "Cri*"}}}, pagination: {offset: 0, limit: 10}) {
    flight {
      flightNumber
      arrival
      departure
    }
    traveller {
      email
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="con-data-index-service-queries_kogito-developing-decision-services" class="paragraph">
<p>==== GraphQL queries for process instances, user task instances, and jobs</p>
</div>
<div class="paragraph">
<p>Use the following GraphQL queries to retrieve data about process instances, user task instances, and jobs.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from process instances</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data about a specified process instance from your process definition.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances {
    id
    processId
    state
    parentProcessInstanceId
    rootProcessId
    rootProcessInstanceId
    variables
    nodes {
      id
      name
      type
    }
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from user task instances</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data from a specified user task instance.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  UserTaskInstances {
    id
    name
    actualOwner
    description
    priority
    processId
    processInstanceId
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve data from jobs</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can retrieve data from a specified job instance.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  Job {
    id
    status
    priority
    processId
    processInstanceId
    executionCounter
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Filter query results using the <code>where</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>where</code> parameter with multiple combinations to filter query results based on process or task attributes.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {state: {equal: ACTIVE}}) {
    id
    processId
    processName
    start
    state
    variables
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {id: {equal: "d43a56b6-fb11-4066-b689-d70386b9a375"}}) {
    id
    processId
    processName
    start
    state
    variables
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  UserTaskInstances(where: {state: {equal: "Ready"}}) {
    id
    name
    actualOwner
    description
    priority
    processId
    processInstanceId
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, every filtered attribute is executed as an <code>AND</code> operation in queries. You can modify this behavior by combining filters with an <code>AND</code> or <code>OR</code> operator.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {or: {state: {equal: ACTIVE}, rootProcessId: {isNull: false}}}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {and: {processId: {equal: "travels"}, or: {state: {equal: ACTIVE}, rootProcessId: {isNull: false}}}}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the attribute type, the following operators are also available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>String array argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>contains</code> : String</p>
</li>
<li>
<p><code>containsAll</code>: Array of strings</p>
</li>
<li>
<p><code>containsAny</code>: Array of strings</p>
</li>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>String argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>in</code>: Array of strings</p>
</li>
<li>
<p><code>like</code>: String</p>
</li>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
<li>
<p><code>equal</code>: String</p>
</li>
</ul>
</div>
</li>
<li>
<p>ID argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>in</code>: Array of strings</p>
</li>
<li>
<p><code>equal</code>: String</p>
</li>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Boolean argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
<li>
<p><code>equal</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Numeric argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>in</code>: Array of integers</p>
</li>
<li>
<p><code>isNull</code>: Boolean</p>
</li>
<li>
<p><code>equal</code>: Integer</p>
</li>
<li>
<p><code>greaterThan</code>: Integer</p>
</li>
<li>
<p><code>greaterThanEqual</code>: Integer</p>
</li>
<li>
<p><code>lessThan</code>: Integer</p>
</li>
<li>
<p><code>lessThanEqual</code>: Integer</p>
</li>
<li>
<p><code>between</code>: Numeric range</p>
</li>
<li>
<p><code>from</code>: Integer</p>
</li>
<li>
<p><code>to</code>: Integer</p>
</li>
</ul>
</div>
</li>
<li>
<p>Date argument:</p>
<div class="ulist">
<ul>
<li>
<p><code>isNull</code>: Boolean (<code>true</code> or <code>false</code>)</p>
</li>
<li>
<p><code>equal</code>: Date time</p>
</li>
<li>
<p><code>greaterThan</code>: Date time</p>
</li>
<li>
<p><code>greaterThanEqual</code>: Date time</p>
</li>
<li>
<p><code>lessThan</code>: Date time</p>
</li>
<li>
<p><code>lessThanEqual</code>: Date time</p>
</li>
<li>
<p><code>between</code>: Date range</p>
</li>
<li>
<p><code>from</code>: Date time</p>
</li>
<li>
<p><code>to</code>: Date time</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Sort query results using the <code>orderBy</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>orderBy</code> parameter to sort query results based on process or task attributes. You can also specify the direction of sorting in ascending <code>ASC</code> order or descending <code>DESC</code> order. Multiple attributes are applied to the database query in the order they are specified in the query filter.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {state: {equal: ACTIVE}}, orderBy: {start: ASC}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  UserTaskInstances(where: {state: {equal: "Ready"}}, orderBy: {name: ASC, actualOwner: DESC}) {
    id
    name
    actualOwner
    description
    priority
    processId
    processInstanceId
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Limit and offset query results using the <code>pagination</code> parameter</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>You can use the <code>pagination</code> parameter to specify a <code>limit</code> and <code>offset</code> for query results.</p>
</div>
<div class="listingblock">
<div class="title">Example query</div>
<div class="content">
<pre class="highlight"><code>{
  ProcessInstances(where: {state: {equal: ACTIVE}}, orderBy: {start: ASC}, pagination: {limit: 10, offset: 0}) {
    id
    processId
    processName
    start
    end
    state
  }
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="proc-data-index-service-runtime-connection_kogito-developing-decision-services" class="paragraph">
<p>==== Data Index service Gateway API</p>
</div>
<div class="paragraph">
<p>Data Index incorporates a set of queries or mutations that allow firing operations on runtime services endpoints using GraphQL notation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/data-index-gateway-api.png" alt="Image of data-index external points connections">
</div>
<div class="title">Figure 251. Data Index Gateway API external connections</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="#con-bpmn-process-management-addon_kogito-developing-process-services">Kogito process management add-on</a> needs to be enabled for Kogito runtime service to perform the requested operation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Data Index Gateway API enables you to peform the following operations:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Abort a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves a process instance with the ID passed as a parameter and launches the abort operation on related Kogito service.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation for abort operation</div>
<div class="content">
<pre class="highlight"><code>mutation {
    ProcessInstanceAbort (id:"66e05e9c-eaab-47af-a83e-156498b7096d")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retry a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves a process instance with the id passed as a parameter and launches the retry operation on related Kogito service.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation for retry operation</div>
<div class="content">
<pre class="highlight"><code>mutation {
    ProcessInstanceRetry (id:"66e05e9c-eaab-47af-a83e-156498b7096d")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Skip a process instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves a process instance with the ID passed as a parameter and launches the skip operation on related Kogito service.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation for skip operation</div>
<div class="content">
<pre class="highlight"><code>mutation {
    ProcessInstanceSkip (id:"66e05e9c-eaab-47af-a83e-156498b7096d")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve a process instance diagram</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves a process instance diagram that shows the execution path. When the <code>diagram</code> field of a process instance is queried, a call to a specific Kogito service is generated to retrieve the requested process instance diagram.</p>
</div>
<div class="listingblock">
<div class="title">Example query to retrieve a process instance diagram</div>
<div class="content">
<pre class="highlight"><code>{ProcessInstances(where: { id: {equal: "1017afb1-5749-440e-8b9b-6b876bb5894d"}}){
  diagram
}}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The  <a href="#con-bpmn-process-svg-addon_kogito-developing-process-services">Kogito process SVG add-on</a> also needs to be enabled for Kogito runtime service to retrieve the process instance diagram.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve the process instance source file content</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves the process instance source file. When the <code>source</code> field of a process instance is queried, a call to a specific Kogito service is generated to retrieve the requested process instance source file content.</p>
</div>
<div class="listingblock">
<div class="title">Example query to retrieve a process instance source file content</div>
<div class="content">
<pre class="highlight"><code>{ProcessInstances(where: { id: {equal: "1017afb1-5749-440e-8b9b-6b876bb5894d"}}){
  source
}}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The  <a href="#source-files-add-on">Kogito source files add-on</a> also needs to be enabled for Kogito runtime service to retrieve the process instance diagram.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve process instance nodes</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves the nodes of a process instance that are coming from the process definition. When the <code>nodeDefinitions</code> field of a process instance is queried, a call to a specific Kogito service is generated to retrieve the requested list of available nodes.</p>
</div>
<div class="listingblock">
<div class="title">Example query to retrieve process instance nodes</div>
<div class="content">
<pre class="highlight"><code>{ProcessInstances(where: { id: {equal: "1017afb1-5749-440e-8b9b-6b876bb5894d"}}){
  diagram
}}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Update process instance variables</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Updates the variables of a process instance using the <code>id</code> passed as a parameter. Retrieves a process instance using the <code>id</code> passed as a parameter and launches the update operation on related Kogito service with the new values passed in <code>variables</code> parameter.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to update process instance variables</div>
<div class="content">
<pre class="highlight"><code>mutation {
    ProcessInstanceUpdateVariables
        (id:"23147fcc-da82-43a2-a577-7a36b26094bd",
         variables:"{\"it_approval\":true,\"candidate\":{\"name\":\"Joe\",\"email\":\"jdoe@ts.com\",\"salary\":30000,\"skills\":\"java\"},\"hr_approval\":true}")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Trigger a node instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Triggers a node instance using the node definition <code>nodeId</code>. The <code>nodeId</code> is included in the <code>nodeInstances</code> of a process instance using the <code>id</code> passed as parameter.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to trigger a node instance</div>
<div class="content">
<pre class="highlight"><code>mutation{
  NodeInstanceTrigger(
    id: "9674e3ed-8c13-4c3f-870e-7465d9ca7ca7",
    nodeId:"_B8C4F63C-81AD-4291-9C1B-84967277EEF6")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retrigger a node instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retriggers a node instance using the <code>id</code>, which is similar to <code>nodeInstanceId</code> related to a process instance. The <code>id</code> of the process instance is passed as a parameter.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to retrigger a node instance</div>
<div class="content">
<pre class="highlight"><code>mutation{
  NodeInstanceRetrigger(
    id: "9674e3ed-8c13-4c3f-870e-7465d9ca7ca7",
    nodeInstanceId:"01756ba2-ac16-4cf1-9d74-154ae8f2df21")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Cancel a node instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Cancels a node instance with the <code>id</code>, which is similar to <code>nodeInstanceId</code> related to a process instance. The <code>id</code> of the process instance is passed as a parameter.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to cancel a node instance</div>
<div class="content">
<pre class="highlight"><code>mutation{
  NodeInstanceCancel(
    id: "9674e3ed-8c13-4c3f-870e-7465d9ca7ca7",
    nodeInstanceId:"01756ba2-ac16-4cf1-9d74-154ae8f2df21")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Reschedule a job</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Reschedules a job using the <code>id</code>. The job <code>id</code> and other information are passed in the <code>data</code> parameter.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to reschedule a job</div>
<div class="content">
<pre class="highlight"><code>mutation{
  JobReschedule(
    id: "9674e3ed-8c13-4c3f-870e-7465d9ca7ca7",
    data:"{\"expirationTime\": \"2021-08-27T04:35:54.631Z\",\"retries\": 2}")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Cancel a job</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Cancels a job using the <code>id</code> passed as a parameter.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to cancel a job</div>
<div class="content">
<pre class="highlight"><code>mutation{
  JobCancel(
    id: "9674e3ed-8c13-4c3f-870e-7465d9ca7ca7")
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Retrieve the user task schema</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Retrieves the schema of the user task instance using the <code>taskId</code>. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes. When the <code>schema</code> field of a user task instance is queried, a call to a specific Kogito service is
generated to retrieve the requested task schema.</p>
</div>
<div class="listingblock">
<div class="title">Example query for task instance schema</div>
<div class="content">
<pre class="highlight"><code>{UserTaskInstances (where: {id: {equal: "b356d136-e601-43ee-9c2d-ee47198b9303"}}) {
  schema(user:"jdoe" groups:["managers"])
}}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Update a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Updates the data of a user task instance using the <code>taskId</code> and the information passed in the parameters. The parameters passed is only affected with this operation. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to update a task instance</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceUpdate (
        taskId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        user: "jdoe",
        groups: ["managers", "users", "IT"],
        description: "New task description"
        priority: "High"
        actualOwner: "jdoe"
        adminGroups: ["managers","IT"]
        adminUsers: ["admin"]
        excludedUsers: ["katy"]
        potentialGroups: ["users"]
        potentialUsers: ["alice"]
        inputParams: "{\"it_approval\":true,\"candidate\":{\"name\":\"Joe\",\"email\":\"jdoe@ts.com\",\"salary\":30000,\"skills\":\"java\"},\"hr_approval\":true}"
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Add a comment to a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Adds a new comment to the user task instance using the <code>taskId</code> and the information passed in the <code>comment</code> parameter. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to add a new comment to a user task instance</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceCommentCreate(
        taskId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        user: "jdoe",
        groups: ["managers", "users", "IT"],
        comment: "New Comment to add"
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Update a comment in a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Updates a comment using the <code>commentId</code> and the information passed in the <code>comment</code> parameter in a user task instance. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to update a user task instance comment</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceCommentUpdate(
        commentId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        comment: "Comment new content",
        user: "jdoe",
        groups: ["managers", "users", "IT"]
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Delete a comment in a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Deletes a comment using the <code>commentId</code> in a user task instance. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to delete a user task instance comment</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceCommentDelete(
        commentId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        user: "jdoe",
        groups: ["managers", "users", "IT"]
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Add an attachment to a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Adds a new attachment to the user task instance using the <code>taskId</code> and the information passed in the <code>name</code> and <code>uri</code> parameter. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to add a new attachment to a user task instance</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceAttachmentCreate(
        taskId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        user: "jdoe",
        groups: ["managers", "users", "IT"],
        name:"Attachment name"
        uri:"https://drive.google.com/file/d/1Z_Lipg2jzY9TNewTaskAttachmentUri"
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Update an attachment in a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Updates an attachment using the <code>attachmentId</code> and the information passed in the <code>name</code> and <code>uri</code> parameter in a user task instance. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to update a user task instance attachment</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceAttachmentUpdate(
        attachmentId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        name:"Attachment new name"
        uri:"https://drive.google.com/file/d/1Z_Lipg2jzY9TAttachmentNewUri",
        user: "jdoe",
        groups: ["managers", "users", "IT"]
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Delete an attachment in a user task instance</dt>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>Deletes an attachment using the <code>attachmentId</code> in a user task instance. The call allows you to pass the <code>user</code> and <code>groups</code> parameters even if the parameters are mandatory. If <code>user</code> and <code>groups</code> parameters are used to run the call to runtimes.</p>
</div>
<div class="listingblock">
<div class="title">Example mutation to delete a user task instance attachment</div>
<div class="content">
<pre class="highlight"><code>mutation{
    UserTaskInstanceAttachmentDelete(
        attachmentId:"b356d136-e601-43ee-9c2d-ee47198b9303",
        user: "jdoe",
        groups: ["managers", "users", "IT"]
    )
}</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div id="proc-data-index-service-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kogito Data Index Service security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based Kogito services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the Kogito Data Index Service to enable security using token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/data-index">Kogito Data Index Service</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/data-index">Kogito Data Index Service</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the Kogito Data Index Service repository and enter the following command to run the application with the required security properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Data Index Service with security properties</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev  \
  -Dquarkus.profile=keycloak  \
  -Dkogito.protobuf.folder=/home/git/kogito-apps/tree/master/data-index/data-index-service/src/test/resources  \
  -Dkogito.protobuf.watch=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kogito Data Index Service contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Data Index Service project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-service
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=service

%keycloak.quarkus.oidc.web-app-tenant.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.web-app-tenant.client-id=kogito-service
%keycloak.quarkus.oidc.web-app-tenant.credentials.secret=secret
%keycloak.quarkus.oidc.web-app-tenant.application-type=web-app

kogito.data-index.vertx-graphql.ui.path=/graphiql
kogito.data-index.vertx-graphql.ui.tenant=web-app-tenant

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The default configuration provides a multi-tenant configuration so that the Kogito Data Index Service can use two endpoints with different security <a href="https://quarkus.io/guides/security-openid-connect#quarkus-oidc_quarkus.oidc.application-type"><code>quarkus.oidc.application-type</code></a> configurations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>/graphql</code> endpoint is configured as a <code>service</code> application that enables Bearer token authentication.</p>
</li>
<li>
<p>The <code>/graphiql</code> interface endpoint, shown in the previous configuration file example, is configured as a <code>web-app</code> application that redirects unauthenticated users to the Keycloak login page. You configure this endpoint using the <code>kogito.data-index.vertx-graphql.ui.path</code> property.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>For example, you can enable only users with the role <code>confidential</code> to access a single <code>/graphql</code> endpoint:</p>
</div>
<div class="listingblock">
<div class="title">Example GraphQL security role configuration</div>
<div class="content">
<pre class="highlight"><code>%keycloak.quarkus.http.auth.policy.role-policy1.roles-allowed=confidential
%keycloak.quarkus.http.auth.permission.roles1.paths=/graphql
%keycloak.quarkus.http.auth.permission.roles1.policy=role-policy1</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop and restart the Kogito Data Index Service to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="proc-data-index-service-mongodb_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling MongoDB persistence for the Kogito Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>Instead of using the default Infinispan-based persistence in the Kogito Data Index Service, you can configure the Data Index Service to use <a href="https://www.mongodb.com/">MongoDB</a> persistence storage if needed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.mongodb.com/try/download">MongoDB Server</a> 3.6 or later is installed and running. For information about MongoDB installation and configuration, see the <a href="https://docs.mongodb.com/manual/installation/">MongoDB documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/data-index-service-mongodb/"><code>data-index-service-mongodb</code></a> artifacts page, select the latest release of the Data Index Service, and download the <code>data-index-service-mongodb-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>data-index-service-mongodb-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Data Index Service with the required MongoDB connection information:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Data Index Service with MongoDB connection information</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.mongodb.connection-string=<em>MONGODB_SERVER_CONNECTION_STRING</em> \
  -Dquarkus.mongodb.database=<em>DATABASE_NAME</em> \
  -jar data-index-service-mongodb-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about MongoDB configuration on Quarkus, see <a href="https://quarkus.io/guides/mongodb#quarkus-mongodb_configuration">Using the MongoDB client</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After the Data Index Service is running, compile and run your Kogito project as usual and navigate to the <code>http://<em>HOST</em>:<em>PORT</em></code> location configured for your running Kogito service, such as <code>http://localhost:8080/</code>, to explore the exposed data model.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Indexes are created on every attribute that is annotated with <code>@Indexed</code> and <code>@Field</code> in the protobuf files. However, a single MongoDB collection can have no more than 64 indexes, including the default <code>_id</code> Index.
</td>
</tr>
</table>
</div>
<div id="proc-data-index-service-postgresql_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling PostgreSQL persistence for the Kogito Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>Instead of using the default Infinispan-based persistence in the Kogito Data Index Service, you can configure the Data Index Service to use <a href="https://www.postgresql.org/">PostgreSQL</a> persistence storage if needed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.postgresql.org/download/">PostgreSQL Server</a> 13 or later is installed and running. For information about PostgreSQL installation and configuration, see the <a href="https://www.postgresql.org/docs/">PostgreSQL documentation</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/data-index-service-postgresql/"><code>data-index-service-postgresql</code></a> artifacts page, select the latest release of the Data Index Service, and download the <code>data-index-service-postgresql-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>data-index-service-postgresql-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Data Index Service with the required PostgreSQL connection information:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Data Index Service with PostgreSQL connection information</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.datasource.jdbc.url=<em>POSTGRESQL_SERVER_JDBC_URL</em> \
  -Dquarkus.datasource.username=<em>POSTGRESQL_USERNAME</em> \
  -Dquarkus.datasource.password=<em>POSTGRESQL_PASSWORD</em> \
  -jar data-index-service-postgresql-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about PostgreSQL configuration on Quarkus, see <a href="https://quarkus.io/guides/datasource#jdbc-configuration">JDBC Configuration Reference</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After the Data Index Service is running, compile and run your Kogito project as usual and navigate to the <code>http://<em>HOST</em>:<em>PORT</em></code> location configured for your running Kogito service, such as <code>http://localhost:8080/</code>, to explore the exposed data model.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Data Index Service with PostgreSQL does not support indexing domain-specific data. The GraphQL schema only exposes queries for <code>ProcessInstances</code>, <code>UserTaskInstances</code>, and <code>Jobs</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>==== PostgreSQL database setup for the Kogito Data Index Service</p>
</div>
<div class="paragraph">
<p>Kogito provides two ways to manage the database schema, either via manually applying the provided DDL <a href="https://repository.jboss.org/org/kie/kogito/kogito-ddl/10.0.0.0/">kogito-ddl-10.0.0.0-db-scripts.zip</a>, or via <a href="https://flywaydb.org/">Flyway</a> integration. This integration is done via Quarkus Flyway and the following <a href="https://quarkus.io/guides/flyway">guide</a> can give extra details about how to use it. In a nutshell, to create the required tables for Data Index on an empty database, you must add the <code>quarkus.flyway.migrate-at-start=true</code> property.</p>
</div>
<div id="proc-data-index-service-oracle_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Oracle persistence for the Kogito Data Index Service</p>
</div>
<div class="paragraph _abstract">
<p>You can configure the Kogito Data Index Service to use <a href="https://www.oracle.com/database/">Oracle</a> persistence storage if needed.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="https://www.oracle.com/database/">Oracle Database</a> is installed and running.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/data-index-service-oracle/"><code>data-index-service-oracle</code></a> artifacts page and select the latest release of the Data Index Service.</p>
</li>
<li>
<p>Download the <code>data-index-service-oracle-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>data-index-service-oracle-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Data Index Service with the required Oracle connection information:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Data Index Service with Oracle connection information</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.datasource.db-kind=oracle
  -Dquarkus.datasource.jdbc.url=<em>ORACLE_SERVER_JDBC_URL</em> \
  -Dquarkus.datasource.username=<em>ORACLE_USERNAME</em> \
  -Dquarkus.datasource.password=<em>ORACLE_PASSWORD</em> \
  -jar data-index-service-oracle-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Oracle configuration on Quarkus, see <a href="https://quarkus.io/guides/datasource#jdbc-configuration">JDBC Configuration Reference</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After the Data Index Service is running, compile and run your Kogito project as usual and navigate to the <code>http://<em>HOST</em>:<em>PORT</em></code> location configured for your running Kogito service, such as <code>http://localhost:8080/</code>, to explore the exposed data model.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Data Index Service with Oracle does not support indexing domain-specific data. The GraphQL schema only exposes queries for <code>ProcessInstances</code>, <code>UserTaskInstances</code>, and <code>Jobs</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>==== Oracle database setup for the Kogito Data Index Service</p>
</div>
<div class="paragraph">
<p>Kogito provides two ways to manage the database schema, either via manually applying the provided DDL <a href="https://repository.jboss.org/org/kie/kogito/kogito-ddl/10.0.0.0/">kogito-ddl-10.0.0.0-db-scripts.zip</a>, or via <a href="https://flywaydb.org/">Flyway</a> integration. This integration is done via Quarkus Flyway and the following <a href="https://quarkus.io/guides/flyway">guide</a> can give extra details about how to use it. In a nutshell, to create the required tables for Data Index on an empty database, you must add the <code>quarkus.flyway.migrate-at-start=true</code> property.</p>
</div>
<div id="con-data-index-dev-service_kogito-developing-decision-services" class="paragraph">
<p>=== Quarkus Dev Service for Kogito Data Index Service</p>
</div>
<div class="paragraph">
<p>When you use the Kogito Process Quarkus extension, a temporary Data Index Service is automatically provisioned while the Quarkus application is running in development mode. When you use one of the following Quarkus extensions, the Dev Service is set up for immediate use:</p>
</div>
<div class="listingblock">
<div class="title">Quarkus extension in Kogito</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;jbpm&lt;/groupId&gt;
  &lt;artifactId&gt;jbpm-quarkus&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Quarkus extension in Kogito</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.jbpm&lt;/groupId&gt;
  &lt;artifactId&gt;jbpm-quarkus&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you start your Quarkus project in development mode, an in-memory instance of the Data Index Service is automatically started in the background. This feature is enabled by <a href="https://quarkus.io/guides/dev-services">Quarkus Dev Services</a>, and leverages <a href="https://www.testcontainers.org/">Testcontainers</a> to start an image of the Data Index Service.</p>
</div>
<div class="paragraph">
<p>The Kogito Process Quarkus extension sets up your Quarkus application to automatically replicate any Kogito messaging events related to process instances and user tasks into the provisioned Data Index instance.</p>
</div>
<div class="paragraph">
<p>Once the service is up and running, you can query the GraphQL interface directly using <code><a href="http://localhost:8180/graphql" class="bare">http://localhost:8180/graphql</a></code> or using the Quarkus Dev UI console <code><a href="http://localhost:8080/q/dev" class="bare">http://localhost:8080/q/dev</a></code>.</p>
</div>
<div class="paragraph">
<p>The Data Index GraphQL endpoint can query for <code>ProcessInstances</code> and <code>UserTaskInstances</code>. For more information about operations and attributes to query, see <a href="https://kie.apache.org/kogito-docs/#con-data-index-service-queries_kogito-configuring"><em>Kogito Data Index GraphQL queries</em></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Quarkus Dev Service for the Kogito Data Index Service does not support indexing for custom types. The GraphQL schema only exposes queries for <code>ProcessInstances</code>, <code>UserTaskInstances</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can share the same Data Index instance across multiple Kogito services during development. Sharing Data Index instances is enabled by default, therefore, only one Data Index instance is started. This behaviour can be adjusted to start multiple instances using the <code>quarkus.kogito.devservices.shared</code> property.</p>
</div>
<div class="paragraph">
<p>The Quarkus Dev Service also allows further configuration options including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To disable Data Index Dev Service, use the <code>quarkus.kogito.devservices.enabled=false</code> property.</p>
</li>
<li>
<p>To change the port where the Data Index Service runs, use the <code>quarkus.kogito.devservices.port=8180</code> property.</p>
</li>
<li>
<p>To adjust the provisioned image, use <code>quarkus.kogito.devservices.imageName=quay.io/kiegroup/kogito-data-index-ephemeral</code> property.</p>
</li>
<li>
<p>To disable sharing the Data Index instance across multiple Quarkus applications, use <code>quarkus.kogito.devservices.shared=false</code> property.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about Quarkus Dev Services, see <a href="https://quarkus.io/guides/dev-services">Dev Services guide</a>.</p>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#proc-data-index-service-using_kogito-configuring">[proc-data-index-service-using_kogito-configuring]</a></p>
</li>
<li>
<p><a href="#con-persistence_kogito-configuring">[con-persistence_kogito-configuring]</a></p>
</li>
</ul>
</div>
<div id="con-jobs-service_kogito-developing-decision-services" class="paragraph">
<p>== Kogito Jobs Service</p>
</div>
<div class="paragraph _abstract">
<p>Kogito provides a Jobs Service for scheduling Business Process Model and Notation (BPMN) process events that are configured to be executed at a specified time. These time-based events in a process model are known as <em>jobs</em>.</p>
</div>
<div class="paragraph">
<p>By default, Kogito services use an in-memory timer service to handle jobs defined in your BPMN process models. This default timer service does not cover long time intervals and is only suitable for short delays defined in the process. For advanced use cases where time intervals can be days or weeks or when additional event handling options are required, you can configure your Kogito project to use the Kogito Jobs Service as an external timer service.</p>
</div>
<div class="paragraph">
<p>The Jobs Service does not execute a job, but triggers a callback that might be an HTTP request on an endpoint specified for the job request or any other configured callback. The Jobs Service receives requests for job scheduling and then sends a request at the time specified on the job request.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/jobs-service-architecture_enterprise.png" alt="Diagram of the Jobs Service architecture">
</div>
<div class="title">Figure 252. Jobs Service architecture</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Kogito Jobs Service currently supports only HTTP <code>POST</code> requests that are sent to an endpoint specified on the job-scheduling request. The HTTP callback information must be specified in the job-scheduling request.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The main goal of the Jobs Service is to work with only active jobs. The Jobs Service tracks only the jobs that are scheduled and that need to be executed. When a job reaches a final state, the job is removed from the Jobs Service. All job information and transition states are sent to the Kogito Data Index Service where they can be indexed and made available for GraphQL queries.</p>
</div>
<div class="paragraph">
<p>The Jobs Service implementation is based on non-blocking APIs and <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a> on top of Quarkus, which provides effective throughput and resource utilization. The scheduling engine is implemented on top of <a href="https://vertx.io/">Vert.x</a> and the external requests are built using a non-blocking HTTP client based on Vert.x.</p>
</div>
<div class="paragraph">
<p>=== Supported job states in the Kogito Jobs Service</p>
</div>
<div class="paragraph">
<p>The Kogito Jobs Service uses an internal state control mechanism to manage the job scheduling lifecycle using the following supported job states:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Scheduled</strong></p>
</li>
<li>
<p><strong>Executed</strong></p>
</li>
<li>
<p><strong>Canceled</strong></p>
</li>
<li>
<p><strong>Retry</strong></p>
</li>
<li>
<p><strong>Error</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Jobs Service workflow through these states is illustrated in the following diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/jobs-service-state-control_enterprise.png" alt="Diagram of Jobs Service states">
</div>
<div class="title">Figure 253. Jobs Service state control workflow</div>
</div>
<div class="paragraph">
<p>=== Supported job types in the Kogito Jobs Service</p>
</div>
<div class="paragraph">
<p>The Kogito Jobs Service supports the following job types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Time scheduled</strong>: A job that is scheduled at a specified time and executed only once when that point in time is reached. The time must be specified on the job scheduling request and must be in the future.</p>
</li>
<li>
<p><strong>Periodic scheduled</strong>: A job that is scheduled at a specified time and executed after a specified interval, and then executed repeatedly over a specified period of time until a limit of executions is reached. The execution limit and interval must be specified in the job-scheduling request.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Supported configuration properties in the Kogito Jobs Service</p>
</div>
<div class="paragraph">
<p>The Kogito Jobs Service supports the following configuration properties. You can set these properties either using the <code>-D</code> prefix during Jobs Service start-up or in the <code>src/main/resources/application.properties</code> file of the Jobs Service project.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 125. Supported configuration properties in Jobs Service</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 40%;">
<col style="width: 15%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.backoffRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the retry back-off time in milliseconds between job execution attempts, in case the execution fails</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.maxIntervalLimitToRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the maximum interval in milliseconds when retrying to execute jobs, in case the execution fails</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifies the Kafka bootstrap server address with the port used to publish events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost:9092</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name of the Kafka topic where the events are published</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito-jobs-events</code></p></td>
</tr>
</tbody>
</table>
<div id="proc-jobs-service-using_kogito-developing-decision-services" class="paragraph">
<p>=== Using the Kogito Jobs Service as a timer service</p>
</div>
<div class="paragraph _abstract">
<p>By default, Kogito services use an in-memory timer service to handle time-based events (jobs) defined in your Business Process Model and Notation (BPMN) process models. This default timer service does not cover long time intervals and is only suitable for short delays defined in the process.</p>
</div>
<div class="paragraph">
<p>For advanced use cases where time intervals can be days or weeks or when additional event handling options are required, you can configure your Kogito project to use the Kogito Jobs Service as an external timer service. Whenever you need to schedule a timer as part of process instance, the timer is scheduled in the Jobs Service and the Jobs Service calls back to the Kogito service upon timer expiration.</p>
</div>
<div class="paragraph">
<p>The Kogito Jobs Service also supports Infinispan, PostgreSQL, or MongoDB persistence that you can enable when you run the Jobs Service so that job data is preserved across application restarts.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/jobs-service-common"><code>jobs-service-common</code></a> artifacts page, select the latest release of the Jobs Service, and download the <code>jobs-service-common-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>jobs-service-common-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Jobs Service with in-memory persistence enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Jobs Service with in-memory persistence enabled</div>
<div class="content">
<pre class="highlight"><code>$ java -jar jobs-service-common-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the Jobs Service uses the default in-memory storage, all job information is lost between application restarts.</p>
</div>
<div class="paragraph">
<p>To change the logging level of the Jobs Service, such as for debugging, you can specify the following start-up properties:</p>
</div>
<div class="listingblock">
<div class="title">Modifying Jobs Service logging level for debugging</div>
<div class="content">
<pre class="highlight"><code>$ java  \
  -Dquarkus.log.console.level=DEBUG -Dquarkus.log.category.\"org.kie.kogito\".min-level=DEBUG  \
  -Dquarkus.log.category.\"org.kie.kogito\".level=DEBUG  \
  -jar jobs-service-common-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your Kogito project, add the following dependency to the <code>pom.xml</code> file to enable the Jobs Service add-on:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-jobs-management&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Spring Boot</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-springboot-jobs-management&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your Kogito project, add the following properties to the <code>src/main/resources/application.properties</code> to define the locations of the Jobs Service and the callback to be used when the timer expires:</p>
<div class="listingblock">
<div class="title">Configure Kogito service properties for Jobs Service</div>
<div class="content">
<pre class="highlight"><code>kogito.jobs-service.url=http://localhost:8085
kogito.service.url=http://localhost:8080</code></pre>
</div>
</div>
</li>
<li>
<p>In a command terminal, navigate to your Kogito project and run the project using your preferred run mode, such as development mode:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">On Quarkus</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Sprint Boot</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the Jobs Service and your Kogito project both configured and running, the Jobs Service can receive any job-scheduling requests to function as the external timer service.</p>
</div>
<div class="paragraph">
<p>By default, the implementation of the Jobs Service uses the following basic components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An implementation of the <code>org.kie.kogito.jobs.JobsService</code> interface that is used by the service to schedule jobs</p>
</li>
<li>
<p>A REST endpoint registered at the path <code>/management/jobs</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the default REST clients used by the Jobs Service add-on do not meet your needs, you can configure custom REST clients using the relevant service implementors. The REST client depends on the application type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On Quarkus, the Jobs Service uses a Vert.x web client: <code>io.vertx.ext.web.client.WebClient</code></p>
</li>
<li>
<p>On Spring Boot, the Jobs Service uses a rest template: <code>org.springframework.web.client.RestTemplate</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In both cases, you produce an instance of the client to enable detailed setup of the client.</p>
</div>
<div class="openblock">
<div class="content">
<div id="proc-jobs-service-persistence_kogito-developing-decision-services" class="paragraph">
<p>=== Persistence in the Kogito Jobs Service</p>
</div>
<div class="paragraph _abstract">
<p>The Kogito Jobs Service supports the following persistence mechanisms for job data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>In-memory persistence</strong>: (Default) Job data is persisted with the Jobs Service in-memory storage during the Jobs Service runtime. If the Jobs Service is restarted, all job information is lost. If no other persistence configuration is set, the Jobs Service uses this persistence mechanism.</p>
</li>
<li>
<p><strong>Infinispan persistence</strong>: Job data is persisted using Infinispan storage so that the data is preserved across application restarts. If the Jobs Service is restarted, the service continues to process any previously scheduled jobs.</p>
</li>
<li>
<p><strong>PostgreSQL persistence</strong>: Job data is persisted using PostgreSQL storage so that the data is preserved across application restarts. If the Jobs Service is restarted, the service continues to process any previously scheduled jobs. Flyway is used to manage database schema.</p>
</li>
<li>
<p><strong>MongoDB persistence</strong>: Job data is persisted using MongoDB storage so that the data is preserved across application restarts. If the Jobs Service is restarted, the service continues to process any previously scheduled jobs.</p>
</li>
</ul>
</div>
<div id="proc-jobs-service-persistence-infinispan_kogito-developing-decision-services" class="paragraph">
<p>==== Enabling Infinispan persistence in the Kogito Jobs Service</p>
</div>
<div class="paragraph">
<p>You can enable Infinispan persistence in the Kogito Jobs Service during application start-up.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/jobs-service-infinispan"><code>jobs-service-infinispan</code></a> artifacts page, select the latest release of the Jobs Service, and download the <code>jobs-service-infinispan-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>jobs-service-infinispan-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Jobs Service with Infinispan persistence enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Jobs Service with Infinispan persistence enabled</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -jar jobs-service-infinispan-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about Infinispan configuration with Quarkus applications, see <a href="https://quarkus.io/guides/infinispan-client">Infinispan client</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div id="proc-jobs-service-persistence-postgresql_kogito-developing-decision-services" class="paragraph">
<p>==== Enabling PostgreSQL persistence in the Kogito Jobs Service</p>
</div>
<div class="paragraph">
<p>You can enable PostgreSQL persistence in the Kogito Jobs Service during application start-up.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/jobs-service-postgresql"><code>jobs-service-postgresql</code></a> artifacts page, select the latest release of the Jobs Service, and download the <code>jobs-service-postgresql-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>jobs-service-postgresql-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Jobs Service with PostgreSQL persistence enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Jobs Service with PostgreSQL persistence enabled</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -Dquarkus.datasource.jdbc.url=<em>DATASOURCE_JDBC_URL</em> \
    -Dquarkus.datasource.reactive.url=<em>DATASOURCE_URL</em> \
    -Dquarkus.datasource.username=<em>DATASOURCE_USERNAME</em> \
    -Dquarkus.datasource.password=<em>DATASOURCE_PASSWORD</em> \
    -jar jobs-service-postgresql-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, <a href="https://quarkus.io/guides/flyway">Flyway</a> is enabled in the Kogito Jobs Service. According to the <code>quarkus.datasource.jdbc.url</code> property, Flyway creates or updates the required database schema to run the Jobs Service, alongside configured user must have permissions to alter the database.</p>
</div>
<div class="paragraph">
<p>In case you want to manage the database without Flyway automation, set the <code>-Dquarkus.flyway.migrate-at-start</code> property to <code>false</code> when you start the Jobs Service, otherwise, the service might fail during the initialization.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about PostgreSQL configuration with Quarkus applications, see <a href="https://quarkus.io/guides/reactive-sql-clients">Quarkus reactive SQL client</a> and <a href="https://quarkus.io/guides/flyway">Flyway</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div id="proc-jobs-service-persistence-mongodb_kogito-developing-decision-services" class="paragraph">
<p>==== Enabling MongoDB persistence in the Kogito Jobs Service</p>
</div>
<div class="paragraph">
<p>You can enable MongoDB persistence in the Kogito Jobs Service during application start-up.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Go to the <a href="https://repository.jboss.org/org/kie/kogito/jobs-service-mongodb"><code>jobs-service-mongodb</code></a> artifacts page, select the latest release of the Jobs Service, and download the <code>jobs-service-mongodb-<em>VERSION</em>-runner.jar</code> file to a local directory.</p>
</li>
<li>
<p>In a command terminal, navigate to the directory location of the downloaded <code>jobs-service-mongodb-<em>VERSION</em>-runner.jar</code> file and enter the following command to run the Jobs Service with MongoDB persistence enabled:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Running the Jobs Service with MongoDB persistence enabled</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -Dquarkus.mongodb.connection-string=<em>MONGODB_SERVER_CONNECTION_STRING</em> \
    -Dquarkus.mongodb.database=<em>DATABASE_NAME</em> \
    -jar jobs-service-mongodb-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about MongoDB configuration with Quarkus applications, see <a href="https://quarkus.io/guides/mongodb">Using the MongoDB client</a> in the Quarkus documentation.</p>
</div>
<div class="openblock">
<div class="content">
<div id="proc-jobs-service-messaging_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kafka messaging in the Kogito Jobs Service</p>
</div>
<div class="paragraph _abstract">
<p>The Kogito Jobs Service supports Apache Kafka messaging to publish events for each job state transition to a defined Kafka topic. Any application can subscribe to this Kafka topic to receive information about jobs and job state transitions. For example, the Kogito Data Index Service is subscribed to the Jobs Service Kafka topic so that if you configure and run the Jobs Service, the Data Index Service can begin indexing jobs with their current state.</p>
</div>
<div class="paragraph">
<p>You can enable Kafka messaging in the Kogito Jobs Service during application start-up and in the Jobs Service <code>application.properties</code> file.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the <code>src/main/resources/application.properties</code> file in the Jobs Service project, add the following properties to identify the Kafka bootstrap server with the port used to publish events and the Kafka topic where the events are published:</p>
<div class="listingblock">
<div class="title">Defining Kafka server and topic in Jobs Service <code>application.properties</code></div>
<div class="content">
<pre class="highlight"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.bootstrap.servers=<em>SERVER_ADDRESS</em>
mp.messaging.outgoing.kogito-job-service-job-status-events.topic=<em>TOPIC_NAME</em></code></pre>
</div>
</div>
</li>
<li>
<p>Run the Jobs Service with the property <code>-Dquarkus.profile=events-support</code>:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Enabling Kafka messaging during Jobs Service start-up</div>
<div class="content">
<pre class="highlight"><code>$ java  \
    -Dquarkus.profile=events-support  \
    -jar jobs-service-common-<em>VERSION</em>-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can add the environment variable <code>QUARKUS_PROFILE=events-support</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div id="proc-jobs-service-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kogito Jobs Service security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based Kogito services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the Kogito Jobs Service to enable security using bearer token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/jobs-service">Kogito Jobs Service</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/jobs-service">Kogito Jobs Service</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the Kogito Jobs Service repository and enter the following command to run the application with the required security properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the Jobs Service with security properties</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev  -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jobs Service contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Jobs Service project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code>%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-jobs-service
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.http.auth.policy.role-policy1.roles-allowed=confidential
%keycloak.quarkus.http.auth.permission.roles1.paths=/*
%keycloak.quarkus.http.auth.permission.roles1.policy=role-policy1</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the same <code>application.properties</code> file, also configure the resources to be exposed and the required permissions for accessing the resources.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This example configuration enables only users with role <code>confidential</code> to access any endpoint.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop and restart the Kogito Jobs Service to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div id="con-bpmn-process-management-addon_kogito-developing-decision-services" class="paragraph">
<p>== Kogito process management add-on</p>
</div>
<div class="paragraph _abstract">
<p>Kogito provides a <code>kie-addons-quarkus-process-management</code> add-on that enables basic REST operations that you can use to manage process instances. These REST operations are supplemental to any other specific REST operations that you have configured in your application.</p>
</div>
<div class="paragraph">
<p>To configure process management REST capabilities for your Kogito services, you can add the process management add-on as a dependency in the <code>pom.xml</code> file of your Kogito project:</p>
</div>
<div class="listingblock">
<div class="title">Project dependency to enable process management REST operations</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.kie.kie&lt;/groupId&gt;
  &lt;artifactId&gt;kie-addons-quarkus-process-management&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kogito process management add-on provides REST support for the following basic operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Process instances</strong>: Abort an active process instance</p>
</li>
<li>
<p><strong>Node instances</strong>:  Cancel or re-trigger a node instance, or trigger a new node instance</p>
</li>
<li>
<p><strong>Error handling</strong>: Retrieve error details for a process instance, or skip or re-trigger a failed node instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to exposed REST operations, the process management add-on also provides the following REST exception mappers to generate more meaningful error messages for typical exception types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ProcessInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeInstanceNotFound</code></p>
</li>
<li>
<p><code>NodeNotFound</code></p>
</li>
<li>
<p><code>ProcessInstanceExecutionError</code></p>
</li>
<li>
<p><code>NotAuthorized</code></p>
</li>
<li>
<p><code>InvalidTransition</code> (for work items)</p>
</li>
<li>
<p><code>InvalidLifeCyclePhase</code> (for work items)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These exception mappers produce a valid HTTP error code with JSON payload with the context that caused the exception.</p>
</div>
<div class="paragraph">
<p>For example, the following is a <code>ProcessInstanceNotFoundException</code> error generated at runtime:</p>
</div>
<div class="listingblock">
<div class="title">Example error with JSON payload at runtime</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">HTTP code : 404

{
  "processInstanceId" : "c6862071-0f2e-4f21-9bc8-586245a76c3aa",
  "message" : "Process instance with id c6862071-0f2e-4f21-9bc8-586245a76c3aa not found"
}</code></pre>
</div>
</div>
<div id="con-trusty-service_kogito-developing-decision-services" class="paragraph">
<p>== Kogito Trusty Service and Explainability Service</p>
</div>
<div class="paragraph _abstract">
<p>Kogito provides a Trusty Service that stores all Kogito tracing events related to decisions made in Kogito services. As an aid to the Trusty Service workflow for storing tracing events, Kogito also provides a supplemental Explainability Service that provides an explanation for the decisions made in Kogito services.</p>
</div>
<div class="paragraph">
<p>The Trusty Service uses Apache Kafka messaging to consume <a href="https://cloudevents.io/">CloudEvents</a> messages from Kogito services, and then processes the tracing events and stores the data, including any explainability results from the Explainability Service, in the Infinispan persistence store. The Explainability Service likewise uses Apache Kafka messaging to consume CloudEvents messages from the Trusty Service, and then applies explainability algorithms. Some algorithms require the Explainability Service to interact with the Kogito service that evaluated the decision. This communication is performed with HTTP <code>POST</code> requests.</p>
</div>
<div class="paragraph">
<p>The Trusty Service and Explainability Service are at the core of the TrustyAI metrics monitoring initiative in Kogito.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./kogito/configuration/trusty-architecture_enterprise.png" alt="Diagram of an example Kogito service using Trusty Service">
</div>
<div class="title">Figure 254. Trusty Service and Explainability Service architecture in an example Kogito service</div>
</div>
<div class="paragraph">
<p>The Kogito Trusty Service has the following key attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Focus on decisions</p>
</li>
<li>
<p>Flexible data structure</p>
</li>
<li>
<p>Distributable and cloud-ready format</p>
</li>
<li>
<p>Infinispan-based persistence support</p>
</li>
<li>
<p>Message-based communication with Kogito runtime (Apache Kafka, cloud events )</p>
</li>
<li>
<p>Integration with the Explainability Service to retrieve advanced analysis for the decisions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Kogito Trusty Service and Explainability Service are Quarkus applications, based on <a href="https://vertx.io/">Vert.x</a> with <a href="https://smallrye.io/smallrye-reactive-messaging/">Reactive Messaging</a>. Tracing data from the Trusty Service is parsed and pushed into the <strong>Decisions</strong> cache for each decision made in a Kogito service. Each record contains information about all decision inputs, outputs, and errors, if any.</p>
</div>
<div class="paragraph">
<p>The Trusty Service storage is provided by <a href="https://infinispan.org/">Infinispan</a>. Communication between the Trusty Service and Infinispan is handled through a protobuf (<a href="https://developers.google.com/protocol-buffers/">protocol buffers</a>) schema and generated marshallers.</p>
</div>
<div class="paragraph">
<p>After the tracing event is analyzed and stored, the Trusty Service exposes the data with a dedicated API.</p>
</div>
<div class="paragraph">
<p>For example Kogito services that use the Trusty Service and Explainability Service, see the following example applications in GitHub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/apache/incubator-kie-kogito-examples/tree/stable/dmn-tracing-quarkus"><code>dmn-tracing-quarkus</code></a>: A DMN decision service on Quarkus that uses the <code>kie-addons-quarkus-tracing-decision</code> add-on to generate tracing events that the Kogito Trusty Service and Explainability Service can consume and expose.</p>
</li>
</ul>
</div>
<div id="proc-trusty-service-security_kogito-developing-decision-services" class="paragraph">
<p>=== Enabling Kogito Trusty Service security with OpenID Connect</p>
</div>
<div class="paragraph _abstract">
<p>For Quarkus-based Kogito services, you can use the <a href="https://quarkus.io/guides/security-openid-connect">Quarkus OpenID Connect adapter</a> with the Kogito Trusty Service to enable security using token authorization. These tokens are issued by OpenID Connect and OAuth 2.0 compliant authorization servers such as <a href="https://www.keycloak.org/about.html">Keycloak</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This procedure applies only when you are using a locally cloned copy of the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/trusty">Kogito Trusty Service</a> repository in GitHub.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have cloned the <a href="https://github.com/apache/incubator-kie-kogito-apps/tree/master/trusty">Kogito Trusty Service</a> repository from GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a command terminal, navigate to the local clone of the Kogito Trusty Service repository and enter the following command to run the application with the required security properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Run the trusty Service with security properties</div>
<div class="content">
<pre class="highlight"><code>mvn clean compile quarkus:dev -Dquarkus.profile=keycloak</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kogito Trusty Service contains a Quarkus profile to encapsulate the security configuration, so if the service requires security, you can specify the <code>quarkus.profile=keycloak</code> property at build time to enable the needed security. If the <code>keycloak</code> Quarkus profile is not added, the OpenID Connect extension is disabled.</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <code>src/main/resources/application.properties</code> file of the Trusty Service project and add the following properties:</p>
</li>
</ol>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">Required security properties in <code>applications.properties</code> file</div>
<div class="content">
<pre class="highlight"><code># OpenID Connect configurations
%keycloak.quarkus.oidc.enabled=true
%keycloak.quarkus.oidc.tenant-enabled=true
%keycloak.quarkus.oidc.auth-server-url=http://localhost:8280/auth/realms/kogito
%keycloak.quarkus.oidc.client-id=kogito-service
%keycloak.quarkus.oidc.credentials.secret=secret
%keycloak.quarkus.oidc.application-type=service

# HTTP security configurations
%keycloak.quarkus.http.auth.permission.authenticated.paths=/*
%keycloak.quarkus.http.auth.permission.authenticated.policy=authenticated</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>quarkus.oidc.enabled</code> property enables or disables security at build time, while the <code>quarkus.oidc.tenant-enabled</code> property enables or disables security at runtime.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replace any property definitions with those of your specific environment, especially the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>quarkus.oidc.auth-server-url</code>: The base URL of the OpenID Connect (OIDC) server, such as <code><a href="https://localhost:8280/auth" class="bare">https://localhost:8280/auth</a></code>. All other OIDC server page and service URLs are derived from this URL. If you work with Keycloak OIDC server, ensure that the base URL is in the following format: <code>https://<em>HOST</em>:<em>PORT</em>/auth/realms/<em>KEYCLOAK_REALM</em></code>.</p>
</li>
<li>
<p><code>quarkus.oidc.client-id</code>: The client ID of the application. Each application has a client ID that is used to identify the application.</p>
</li>
<li>
<p><code>quarkus.oidc.credentials.secret</code>: The client secret for the application.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are enabling security at runtime using the <code>quarkus.oidc.tenant-enabled</code> property, the <code>quarkus.http.auth.permission</code> path and policy must specify how authentication is applied. By default, if security is enabled, the user must be authenticated to access any path.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Stop and restart the Kogito Trusty Service to ensure that the security changes are applied.</p>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://quarkus.io/guides/security">Security Architecture and Guides</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect#configuring-using-the-application-properties-file">Configuring using the application.properties file</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/security-openid-connect-multitenancy">Using OpenID Connect multi-tenancy</a></p>
</li>
</ul>
</div>
<div class="paragraph _additional-resources">
<p>== Additional resources
* <a href="https://kie.apache.org/kogito-docs/"><em>Creating and running your first Kogito services</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Developing decision services with Kogito</em></a>
* <a href="https://kie.apache.org/kogito-docs/"><em>Developing process services with Kogito</em></a></p>
</div>
<div id="chap-kogito-release-notes" class="paragraph">
<p>= Release notes for Kogito 10.0.0
:parent-context: kogito-developing-decision-services
:context: kogito-release-notes</p>
</div>
<div class="paragraph _abstract">
<p>These release notes highlight some of the new features, fixed issues, and known issues in Kogito 10.0.0. These release notes are not comprehensive.</p>
</div>
<div class="paragraph">
<p>For the complete list of new features, fixed issues, and known issues in Kogito 10.0.0, see the following release notes pages in Atlassian Jira. Each Kogito release includes one or more Kogito tooling releases as shown in this list.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://issues.redhat.com/secure/ReleaseNote.jspa?projectId=12322421&amp;version=12406529">Kogito 10.0.0.0</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="https://issues.redhat.com/secure/ReleaseNote.jspa?projectId=12322421&amp;version=12410158">Kogito tooling 0.31.0</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="ref-kogito-rn-key-features_kogito-developing-decision-services" class="paragraph">
<p>== Summary of key features in Kogito</p>
</div>
<div class="paragraph _abstract">
<p>Kogito offers the following key features. For more information about these and other features in Kogito, see the Kogito documentation links where provided. Not all Kogito features are fully documented.</p>
</div>
<div class="paragraph">
<p>=== Kogito domain-specific services</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lightweight cloud-native services based on high-level business models, such as processes and decisions</p>
</li>
<li>
<p>Layering on <a href="https://quarkus.io/">Quarkus</a> or <a href="https://spring.io/projects/spring-boot">Spring Boot</a> to enable developers to run Kogito on their preferred cloud-native application development stack</p>
</li>
<li>
<p>Automated decision-making capabilities based on rule units to run within defined business constraints</p>
</li>
<li>
<p>Automatically generated business domain APIs using domain-specific data models</p>
</li>
<li>
<p>Standards-based resources for Kogito services, such as <a href="https://www.omg.org/spec/BPMN/2.0/About-BPMN">Business Process Model and Notation (BPMN) 2.0</a> for processes, <a href="https://www.omg.org/spec/DMN">Decision Model and Notation (DMN)</a> for decisions, and <a href="https://github.com/eclipse/microprofile-reactive-messaging">MicroProfile Reactive Messaging</a> and <a href="https://cloudevents.io/">CloudEvents</a> for messaging</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#collection-kogito-developing-decision-services"><em>Developing decision services with Kogito</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#chap-kogito-developing-process-services"><em>Developing process services with Kogito</em></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Kogito supporting services and consoles</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data Index Service for indexing, storing, and querying your Kogito service data</p>
</li>
<li>
<p>Jobs Service for scheduling process events over extended periods of time</p>
</li>
<li>
<p>Trusty Service for storing all Kogito tracing events related to decisions made in Kogito services.</p>
</li>
<li>
<p>Explainability Service that provides an explanation for the decisions made in Kogito services, in conjunction with the Trusty Service.</p>
</li>
<li>
<p>NoSQL key-value persistence store based on <a href="https://infinispan.org/">Infinispan</a> to enable elastic persistence scalability</p>
</li>
<li>
<p>JSON-like document-based persistence with <a href="https://www.mongodb.com/">MongoDB</a> as an alternative to using Infinispan for Kogito runtime persistence</p>
</li>
<li>
<p>Messaging capabilities based on <a href="https://kafka.apache.org/">Apache Kafka</a> to enable messages as either input or output of business process execution</p>
</li>
<li>
<p>Business monitoring capabilities based on <a href="https://prometheus.io/">Prometheus</a> for generated metrics</p>
</li>
<li>
<p>Process management add-on to enable basic REST operations for managing process instances</p>
</li>
<li>
<p>Process SVG add-on to enable basic REST operations for visualizing process diagram and the related execution path</p>
</li>
<li>
<p>Management Console includes a new panel to view the process diagram, displaying the execution path of the related process instance</p>
</li>
<li>
<p>Management Console user interface for viewing the state of all available Kogito services and managing process instances</p>
</li>
<li>
<p>Task Console user interface for viewing and interacting with user tasks in Kogito process services.</p>
</li>
<li>
<p>Audit Investigation Console user interface for monitoring and investigating Decision Model and Notation (DMN) model executions in Kogito.</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-data-index-service_kogito-configuring"><em>Kogito Data Index Service</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-jobs-service_kogito-configuring"><em>Kogito Jobs Service</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-trusty-service_kogito-configuring"><em>Kogito Trusty Service and Explainability Service</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-infinispan-persistence-enabling_kogito-configuring"><em>Enabling Infinispan persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-mongodb-persistence-enabling_kogito-configuring"><em>Enabling MongoDB persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-kafka-streams-persistence-enabling_kogito-configuring"><em>Enabling Kafka Streams persistence for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#proc-messaging-enabling_kogito-configuring"><em>Enabling messaging for Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-management-console_kogito-developing-process-services"><em>Kogito Management Console</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-task-console_kogito-developing-process-services"><em>Kogito Task Console</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-audit-console_kogito-dmn-models"><em>Kogito Audit Investigation Console</em></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Kogito developer tooling</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code generation based on the process models and decision models that developers create</p>
</li>
<li>
<p>Local live (hot reload) coding on Quarkus for Kogito domain-specific services</p>
</li>
<li>
<p><strong>Apache KIE™ Kogito Bundle</strong> VSCode extension (recommended) for modeling in Visual Studio Code</p>
</li>
<li>
<p>Kogito GitHub Chrome extension for viewing graphical business models directly in GitHub, including model differences in GitHub pull requests</p>
</li>
<li>
<p>Business Modeler online viewer for online modeling</p>
</li>
<li>
<p>Kogito DMN editor supports opening DMN 1.1, DMN 1.2, and DMN 1.3 models and saves any model as DMN 1.2</p>
</li>
<li>
<p>Kogito standalone editors for embedding editors in your application</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#chap-kogito-creating-running"><em>Creating and running your first Kogito services</em></a></p>
</li>
<li>
<p><a href="https://kie.apache.org/kogito-docs/#con-kogito-modelers_kogito-creating-running"><em>Kogito BPMN and DMN modelers</em></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>=== Kogito deployment on OpenShift</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Scalable and auto-provisioned infrastructure managed by the Kogito Operator</p>
</li>
<li>
<p>Kogito command-line interface (CLI) to interact with the Kogito Operator to deploy Kogito services on OpenShift</p>
</li>
<li>
<p>Support for Source-to-Image (S2I) builds and binary builds for deploying Kogito services on OpenShift</p>
</li>
</ul>
</div>
<div id="ref-kogito-rn-new-features-1.43_kogito-developing-decision-services" class="paragraph">
<p>= New features in Kogito 1.43.0</p>
</div>
<div class="paragraph _abstract">
<p>The following sections describe some of the new features or enhancements in Kogito 1.43.0.</p>
</div>
<div class="paragraph">
<p>== Kogito runtimes</p>
</div>
<div class="paragraph">
<p>=== Kogito Serverless Workflow</p>
</div>
<div class="paragraph">
<p><a href="https://kiegroup.github.io/kogito-docs/serverlessworkflow/1.43.0.Final/release_notes.html">New features on 1.43.0</a>.</p>
</div>
<div id="ref-kogito-rn-known-issues_kogito-developing-decision-services" class="paragraph">
<p>== Known issues in Kogito 10.0.0</p>
</div>
<div class="paragraph _abstract">
<p>The following list describes some of the known issues in Kogito 10.0.0. For more information about each known issue, select the Atlassian Jira link provided.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 10.0.0<br>
Last updated 2025-05-07 00:47:26 UTC
</div>
</div>
<!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<!-- Collapsed Table of Content -->
<script src="website/jquery/jquery.min.js"></script>
<script src="website/jstree/jstree.min.js"></script>
<script src="website/toc.js"></script>
</body>
</html>