<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduction :: SonataFlow Guides</title>
    <meta name="description" content="Job Service to control timeouts in SonataFlow">
    <meta name="keywords" content="sonataflow, workflow, serverless, timeout, timer, expiration, job service">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">

<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="stylesheet" href="../../../_/css/menu.css">
<link rel="stylesheet" href="../../../_/css/tabs.css">
<link rel="stylesheet" href="../../../_/css/navbar.css">
<link rel="stylesheet" href="../../../_/css/custom.css">
<link rel="stylesheet" href="../../../_/css/home.css"><script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
    <nav class="navbar">
        <div class="navbar-brand">
            <div class="navbar-item">
                <a href="../../..">
                    <img src="../../../_/img/sonata-flow-color-justlogo-circle-white.png" height="50px" alt="SonataFlow logo"/>
                </a>
                <a class="navbar-item" href="../../..">
                    SonataFlow Guides
                </a>
            </div>
                <div class="navbar-item search hide-for-print">
                    <div id="search-field" class="field">
                        <input id="search-input" type="text" placeholder="Search docs">
                    </div>
                </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a class="navbar-item small-item" href="https://github.com/apache"
                       target="_blank" title="Follow KIE on GitHub">
                        <div class="github-icon"></div>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="serverlessworkflow" data-version="10.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">SonataFlow Guides</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../release_notes.html">Release notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/learning-environment.html">Learning environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/preparing-environment.html">Environment setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/production-environment.html">Production environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/getting-familiar-with-our-tooling.html">Getting familiar with SonataFlow tooling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/introduction-sonataflow-development-guide.html">Introduction to SonataFlow development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/java-embedded-workflows.html">Workflow embedded execution in Java</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Core Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/cncf-serverless-workflow-specification-support.html">Serverless Workflow Specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/handling-events-on-workflows.html">Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/working-with-callbacks.html">Callbacks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/understanding-jq-expressions.html">jq Expressions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/understanding-workflow-error-handling.html">Error handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/configuration-properties.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/defining-an-input-schema-for-workflows.html">Input Schema</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/custom-functions-support.html">Custom Functions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/timeouts-support.html">Timeouts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../core/working-with-parallelism.html">Parallelism</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tooling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-overview.html">Editor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-vscode-extension.html">VS Code extension</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tooling/serverless-workflow-editor/swf-editor-chrome-extension.html">Chrome extension for GitHub</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-overview.html">Serverless Logic Web Tools</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-github-integration.html">Integration with GitHub</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-openshift-integration.html">Integration with OpenShift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-redhat-application-services-integration.html">Integration with Service Registries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tooling/serverless-logic-web-tools/serverless-logic-web-tools-deploy-projects.html">Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cloud/index.html">Cloud</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cloud/custom-ingress-authz.html">Securing Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cloud/deploying-sonataflow-management-console-on-kubernetes.html">Deploying Management Console on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Operator</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/install-serverless-operator.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/global-configuration.html">Admin Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/developing-workflows.html">Development Mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/referencing-resource-files.html">Referencing Workflow Resources</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/configuring-workflows.html">Workflow Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/build-and-deploy-workflows.html">Building and Deploying Workflow Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/supporting-services.html">Deploy Supporting Services</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/workflow-status-conditions.html">Custom Resource Status</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/building-custom-images.html">Building Custom Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/customize-podspec.html">Custom Workflow PodSpec</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/service-discovery.html">Service Discovery</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/using-persistence.html">Workflow Persistence</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/configuring-workflow-eventing-system.html">Workflow Eventing System</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/configuring-knative-eventing-resources.html">Knative Eventing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Monitoring</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../cloud/operator/monitoring-workflows.html">Workflow Monitoring</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../cloud/operator/sonataflow-metrics.html">Prometheus Metrics for Workflows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/known-issues.html">Roadmap and Known Issues</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cloud/operator/add-custom-ca-to-a-workflow-pod.html">Add Custom CA to Workflow Pod</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Service Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../service-orchestration/orchestration-of-openapi-based-services.html">OpenAPI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../service-orchestration/configuring-openapi-services-endpoints.html">Advanced Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../service-orchestration/working-with-openapi-callbacks.html">Callbacks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../service-orchestration/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Event Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../eventing/orchestration-of-asyncapi-based-services.html">AsyncAPI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../eventing/event-correlation-with-workflows.html">Event Correlation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Client Authentication</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../security/authention-support-for-openapi-services.html">OpenAPI Authentication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../security/orchestrating-third-party-services-with-oauth2.html">OpenAPI OAuth2</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Executing, Testing and Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../testing-and-troubleshooting/kn-plugin-workflow-overview.html">KN CLI Workflow plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-overview.html">Developer UI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-instances-page.html">Workflow Instances</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-workflow-definition-page.html">Workflow Definitions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-monitoring-page.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../testing-and-troubleshooting/quarkus-dev-ui-extension/quarkus-dev-ui-custom-dashboard-page.html">Dashboards</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../persistence/core-concepts.html">Core concepts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/core-concepts.html">Introduction</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Job Service</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="core-concepts.html">Core Concepts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Index</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-index/data-index-core-concepts.html">Core concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-index/data-index-service.html">Standalone service</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Use Cases</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/index.html">SonataFlow applications development using Quarkus and Java</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/create-your-first-workflow-service.html">Creating a Quarkus Workflow service</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/create-your-first-workflow-project.html">Creating a Quarkus Workflow project</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/build-workflow-image-with-quarkus-cli.html">Building workflow images using Quarkus CLI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/working-with-serverless-workflow-quarkus-examples.html">Working with SonataFlow example applications</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/getting-started/test-serverless-workflow-quarkus-examples.html">Testing images of SonataFlow example applications using Quarkus CLI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Deployment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/deployments/deploying-on-minikube.html">Deploying on Minikube</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/deployments/deploying-on-kubernetes.html">Deploying on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/deployments/deploying-on-openshift.html">Deploying on OpenShift</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/persistence-core-concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/persistence-with-postgresql.html">Running a Quarkus Workflow Application using PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/postgresql-advanced-concepts.html">Postgresql Advanced Concepts</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/postgresql-flyway-migration.html">PostgreSQL Database Migration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/persistence/integration-tests-with-postgresql.html">SonataFlow integration test using PostgreSQL</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Job Service</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/job-service/quarkus-extensions.html">Job Service Quarkus Extensions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data Index</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-as-quarkus-dev-service.html">Data Index as a Quarkus Development service</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-usecase-singleton.html">Deploying Data Index and SonataFlow application on Minikube</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-usecase-multi.html">Deploying Data Index and multiple SonataFlow applications on Minikube</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/data-index/data-index-quarkus-extension.html">Data Index Quarkus extensions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Service Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/service-orchestration/configuring-openapi-services-endpoints-with-quarkus.html">Configuring the OpenAPI services endpoints in different environments</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/service-orchestration/orchestration-of-grpc-services.html">Orchestrating gRPC based Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Service Discovery</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/service-discovery/kubernetes-service-discovery.html">Service Discovery</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Event Orchestration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/consume-produce-events-with-knative-eventing.html">Consuming and producing events on Knative Eventing in Quarkus</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/consume-producing-events-with-kafka.html">Consuming and producing events using Apache Kafka in Quarkus</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/orchestration-based-saga-pattern.html">Saga orchestration example in SonataFlow</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/event-orchestration/newsletter-subscription-example.html">Newsletter subscription example in SonataFlow</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Timeouts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/timeouts/timeout-showcase-example.html">Timeouts Showcase in SonataFlow</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Callbacks</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/callbacks/callback-state-example.html">Example of SonataFlow application using callback state with Quarkus</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrations of external services</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/camel-routes-integration.html">Integrating with Camel routes</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/custom-functions-knative.html">Invoking Knative services from SonataFlow</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/custom-functions-python.html">Invoking Python from SonataFlow</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/expose-metrics-to-prometheus.html">Exposing Workflow base metrics to Prometheus</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/integrations/serverless-dashboard-with-runtime-data.html">Displaying Workflow Data in Dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Testing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/testing/basic-integration-tests-with-restassured.html">Testing your Quarkus Workflow Application using REST Assured</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/testing/mocking-http-cloudevents-with-wiremock.html">Mocking HTTP CloudEvents sink using WireMock</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../use-cases/advanced-developer-use-cases/testing/mocking-openapi-services-with-wiremock.html">Mocking OpenAPI services using WireMock</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SonataFlow Guides</span>
    <span class="version">10.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">SonataFlow Guides</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">10.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">SonataFlow Guides</a></li>
    <li>Job Service</li>
    <li><a href="core-concepts.html">Core Concepts</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/incubator-kie-kogito-docs/edit/10.0.x/serverlessworkflow/modules/ROOT/pages/job-services/core-concepts.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Introduction</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Job Service facilitates the scheduled execution of tasks in a cloud environment. These tasks are implemented by independent services, and can be started by using any of the Job Service supported interaction modes, based on Http calls or Knative Events delivery.</p>
</div>
<div class="paragraph">
<p>To schedule task execution, you must create a Job configured with the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Schedule</code>: the job triggering periodicity.</p>
</li>
<li>
<p><code>Recipient</code>: the entity that is called on the job execution for the given interaction mode, and  receives the execution parameters.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/job-services/Job-Service-Generic-Diagram.png" alt="Job Service Generic Diagram">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="integration-with-the-workflows"><a class="anchor" href="#integration-with-the-workflows"></a>Integration with the Workflows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the context of the SonataFlow, the Job Service is responsible for controlling the execution of the time-triggered actions. And thus, all the time-based states that you can use in a workflow, are handled by the interaction between the workflow and the Job Service.</p>
</div>
<div class="paragraph">
<p>For example, every time the workflow execution reaches a state with a configured timeout, a corresponding job is created in the Job Service, and when the timeout is met, a http callback is executed to notify the workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/job-services/Time-Based-States-And-Job-Service-Interaction.png" alt="Time Based States And Job Service Interaction">
</div>
</div>
<div class="paragraph">
<p>To set up this integration you can use different <a href="../use-cases/advanced-developer-use-cases/job-service/quarkus-extensions.html#job-service-quarkus-extensions" class="xref page">communication alternatives</a>, that must be configured by combining the Job Service and the Quarkus Workflow Project configurations.
Alternatively, when you work with SonataFlow Operator workflow deployments, the operator can manage all these configurations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the project is not configured to use the Job Service, all time-based actions will use an in-memory implementation of that service.
However, this setup must not be used in production, since every time the application is restarted, all the timers are lost, making it unsuitable for serverless architectures where applications might scale to zero at any time, etc.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are working with the SonataFlow Operator be sure that you read this section <a href="#_sonataflow_operator_managed_deployment">SonataFlow Operator managed deployments</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jobs_life_span"><a class="anchor" href="#_jobs_life_span"></a>Jobs life-span</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since the main goal of the Job Service is to work with the active jobs, such as the scheduled jobs that needs to be executed, when a job reaches a final state, it is removed from the Job Service.
However, in some cases where you want to keep the information about the jobs in a permanent repository, you can configure the Job Service to produce status change events, that can be collected by the <a href="../data-index/data-index-core-concepts.html" class="xref page">Data Index Service</a>, where they can be indexed and made available by GraphQL queries.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sonataflow_operator_managed_deployment"><a class="anchor" href="#_sonataflow_operator_managed_deployment"></a>SonataFlow Operator managed deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you work with the SonataFlow Operator to deploy your workflows, there&#8217;s no need to do any manual Job Service installation or configuration, the operator already has the ability to do that.
Additionally, it can manage all the required configurations for every workflow to connect with it.</p>
</div>
<div class="paragraph">
<p>To learn how to install and configure the Job Service in this case, you must read the <a href="../cloud/operator/supporting-services.html" class="xref page">Operator Supporting Services</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="executing"><a class="anchor" href="#executing"></a>Custom Execution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To execute the Job Service in your docker or Kubernetes environment, you must use any of the following images, depending on the persistence mechanism to use <a href="#job-service-postgresql">PostgreSQL</a> or <a href="#job-service-ephemeral">Ephemeral</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>docker.io/apache/incubator-kie-kogito-jobs-service-postgresql</code></p>
</li>
<li>
<p><code>docker.io/apache/incubator-kie-kogito-jobs-ephemeral</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the next topics you can see how to configure them.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <a href="#job-service-global-configurations">common configurations</a> and the <a href="#job-service-eventing-api">eventing API configurations</a> are the same for both images.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We recommend that you follow this procedure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify the image to use depending on the persistence mechanism, and see the required configuration parameters specific for that image.</p>
</li>
<li>
<p>Identify if the <a href="#job-service-eventing-api">Eventing API</a> is required for your needs and see the required configuration parameters.</p>
</li>
<li>
<p>Identify if the project containing your workflows is configured with the appropriate <a href="../use-cases/advanced-developer-use-cases/job-service/quarkus-extensions.html#job-service-quarkus-extensions" class="xref page">Job Service Quarkus Extension</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Finally, when you run the image, you must pass these configurations using <a href="#using-environent-variables">environment variables</a> or using <a href="#using-java-like-system-properties">system properties with java like names</a>.</p>
</div>
<div class="sect2">
<h3 id="using-environent-variables"><a class="anchor" href="#using-environent-variables"></a>Using environment variables</h3>
<div class="paragraph">
<p>To configure the image by using environment variables you must pass one environment variable per each parameter.</p>
</div>
<div class="listingblock">
<div class="title">Job Service image configuration for docker execution example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -it -e QUARKUS_DATASOURCE_USERNAME=postgres -e VARIABLE_NAME=value docker.io/apache/incubator-kie-kogito-jobs-service-postgresql:latest</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Job Service image configuration for Kubernetes execution example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  containers:
    - name: jobs-service-postgresql
      image: docker.io/apache/incubator-kie-kogito-jobs-service-postgresql:latest
      imagePullPolicy: Always
      ports:
        - containerPort: 8080
          name: http
          protocol: TCP
      env:
        # Set the image parameters as environment variables in the container definition.
        - name: KUBERNETES_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: QUARKUS_DATASOURCE_USERNAME
          value: postgres
        - name: QUARKUS_DATASOURCE_PASSWORD
          value: pass
        - name: QUARKUS_DATASOURCE_JDBC_URL
          value: jdbc:postgresql://timeouts-showcase-database:5432/postgres?currentSchema=jobs-service
        - name: QUARKUS_DATASOURCE_REACTIVE_URL
          value: postgresql://timeouts-showcase-database:5432/postgres?search_path=jobs-service</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is the recommended approach when you execute the Job Service in Kubernetes.
The timeouts showcase example <a href="../use-cases/advanced-developer-use-cases/timeouts/timeout-showcase-example.html#execute-quarkus-project-standalone-services" class="xref page">Quarkus Workflow Project with standalone services</a> contains an example of this configuration, <a href="https://github.com/apache/incubator-kie-kogito-examples/tree/main/serverless-workflow-examples/serverless-workflow-timeouts-showcase-extended/kubernetes/jobs-service-postgresql.yml#L65">see</a>.
On the other hand, when you work with the SonataFlow Operator, it can automatically manage all these configurations, <a href="../cloud/operator/supporting-services.html" class="xref page">see</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="using-java-like-system-properties"><a class="anchor" href="#using-java-like-system-properties"></a>Using system properties with java like names</h3>
<div class="paragraph">
<p>To configure the image by using system properties you must pass one property per parameter, however, in this case, all these properties are passed as part of a single environment with the name <code>JAVA_OPTIONS</code>.</p>
</div>
<div class="listingblock">
<div class="title">Job Service image configuration for docker execution example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -it -e JAVA_OPTIONS='-Dquarkus.datasource.username=postgres -Dmy.sys.prop1=value1 -Dmy.sys.prop2=value2' \
docker.io/apache/incubator-kie-kogito-jobs-service-postgresql:latest</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>I case that you need to convert a java like property name, to the corresponding environment variable name, to use the environment variables configuration alternative, you must apply the naming convention defined in the <a href="https://quarkus.io/guides/config-reference#environment-variables">Quarkus Configuration Reference</a>.
For example, the name <code>quarkus.datasource.jdbc.url</code> must be converted to <code>QUARKUS_DATASOURCE_JDBC_URL</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="job-service-global-configurations"><a class="anchor" href="#job-service-global-configurations"></a>Common configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Common configurations that affect the job execution retries, startup procedure, etc.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_using-environment-variables"></a>Using environment variables</p>
</li>
<li>
<p><a id="tabset1_using-system-properties-with-java-like-names"></a>Using system properties with java like names</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_using-environment-variables">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KOGITO_JOBS_SERVICE_BACKOFFRETRYMILLIS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long value that defines the retry back-off time in milliseconds between job execution attempts, in case the execution fails.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KOGITO_JOBS_SERVICE_MAXINTERVALLIMITTORETRYMILLIS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long value that defines the maximum interval in milliseconds when retrying to execute jobs, in case the execution fails.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60000</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="tab-pane" aria-labelledby="tabset1_using-system-properties-with-java-like-names">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.backoffRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long value that defines the retry back-off time in milliseconds between job execution attempts, in case the execution fails.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.maxIntervalLimitToRetryMillis</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A long value that defines the maximum interval in milliseconds when retrying to execute jobs, in case the execution fails.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60000</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="job-service-postgresql"><a class="anchor" href="#job-service-postgresql"></a>Job Service PostgreSQL Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PostgreSQL is the recommended database to use with the Job Service.
Additionally, it provides an initialization procedure that integrates Flyway for the database initialization. Which automatically controls the database schema, in this way, the tables are created or updated by the service when required.</p>
</div>
<div class="paragraph">
<p>In case you need to externally control the database schema, you can check and apply the DDL scripts for the Job Service in the same way as described in
<a href="../use-cases/advanced-developer-use-cases/persistence/postgresql-flyway-migration.html#manually-executing-scripts" class="xref page">Manually executing scripts</a> guide.</p>
</div>
<div class="paragraph">
<p>To configure the Job Service PostgreSQL you must provide these configurations:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset2_using-environment-variables"></a>Using environment variables</p>
</li>
<li>
<p><a id="tabset2_using-system-properties-with-java-like-names"></a>Using system properties with java like names</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset2_using-environment-variables">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARKUS_DATASOURCE_USERNAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username to connect to the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgres</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARKUS_DATASOURCE_PASSWORD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password to connect to the database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pass</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARKUS_DATASOURCE_JDBC_URL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC datasource url used by Flyway to connect to the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jdbc:postgresql://timeouts-showcase-database:5432/postgres?currentSchema=jobs-service</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARKUS_DATASOURCE_REACTIVE_URL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reactive datasource url used by the Job Service to connect to the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgresql://timeouts-showcase-database:5432/postgres?search_path=jobs-service</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="tab-pane" aria-labelledby="tabset2_using-system-properties-with-java-like-names">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.datasource.username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username to connect to the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgres</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.datasource.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password to connect to the database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pass</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.datasource.jdbc.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC datasource url used by Flyway to connect to the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jdbc:postgresql://timeouts-showcase-database:5432/postgres?currentSchema=jobs-service</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.datasource.reactive.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reactive datasource url used by the Job Service to connect to the database.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgresql://timeouts-showcase-database:5432/postgres?search_path=jobs-service</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>The timeouts showcase example <a href="../use-cases/advanced-developer-use-cases/timeouts/timeout-showcase-example.html#execute-quarkus-project-standalone-services" class="xref page">Quarkus Workflow Project with standalone services</a>, shows how to run a PostgreSQL based Job Service as a Kubernetes deployment.
In your local environment you might have to change some of these values to point to your own PostgreSQL database.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="job-service-ephemeral"><a class="anchor" href="#job-service-ephemeral"></a>Job Service Ephemeral Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Ephemeral persistence mechanism is based on an embedded PostgreSQL database and does not require any specific configuration other thant the <a href="#job-service-global-configurations">common configurations</a> and the <a href="#job-service-eventing-api">Eventing API</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The database is recreated on each service restart, and thus, it must be used only for testing purposes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="job-service-eventing-api"><a class="anchor" href="#job-service-eventing-api"></a>Eventing API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Job Service provides a Cloud Event based API that can be used to create and delete jobs.
This API is useful in deployment scenarios where you want to use an event based communication from the workflow runtime to the Job Service. For the transport of these events you can use the <a href="#knative-eventing">Knative eventing</a> system or the <a href="#kafka-messaging">kafka messaging</a> system.</p>
</div>
<div class="sect2">
<h3 id="knative-eventing"><a class="anchor" href="#knative-eventing"></a>Knative eventing</h3>
<div class="paragraph">
<p>By default, the Job Service Eventing API is prepared to work in a <a href="https://knative.dev/docs/eventing/">Knative eventing</a> system. This means that by adding no additional configurations parameters, it&#8217;ll be able to receive cloud events via the <a href="https://knative.dev/docs/eventing/">Knative eventing</a> system to manage the jobs.
However, you must still prepare your <a href="https://knative.dev/docs/eventing/">Knative eventing</a> environment to ensure these events are properly delivered to the Job Service, see <a href="#knative-eventing-supporting-resources">Knative eventing supporting resources</a>.</p>
</div>
<div class="paragraph">
<p>Finally, the only configuration parameter that you must set, when needed, is to enable the propagation of the Job Status Change events, for example, if you want to register these events in the <a href="../data-index/data-index-core-concepts.html" class="xref page">Data Index Service</a>.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset3_using-environment-variables"></a>Using environment variables</p>
</li>
<li>
<p><a id="tabset3_using-system-properties-with-java-like-names"></a>Using system properties with java like names</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset3_using-environment-variables">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KOGITO_JOBS_SERVICE_HTTP_JOB_STATUS_CHANGE_EVENTS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> to establish if the Job Status Change events must be propagated. If you set this value to <code>true</code> you must be sure that the <a href="#knative-eventing-supporting-resources-sink-binding">sink binding</a> was created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="tab-pane" aria-labelledby="tabset3_using-system-properties-with-java-like-names">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.http.job-status-change-events</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> to establish if the Job Status Change events must be propagated. If you set this value to <code>true</code> you must be sure that the <a href="#knative-eventing-supporting-resources-sink-binding">sink binding</a> was created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="knative-eventing-supporting-resources"><a class="anchor" href="#knative-eventing-supporting-resources"></a>Knative eventing supporting resources</h4>
<div class="paragraph">
<p>To ensure the Job Service receives the Knative events to manage the jobs, you must create the <a href="#knative-eventing-supporting-resources-trigger-create">create job events</a> and <a href="#knative-eventing-supporting-resources-trigger-delete">delete job events</a> triggers shown in the diagram below.
Additionally, if you have enabled the Job Status Change events propagation you must create the <a href="#knative-eventing-supporting-resources-sink-binding">sink binding</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/job-services/Knative-Eventing-API-Resources.png" alt="Knative Eventing API Resources">
</div>
<div class="title">Figure 1. Knative eventing supporting resources</div>
</div>
<div class="paragraph">
<p>The following snippets shows an example on how you can configure these resources. Consider that these configurations might need to be adjusted to your local kubernetes cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We recommend that you visit this example <a href="../use-cases/advanced-developer-use-cases/timeouts/timeout-showcase-example.html#execute-quarkus-project-standalone-services" class="xref page">Quarkus Workflow Project with standalone services</a> to see a full setup of all these configurations.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="knative-eventing-supporting-resources-trigger-create" class="listingblock">
<div class="title">Create Job event trigger configuration example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: jobs-service-postgresql-create-job-trigger
spec:
  broker: default
  filter:
    attributes:
      type: job.create
  subscriber:
    ref:
      apiVersion: v1
      kind: Service
      name: jobs-service-postgresql
    uri: /v2/jobs/events</code></pre>
</div>
</div>
<div id="knative-eventing-supporting-resources-trigger-delete" class="listingblock">
<div class="title">Delete Job event trigger configuration example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: eventing.knative.dev/v1
kind: Trigger
metadata:
  name: jobs-service-postgresql-delete-job-trigger
spec:
  broker: default
  filter:
    attributes:
      type: job.delete
  subscriber:
    ref:
      apiVersion: v1
      kind: Service
      name: jobs-service-postgresql
    uri: /v2/jobs/events</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about triggers, see <a href="https://knative.dev/docs/eventing/triggers/">Knative Triggers</a>.</p>
</div>
<div id="knative-eventing-supporting-resources-sink-binding" class="listingblock">
<div class="title">Job Service sink binding configuration example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: sources.knative.dev/v1
kind: SinkBinding
metadata:
  name: jobs-service-postgresql-sb
spec:
  sink:
    ref:
      apiVersion: eventing.knative.dev/v1
      kind: Broker
      name: default
  subject:
    apiVersion: apps/v1
    kind: Deployment
    selector:
      matchLabels:
        app.kubernetes.io/name: jobs-service-postgresql
        app.kubernetes.io/version: 2.0.0-SNAPSHOT</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about sink bindings, see <a href="https://knative.dev/docs/eventing/sinks/#sink-parameter-example">Knative Sink Bindings</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="kafka-messaging"><a class="anchor" href="#kafka-messaging"></a>Kafka messaging</h3>
<div class="paragraph">
<p>To enable the Job Service Eventing API via the Kafka messaging system you must provide these configurations:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset4_using-environment-variables"></a>Using environment variables</p>
</li>
<li>
<p><a id="tabset4_using-system-properties-with-java-like-names"></a>Using system properties with java like names</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset4_using-environment-variables">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>QUARKUS_PROFILE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the quarkus profile with the value <code>kafka-events-support</code> to enable the kafka messaging based Job Service Eventing API.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, the kafka eventing api is disabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KOGITO_JOBS_SERVICE_KAFKA_JOB_STATUS_CHANGE_EVENTS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> to establish if the Job Status Change events must be propagated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>KAFKA_BOOTSTRAP_SERVERS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of host:port to use for establishing the initial connection to the Kafka cluster.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost:9092</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MP_MESSAGING_INCOMING_KOGITO_JOB_SERVICE_JOB_REQUEST_EVENTS_V2_TOPIC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka topic for events API incoming events. In general you don&#8217;t need to change this value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito-job-service-job-request-events-v2</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MP_MESSAGING_OUTGOING_KOGITO_JOB_SERVICE_JOB_STATUS_EVENTS_TOPIC</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka topic for job status change outgoing events. In general you don&#8217;t need to change this value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito-jobs-events</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tab-pane" aria-labelledby="tabset4_using-system-properties-with-java-like-names">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.profile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the quarkus profile with the value <code>kafka-events-support</code> to enable the kafka messaging based Job Service Eventing API.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, the kafka eventing api is disabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito.jobs-service.kafka.job-status-change-events</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> to establish if the Job Status Change events must be propagated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kafka.bootstrap.servers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma-separated list of host:port to use for establishing the initial connection to the Kafka cluster.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost:9092</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.incoming.kogito-job-service-job-request-events-v2.topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka topic for events API incoming events. In general you don&#8217;t need to change this value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito-job-service-job-request-events-v2</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mp.messaging.outgoing.kogito-job-service-job-status-events.topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kafka topic for job status change outgoing events. In general you don&#8217;t need to change this value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>kogito-jobs-events</code> when the <code>kafka-events-support</code> profile is set.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Depending on your Kafka messaging system configuration you might need to apply additional Kafka configurations to connect to the Kafka broker, etc.
To see the list of all the supported configurations you must read the <a href="https://quarkus.io/guides/kafka">Quarkus Apache Kafka Reference Guide</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_leader_election"><a class="anchor" href="#_leader_election"></a>Leader election</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently, the Job Service is a singleton service, and thus, just one active instance of the service can be scheduling and executing the jobs.</p>
</div>
<div class="paragraph">
<p>To avoid issues when it is deployed in the cloud, where it is common to eventually have more than one instance deployed, the Job Service supports a leader instance election process.
Only the instance that becomes the leader activates the external communication to receive and schedule jobs.</p>
</div>
<div class="paragraph">
<p>All the instances that are not leaders, stay inactive in a wait state and try to become the leader continuously.</p>
</div>
<div class="paragraph">
<p>When a new instance of the service is started, it is not set as a leader at startup time but instead, it starts the process to become one.</p>
</div>
<div class="paragraph">
<p>When an instance that is the leader for any issue stays unresponsive or is shut down, one of the other running instances becomes the leader.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/job-services/job-service-leader.png" alt="job service leader">
</div>
<div class="title">Figure 2. Job Service leader election</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This leader election mechanism uses the underlying persistence backend, which currently is only supported in the PostgreSQL implementation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There is no need for any configuration to support this feature, the only requirement is to have the supported database with the data schema up-to-date as described in the <a href="#job-service-postgresql">Job Service PostgreSQL Configuration</a> section.</p>
</div>
<div class="paragraph">
<p>In case the underlying persistence does not support this feature, you must guarantee that just one single instance of the Job Service is running at the same time.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_found_an_issue"><a class="anchor" href="#_found_an_issue"></a><em><strong>Found an issue?</strong></em></h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you find an issue or any misleading information, please feel free to report it <a href="https://github.com/apache/incubator-kie-kogito-docs/issues/new">here</a>.
We really appreciate it!</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/tabsBehavior.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
